# Matchstick-Man-Battle （公测版）

## 游戏简介

本游戏是基于moonbit语言作为基础，通过ffi链接了[`box2d`](https://box2d.org/)，(`P5js`)[https://p5js.org/]和浏览器js环境，构建出的基于js后端的纯网页游戏。

游戏项目地址[Matchstick_Man_Battle](https://github.com/Great-Love-League/Matchstick_Man_Battle)，[初赛提交发布包](https://github.com/Great-Love-League/Matchstick_Man_Battle/releases/tag/V1.0.0)

灵感源自广受欢迎的《Stick Fight: The Game》([Steam 上的 Stick Fight: The Game](https://store.steampowered.com/app/674940/Stick_Fight_The_Game/))，我们为您呈现一场发生在未来科幻世界的火柴人大乱斗！

准备好操控你的火柴人，来一场基于物理引擎的魔性乱斗了吗？在这里，每一次走位都可能出乎意料，每一次对决都充满爆笑。地图中遍布着致命的动态机关和颠覆战局的随机“特性”，让战斗的每一秒都充满变数与惊喜。

操作极其简单，让你瞬间上手，立即投身于这场激情四射的大乱斗！别再犹豫，现在就叫上你的伙伴，在这混乱又欢乐的战场上，为了唯一的胜利桂冠，战个痛快！

## 操作说明

### 玩家操作

游戏目前是双人游戏，玩家可以实现以下操作

1. 切换武器
2. 左右上移动
3. 快速下坠/瘫软
4. 射击
5. 自动瞄准（自动打开）

对于P0

1. 切换武器 `1,2,3,4`
2. 左右上移动 `a,d,w`
3. 快速下坠/瘫软 `s`
4. 射击 `z`
5. 自动瞄准 `T` 切换状态

对于 P1

1. 切换武器 `7,8,9,0`
2. 左右上移动 `ArrowLeft,ArrowRight,ArrowUp`
3. 快速下坠/瘫软 `ArrowDown`
4. 射击 `slash`（问号/斜杠键）
5. 自动瞄准 `.`（句号键） 切换状态

玩家一共有5中武器可供选择，分别是小手枪，散弹枪，狙击步枪，机关枪。具体特色待各位玩家自行探索。

> 玩家还有一个神秘按钮，双方共有，效果十分炸裂，希望玩家自行探索！

### 游戏Router

+ 暂停 `p` 键，暂停后可以通过 `1,2,3,4,5`选择关卡
+ 胜利后按 `R` 重启游戏
+ 胜利后可以通过 `1,2,3,4,5`选择关卡

### 子弹伤害

子弹击中玩家不同部分的伤害不同，头部有双倍暴击伤害，四肢会有一个衰减系数

## 技术特色

### 手搓游戏引擎

在技术选型上，我们选择了最艰难但也最精彩的道路——自主研发。虽然放弃了官方提供的 selene 引擎，但我们凭借扎实的技术实力，构建了一套性能与灵活性并存的定制化引擎。
我们的引擎不仅完美复刻了 selene 的灵活性，更在复杂物理碰撞检测、高并发子弹运算、沉浸式音效处理及动态特效系统上，展现出了超越通用方案的优越性。这套引擎是我们技术实力的证明，也是游戏品质的基石。详细信息可以查看我们的[游戏](https://moonbitlang.github.io/MoonBit-Code-JAM-2025/1297087-%E5%A4%A9%E5%9C%B0%E4%B8%80%EF%BC%81%E5%B1%8B%EF%BC%81%E5%A4%A7%E7%88%B1%E7%9B%9F-Matchstick-Man-Battle/artifact/index.html)以及[代码仓库](https://github.com/Great-Love-League/Matchstick_Man_Battle/blob/master/src/server/game.mbt)

### 基于trait

在游戏的核心设计上，我们遵循“组合优于继承”的现代编程哲学，广泛采用了基于Trait的开发模式。

这种方式让我们能够将枪支的射击模式、子弹的飞行轨迹、平台的物理特性、特效的视觉表现乃至音效的触发逻辑，都解构成一个个独立的“特性”单元。

对玩家而言，这意味着：

+ 玩法的高度可塑性： 我们可以将这些“特性”自由组合，创造出传统开发模式下难以实现的新奇道具和互动机制，让每一次战斗都充满变数。
+ 卓越的稳定性： 通过对所有游戏对象的统一管理，我们极大地提升了游戏的健壮性，确保您在享受混乱乐趣的同时，拥有一个稳定可靠的游戏环境。
+ 敏捷的内容迭代： 这种高效的架构使我们的团队能够快速响应需求，持续不断地为游戏注入新的活力。

### 移植现有js库

我们本次对于开源的两个著名的库进行了ffi移植并且依托于moon包管理进行了开源。在现有依赖的情况下，我们获得了强大了2D物理引擎与方便的前端canvas渲染引擎

+ [MoonP5](https://mooncakes.io/docs/Demonmasterlqx/MoonP5)
+ [box2d_ffi](https://mooncakes.io/docs/Demonmasterlqx/box2d_ffi)

### 优秀的美术设计

我们坚信，顶级的视听效果能将乱斗的乐趣放大十倍。为此，我们倾注了大量心血，为您打造了一个生动而真实的战场。

+ 独一无二的战场交响曲： 我们创新地结合了前沿的AI生成技术与专业游戏音效采样，为每一个精心设计的关卡都创作了独一无二的BGM。无论是未来都市的赛博朋克节奏，还是神秘地堡的紧张氛围，音乐将完美契合战斗的起承转合。
+ 拳拳到肉的音效反馈： 子弹的每一次呼啸、每一次精准打击和每一次滑稽的阵亡，都有着经过精心调校的音效反馈，让每一次操作都充满爽快感。
+ 炫酷的视觉风格： 我们同样在视觉层面追求极致。从风格迥异、细节满满的战斗地图，到海量酷炫、彰显个性的武器外观，再到可以在战场上肆意挥洒的趣味贴纸，子弹命中的血雾特效。让您有沉浸式的游戏体验

## 团队信息

团队由香港科技大学广州与中山大学的大二本科生共同组成，大多数成员是 [`MGPIC 2024`]([飞机大战](https://moonbitlang.github.io/MoonBit-Code-JAM-2024/天地一！屋！大爱盟/index.html)) 的决赛成员

联系我们

1. [邮箱](qli299@connect.hkust-gz.edu.cn)

## 视频链接

[《Matchstick-Man-Battle》震撼级超级内测发布](https://www.bilibili.com/video/BV14aJ9zfEgb/?vd_source=7c5af907927ab5070c4787c2f1712d49)

[别管！是Moonbit把Box2D玩坏了！]https://www.bilibili.com/video/BV1FbCTBfEYF/?vd_source=7c5af907927ab5070c4787c2f1712d49