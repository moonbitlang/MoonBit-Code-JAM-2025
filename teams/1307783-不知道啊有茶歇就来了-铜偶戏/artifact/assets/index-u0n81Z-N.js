import{T as $c,a as ca,b as fr,L as pr,c as vn,F as ao,M as ds,V as Ct,C as ts,d as us,S as bt,e as Pc,P as Qs,D as cs,f as Ks,g as ke,I as hr,Q as un,h as Lc,O as mr,i as dn,j as Ic,B as wn,k as Oc,l as gr,N as Dc,m as Nc,n as Gc,o as ua,p as _r,R as Ss,q as Hc,r as Uc,s as Fc,t as jo,u as Bc,v as pt,w as Nt,x as ht,y as jc,z as yr,A as zc,E as et,G as Vc,H as Wc,J as Kc,K as qc,U as Jt,W as Hn,X as vr,Y as Xc,Z as Yc,_ as Jc,$ as Zc,a0 as Qc,a1 as wr,a2 as eu,a3 as ai,a4 as ii,a5 as ri,a6 as li,a7 as da,a8 as tu,a9 as su,aa as xt,ab as nu,ac as ou,ad as rs,ae as wo,af as bo,ag as So,ah as au,ai as iu,aj as tn,ak as en,al as ci,am as ru,an as br,ao as Rn,ap as fa,aq as io,ar as lu,as as cu,at as uu,au as du,av as ui,aw as pa,ax as fu,ay as di}from"./three-DALeLLf3.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();const pu="release";function f(...t){switch(pu){case"debug":console.log(...t);break}}/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function $a(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const qe={},sn=[],Qt=()=>{},Sr=()=>!1,Mo=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Pa=t=>t.startsWith("onUpdate:"),_t=Object.assign,La=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},hu=Object.prototype.hasOwnProperty,ze=(t,e)=>hu.call(t,e),Te=Array.isArray,nn=t=>To(t)==="[object Map]",Mr=t=>To(t)==="[object Set]",Ae=t=>typeof t=="function",ot=t=>typeof t=="string",Os=t=>typeof t=="symbol",Ze=t=>t!==null&&typeof t=="object",Tr=t=>(Ze(t)||Ae(t))&&Ae(t.then)&&Ae(t.catch),Cr=Object.prototype.toString,To=t=>Cr.call(t),mu=t=>To(t).slice(8,-1),Er=t=>To(t)==="[object Object]",Ia=t=>ot(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,bn=$a(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Co=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},gu=/-\w/g,$s=Co(t=>t.replace(gu,e=>e.slice(1).toUpperCase())),_u=/\B([A-Z])/g,Xs=Co(t=>t.replace(_u,"-$1").toLowerCase()),xr=Co(t=>t.charAt(0).toUpperCase()+t.slice(1)),zo=Co(t=>t?`on${xr(t)}`:""),Rs=(t,e)=>!Object.is(t,e),Vo=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},kr=(t,e,s,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:s})},yu=t=>{const e=parseFloat(t);return isNaN(e)?t:e},vu=t=>{const e=ot(t)?Number(t):NaN;return isNaN(e)?t:e};let fi;const Eo=()=>fi||(fi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function zt(t){if(Te(t)){const e={};for(let s=0;s<t.length;s++){const n=t[s],o=ot(n)?Mu(n):zt(n);if(o)for(const a in o)e[a]=o[a]}return e}else if(ot(t)||Ze(t))return t}const wu=/;(?![^(]*\))/g,bu=/:([^]+)/,Su=/\/\*[^]*?\*\//g;function Mu(t){const e={};return t.replace(Su,"").split(wu).forEach(s=>{if(s){const n=s.split(bu);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Je(t){let e="";if(ot(t))e=t;else if(Te(t))for(let s=0;s<t.length;s++){const n=Je(t[s]);n&&(e+=n+" ")}else if(Ze(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const Tu="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Cu=$a(Tu);function Ar(t){return!!t||t===""}const Rr=t=>!!(t&&t.__v_isRef===!0),Q=t=>ot(t)?t:t==null?"":Te(t)||Ze(t)&&(t.toString===Cr||!Ae(t.toString))?Rr(t)?Q(t.value):JSON.stringify(t,$r,2):String(t),$r=(t,e)=>Rr(e)?$r(t,e.value):nn(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[n,o],a)=>(s[Wo(n,a)+" =>"]=o,s),{})}:Mr(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>Wo(s))}:Os(e)?Wo(e):Ze(e)&&!Te(e)&&!Er(e)?String(e):e,Wo=(t,e="")=>{var s;return Os(t)?`Symbol(${(s=t.description)!=null?s:e})`:t};function Eu(t){return t==null?"initial":typeof t=="string"?t===""?" ":t:String(t)}/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let It;class xu{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=It,!e&&It&&(this.index=(It.scopes||(It.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].pause();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].resume();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].resume()}}run(e){if(this._active){const s=It;try{return It=this,e()}finally{It=s}}}on(){++this._on===1&&(this.prevScope=It,It=this)}off(){this._on>0&&--this._on===0&&(It=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(this.effects.length=0,s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function ku(){return It}let Ye;const Ko=new WeakSet;class Pr{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,It&&It.active&&It.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ko.has(this)&&(Ko.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Ir(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,pi(this),Or(this);const e=Ye,s=es;Ye=this,es=!0;try{return this.fn()}finally{Dr(this),Ye=e,es=s,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Na(e);this.deps=this.depsTail=void 0,pi(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ko.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){ha(this)&&this.run()}get dirty(){return ha(this)}}let Lr=0,Sn,Mn;function Ir(t,e=!1){if(t.flags|=8,e){t.next=Mn,Mn=t;return}t.next=Sn,Sn=t}function Oa(){Lr++}function Da(){if(--Lr>0)return;if(Mn){let e=Mn;for(Mn=void 0;e;){const s=e.next;e.next=void 0,e.flags&=-9,e=s}}let t;for(;Sn;){let e=Sn;for(Sn=void 0;e;){const s=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=s}}if(t)throw t}function Or(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Dr(t){let e,s=t.depsTail,n=s;for(;n;){const o=n.prevDep;n.version===-1?(n===s&&(s=o),Na(n),Au(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=o}t.deps=e,t.depsTail=s}function ha(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Nr(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Nr(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===$n)||(t.globalVersion=$n,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!ha(t))))return;t.flags|=2;const e=t.dep,s=Ye,n=es;Ye=t,es=!0;try{Or(t);const o=t.fn(t._value);(e.version===0||Rs(o,t._value))&&(t.flags|=128,t._value=o,e.version++)}catch(o){throw e.version++,o}finally{Ye=s,es=n,Dr(t),t.flags&=-3}}function Na(t,e=!1){const{dep:s,prevSub:n,nextSub:o}=t;if(n&&(n.nextSub=o,t.prevSub=void 0),o&&(o.prevSub=n,t.nextSub=void 0),s.subs===t&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let a=s.computed.deps;a;a=a.nextDep)Na(a,!0)}!e&&!--s.sc&&s.map&&s.map.delete(s.key)}function Au(t){const{prevDep:e,nextDep:s}=t;e&&(e.nextDep=s,t.prevDep=void 0),s&&(s.prevDep=e,t.nextDep=void 0)}let es=!0;const Gr=[];function Ms(){Gr.push(es),es=!1}function Ts(){const t=Gr.pop();es=t===void 0?!0:t}function pi(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const s=Ye;Ye=void 0;try{e()}finally{Ye=s}}}let $n=0;class Ru{constructor(e,s){this.sub=e,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ga{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Ye||!es||Ye===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==Ye)s=this.activeLink=new Ru(Ye,this),Ye.deps?(s.prevDep=Ye.depsTail,Ye.depsTail.nextDep=s,Ye.depsTail=s):Ye.deps=Ye.depsTail=s,Hr(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const n=s.nextDep;n.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=n),s.prevDep=Ye.depsTail,s.nextDep=void 0,Ye.depsTail.nextDep=s,Ye.depsTail=s,Ye.deps===s&&(Ye.deps=n)}return s}trigger(e){this.version++,$n++,this.notify(e)}notify(e){Oa();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{Da()}}}function Hr(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)Hr(n)}const s=t.dep.subs;s!==t&&(t.prevSub=s,s&&(s.nextSub=t)),t.dep.subs=t}}const ma=new WeakMap,qs=Symbol(""),ga=Symbol(""),Pn=Symbol("");function wt(t,e,s){if(es&&Ye){let n=ma.get(t);n||ma.set(t,n=new Map);let o=n.get(s);o||(n.set(s,o=new Ga),o.map=n,o.key=s),o.track()}}function vs(t,e,s,n,o,a){const i=ma.get(t);if(!i){$n++;return}const r=l=>{l&&l.trigger()};if(Oa(),e==="clear")i.forEach(r);else{const l=Te(t),c=l&&Ia(s);if(l&&s==="length"){const u=Number(n);i.forEach((d,h)=>{(h==="length"||h===Pn||!Os(h)&&h>=u)&&r(d)})}else switch((s!==void 0||i.has(void 0))&&r(i.get(s)),c&&r(i.get(Pn)),e){case"add":l?c&&r(i.get("length")):(r(i.get(qs)),nn(t)&&r(i.get(ga)));break;case"delete":l||(r(i.get(qs)),nn(t)&&r(i.get(ga)));break;case"set":nn(t)&&r(i.get(qs));break}}Da()}function Ys(t){const e=je(t);return e===t?e:(wt(e,"iterate",Pn),Kt(t)?e:e.map(gt))}function xo(t){return wt(t=je(t),"iterate",Pn),t}const $u={__proto__:null,[Symbol.iterator](){return qo(this,Symbol.iterator,gt)},concat(...t){return Ys(this).concat(...t.map(e=>Te(e)?Ys(e):e))},entries(){return qo(this,"entries",t=>(t[1]=gt(t[1]),t))},every(t,e){return ms(this,"every",t,e,void 0,arguments)},filter(t,e){return ms(this,"filter",t,e,s=>s.map(gt),arguments)},find(t,e){return ms(this,"find",t,e,gt,arguments)},findIndex(t,e){return ms(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return ms(this,"findLast",t,e,gt,arguments)},findLastIndex(t,e){return ms(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return ms(this,"forEach",t,e,void 0,arguments)},includes(...t){return Xo(this,"includes",t)},indexOf(...t){return Xo(this,"indexOf",t)},join(t){return Ys(this).join(t)},lastIndexOf(...t){return Xo(this,"lastIndexOf",t)},map(t,e){return ms(this,"map",t,e,void 0,arguments)},pop(){return hn(this,"pop")},push(...t){return hn(this,"push",t)},reduce(t,...e){return hi(this,"reduce",t,e)},reduceRight(t,...e){return hi(this,"reduceRight",t,e)},shift(){return hn(this,"shift")},some(t,e){return ms(this,"some",t,e,void 0,arguments)},splice(...t){return hn(this,"splice",t)},toReversed(){return Ys(this).toReversed()},toSorted(t){return Ys(this).toSorted(t)},toSpliced(...t){return Ys(this).toSpliced(...t)},unshift(...t){return hn(this,"unshift",t)},values(){return qo(this,"values",gt)}};function qo(t,e,s){const n=xo(t),o=n[e]();return n!==t&&!Kt(t)&&(o._next=o.next,o.next=()=>{const a=o._next();return a.done||(a.value=s(a.value)),a}),o}const Pu=Array.prototype;function ms(t,e,s,n,o,a){const i=xo(t),r=i!==t&&!Kt(t),l=i[e];if(l!==Pu[e]){const d=l.apply(t,a);return r?gt(d):d}let c=s;i!==t&&(r?c=function(d,h){return s.call(this,gt(d),h,t)}:s.length>2&&(c=function(d,h){return s.call(this,d,h,t)}));const u=l.call(i,c,n);return r&&o?o(u):u}function hi(t,e,s,n){const o=xo(t);let a=s;return o!==t&&(Kt(t)?s.length>3&&(a=function(i,r,l){return s.call(this,i,r,l,t)}):a=function(i,r,l){return s.call(this,i,gt(r),l,t)}),o[e](a,...n)}function Xo(t,e,s){const n=je(t);wt(n,"iterate",Pn);const o=n[e](...s);return(o===-1||o===!1)&&Ba(s[0])?(s[0]=je(s[0]),n[e](...s)):o}function hn(t,e,s=[]){Ms(),Oa();const n=je(t)[e].apply(t,s);return Da(),Ts(),n}const Lu=$a("__proto__,__v_isRef,__isVue"),Ur=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Os));function Iu(t){Os(t)||(t=String(t));const e=je(this);return wt(e,"has",t),e.hasOwnProperty(t)}class Fr{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,n){if(s==="__v_skip")return e.__v_skip;const o=this._isReadonly,a=this._isShallow;if(s==="__v_isReactive")return!o;if(s==="__v_isReadonly")return o;if(s==="__v_isShallow")return a;if(s==="__v_raw")return n===(o?a?zu:Vr:a?zr:jr).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const i=Te(e);if(!o){let l;if(i&&(l=$u[s]))return l;if(s==="hasOwnProperty")return Iu}const r=Reflect.get(e,s,St(e)?e:n);if((Os(s)?Ur.has(s):Lu(s))||(o||wt(e,"get",s),a))return r;if(St(r)){const l=i&&Ia(s)?r:r.value;return o&&Ze(l)?ya(l):l}return Ze(r)?o?ya(r):Ua(r):r}}class Br extends Fr{constructor(e=!1){super(!1,e)}set(e,s,n,o){let a=e[s];if(!this._isShallow){const l=Ps(a);if(!Kt(n)&&!Ps(n)&&(a=je(a),n=je(n)),!Te(e)&&St(a)&&!St(n))return l||(a.value=n),!0}const i=Te(e)&&Ia(s)?Number(s)<e.length:ze(e,s),r=Reflect.set(e,s,n,St(e)?e:o);return e===je(o)&&(i?Rs(n,a)&&vs(e,"set",s,n):vs(e,"add",s,n)),r}deleteProperty(e,s){const n=ze(e,s);e[s];const o=Reflect.deleteProperty(e,s);return o&&n&&vs(e,"delete",s,void 0),o}has(e,s){const n=Reflect.has(e,s);return(!Os(s)||!Ur.has(s))&&wt(e,"has",s),n}ownKeys(e){return wt(e,"iterate",Te(e)?"length":qs),Reflect.ownKeys(e)}}class Ou extends Fr{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const Du=new Br,Nu=new Ou,Gu=new Br(!0);const _a=t=>t,Vn=t=>Reflect.getPrototypeOf(t);function Hu(t,e,s){return function(...n){const o=this.__v_raw,a=je(o),i=nn(a),r=t==="entries"||t===Symbol.iterator&&i,l=t==="keys"&&i,c=o[t](...n),u=s?_a:e?ro:gt;return!e&&wt(a,"iterate",l?ga:qs),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:r?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function Wn(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Uu(t,e){const s={get(o){const a=this.__v_raw,i=je(a),r=je(o);t||(Rs(o,r)&&wt(i,"get",o),wt(i,"get",r));const{has:l}=Vn(i),c=e?_a:t?ro:gt;if(l.call(i,o))return c(a.get(o));if(l.call(i,r))return c(a.get(r));a!==i&&a.get(o)},get size(){const o=this.__v_raw;return!t&&wt(je(o),"iterate",qs),o.size},has(o){const a=this.__v_raw,i=je(a),r=je(o);return t||(Rs(o,r)&&wt(i,"has",o),wt(i,"has",r)),o===r?a.has(o):a.has(o)||a.has(r)},forEach(o,a){const i=this,r=i.__v_raw,l=je(r),c=e?_a:t?ro:gt;return!t&&wt(l,"iterate",qs),r.forEach((u,d)=>o.call(a,c(u),c(d),i))}};return _t(s,t?{add:Wn("add"),set:Wn("set"),delete:Wn("delete"),clear:Wn("clear")}:{add(o){!e&&!Kt(o)&&!Ps(o)&&(o=je(o));const a=je(this);return Vn(a).has.call(a,o)||(a.add(o),vs(a,"add",o,o)),this},set(o,a){!e&&!Kt(a)&&!Ps(a)&&(a=je(a));const i=je(this),{has:r,get:l}=Vn(i);let c=r.call(i,o);c||(o=je(o),c=r.call(i,o));const u=l.call(i,o);return i.set(o,a),c?Rs(a,u)&&vs(i,"set",o,a):vs(i,"add",o,a),this},delete(o){const a=je(this),{has:i,get:r}=Vn(a);let l=i.call(a,o);l||(o=je(o),l=i.call(a,o)),r&&r.call(a,o);const c=a.delete(o);return l&&vs(a,"delete",o,void 0),c},clear(){const o=je(this),a=o.size!==0,i=o.clear();return a&&vs(o,"clear",void 0,void 0),i}}),["keys","values","entries",Symbol.iterator].forEach(o=>{s[o]=Hu(o,t,e)}),s}function Ha(t,e){const s=Uu(t,e);return(n,o,a)=>o==="__v_isReactive"?!t:o==="__v_isReadonly"?t:o==="__v_raw"?n:Reflect.get(ze(s,o)&&o in n?s:n,o,a)}const Fu={get:Ha(!1,!1)},Bu={get:Ha(!1,!0)},ju={get:Ha(!0,!1)};const jr=new WeakMap,zr=new WeakMap,Vr=new WeakMap,zu=new WeakMap;function Vu(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Wu(t){return t.__v_skip||!Object.isExtensible(t)?0:Vu(mu(t))}function Ua(t){return Ps(t)?t:Fa(t,!1,Du,Fu,jr)}function Ku(t){return Fa(t,!1,Gu,Bu,zr)}function ya(t){return Fa(t,!0,Nu,ju,Vr)}function Fa(t,e,s,n,o){if(!Ze(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const a=Wu(t);if(a===0)return t;const i=o.get(t);if(i)return i;const r=new Proxy(t,a===2?n:s);return o.set(t,r),r}function on(t){return Ps(t)?on(t.__v_raw):!!(t&&t.__v_isReactive)}function Ps(t){return!!(t&&t.__v_isReadonly)}function Kt(t){return!!(t&&t.__v_isShallow)}function Ba(t){return t?!!t.__v_raw:!1}function je(t){const e=t&&t.__v_raw;return e?je(e):t}function qu(t){return!ze(t,"__v_skip")&&Object.isExtensible(t)&&kr(t,"__v_skip",!0),t}const gt=t=>Ze(t)?Ua(t):t,ro=t=>Ze(t)?ya(t):t;function St(t){return t?t.__v_isRef===!0:!1}function V(t){return Xu(t,!1)}function Xu(t,e){return St(t)?t:new Yu(t,e)}class Yu{constructor(e,s){this.dep=new Ga,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?e:je(e),this._value=s?e:gt(e),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(e){const s=this._rawValue,n=this.__v_isShallow||Kt(e)||Ps(e);e=n?e:je(e),Rs(e,s)&&(this._rawValue=e,this._value=n?e:gt(e),this.dep.trigger())}}function ue(t){return St(t)?t.value:t}const Ju={get:(t,e,s)=>e==="__v_raw"?t:ue(Reflect.get(t,e,s)),set:(t,e,s,n)=>{const o=t[e];return St(o)&&!St(s)?(o.value=s,!0):Reflect.set(t,e,s,n)}};function Wr(t){return on(t)?t:new Proxy(t,Ju)}class Zu{constructor(e,s,n){this.fn=e,this.setter=s,this._value=void 0,this.dep=new Ga(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=$n-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&Ye!==this)return Ir(this,!0),!0}get value(){const e=this.dep.track();return Nr(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Qu(t,e,s=!1){let n,o;return Ae(t)?n=t:(n=t.get,o=t.set),new Zu(n,o,s)}const Kn={},lo=new WeakMap;let zs;function ed(t,e=!1,s=zs){if(s){let n=lo.get(s);n||lo.set(s,n=[]),n.push(t)}}function td(t,e,s=qe){const{immediate:n,deep:o,once:a,scheduler:i,augmentJob:r,call:l}=s,c=v=>o?v:Kt(v)||o===!1||o===0?ws(v,1):ws(v);let u,d,h,m,g=!1,E=!1;if(St(t)?(d=()=>t.value,g=Kt(t)):on(t)?(d=()=>c(t),g=!0):Te(t)?(E=!0,g=t.some(v=>on(v)||Kt(v)),d=()=>t.map(v=>{if(St(v))return v.value;if(on(v))return c(v);if(Ae(v))return l?l(v,2):v()})):Ae(t)?e?d=l?()=>l(t,2):t:d=()=>{if(h){Ms();try{h()}finally{Ts()}}const v=zs;zs=u;try{return l?l(t,3,[m]):t(m)}finally{zs=v}}:d=Qt,e&&o){const v=d,L=o===!0?1/0:o;d=()=>ws(v(),L)}const S=ku(),_=()=>{u.stop(),S&&S.active&&La(S.effects,u)};if(a&&e){const v=e;e=(...L)=>{v(...L),_()}}let M=E?new Array(t.length).fill(Kn):Kn;const b=v=>{if(!(!(u.flags&1)||!u.dirty&&!v))if(e){const L=u.run();if(o||g||(E?L.some((F,j)=>Rs(F,M[j])):Rs(L,M))){h&&h();const F=zs;zs=u;try{const j=[L,M===Kn?void 0:E&&M[0]===Kn?[]:M,m];M=L,l?l(e,3,j):e(...j)}finally{zs=F}}}else u.run()};return r&&r(b),u=new Pr(d),u.scheduler=i?()=>i(b,!1):b,m=v=>ed(v,!1,u),h=u.onStop=()=>{const v=lo.get(u);if(v){if(l)l(v,4);else for(const L of v)L();lo.delete(u)}},e?n?b(!0):M=u.run():i?i(b.bind(null,!0),!0):u.run(),_.pause=u.pause.bind(u),_.resume=u.resume.bind(u),_.stop=_,_}function ws(t,e=1/0,s){if(e<=0||!Ze(t)||t.__v_skip||(s=s||new Map,(s.get(t)||0)>=e))return t;if(s.set(t,e),e--,St(t))ws(t.value,e,s);else if(Te(t))for(let n=0;n<t.length;n++)ws(t[n],e,s);else if(Mr(t)||nn(t))t.forEach(n=>{ws(n,e,s)});else if(Er(t)){for(const n in t)ws(t[n],e,s);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&ws(t[n],e,s)}return t}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Un(t,e,s,n){try{return n?t(...n):t()}catch(o){ko(o,e,s)}}function ss(t,e,s,n){if(Ae(t)){const o=Un(t,e,s,n);return o&&Tr(o)&&o.catch(a=>{ko(a,e,s)}),o}if(Te(t)){const o=[];for(let a=0;a<t.length;a++)o.push(ss(t[a],e,s,n));return o}}function ko(t,e,s,n=!0){const o=e?e.vnode:null,{errorHandler:a,throwUnhandledErrorInProduction:i}=e&&e.appContext.config||qe;if(e){let r=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${s}`;for(;r;){const u=r.ec;if(u){for(let d=0;d<u.length;d++)if(u[d](t,l,c)===!1)return}r=r.parent}if(a){Ms(),Un(a,null,10,[t,l,c]),Ts();return}}sd(t,s,o,n,i)}function sd(t,e,s,n=!0,o=!1){if(o)throw t;console.error(t)}const kt=[];let as=-1;const an=[];let ks=null,Zs=0;const Kr=Promise.resolve();let co=null;function Ln(t){const e=co||Kr;return t?e.then(this?t.bind(this):t):e}function nd(t){let e=as+1,s=kt.length;for(;e<s;){const n=e+s>>>1,o=kt[n],a=In(o);a<t||a===t&&o.flags&2?e=n+1:s=n}return e}function ja(t){if(!(t.flags&1)){const e=In(t),s=kt[kt.length-1];!s||!(t.flags&2)&&e>=In(s)?kt.push(t):kt.splice(nd(e),0,t),t.flags|=1,qr()}}function qr(){co||(co=Kr.then(Jr))}function Xr(t){Te(t)?an.push(...t):ks&&t.id===-1?ks.splice(Zs+1,0,t):t.flags&1||(an.push(t),t.flags|=1),qr()}function mi(t,e,s=as+1){for(;s<kt.length;s++){const n=kt[s];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;kt.splice(s,1),s--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Yr(t){if(an.length){const e=[...new Set(an)].sort((s,n)=>In(s)-In(n));if(an.length=0,ks){ks.push(...e);return}for(ks=e,Zs=0;Zs<ks.length;Zs++){const s=ks[Zs];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}ks=null,Zs=0}}const In=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Jr(t){try{for(as=0;as<kt.length;as++){const e=kt[as];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Un(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;as<kt.length;as++){const e=kt[as];e&&(e.flags&=-2)}as=-1,kt.length=0,Yr(),co=null,(kt.length||an.length)&&Jr()}}let Vt=null,Zr=null;function uo(t){const e=Vt;return Vt=t,Zr=t&&t.type.__scopeId||null,e}function Qr(t,e=Vt,s){if(!e||t._n)return t;const n=(...o)=>{n._d&&ho(-1);const a=uo(e);let i;try{i=t(...o)}finally{uo(a),n._d&&ho(1)}return i};return n._n=!0,n._c=!0,n._d=!0,n}function el(t,e){if(Vt===null)return t;const s=Lo(Vt),n=t.dirs||(t.dirs=[]);for(let o=0;o<e.length;o++){let[a,i,r,l=qe]=e[o];a&&(Ae(a)&&(a={mounted:a,updated:a}),a.deep&&ws(i),n.push({dir:a,instance:s,value:i,oldValue:void 0,arg:r,modifiers:l}))}return t}function Hs(t,e,s,n){const o=t.dirs,a=e&&e.dirs;for(let i=0;i<o.length;i++){const r=o[i];a&&(r.oldValue=a[i].value);let l=r.dir[n];l&&(Ms(),ss(l,s,8,[t.el,r,t,e]),Ts())}}const tl=Symbol("_vte"),sl=t=>t.__isTeleport,Tn=t=>t&&(t.disabled||t.disabled===""),gi=t=>t&&(t.defer||t.defer===""),_i=t=>typeof SVGElement<"u"&&t instanceof SVGElement,yi=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,va=(t,e)=>{const s=t&&t.to;return ot(s)?e?e(s):null:s},nl={name:"Teleport",__isTeleport:!0,process(t,e,s,n,o,a,i,r,l,c){const{mc:u,pc:d,pbc:h,o:{insert:m,querySelector:g,createText:E,createComment:S}}=c,_=Tn(e.props);let{shapeFlag:M,children:b,dynamicChildren:v}=e;if(t==null){const L=e.el=E(""),F=e.anchor=E("");m(L,s,n),m(F,s,n);const j=(W,q)=>{M&16&&u(b,W,q,o,a,i,r,l)},re=()=>{const W=e.target=va(e.props,g),q=al(W,e,E,m);W&&(i!=="svg"&&_i(W)?i="svg":i!=="mathml"&&yi(W)&&(i="mathml"),o&&o.isCE&&(o.ce._teleportTargets||(o.ce._teleportTargets=new Set)).add(W),_||(j(W,q),Qn(e,!1)))};_&&(j(s,F),Qn(e,!0)),gi(e.props)?(e.el.__isMounted=!1,Et(()=>{re(),delete e.el.__isMounted},a)):re()}else{if(gi(e.props)&&t.el.__isMounted===!1){Et(()=>{nl.process(t,e,s,n,o,a,i,r,l,c)},a);return}e.el=t.el,e.targetStart=t.targetStart;const L=e.anchor=t.anchor,F=e.target=t.target,j=e.targetAnchor=t.targetAnchor,re=Tn(t.props),W=re?s:F,q=re?L:j;if(i==="svg"||_i(F)?i="svg":(i==="mathml"||yi(F))&&(i="mathml"),v?(h(t.dynamicChildren,v,W,o,a,i,r),Ka(t,e,!0)):l||d(t,e,W,q,o,a,i,r,!1),_)re?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):qn(e,s,L,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const se=e.target=va(e.props,g);se&&qn(e,se,null,c,0)}else re&&qn(e,F,j,c,1);Qn(e,_)}},remove(t,e,s,{um:n,o:{remove:o}},a){const{shapeFlag:i,children:r,anchor:l,targetStart:c,targetAnchor:u,target:d,props:h}=t;if(d&&(o(c),o(u)),a&&o(l),i&16){const m=a||!Tn(h);for(let g=0;g<r.length;g++){const E=r[g];n(E,e,s,m,!!E.dynamicChildren)}}},move:qn,hydrate:od};function qn(t,e,s,{o:{insert:n},m:o},a=2){a===0&&n(t.targetAnchor,e,s);const{el:i,anchor:r,shapeFlag:l,children:c,props:u}=t,d=a===2;if(d&&n(i,e,s),(!d||Tn(u))&&l&16)for(let h=0;h<c.length;h++)o(c[h],e,s,2);d&&n(r,e,s)}function od(t,e,s,n,o,a,{o:{nextSibling:i,parentNode:r,querySelector:l,insert:c,createText:u}},d){function h(E,S,_,M){S.anchor=d(i(E),S,r(E),s,n,o,a),S.targetStart=_,S.targetAnchor=M}const m=e.target=va(e.props,l),g=Tn(e.props);if(m){const E=m._lpa||m.firstChild;if(e.shapeFlag&16)if(g)h(t,e,E,E&&i(E));else{e.anchor=i(t);let S=E;for(;S;){if(S&&S.nodeType===8){if(S.data==="teleport start anchor")e.targetStart=S;else if(S.data==="teleport anchor"){e.targetAnchor=S,m._lpa=e.targetAnchor&&i(e.targetAnchor);break}}S=i(S)}e.targetAnchor||al(m,e,u,c),d(E&&i(E),e,m,s,n,o,a)}Qn(e,g)}else g&&e.shapeFlag&16&&h(t,e,t,i(t));return e.anchor&&i(e.anchor)}const ol=nl;function Qn(t,e){const s=t.ctx;if(s&&s.ut){let n,o;for(e?(n=t.el,o=t.anchor):(n=t.targetStart,o=t.targetAnchor);n&&n!==o;)n.nodeType===1&&n.setAttribute("data-v-owner",s.uid),n=n.nextSibling;s.ut()}}function al(t,e,s,n){const o=e.targetStart=s(""),a=e.targetAnchor=s("");return o[tl]=a,t&&(n(o,t),n(a,t)),a}const ys=Symbol("_leaveCb"),Xn=Symbol("_enterCb");function ad(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return $t(()=>{t.isMounted=!0}),fs(()=>{t.isUnmounting=!0}),t}const Bt=[Function,Array],il={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Bt,onEnter:Bt,onAfterEnter:Bt,onEnterCancelled:Bt,onBeforeLeave:Bt,onLeave:Bt,onAfterLeave:Bt,onLeaveCancelled:Bt,onBeforeAppear:Bt,onAppear:Bt,onAfterAppear:Bt,onAppearCancelled:Bt},rl=t=>{const e=t.subTree;return e.component?rl(e.component):e},id={name:"BaseTransition",props:il,setup(t,{slots:e}){const s=Xa(),n=ad();return()=>{const o=e.default&&ul(e.default(),!0);if(!o||!o.length)return;const a=ll(o),i=je(t),{mode:r}=i;if(n.isLeaving)return Yo(a);const l=vi(a);if(!l)return Yo(a);let c=wa(l,i,n,s,d=>c=d);l.type!==At&&On(l,c);let u=s.subTree&&vi(s.subTree);if(u&&u.type!==At&&!Vs(u,l)&&rl(s).type!==At){let d=wa(u,i,n,s);if(On(u,d),r==="out-in"&&l.type!==At)return n.isLeaving=!0,d.afterLeave=()=>{n.isLeaving=!1,s.job.flags&8||s.update(),delete d.afterLeave,u=void 0},Yo(a);r==="in-out"&&l.type!==At?d.delayLeave=(h,m,g)=>{const E=cl(n,u);E[String(u.key)]=u,h[ys]=()=>{m(),h[ys]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{g(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return a}}};function ll(t){let e=t[0];if(t.length>1){for(const s of t)if(s.type!==At){e=s;break}}return e}const rd=id;function cl(t,e){const{leavingVNodes:s}=t;let n=s.get(e.type);return n||(n=Object.create(null),s.set(e.type,n)),n}function wa(t,e,s,n,o){const{appear:a,mode:i,persisted:r=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:h,onLeave:m,onAfterLeave:g,onLeaveCancelled:E,onBeforeAppear:S,onAppear:_,onAfterAppear:M,onAppearCancelled:b}=e,v=String(t.key),L=cl(s,t),F=(W,q)=>{W&&ss(W,n,9,q)},j=(W,q)=>{const se=q[1];F(W,q),Te(W)?W.every(A=>A.length<=1)&&se():W.length<=1&&se()},re={mode:i,persisted:r,beforeEnter(W){let q=l;if(!s.isMounted)if(a)q=S||l;else return;W[ys]&&W[ys](!0);const se=L[v];se&&Vs(t,se)&&se.el[ys]&&se.el[ys](),F(q,[W])},enter(W){let q=c,se=u,A=d;if(!s.isMounted)if(a)q=_||c,se=M||u,A=b||d;else return;let ne=!1;const Ie=W[Xn]=Se=>{ne||(ne=!0,Se?F(A,[W]):F(se,[W]),re.delayedLeave&&re.delayedLeave(),W[Xn]=void 0)};q?j(q,[W,Ie]):Ie()},leave(W,q){const se=String(t.key);if(W[Xn]&&W[Xn](!0),s.isUnmounting)return q();F(h,[W]);let A=!1;const ne=W[ys]=Ie=>{A||(A=!0,q(),Ie?F(E,[W]):F(g,[W]),W[ys]=void 0,L[se]===t&&delete L[se])};L[se]=t,m?j(m,[W,ne]):ne()},clone(W){const q=wa(W,e,s,n,o);return o&&o(q),q}};return re}function Yo(t){if(Ao(t))return t=Ls(t),t.children=null,t}function vi(t){if(!Ao(t))return sl(t.type)&&t.children?ll(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:s}=t;if(s){if(e&16)return s[0];if(e&32&&Ae(s.default))return s.default()}}function On(t,e){t.shapeFlag&6&&t.component?(t.transition=e,On(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function ul(t,e=!1,s){let n=[],o=0;for(let a=0;a<t.length;a++){let i=t[a];const r=s==null?i.key:String(s)+String(i.key!=null?i.key:a);i.type===Xe?(i.patchFlag&128&&o++,n=n.concat(ul(i.children,e,r))):(e||i.type!==At)&&n.push(r!=null?Ls(i,{key:r}):i)}if(o>1)for(let a=0;a<n.length;a++)n[a].patchFlag=-2;return n}function dl(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const fo=new WeakMap;function Cn(t,e,s,n,o=!1){if(Te(t)){t.forEach((g,E)=>Cn(g,e&&(Te(e)?e[E]:e),s,n,o));return}if(En(n)&&!o){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Cn(t,e,s,n.component.subTree);return}const a=n.shapeFlag&4?Lo(n.component):n.el,i=o?null:a,{i:r,r:l}=t,c=e&&e.r,u=r.refs===qe?r.refs={}:r.refs,d=r.setupState,h=je(d),m=d===qe?Sr:g=>ze(h,g);if(c!=null&&c!==l){if(wi(e),ot(c))u[c]=null,m(c)&&(d[c]=null);else if(St(c)){c.value=null;const g=e;g.k&&(u[g.k]=null)}}if(Ae(l))Un(l,r,12,[i,u]);else{const g=ot(l),E=St(l);if(g||E){const S=()=>{if(t.f){const _=g?m(l)?d[l]:u[l]:l.value;if(o)Te(_)&&La(_,a);else if(Te(_))_.includes(a)||_.push(a);else if(g)u[l]=[a],m(l)&&(d[l]=u[l]);else{const M=[a];l.value=M,t.k&&(u[t.k]=M)}}else g?(u[l]=i,m(l)&&(d[l]=i)):E&&(l.value=i,t.k&&(u[t.k]=i))};if(i){const _=()=>{S(),fo.delete(t)};_.id=-1,fo.set(t,_),Et(_,s)}else wi(t),S()}}}function wi(t){const e=fo.get(t);e&&(e.flags|=8,fo.delete(t))}Eo().requestIdleCallback;Eo().cancelIdleCallback;const En=t=>!!t.type.__asyncLoader,Ao=t=>t.type.__isKeepAlive;function ld(t,e){fl(t,"a",e)}function cd(t,e){fl(t,"da",e)}function fl(t,e,s=Rt){const n=t.__wdc||(t.__wdc=()=>{let o=s;for(;o;){if(o.isDeactivated)return;o=o.parent}return t()});if(Ro(e,n,s),s){let o=s.parent;for(;o&&o.parent;)Ao(o.parent.vnode)&&ud(n,e,s,o),o=o.parent}}function ud(t,e,s,n){const o=Ro(e,t,n,!0);za(()=>{La(n[e],o)},s)}function Ro(t,e,s=Rt,n=!1){if(s){const o=s[t]||(s[t]=[]),a=e.__weh||(e.__weh=(...i)=>{Ms();const r=Fn(s),l=ss(e,s,t,i);return r(),Ts(),l});return n?o.unshift(a):o.push(a),a}}const Cs=t=>(e,s=Rt)=>{(!Nn||t==="sp")&&Ro(t,(...n)=>e(...n),s)},dd=Cs("bm"),$t=Cs("m"),pl=Cs("bu"),fd=Cs("u"),fs=Cs("bum"),za=Cs("um"),pd=Cs("sp"),hd=Cs("rtg"),md=Cs("rtc");function gd(t,e=Rt){Ro("ec",t,e)}const _d=Symbol.for("v-ndc");function qt(t,e,s,n){let o;const a=s,i=Te(t);if(i||ot(t)){const r=i&&on(t);let l=!1,c=!1;r&&(l=!Kt(t),c=Ps(t),t=xo(t)),o=new Array(t.length);for(let u=0,d=t.length;u<d;u++)o[u]=e(l?c?ro(gt(t[u])):gt(t[u]):t[u],u,void 0,a)}else if(typeof t=="number"){o=new Array(t);for(let r=0;r<t;r++)o[r]=e(r+1,r,void 0,a)}else if(Ze(t))if(t[Symbol.iterator])o=Array.from(t,(r,l)=>e(r,l,void 0,a));else{const r=Object.keys(t);o=new Array(r.length);for(let l=0,c=r.length;l<c;l++){const u=r[l];o[l]=e(t[u],u,l,a)}}else o=[];return o}const ba=t=>t?Pl(t)?Lo(t):ba(t.parent):null,xn=_t(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>ba(t.parent),$root:t=>ba(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>ml(t),$forceUpdate:t=>t.f||(t.f=()=>{ja(t.update)}),$nextTick:t=>t.n||(t.n=Ln.bind(t.proxy)),$watch:t=>Hd.bind(t)}),Jo=(t,e)=>t!==qe&&!t.__isScriptSetup&&ze(t,e),yd={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:n,data:o,props:a,accessCache:i,type:r,appContext:l}=t;let c;if(e[0]!=="$"){const m=i[e];if(m!==void 0)switch(m){case 1:return n[e];case 2:return o[e];case 4:return s[e];case 3:return a[e]}else{if(Jo(n,e))return i[e]=1,n[e];if(o!==qe&&ze(o,e))return i[e]=2,o[e];if((c=t.propsOptions[0])&&ze(c,e))return i[e]=3,a[e];if(s!==qe&&ze(s,e))return i[e]=4,s[e];Sa&&(i[e]=0)}}const u=xn[e];let d,h;if(u)return e==="$attrs"&&wt(t.attrs,"get",""),u(t);if((d=r.__cssModules)&&(d=d[e]))return d;if(s!==qe&&ze(s,e))return i[e]=4,s[e];if(h=l.config.globalProperties,ze(h,e))return h[e]},set({_:t},e,s){const{data:n,setupState:o,ctx:a}=t;return Jo(o,e)?(o[e]=s,!0):n!==qe&&ze(n,e)?(n[e]=s,!0):ze(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(a[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:n,appContext:o,propsOptions:a,type:i}},r){let l,c;return!!(s[r]||t!==qe&&r[0]!=="$"&&ze(t,r)||Jo(e,r)||(l=a[0])&&ze(l,r)||ze(n,r)||ze(xn,r)||ze(o.config.globalProperties,r)||(c=i.__cssModules)&&c[r])},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:ze(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};function bi(t){return Te(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}let Sa=!0;function vd(t){const e=ml(t),s=t.proxy,n=t.ctx;Sa=!1,e.beforeCreate&&Si(e.beforeCreate,t,"bc");const{data:o,computed:a,methods:i,watch:r,provide:l,inject:c,created:u,beforeMount:d,mounted:h,beforeUpdate:m,updated:g,activated:E,deactivated:S,beforeDestroy:_,beforeUnmount:M,destroyed:b,unmounted:v,render:L,renderTracked:F,renderTriggered:j,errorCaptured:re,serverPrefetch:W,expose:q,inheritAttrs:se,components:A,directives:ne,filters:Ie}=e;if(c&&wd(c,n,null),i)for(const J in i){const $=i[J];Ae($)&&(n[J]=$.bind(s))}if(o){const J=o.call(s,s);Ze(J)&&(t.data=Ua(J))}if(Sa=!0,a)for(const J in a){const $=a[J],de=Ae($)?$.bind(s,s):Ae($.get)?$.get.bind(s,s):Qt,z=!Ae($)&&Ae($.set)?$.set.bind(s):Qt,O=De({get:de,set:z});Object.defineProperty(n,J,{enumerable:!0,configurable:!0,get:()=>O.value,set:X=>O.value=X})}if(r)for(const J in r)hl(r[J],n,s,J);if(l){const J=Ae(l)?l.call(s):l;Reflect.ownKeys(J).forEach($=>{Ed($,J[$])})}u&&Si(u,t,"c");function we(J,$){Te($)?$.forEach(de=>J(de.bind(s))):$&&J($.bind(s))}if(we(dd,d),we($t,h),we(pl,m),we(fd,g),we(ld,E),we(cd,S),we(gd,re),we(md,F),we(hd,j),we(fs,M),we(za,v),we(pd,W),Te(q))if(q.length){const J=t.exposed||(t.exposed={});q.forEach($=>{Object.defineProperty(J,$,{get:()=>s[$],set:de=>s[$]=de,enumerable:!0})})}else t.exposed||(t.exposed={});L&&t.render===Qt&&(t.render=L),se!=null&&(t.inheritAttrs=se),A&&(t.components=A),ne&&(t.directives=ne),W&&dl(t)}function wd(t,e,s=Qt){Te(t)&&(t=Ma(t));for(const n in t){const o=t[n];let a;Ze(o)?"default"in o?a=eo(o.from||n,o.default,!0):a=eo(o.from||n):a=eo(o),St(a)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>a.value,set:i=>a.value=i}):e[n]=a}}function Si(t,e,s){ss(Te(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,s)}function hl(t,e,s,n){let o=n.includes(".")?xl(s,n):()=>s[n];if(ot(t)){const a=e[t];Ae(a)&&Gt(o,a)}else if(Ae(t))Gt(o,t.bind(s));else if(Ze(t))if(Te(t))t.forEach(a=>hl(a,e,s,n));else{const a=Ae(t.handler)?t.handler.bind(s):e[t.handler];Ae(a)&&Gt(o,a,t)}}function ml(t){const e=t.type,{mixins:s,extends:n}=e,{mixins:o,optionsCache:a,config:{optionMergeStrategies:i}}=t.appContext,r=a.get(e);let l;return r?l=r:!o.length&&!s&&!n?l=e:(l={},o.length&&o.forEach(c=>po(l,c,i,!0)),po(l,e,i)),Ze(e)&&a.set(e,l),l}function po(t,e,s,n=!1){const{mixins:o,extends:a}=e;a&&po(t,a,s,!0),o&&o.forEach(i=>po(t,i,s,!0));for(const i in e)if(!(n&&i==="expose")){const r=bd[i]||s&&s[i];t[i]=r?r(t[i],e[i]):e[i]}return t}const bd={data:Mi,props:Ti,emits:Ti,methods:yn,computed:yn,beforeCreate:Tt,created:Tt,beforeMount:Tt,mounted:Tt,beforeUpdate:Tt,updated:Tt,beforeDestroy:Tt,beforeUnmount:Tt,destroyed:Tt,unmounted:Tt,activated:Tt,deactivated:Tt,errorCaptured:Tt,serverPrefetch:Tt,components:yn,directives:yn,watch:Md,provide:Mi,inject:Sd};function Mi(t,e){return e?t?function(){return _t(Ae(t)?t.call(this,this):t,Ae(e)?e.call(this,this):e)}:e:t}function Sd(t,e){return yn(Ma(t),Ma(e))}function Ma(t){if(Te(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function Tt(t,e){return t?[...new Set([].concat(t,e))]:e}function yn(t,e){return t?_t(Object.create(null),t,e):e}function Ti(t,e){return t?Te(t)&&Te(e)?[...new Set([...t,...e])]:_t(Object.create(null),bi(t),bi(e??{})):e}function Md(t,e){if(!t)return e;if(!e)return t;const s=_t(Object.create(null),t);for(const n in e)s[n]=Tt(t[n],e[n]);return s}function gl(){return{app:null,config:{isNativeTag:Sr,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Td=0;function Cd(t,e){return function(n,o=null){Ae(n)||(n=_t({},n)),o!=null&&!Ze(o)&&(o=null);const a=gl(),i=new WeakSet,r=[];let l=!1;const c=a.app={_uid:Td++,_component:n,_props:o,_container:null,_context:a,_instance:null,version:lf,get config(){return a.config},set config(u){},use(u,...d){return i.has(u)||(u&&Ae(u.install)?(i.add(u),u.install(c,...d)):Ae(u)&&(i.add(u),u(c,...d))),c},mixin(u){return a.mixins.includes(u)||a.mixins.push(u),c},component(u,d){return d?(a.components[u]=d,c):a.components[u]},directive(u,d){return d?(a.directives[u]=d,c):a.directives[u]},mount(u,d,h){if(!l){const m=c._ceVNode||tt(n,o);return m.appContext=a,h===!0?h="svg":h===!1&&(h=void 0),t(m,u,h),l=!0,c._container=u,u.__vue_app__=c,Lo(m.component)}},onUnmount(u){r.push(u)},unmount(){l&&(ss(r,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,d){return a.provides[u]=d,c},runWithContext(u){const d=rn;rn=c;try{return u()}finally{rn=d}}};return c}}let rn=null;function Ed(t,e){if(Rt){let s=Rt.provides;const n=Rt.parent&&Rt.parent.provides;n===s&&(s=Rt.provides=Object.create(n)),s[t]=e}}function eo(t,e,s=!1){const n=Xa();if(n||rn){let o=rn?rn._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(o&&t in o)return o[t];if(arguments.length>1)return s&&Ae(e)?e.call(n&&n.proxy):e}}const _l={},yl=()=>Object.create(_l),vl=t=>Object.getPrototypeOf(t)===_l;function xd(t,e,s,n=!1){const o={},a=yl();t.propsDefaults=Object.create(null),wl(t,e,o,a);for(const i in t.propsOptions[0])i in o||(o[i]=void 0);s?t.props=n?o:Ku(o):t.type.props?t.props=o:t.props=a,t.attrs=a}function kd(t,e,s,n){const{props:o,attrs:a,vnode:{patchFlag:i}}=t,r=je(o),[l]=t.propsOptions;let c=!1;if((n||i>0)&&!(i&16)){if(i&8){const u=t.vnode.dynamicProps;for(let d=0;d<u.length;d++){let h=u[d];if($o(t.emitsOptions,h))continue;const m=e[h];if(l)if(ze(a,h))m!==a[h]&&(a[h]=m,c=!0);else{const g=$s(h);o[g]=Ta(l,r,g,m,t,!1)}else m!==a[h]&&(a[h]=m,c=!0)}}}else{wl(t,e,o,a)&&(c=!0);let u;for(const d in r)(!e||!ze(e,d)&&((u=Xs(d))===d||!ze(e,u)))&&(l?s&&(s[d]!==void 0||s[u]!==void 0)&&(o[d]=Ta(l,r,d,void 0,t,!0)):delete o[d]);if(a!==r)for(const d in a)(!e||!ze(e,d))&&(delete a[d],c=!0)}c&&vs(t.attrs,"set","")}function wl(t,e,s,n){const[o,a]=t.propsOptions;let i=!1,r;if(e)for(let l in e){if(bn(l))continue;const c=e[l];let u;o&&ze(o,u=$s(l))?!a||!a.includes(u)?s[u]=c:(r||(r={}))[u]=c:$o(t.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,i=!0)}if(a){const l=je(s),c=r||qe;for(let u=0;u<a.length;u++){const d=a[u];s[d]=Ta(o,l,d,c[d],t,!ze(c,d))}}return i}function Ta(t,e,s,n,o,a){const i=t[s];if(i!=null){const r=ze(i,"default");if(r&&n===void 0){const l=i.default;if(i.type!==Function&&!i.skipFactory&&Ae(l)){const{propsDefaults:c}=o;if(s in c)n=c[s];else{const u=Fn(o);n=c[s]=l.call(null,e),u()}}else n=l;o.ce&&o.ce._setProp(s,n)}i[0]&&(a&&!r?n=!1:i[1]&&(n===""||n===Xs(s))&&(n=!0))}return n}const Ad=new WeakMap;function bl(t,e,s=!1){const n=s?Ad:e.propsCache,o=n.get(t);if(o)return o;const a=t.props,i={},r=[];let l=!1;if(!Ae(t)){const u=d=>{l=!0;const[h,m]=bl(d,e,!0);_t(i,h),m&&r.push(...m)};!s&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!a&&!l)return Ze(t)&&n.set(t,sn),sn;if(Te(a))for(let u=0;u<a.length;u++){const d=$s(a[u]);Ci(d)&&(i[d]=qe)}else if(a)for(const u in a){const d=$s(u);if(Ci(d)){const h=a[u],m=i[d]=Te(h)||Ae(h)?{type:h}:_t({},h),g=m.type;let E=!1,S=!0;if(Te(g))for(let _=0;_<g.length;++_){const M=g[_],b=Ae(M)&&M.name;if(b==="Boolean"){E=!0;break}else b==="String"&&(S=!1)}else E=Ae(g)&&g.name==="Boolean";m[0]=E,m[1]=S,(E||ze(m,"default"))&&r.push(d)}}const c=[i,r];return Ze(t)&&n.set(t,c),c}function Ci(t){return t[0]!=="$"&&!bn(t)}const Va=t=>t==="_"||t==="_ctx"||t==="$stable",Wa=t=>Te(t)?t.map(ls):[ls(t)],Rd=(t,e,s)=>{if(e._n)return e;const n=Qr((...o)=>Wa(e(...o)),s);return n._c=!1,n},Sl=(t,e,s)=>{const n=t._ctx;for(const o in t){if(Va(o))continue;const a=t[o];if(Ae(a))e[o]=Rd(o,a,n);else if(a!=null){const i=Wa(a);e[o]=()=>i}}},Ml=(t,e)=>{const s=Wa(e);t.slots.default=()=>s},Tl=(t,e,s)=>{for(const n in e)(s||!Va(n))&&(t[n]=e[n])},$d=(t,e,s)=>{const n=t.slots=yl();if(t.vnode.shapeFlag&32){const o=e._;o?(Tl(n,e,s),s&&kr(n,"_",o,!0)):Sl(e,n)}else e&&Ml(t,e)},Pd=(t,e,s)=>{const{vnode:n,slots:o}=t;let a=!0,i=qe;if(n.shapeFlag&32){const r=e._;r?s&&r===1?a=!1:Tl(o,e,s):(a=!e.$stable,Sl(e,o)),i=e}else e&&(Ml(t,e),i={default:1});if(a)for(const r in o)!Va(r)&&i[r]==null&&delete o[r]},Et=Kd;function Ld(t){return Id(t)}function Id(t,e){const s=Eo();s.__VUE__=!0;const{insert:n,remove:o,patchProp:a,createElement:i,createText:r,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:h,setScopeId:m=Qt,insertStaticContent:g}=t,E=(w,T,x,B=null,D=null,G=null,ie=void 0,Y=null,U=!!T.dynamicChildren)=>{if(w===T)return;w&&!Vs(w,T)&&(B=Ne(w),X(w,D,G,!0),w=null),T.patchFlag===-2&&(U=!1,T.dynamicChildren=null);const{type:K,ref:fe,shapeFlag:le}=T;switch(K){case Po:S(w,T,x,B);break;case At:_(w,T,x,B);break;case kn:w==null&&M(T,x,B,ie);break;case Xe:A(w,T,x,B,D,G,ie,Y,U);break;default:le&1?L(w,T,x,B,D,G,ie,Y,U):le&6?ne(w,T,x,B,D,G,ie,Y,U):(le&64||le&128)&&K.process(w,T,x,B,D,G,ie,Y,U,st)}fe!=null&&D?Cn(fe,w&&w.ref,G,T||w,!T):fe==null&&w&&w.ref!=null&&Cn(w.ref,null,G,w,!0)},S=(w,T,x,B)=>{if(w==null)n(T.el=r(T.children),x,B);else{const D=T.el=w.el;T.children!==w.children&&c(D,T.children)}},_=(w,T,x,B)=>{w==null?n(T.el=l(T.children||""),x,B):T.el=w.el},M=(w,T,x,B)=>{[w.el,w.anchor]=g(w.children,T,x,B,w.el,w.anchor)},b=({el:w,anchor:T},x,B)=>{let D;for(;w&&w!==T;)D=h(w),n(w,x,B),w=D;n(T,x,B)},v=({el:w,anchor:T})=>{let x;for(;w&&w!==T;)x=h(w),o(w),w=x;o(T)},L=(w,T,x,B,D,G,ie,Y,U)=>{T.type==="svg"?ie="svg":T.type==="math"&&(ie="mathml"),w==null?F(T,x,B,D,G,ie,Y,U):W(w,T,D,G,ie,Y,U)},F=(w,T,x,B,D,G,ie,Y)=>{let U,K;const{props:fe,shapeFlag:le,transition:pe,dirs:he}=w;if(U=w.el=i(w.type,G,fe&&fe.is,fe),le&8?u(U,w.children):le&16&&re(w.children,U,null,B,D,Zo(w,G),ie,Y),he&&Hs(w,null,B,"created"),j(U,w,w.scopeId,ie,B),fe){for(const be in fe)be!=="value"&&!bn(be)&&a(U,be,null,fe[be],G,B);"value"in fe&&a(U,"value",null,fe.value,G),(K=fe.onVnodeBeforeMount)&&ns(K,B,w)}he&&Hs(w,null,B,"beforeMount");const Re=Od(D,pe);Re&&pe.beforeEnter(U),n(U,T,x),((K=fe&&fe.onVnodeMounted)||Re||he)&&Et(()=>{K&&ns(K,B,w),Re&&pe.enter(U),he&&Hs(w,null,B,"mounted")},D)},j=(w,T,x,B,D)=>{if(x&&m(w,x),B)for(let G=0;G<B.length;G++)m(w,B[G]);if(D){let G=D.subTree;if(T===G||Al(G.type)&&(G.ssContent===T||G.ssFallback===T)){const ie=D.vnode;j(w,ie,ie.scopeId,ie.slotScopeIds,D.parent)}}},re=(w,T,x,B,D,G,ie,Y,U=0)=>{for(let K=U;K<w.length;K++){const fe=w[K]=Y?As(w[K]):ls(w[K]);E(null,fe,T,x,B,D,G,ie,Y)}},W=(w,T,x,B,D,G,ie)=>{const Y=T.el=w.el;let{patchFlag:U,dynamicChildren:K,dirs:fe}=T;U|=w.patchFlag&16;const le=w.props||qe,pe=T.props||qe;let he;if(x&&Us(x,!1),(he=pe.onVnodeBeforeUpdate)&&ns(he,x,T,w),fe&&Hs(T,w,x,"beforeUpdate"),x&&Us(x,!0),(le.innerHTML&&pe.innerHTML==null||le.textContent&&pe.textContent==null)&&u(Y,""),K?q(w.dynamicChildren,K,Y,x,B,Zo(T,D),G):ie||$(w,T,Y,null,x,B,Zo(T,D),G,!1),U>0){if(U&16)se(Y,le,pe,x,D);else if(U&2&&le.class!==pe.class&&a(Y,"class",null,pe.class,D),U&4&&a(Y,"style",le.style,pe.style,D),U&8){const Re=T.dynamicProps;for(let be=0;be<Re.length;be++){const Me=Re[be],ce=le[Me],Ve=pe[Me];(Ve!==ce||Me==="value")&&a(Y,Me,ce,Ve,D,x)}}U&1&&w.children!==T.children&&u(Y,T.children)}else!ie&&K==null&&se(Y,le,pe,x,D);((he=pe.onVnodeUpdated)||fe)&&Et(()=>{he&&ns(he,x,T,w),fe&&Hs(T,w,x,"updated")},B)},q=(w,T,x,B,D,G,ie)=>{for(let Y=0;Y<T.length;Y++){const U=w[Y],K=T[Y],fe=U.el&&(U.type===Xe||!Vs(U,K)||U.shapeFlag&198)?d(U.el):x;E(U,K,fe,null,B,D,G,ie,!0)}},se=(w,T,x,B,D)=>{if(T!==x){if(T!==qe)for(const G in T)!bn(G)&&!(G in x)&&a(w,G,T[G],null,D,B);for(const G in x){if(bn(G))continue;const ie=x[G],Y=T[G];ie!==Y&&G!=="value"&&a(w,G,Y,ie,D,B)}"value"in x&&a(w,"value",T.value,x.value,D)}},A=(w,T,x,B,D,G,ie,Y,U)=>{const K=T.el=w?w.el:r(""),fe=T.anchor=w?w.anchor:r("");let{patchFlag:le,dynamicChildren:pe,slotScopeIds:he}=T;he&&(Y=Y?Y.concat(he):he),w==null?(n(K,x,B),n(fe,x,B),re(T.children||[],x,fe,D,G,ie,Y,U)):le>0&&le&64&&pe&&w.dynamicChildren?(q(w.dynamicChildren,pe,x,D,G,ie,Y),(T.key!=null||D&&T===D.subTree)&&Ka(w,T,!0)):$(w,T,x,fe,D,G,ie,Y,U)},ne=(w,T,x,B,D,G,ie,Y,U)=>{T.slotScopeIds=Y,w==null?T.shapeFlag&512?D.ctx.activate(T,x,B,ie,U):Ie(T,x,B,D,G,ie,U):Se(w,T,U)},Ie=(w,T,x,B,D,G,ie)=>{const Y=w.component=ef(w,B,D);if(Ao(w)&&(Y.ctx.renderer=st),tf(Y,!1,ie),Y.asyncDep){if(D&&D.registerDep(Y,we,ie),!w.el){const U=Y.subTree=tt(At);_(null,U,T,x),w.placeholder=U.el}}else we(Y,w,T,x,D,G,ie)},Se=(w,T,x)=>{const B=T.component=w.component;if(Vd(w,T,x))if(B.asyncDep&&!B.asyncResolved){J(B,T,x);return}else B.next=T,B.update();else T.el=w.el,B.vnode=T},we=(w,T,x,B,D,G,ie)=>{const Y=()=>{if(w.isMounted){let{next:le,bu:pe,u:he,parent:Re,vnode:be}=w;{const ct=Cl(w);if(ct){le&&(le.el=be.el,J(w,le,ie)),ct.asyncDep.then(()=>{w.isUnmounted||Y()});return}}let Me=le,ce;Us(w,!1),le?(le.el=be.el,J(w,le,ie)):le=be,pe&&Vo(pe),(ce=le.props&&le.props.onVnodeBeforeUpdate)&&ns(ce,Re,le,be),Us(w,!0);const Ve=xi(w),nt=w.subTree;w.subTree=Ve,E(nt,Ve,d(nt.el),Ne(nt),w,D,G),le.el=Ve.el,Me===null&&Wd(w,Ve.el),he&&Et(he,D),(ce=le.props&&le.props.onVnodeUpdated)&&Et(()=>ns(ce,Re,le,be),D)}else{let le;const{el:pe,props:he}=T,{bm:Re,m:be,parent:Me,root:ce,type:Ve}=w,nt=En(T);Us(w,!1),Re&&Vo(Re),!nt&&(le=he&&he.onVnodeBeforeMount)&&ns(le,Me,T),Us(w,!0);{ce.ce&&ce.ce._def.shadowRoot!==!1&&ce.ce._injectChildStyle(Ve);const ct=w.subTree=xi(w);E(null,ct,x,B,w,D,G),T.el=ct.el}if(be&&Et(be,D),!nt&&(le=he&&he.onVnodeMounted)){const ct=T;Et(()=>ns(le,Me,ct),D)}(T.shapeFlag&256||Me&&En(Me.vnode)&&Me.vnode.shapeFlag&256)&&w.a&&Et(w.a,D),w.isMounted=!0,T=x=B=null}};w.scope.on();const U=w.effect=new Pr(Y);w.scope.off();const K=w.update=U.run.bind(U),fe=w.job=U.runIfDirty.bind(U);fe.i=w,fe.id=w.uid,U.scheduler=()=>ja(fe),Us(w,!0),K()},J=(w,T,x)=>{T.component=w;const B=w.vnode.props;w.vnode=T,w.next=null,kd(w,T.props,B,x),Pd(w,T.children,x),Ms(),mi(w),Ts()},$=(w,T,x,B,D,G,ie,Y,U=!1)=>{const K=w&&w.children,fe=w?w.shapeFlag:0,le=T.children,{patchFlag:pe,shapeFlag:he}=T;if(pe>0){if(pe&128){z(K,le,x,B,D,G,ie,Y,U);return}else if(pe&256){de(K,le,x,B,D,G,ie,Y,U);return}}he&8?(fe&16&&Ue(K,D,G),le!==K&&u(x,le)):fe&16?he&16?z(K,le,x,B,D,G,ie,Y,U):Ue(K,D,G,!0):(fe&8&&u(x,""),he&16&&re(le,x,B,D,G,ie,Y,U))},de=(w,T,x,B,D,G,ie,Y,U)=>{w=w||sn,T=T||sn;const K=w.length,fe=T.length,le=Math.min(K,fe);let pe;for(pe=0;pe<le;pe++){const he=T[pe]=U?As(T[pe]):ls(T[pe]);E(w[pe],he,x,null,D,G,ie,Y,U)}K>fe?Ue(w,D,G,!0,!1,le):re(T,x,B,D,G,ie,Y,U,le)},z=(w,T,x,B,D,G,ie,Y,U)=>{let K=0;const fe=T.length;let le=w.length-1,pe=fe-1;for(;K<=le&&K<=pe;){const he=w[K],Re=T[K]=U?As(T[K]):ls(T[K]);if(Vs(he,Re))E(he,Re,x,null,D,G,ie,Y,U);else break;K++}for(;K<=le&&K<=pe;){const he=w[le],Re=T[pe]=U?As(T[pe]):ls(T[pe]);if(Vs(he,Re))E(he,Re,x,null,D,G,ie,Y,U);else break;le--,pe--}if(K>le){if(K<=pe){const he=pe+1,Re=he<fe?T[he].el:B;for(;K<=pe;)E(null,T[K]=U?As(T[K]):ls(T[K]),x,Re,D,G,ie,Y,U),K++}}else if(K>pe)for(;K<=le;)X(w[K],D,G,!0),K++;else{const he=K,Re=K,be=new Map;for(K=Re;K<=pe;K++){const rt=T[K]=U?As(T[K]):ls(T[K]);rt.key!=null&&be.set(rt.key,K)}let Me,ce=0;const Ve=pe-Re+1;let nt=!1,ct=0;const Ht=new Array(Ve);for(K=0;K<Ve;K++)Ht[K]=0;for(K=he;K<=le;K++){const rt=w[K];if(ce>=Ve){X(rt,D,G,!0);continue}let Mt;if(rt.key!=null)Mt=be.get(rt.key);else for(Me=Re;Me<=pe;Me++)if(Ht[Me-Re]===0&&Vs(rt,T[Me])){Mt=Me;break}Mt===void 0?X(rt,D,G,!0):(Ht[Mt-Re]=K+1,Mt>=ct?ct=Mt:nt=!0,E(rt,T[Mt],x,null,D,G,ie,Y,U),ce++)}const hs=nt?Dd(Ht):sn;for(Me=hs.length-1,K=Ve-1;K>=0;K--){const rt=Re+K,Mt=T[rt],Ds=T[rt+1],Bn=rt+1<fe?Ds.el||Ds.placeholder:B;Ht[K]===0?E(null,Mt,x,Bn,D,G,ie,Y,U):nt&&(Me<0||K!==hs[Me]?O(Mt,x,Bn,2):Me--)}}},O=(w,T,x,B,D=null)=>{const{el:G,type:ie,transition:Y,children:U,shapeFlag:K}=w;if(K&6){O(w.component.subTree,T,x,B);return}if(K&128){w.suspense.move(T,x,B);return}if(K&64){ie.move(w,T,x,st);return}if(ie===Xe){n(G,T,x);for(let le=0;le<U.length;le++)O(U[le],T,x,B);n(w.anchor,T,x);return}if(ie===kn){b(w,T,x);return}if(B!==2&&K&1&&Y)if(B===0)Y.beforeEnter(G),n(G,T,x),Et(()=>Y.enter(G),D);else{const{leave:le,delayLeave:pe,afterLeave:he}=Y,Re=()=>{w.ctx.isUnmounted?o(G):n(G,T,x)},be=()=>{G._isLeaving&&G[ys](!0),le(G,()=>{Re(),he&&he()})};pe?pe(G,Re,be):be()}else n(G,T,x)},X=(w,T,x,B=!1,D=!1)=>{const{type:G,props:ie,ref:Y,children:U,dynamicChildren:K,shapeFlag:fe,patchFlag:le,dirs:pe,cacheIndex:he}=w;if(le===-2&&(D=!1),Y!=null&&(Ms(),Cn(Y,null,x,w,!0),Ts()),he!=null&&(T.renderCache[he]=void 0),fe&256){T.ctx.deactivate(w);return}const Re=fe&1&&pe,be=!En(w);let Me;if(be&&(Me=ie&&ie.onVnodeBeforeUnmount)&&ns(Me,T,w),fe&6)Fe(w.component,x,B);else{if(fe&128){w.suspense.unmount(x,B);return}Re&&Hs(w,null,T,"beforeUnmount"),fe&64?w.type.remove(w,T,x,st,B):K&&!K.hasOnce&&(G!==Xe||le>0&&le&64)?Ue(K,T,x,!1,!0):(G===Xe&&le&384||!D&&fe&16)&&Ue(U,T,x),B&&oe(w)}(be&&(Me=ie&&ie.onVnodeUnmounted)||Re)&&Et(()=>{Me&&ns(Me,T,w),Re&&Hs(w,null,T,"unmounted")},x)},oe=w=>{const{type:T,el:x,anchor:B,transition:D}=w;if(T===Xe){Pe(x,B);return}if(T===kn){v(w);return}const G=()=>{o(x),D&&!D.persisted&&D.afterLeave&&D.afterLeave()};if(w.shapeFlag&1&&D&&!D.persisted){const{leave:ie,delayLeave:Y}=D,U=()=>ie(x,G);Y?Y(w.el,G,U):U()}else G()},Pe=(w,T)=>{let x;for(;w!==T;)x=h(w),o(w),w=x;o(T)},Fe=(w,T,x)=>{const{bum:B,scope:D,job:G,subTree:ie,um:Y,m:U,a:K}=w;Ei(U),Ei(K),B&&Vo(B),D.stop(),G&&(G.flags|=8,X(ie,w,T,x)),Y&&Et(Y,T),Et(()=>{w.isUnmounted=!0},T)},Ue=(w,T,x,B=!1,D=!1,G=0)=>{for(let ie=G;ie<w.length;ie++)X(w[ie],T,x,B,D)},Ne=w=>{if(w.shapeFlag&6)return Ne(w.component.subTree);if(w.shapeFlag&128)return w.suspense.next();const T=h(w.anchor||w.el),x=T&&T[tl];return x?h(x):T};let Qe=!1;const at=(w,T,x)=>{w==null?T._vnode&&X(T._vnode,null,null,!0):E(T._vnode||null,w,T,null,null,null,x),T._vnode=w,Qe||(Qe=!0,mi(),Yr(),Qe=!1)},st={p:E,um:X,m:O,r:oe,mt:Ie,mc:re,pc:$,pbc:q,n:Ne,o:t};return{render:at,hydrate:void 0,createApp:Cd(at)}}function Zo({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function Us({effect:t,job:e},s){s?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Od(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Ka(t,e,s=!1){const n=t.children,o=e.children;if(Te(n)&&Te(o))for(let a=0;a<n.length;a++){const i=n[a];let r=o[a];r.shapeFlag&1&&!r.dynamicChildren&&((r.patchFlag<=0||r.patchFlag===32)&&(r=o[a]=As(o[a]),r.el=i.el),!s&&r.patchFlag!==-2&&Ka(i,r)),r.type===Po&&r.patchFlag!==-1&&(r.el=i.el),r.type===At&&!r.el&&(r.el=i.el)}}function Dd(t){const e=t.slice(),s=[0];let n,o,a,i,r;const l=t.length;for(n=0;n<l;n++){const c=t[n];if(c!==0){if(o=s[s.length-1],t[o]<c){e[n]=o,s.push(n);continue}for(a=0,i=s.length-1;a<i;)r=a+i>>1,t[s[r]]<c?a=r+1:i=r;c<t[s[a]]&&(a>0&&(e[n]=s[a-1]),s[a]=n)}}for(a=s.length,i=s[a-1];a-- >0;)s[a]=i,i=e[i];return s}function Cl(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Cl(e)}function Ei(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const Nd=Symbol.for("v-scx"),Gd=()=>eo(Nd);function Gt(t,e,s){return El(t,e,s)}function El(t,e,s=qe){const{immediate:n,deep:o,flush:a,once:i}=s,r=_t({},s),l=e&&n||!e&&a!=="post";let c;if(Nn){if(a==="sync"){const m=Gd();c=m.__watcherHandles||(m.__watcherHandles=[])}else if(!l){const m=()=>{};return m.stop=Qt,m.resume=Qt,m.pause=Qt,m}}const u=Rt;r.call=(m,g,E)=>ss(m,u,g,E);let d=!1;a==="post"?r.scheduler=m=>{Et(m,u&&u.suspense)}:a!=="sync"&&(d=!0,r.scheduler=(m,g)=>{g?m():ja(m)}),r.augmentJob=m=>{e&&(m.flags|=4),d&&(m.flags|=2,u&&(m.id=u.uid,m.i=u))};const h=td(t,e,r);return Nn&&(c?c.push(h):l&&h()),h}function Hd(t,e,s){const n=this.proxy,o=ot(t)?t.includes(".")?xl(n,t):()=>n[t]:t.bind(n,n);let a;Ae(e)?a=e:(a=e.handler,s=e);const i=Fn(this),r=El(o,a.bind(n),s);return i(),r}function xl(t,e){const s=e.split(".");return()=>{let n=t;for(let o=0;o<s.length&&n;o++)n=n[s[o]];return n}}const Ud=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${$s(e)}Modifiers`]||t[`${Xs(e)}Modifiers`];function Fd(t,e,...s){if(t.isUnmounted)return;const n=t.vnode.props||qe;let o=s;const a=e.startsWith("update:"),i=a&&Ud(n,e.slice(7));i&&(i.trim&&(o=s.map(u=>ot(u)?u.trim():u)),i.number&&(o=s.map(yu)));let r,l=n[r=zo(e)]||n[r=zo($s(e))];!l&&a&&(l=n[r=zo(Xs(e))]),l&&ss(l,t,6,o);const c=n[r+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[r])return;t.emitted[r]=!0,ss(c,t,6,o)}}const Bd=new WeakMap;function kl(t,e,s=!1){const n=s?Bd:e.emitsCache,o=n.get(t);if(o!==void 0)return o;const a=t.emits;let i={},r=!1;if(!Ae(t)){const l=c=>{const u=kl(c,e,!0);u&&(r=!0,_t(i,u))};!s&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!a&&!r?(Ze(t)&&n.set(t,null),null):(Te(a)?a.forEach(l=>i[l]=null):_t(i,a),Ze(t)&&n.set(t,i),i)}function $o(t,e){return!t||!Mo(e)?!1:(e=e.slice(2).replace(/Once$/,""),ze(t,e[0].toLowerCase()+e.slice(1))||ze(t,Xs(e))||ze(t,e))}function xi(t){const{type:e,vnode:s,proxy:n,withProxy:o,propsOptions:[a],slots:i,attrs:r,emit:l,render:c,renderCache:u,props:d,data:h,setupState:m,ctx:g,inheritAttrs:E}=t,S=uo(t);let _,M;try{if(s.shapeFlag&4){const v=o||n,L=v;_=ls(c.call(L,v,u,d,m,h,g)),M=r}else{const v=e;_=ls(v.length>1?v(d,{attrs:r,slots:i,emit:l}):v(d,null)),M=e.props?r:jd(r)}}catch(v){An.length=0,ko(v,t,1),_=tt(At)}let b=_;if(M&&E!==!1){const v=Object.keys(M),{shapeFlag:L}=b;v.length&&L&7&&(a&&v.some(Pa)&&(M=zd(M,a)),b=Ls(b,M,!1,!0))}return s.dirs&&(b=Ls(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(s.dirs):s.dirs),s.transition&&On(b,s.transition),_=b,uo(S),_}const jd=t=>{let e;for(const s in t)(s==="class"||s==="style"||Mo(s))&&((e||(e={}))[s]=t[s]);return e},zd=(t,e)=>{const s={};for(const n in t)(!Pa(n)||!(n.slice(9)in e))&&(s[n]=t[n]);return s};function Vd(t,e,s){const{props:n,children:o,component:a}=t,{props:i,children:r,patchFlag:l}=e,c=a.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&l>=0){if(l&1024)return!0;if(l&16)return n?ki(n,i,c):!!i;if(l&8){const u=e.dynamicProps;for(let d=0;d<u.length;d++){const h=u[d];if(i[h]!==n[h]&&!$o(c,h))return!0}}}else return(o||r)&&(!r||!r.$stable)?!0:n===i?!1:n?i?ki(n,i,c):!0:!!i;return!1}function ki(t,e,s){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let o=0;o<n.length;o++){const a=n[o];if(e[a]!==t[a]&&!$o(s,a))return!0}return!1}function Wd({vnode:t,parent:e},s){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=s,e=e.parent;else break}}const Al=t=>t.__isSuspense;function Kd(t,e){e&&e.pendingBranch?Te(t)?e.effects.push(...t):e.effects.push(t):Xr(t)}const Xe=Symbol.for("v-fgt"),Po=Symbol.for("v-txt"),At=Symbol.for("v-cmt"),kn=Symbol.for("v-stc"),An=[];let Ft=null;function I(t=!1){An.push(Ft=t?null:[])}function qd(){An.pop(),Ft=An[An.length-1]||null}let Dn=1;function ho(t,e=!1){Dn+=t,t<0&&Ft&&e&&(Ft.hasOnce=!0)}function Rl(t){return t.dynamicChildren=Dn>0?Ft||sn:null,qd(),Dn>0&&Ft&&Ft.push(t),t}function H(t,e,s,n,o,a){return Rl(p(t,e,s,n,o,a,!0))}function Dt(t,e,s,n,o){return Rl(tt(t,e,s,n,o,!0))}function mo(t){return t?t.__v_isVNode===!0:!1}function Vs(t,e){return t.type===e.type&&t.key===e.key}const $l=({key:t})=>t??null,to=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?ot(t)||St(t)||Ae(t)?{i:Vt,r:t,k:e,f:!!s}:t:null);function p(t,e=null,s=null,n=0,o=null,a=t===Xe?0:1,i=!1,r=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&$l(e),ref:e&&to(e),scopeId:Zr,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:Vt};return r?(qa(l,s),a&128&&t.normalize(l)):s&&(l.shapeFlag|=ot(s)?8:16),Dn>0&&!i&&Ft&&(l.patchFlag>0||a&6)&&l.patchFlag!==32&&Ft.push(l),l}const tt=Xd;function Xd(t,e=null,s=null,n=0,o=null,a=!1){if((!t||t===_d)&&(t=At),mo(t)){const r=Ls(t,e,!0);return s&&qa(r,s),Dn>0&&!a&&Ft&&(r.shapeFlag&6?Ft[Ft.indexOf(t)]=r:Ft.push(r)),r.patchFlag=-2,r}if(af(t)&&(t=t.__vccOpts),e){e=Yd(e);let{class:r,style:l}=e;r&&!ot(r)&&(e.class=Je(r)),Ze(l)&&(Ba(l)&&!Te(l)&&(l=_t({},l)),e.style=zt(l))}const i=ot(t)?1:Al(t)?128:sl(t)?64:Ze(t)?4:Ae(t)?2:0;return p(t,e,s,n,o,i,a,!0)}function Yd(t){return t?Ba(t)||vl(t)?_t({},t):t:null}function Ls(t,e,s=!1,n=!1){const{props:o,ref:a,patchFlag:i,children:r,transition:l}=t,c=e?Jd(o||{},e):o,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&$l(c),ref:e&&e.ref?s&&a?Te(a)?a.concat(to(e)):[a,to(e)]:to(e):a,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:r,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Xe?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ls(t.ssContent),ssFallback:t.ssFallback&&Ls(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&n&&On(u,l.clone(u)),u}function Is(t=" ",e=0){return tt(Po,null,t,e)}function go(t,e){const s=tt(kn,null,t);return s.staticCount=e,s}function ve(t="",e=!1){return e?(I(),Dt(At,null,t)):tt(At,null,t)}function ls(t){return t==null||typeof t=="boolean"?tt(At):Te(t)?tt(Xe,null,t.slice()):mo(t)?As(t):tt(Po,null,String(t))}function As(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ls(t)}function qa(t,e){let s=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(Te(e))s=16;else if(typeof e=="object")if(n&65){const o=e.default;o&&(o._c&&(o._d=!1),qa(t,o()),o._c&&(o._d=!0));return}else{s=32;const o=e._;!o&&!vl(e)?e._ctx=Vt:o===3&&Vt&&(Vt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ae(e)?(e={default:e,_ctx:Vt},s=32):(e=String(e),n&64?(s=16,e=[Is(e)]):s=8);t.children=e,t.shapeFlag|=s}function Jd(...t){const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const o in n)if(o==="class")e.class!==n.class&&(e.class=Je([e.class,n.class]));else if(o==="style")e.style=zt([e.style,n.style]);else if(Mo(o)){const a=e[o],i=n[o];i&&a!==i&&!(Te(a)&&a.includes(i))&&(e[o]=a?[].concat(a,i):i)}else o!==""&&(e[o]=n[o])}return e}function ns(t,e,s,n=null){ss(t,e,7,[s,n])}const Zd=gl();let Qd=0;function ef(t,e,s){const n=t.type,o=(e?e.appContext:t.appContext)||Zd,a={uid:Qd++,vnode:t,type:n,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new xu(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:bl(n,o),emitsOptions:kl(n,o),emit:null,emitted:null,propsDefaults:qe,inheritAttrs:n.inheritAttrs,ctx:qe,data:qe,props:qe,attrs:qe,slots:qe,refs:qe,setupState:qe,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=Fd.bind(null,a),t.ce&&t.ce(a),a}let Rt=null;const Xa=()=>Rt||Vt;let _o,Ca;{const t=Eo(),e=(s,n)=>{let o;return(o=t[s])||(o=t[s]=[]),o.push(n),a=>{o.length>1?o.forEach(i=>i(a)):o[0](a)}};_o=e("__VUE_INSTANCE_SETTERS__",s=>Rt=s),Ca=e("__VUE_SSR_SETTERS__",s=>Nn=s)}const Fn=t=>{const e=Rt;return _o(t),t.scope.on(),()=>{t.scope.off(),_o(e)}},Ai=()=>{Rt&&Rt.scope.off(),_o(null)};function Pl(t){return t.vnode.shapeFlag&4}let Nn=!1;function tf(t,e=!1,s=!1){e&&Ca(e);const{props:n,children:o}=t.vnode,a=Pl(t);xd(t,n,a,e),$d(t,o,s||e);const i=a?sf(t,e):void 0;return e&&Ca(!1),i}function sf(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,yd);const{setup:n}=s;if(n){Ms();const o=t.setupContext=n.length>1?of(t):null,a=Fn(t),i=Un(n,t,0,[t.props,o]),r=Tr(i);if(Ts(),a(),(r||t.sp)&&!En(t)&&dl(t),r){if(i.then(Ai,Ai),e)return i.then(l=>{Ri(t,l)}).catch(l=>{ko(l,t,0)});t.asyncDep=i}else Ri(t,i)}else Ll(t)}function Ri(t,e,s){Ae(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Ze(e)&&(t.setupState=Wr(e)),Ll(t)}function Ll(t,e,s){const n=t.type;t.render||(t.render=n.render||Qt);{const o=Fn(t);Ms();try{vd(t)}finally{Ts(),o()}}}const nf={get(t,e){return wt(t,"get",""),t[e]}};function of(t){const e=s=>{t.exposed=s||{}};return{attrs:new Proxy(t.attrs,nf),slots:t.slots,emit:t.emit,expose:e}}function Lo(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Wr(qu(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in xn)return xn[s](t)},has(e,s){return s in e||s in xn}})):t.proxy}function af(t){return Ae(t)&&"__vccOpts"in t}const De=(t,e)=>Qu(t,e,Nn);function rf(t,e,s){try{ho(-1);const n=arguments.length;return n===2?Ze(e)&&!Te(e)?mo(e)?tt(t,null,[e]):tt(t,e):tt(t,null,e):(n>3?s=Array.prototype.slice.call(arguments,2):n===3&&mo(s)&&(s=[s]),tt(t,e,s))}finally{ho(1)}}const lf="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ea;const $i=typeof window<"u"&&window.trustedTypes;if($i)try{Ea=$i.createPolicy("vue",{createHTML:t=>t})}catch{}const Il=Ea?t=>Ea.createHTML(t):t=>t,cf="http://www.w3.org/2000/svg",uf="http://www.w3.org/1998/Math/MathML",_s=typeof document<"u"?document:null,Pi=_s&&_s.createElement("template"),df={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,n)=>{const o=e==="svg"?_s.createElementNS(cf,t):e==="mathml"?_s.createElementNS(uf,t):s?_s.createElement(t,{is:s}):_s.createElement(t);return t==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:t=>_s.createTextNode(t),createComment:t=>_s.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>_s.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,n,o,a){const i=s?s.previousSibling:e.lastChild;if(o&&(o===a||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),s),!(o===a||!(o=o.nextSibling)););else{Pi.innerHTML=Il(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const r=Pi.content;if(n==="svg"||n==="mathml"){const l=r.firstChild;for(;l.firstChild;)r.appendChild(l.firstChild);r.removeChild(l)}e.insertBefore(r,s)}return[i?i.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},Es="transition",mn="animation",Gn=Symbol("_vtc"),Ol={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},ff=_t({},il,Ol),pf=t=>(t.displayName="Transition",t.props=ff,t),hf=pf((t,{slots:e})=>rf(rd,mf(t),e)),Fs=(t,e=[])=>{Te(t)?t.forEach(s=>s(...e)):t&&t(...e)},Li=t=>t?Te(t)?t.some(e=>e.length>1):t.length>1:!1;function mf(t){const e={};for(const A in t)A in Ol||(e[A]=t[A]);if(t.css===!1)return e;const{name:s="v",type:n,duration:o,enterFromClass:a=`${s}-enter-from`,enterActiveClass:i=`${s}-enter-active`,enterToClass:r=`${s}-enter-to`,appearFromClass:l=a,appearActiveClass:c=i,appearToClass:u=r,leaveFromClass:d=`${s}-leave-from`,leaveActiveClass:h=`${s}-leave-active`,leaveToClass:m=`${s}-leave-to`}=t,g=gf(o),E=g&&g[0],S=g&&g[1],{onBeforeEnter:_,onEnter:M,onEnterCancelled:b,onLeave:v,onLeaveCancelled:L,onBeforeAppear:F=_,onAppear:j=M,onAppearCancelled:re=b}=e,W=(A,ne,Ie,Se)=>{A._enterCancelled=Se,Bs(A,ne?u:r),Bs(A,ne?c:i),Ie&&Ie()},q=(A,ne)=>{A._isLeaving=!1,Bs(A,d),Bs(A,m),Bs(A,h),ne&&ne()},se=A=>(ne,Ie)=>{const Se=A?j:M,we=()=>W(ne,A,Ie);Fs(Se,[ne,we]),Ii(()=>{Bs(ne,A?l:a),gs(ne,A?u:r),Li(Se)||Oi(ne,n,E,we)})};return _t(e,{onBeforeEnter(A){Fs(_,[A]),gs(A,a),gs(A,i)},onBeforeAppear(A){Fs(F,[A]),gs(A,l),gs(A,c)},onEnter:se(!1),onAppear:se(!0),onLeave(A,ne){A._isLeaving=!0;const Ie=()=>q(A,ne);gs(A,d),A._enterCancelled?(gs(A,h),Gi(A)):(Gi(A),gs(A,h)),Ii(()=>{A._isLeaving&&(Bs(A,d),gs(A,m),Li(v)||Oi(A,n,S,Ie))}),Fs(v,[A,Ie])},onEnterCancelled(A){W(A,!1,void 0,!0),Fs(b,[A])},onAppearCancelled(A){W(A,!0,void 0,!0),Fs(re,[A])},onLeaveCancelled(A){q(A),Fs(L,[A])}})}function gf(t){if(t==null)return null;if(Ze(t))return[Qo(t.enter),Qo(t.leave)];{const e=Qo(t);return[e,e]}}function Qo(t){return vu(t)}function gs(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.add(s)),(t[Gn]||(t[Gn]=new Set)).add(e)}function Bs(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const s=t[Gn];s&&(s.delete(e),s.size||(t[Gn]=void 0))}function Ii(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let _f=0;function Oi(t,e,s,n){const o=t._endId=++_f,a=()=>{o===t._endId&&n()};if(s!=null)return setTimeout(a,s);const{type:i,timeout:r,propCount:l}=yf(t,e);if(!i)return n();const c=i+"end";let u=0;const d=()=>{t.removeEventListener(c,h),a()},h=m=>{m.target===t&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},r+1),t.addEventListener(c,h)}function yf(t,e){const s=window.getComputedStyle(t),n=g=>(s[g]||"").split(", "),o=n(`${Es}Delay`),a=n(`${Es}Duration`),i=Di(o,a),r=n(`${mn}Delay`),l=n(`${mn}Duration`),c=Di(r,l);let u=null,d=0,h=0;e===Es?i>0&&(u=Es,d=i,h=a.length):e===mn?c>0&&(u=mn,d=c,h=l.length):(d=Math.max(i,c),u=d>0?i>c?Es:mn:null,h=u?u===Es?a.length:l.length:0);const m=u===Es&&/\b(?:transform|all)(?:,|$)/.test(n(`${Es}Property`).toString());return{type:u,timeout:d,propCount:h,hasTransform:m}}function Di(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((s,n)=>Ni(s)+Ni(t[n])))}function Ni(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function Gi(t){return(t?t.ownerDocument:document).body.offsetHeight}function vf(t,e,s){const n=t[Gn];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const yo=Symbol("_vod"),Dl=Symbol("_vsh"),Nl={name:"show",beforeMount(t,{value:e},{transition:s}){t[yo]=t.style.display==="none"?"":t.style.display,s&&e?s.beforeEnter(t):gn(t,e)},mounted(t,{value:e},{transition:s}){s&&e&&s.enter(t)},updated(t,{value:e,oldValue:s},{transition:n}){!e!=!s&&(n?e?(n.beforeEnter(t),gn(t,!0),n.enter(t)):n.leave(t,()=>{gn(t,!1)}):gn(t,e))},beforeUnmount(t,{value:e}){gn(t,e)}};function gn(t,e){t.style.display=e?t[yo]:"none",t[Dl]=!e}const Gl=Symbol("");function Xt(t){const e=Xa();if(!e)return;const s=e.ut=(o=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(a=>vo(a,o))},n=()=>{const o=t(e.proxy);e.ce?vo(e.ce,o):xa(e.subTree,o),s(o)};pl(()=>{Xr(n)}),$t(()=>{Gt(n,Qt,{flush:"post"});const o=new MutationObserver(n);o.observe(e.subTree.el.parentNode,{childList:!0}),za(()=>o.disconnect())})}function xa(t,e){if(t.shapeFlag&128){const s=t.suspense;t=s.activeBranch,s.pendingBranch&&!s.isHydrating&&s.effects.push(()=>{xa(s.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)vo(t.el,e);else if(t.type===Xe)t.children.forEach(s=>xa(s,e));else if(t.type===kn){let{el:s,anchor:n}=t;for(;s&&(vo(s,e),s!==n);)s=s.nextSibling}}function vo(t,e){if(t.nodeType===1){const s=t.style;let n="";for(const o in e){const a=Eu(e[o]);s.setProperty(`--${o}`,a),n+=`--${o}: ${a};`}s[Gl]=n}}const wf=/(?:^|;)\s*display\s*:/;function bf(t,e,s){const n=t.style,o=ot(s);let a=!1;if(s&&!o){if(e)if(ot(e))for(const i of e.split(";")){const r=i.slice(0,i.indexOf(":")).trim();s[r]==null&&so(n,r,"")}else for(const i in e)s[i]==null&&so(n,i,"");for(const i in s)i==="display"&&(a=!0),so(n,i,s[i])}else if(o){if(e!==s){const i=n[Gl];i&&(s+=";"+i),n.cssText=s,a=wf.test(s)}}else e&&t.removeAttribute("style");yo in t&&(t[yo]=a?n.display:"",t[Dl]&&(n.display="none"))}const Hi=/\s*!important$/;function so(t,e,s){if(Te(s))s.forEach(n=>so(t,e,n));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const n=Sf(t,e);Hi.test(s)?t.setProperty(Xs(n),s.replace(Hi,""),"important"):t[n]=s}}const Ui=["Webkit","Moz","ms"],ea={};function Sf(t,e){const s=ea[e];if(s)return s;let n=$s(e);if(n!=="filter"&&n in t)return ea[e]=n;n=xr(n);for(let o=0;o<Ui.length;o++){const a=Ui[o]+n;if(a in t)return ea[e]=a}return e}const Fi="http://www.w3.org/1999/xlink";function Bi(t,e,s,n,o,a=Cu(e)){n&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(Fi,e.slice(6,e.length)):t.setAttributeNS(Fi,e,s):s==null||a&&!Ar(s)?t.removeAttribute(e):t.setAttribute(e,a?"":Os(s)?String(s):s)}function ji(t,e,s,n,o){if(e==="innerHTML"||e==="textContent"){s!=null&&(t[e]=e==="innerHTML"?Il(s):s);return}const a=t.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){const r=a==="OPTION"?t.getAttribute("value")||"":t.value,l=s==null?t.type==="checkbox"?"on":"":String(s);(r!==l||!("_value"in t))&&(t.value=l),s==null&&t.removeAttribute(e),t._value=s;return}let i=!1;if(s===""||s==null){const r=typeof t[e];r==="boolean"?s=Ar(s):s==null&&r==="string"?(s="",i=!0):r==="number"&&(s=0,i=!0)}try{t[e]=s}catch{}i&&t.removeAttribute(o||e)}function Mf(t,e,s,n){t.addEventListener(e,s,n)}function Tf(t,e,s,n){t.removeEventListener(e,s,n)}const zi=Symbol("_vei");function Cf(t,e,s,n,o=null){const a=t[zi]||(t[zi]={}),i=a[e];if(n&&i)i.value=n;else{const[r,l]=Ef(e);if(n){const c=a[e]=Af(n,o);Mf(t,r,c,l)}else i&&(Tf(t,r,i,l),a[e]=void 0)}}const Vi=/(?:Once|Passive|Capture)$/;function Ef(t){let e;if(Vi.test(t)){e={};let n;for(;n=t.match(Vi);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Xs(t.slice(2)),e]}let ta=0;const xf=Promise.resolve(),kf=()=>ta||(xf.then(()=>ta=0),ta=Date.now());function Af(t,e){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;ss(Rf(n,s.value),e,5,[n])};return s.value=t,s.attached=kf(),s}function Rf(t,e){if(Te(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(n=>o=>!o._stopped&&n&&n(o))}else return e}const Wi=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,$f=(t,e,s,n,o,a)=>{const i=o==="svg";e==="class"?vf(t,n,i):e==="style"?bf(t,s,n):Mo(e)?Pa(e)||Cf(t,e,s,n,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Pf(t,e,n,i))?(ji(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Bi(t,e,n,i,a,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!ot(n))?ji(t,$s(e),n,a,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),Bi(t,e,n,i))};function Pf(t,e,s,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&Wi(e)&&Ae(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const o=t.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return Wi(e)&&ot(s)?!1:e in t}const Lf=["ctrl","shift","alt","meta"],If={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Lf.some(s=>t[`${s}Key`]&&!e.includes(s))},bs=(t,e)=>{const s=t._withMods||(t._withMods={}),n=e.join(".");return s[n]||(s[n]=(o,...a)=>{for(let i=0;i<e.length;i++){const r=If[e[i]];if(r&&r(o,e))return}return t(o,...a)})},Of=_t({patchProp:$f},df);let Ki;function Df(){return Ki||(Ki=Ld(Of))}const qi=(...t)=>{const e=Df().createApp(...t),{mount:s}=e;return e.mount=n=>{const o=Gf(n);if(!o)return;const a=e._component;!Ae(a)&&!a.render&&!a.template&&(a.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const i=s(o,!1,Nf(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),i},e};function Nf(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Gf(t){return ot(t)?document.querySelector(t):t}const no={maxRetries:3,retryDelay:1e3,timeout:1e4};let sa=null;const ln={enabled:!0,maxCacheSize:50*1024*1024,cachePrefix:"mgpic_",version:"1.0.0",loadInterval:50,batchSize:3};class Hf{constructor(){this.cache=new Map,this.totalSize=0}isSupported(){return"caches"in window}getCacheName(){return`${ln.cachePrefix}${ln.version}`}async isCached(e){if(!this.isSupported())return!1;try{return await(await caches.open(this.getCacheName())).match(e)!==void 0}catch(s){return f(":",s.message),!1}}async cacheResource(e,s){if(!this.isSupported())return!1;try{const n=await caches.open(this.getCacheName());if(await n.match(e))return f(`: ${e}`),!0;await n.put(e,s.clone());const a=s.headers.get("content-length");return a&&(this.totalSize+=parseInt(a)),f(`: ${e}`),!0}catch(n){return f(":",n.message),!1}}async getCachedResource(e){if(!this.isSupported())return null;try{return await(await caches.open(this.getCacheName())).match(e)}catch(s){return f(":",s.message),null}}async cleanupCache(){if(this.isSupported())try{const e=await caches.keys(),s=this.getCacheName();for(const n of e)n.startsWith(ln.cachePrefix)&&n!==s&&(await caches.delete(n),f(`: ${n}`))}catch(e){f(":",e.message)}}}const Wt=new Hf;let Yn=null;function Uf(){return Yn||(f("R2 URL"),Yn="https://pub-6f9181bda40946ea92b5e87fe84e27d4.r2.dev",Yn)}function N(t){let e=t;t.startsWith("/assets/")?e=t.slice(7):t.startsWith("@assets/")&&(e=t.slice(8));const s=Uf(),n=e.startsWith("/")?e.slice(1):e;return`${s}/${n}`}async function Hl(t,e={}){if(Wt.isSupported()){const o=await Wt.getCachedResource(t);if(o)return f(` Cache Storage : ${t}`),o}const{maxRetries:s=no.maxRetries,retryDelay:n=no.retryDelay}=e;for(let o=1;o<=s;o++)try{f(` (${o}/${s}): ${t}`);const a=new AbortController,i=setTimeout(()=>a.abort(),no.timeout),r=await fetch(t,{method:"GET",mode:"cors",credentials:"omit",cache:"no-cache",signal:a.signal,...e});if(clearTimeout(i),r.ok)return Wt.isSupported()&&await Wt.cacheResource(t,r),f(`: ${t}`),r;throw new Error(`HTTP ${r.status}: ${r.statusText}`)}catch(a){if(f(` (${o}/${s}): ${t}`,a.message),o===s)throw f(`: ${t}`,a.message),a;const i=n*o;f(` ${i}ms ...`),await new Promise(r=>setTimeout(r,i))}}async function Ff(t=["high","medium"]){try{if(sa){f("");const a=Xi(sa,t);return f(` ${a.length}  (: ${t.join(", ")})`),a}const e=N("asset-list.json");f(` R2 CDN : ${e}`);const s=await Hl(e);if(!s.ok)throw new Error(`: HTTP ${s.status}`);const n=await s.json();sa=n,f("");const o=Xi(n,t);return f(` ${o.length}  (: ${t.join(", ")})`),o}catch(e){return f(":",e.message),["logo.glb","frontend_resource/start_game.webp","frontend_resource/copper_warehouse.webp","frontend_resource/game_wiki.webp","frontend_resource/Tutorial.webp","frontend_resource/gacha.webp"]}}function Xi(t,e){const s=[];for(const n of e)if(t.categories&&t.categories[n]){const o=t.categories[n].resources||[];s.push(...o.map(a=>a.path))}return s}async function ka(t=null,e=["high","medium"]){f("..."),await Wt.cleanupCache();const s=await Ff(e),n=ln.batchSize,o=ln.loadInterval,a=s.length;let i=0;t&&t(0,a,0);for(let r=0;r<s.length;r+=n){const l=s.slice(r,r+n);f(` ${Math.floor(r/n)+1}/${Math.ceil(s.length/n)}: ${l.length} `);const c=l.map(async(S,_)=>{const M=N(S);try{if(await Wt.isCached(M))return f(`Cache Storage: ${S}`),{success:!0,path:S,cached:!0,source:"cache"};const v=new AbortController,L=setTimeout(()=>v.abort(),no.timeout),F=await fetch(M,{method:"GET",mode:"cors",credentials:"omit",cache:"no-cache",signal:v.signal});if(clearTimeout(L),F.ok){const j=F.headers.get("x-cache")||F.headers.get("cf-cache-status")||F.type==="basic"&&!F.redirected;return Wt.isSupported()&&await Wt.cacheResource(M,F),f(`: ${S}${j?" ()":""}`),{success:!0,path:S,cached:!1,fromBrowserCache:!!j}}else throw new Error(`HTTP ${F.status}: ${F.statusText}`)}catch(b){return f(`: ${S}`,b.message),{success:!1,path:S,error:b.message}}}),u=await Promise.all(c);i+=l.length;const d=Math.round(i/a*100);t&&t(i,a,d);const h=u.filter(S=>S.success).length,m=u.filter(S=>S.cached).length,g=u.filter(S=>S.fromBrowserCache).length,E=u.filter(S=>!S.success).length;f(`:  ${h}, Cache Storage ${m},  ${g},  ${E}`),r+n<s.length&&(f(` ${o}ms ...`),await new Promise(S=>setTimeout(S,o)))}f(""),t&&t(a,a,100)}async function Bf(){if(!Wt.isSupported())return{supported:!1,message:"API"};try{const e=await(await caches.open(Wt.getCacheName())).keys();return{supported:!0,cacheName:Wt.getCacheName(),resourceCount:e.length,totalSize:Wt.totalSize,maxSize:ln.maxCacheSize}}catch(t){return{supported:!0,error:t.message}}}function Io(t,e){return N(`copper/${t.toLowerCase()}/${e}/${e}.glb`)}function Oo(t){return N(`enemy/${t}/${t}.glb`)}function Ul(t){return N(`structure/${t}/${t}.glb`)}function jf(t){return N(t)}const mt=(t,e)=>{const s=t.__vccOpts||t;for(const[n,o]of e)s[n]=o;return s},zf={class:"hall-container"},Vf=["src"],Wf={__name:"Hall",props:{musicOn:{type:Boolean,default:!0},paused:{type:Boolean,default:!1}},emits:["startGame","openWarehouse","openTutorial","openEncyclopedia","toggle-music"],setup(t,{emit:e}){const s=e,n=t;function o(){s("startGame")}function a(){s("openWarehouse")}function i(){s("openTutorial")}function r(){s("openEncyclopedia")}const l=V(N("@assets/frontend_resource/start_game.webp")),c=V(N("@assets/frontend_resource/copper_warehouse.webp")),u=V(N("@assets/frontend_resource/game_wiki.webp")),d=V(N("@assets/frontend_resource/Tutorial.webp")),h=V(N("ui/Gemini_Generated_Image_gtrehogtrehogtre (1).png")),m=V(!1),g=V(null),E=N("@assets/frontend_resource/hall.mp3");return $t(()=>{setTimeout(()=>{m.value=!0,f("HallUI")},100),n.musicOn&&!n.paused&&g.value&&setTimeout(()=>{if(g.value.readyState>=2)g.value.play().then(()=>{f("[Hall] ")}).catch(_=>{f("[Hall] :",_)});else{const _=()=>{g.value.play().then(()=>{f("[Hall] ")}).catch(M=>{f("[Hall] :",M)}),g.value.removeEventListener("canplay",_)};g.value.addEventListener("canplay",_,{once:!0})}},200)}),Gt(()=>n.musicOn,S=>{if(g.value)if(S&&!n.paused)if(g.value.readyState>=2)g.value.play().catch(_=>{f("[Hall] :",_)});else{const _=()=>{g.value.play().catch(M=>{f("[Hall] :",M)}),g.value.removeEventListener("canplay",_)};g.value.addEventListener("canplay",_)}else g.value.pause()}),Gt(()=>n.paused,S=>{if(g.value){if(S)g.value.pause(),f("[Hall] ");else if(n.musicOn){if(g.value.readyState>=2)g.value.play().catch(_=>{f("[Hall] :",_)});else{const _=()=>{g.value.play().catch(M=>{f("[Hall] :",M)}),g.value.removeEventListener("canplay",_)};g.value.addEventListener("canplay",_)}f("[Hall] ")}}}),fs(()=>{g.value&&g.value.pause()}),(S,_)=>(I(),H("div",zf,[p("div",{class:"hall-bg",style:zt({backgroundImage:`url('${h.value}')`})},null,4),p("div",{class:Je(["menu",{"menu--loaded":m.value}])},[p("button",{class:"tile tile--start",style:zt({backgroundImage:`url('${l.value}')`}),onClick:o},[..._[0]||(_[0]=[p("div",{class:"tile__mask"},null,-1),p("div",{class:"tile__caption tile__caption--bottom"},[p("div",{class:"tile__title"},""),p("div",{class:"tile__subtitle"},"Begin Adventure")],-1)])],4),p("button",{class:"tile tile--warehouse",style:zt({backgroundImage:`url('${c.value}')`}),onClick:a},[..._[1]||(_[1]=[p("div",{class:"tile__mask"},null,-1),p("div",{class:"tile__caption tile__caption--top"},[p("div",{class:"tile__title"},""),p("div",{class:"tile__subtitle"},"Character Collection")],-1)])],4),p("button",{class:"tile tile--wiki",style:zt({backgroundImage:`url('${u.value}')`}),onClick:r},[..._[2]||(_[2]=[p("div",{class:"tile__mask"},null,-1),p("div",{class:"tile__caption tile__caption--bottom"},[p("div",{class:"tile__title"},""),p("div",{class:"tile__subtitle"},"Encyclopedia")],-1)])],4),p("button",{class:"tile tile--tutorial",style:zt({backgroundImage:`url('${d.value}')`}),onClick:i},[..._[3]||(_[3]=[p("div",{class:"tile__mask"},null,-1),p("div",{class:"tile__caption tile__caption--top"},[p("div",{class:"tile__title"},""),p("div",{class:"tile__subtitle"},"Tutorial")],-1)])],4)],2),p("audio",{ref_key:"audioRef",ref:g,src:ue(E),loop:"",preload:"auto"},null,8,Vf)]))}},Kf=mt(Wf,[["__scopeId","data-v-4537fc51"]]),Zt={HeartCrystalDust:{name:"",icon:N("resource/heart_crystal_dust.webp")},RecallGear:{name:"",icon:N("resource/recall_gear.webp")},ResonantCrystal:{name:"",icon:N("resource/resonant_star_crystal/resonant_star_crystal.webp")},RefinedCopper:{name:"",icon:N("resource/refined_copper_ingot/refined_copper_ingot.webp")},SpiritalSpark:{name:"",icon:N("resource/spiritual_spark.webp")}};function Ya(t){var e;if(Array.isArray(t==null?void 0:t.item_type)&&t.item_type[0]==="Resource"){const s=t.item_type[1];return((e=Zt[s])==null?void 0:e.name)||s}else if(Array.isArray(t==null?void 0:t.item_type)&&t.item_type[0]==="Equipment")return"";return""}function vt(t){var e;return((e=Zt[t])==null?void 0:e.name)||t}function os(t){var e;return((e=Zt[t])==null?void 0:e.icon)||""}const qf="modulepreload",Xf=function(t,e){return new URL(t,e).href},Yi={},Fl=function(e,s,n){let o=Promise.resolve();if(s&&s.length>0){const i=document.getElementsByTagName("link"),r=document.querySelector("meta[property=csp-nonce]"),l=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));o=Promise.allSettled(s.map(c=>{if(c=Xf(c,n),c in Yi)return;Yi[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(!!n)for(let g=i.length-1;g>=0;g--){const E=i[g];if(E.href===c&&(!u||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":qf,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((g,E)=>{m.addEventListener("load",g),m.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=i,window.dispatchEvent(r),!r.defaultPrevented)throw i}return o.then(i=>{for(const r of i||[])r.status==="rejected"&&a(r.reason);return e().catch(a)})};function Yf(t){return{all:t=t||new Map,on:function(e,s){var n=t.get(e);n?n.push(s):t.set(e,[s])},off:function(e,s){var n=t.get(e);n&&(s?n.splice(n.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var n=t.get(e);n&&n.slice().map(function(o){o(s)}),(n=t.get("*"))&&n.slice().map(function(o){o(e,s)})}}}const Ja=Yf(),Ot={UPDATE_RESOURCES:"update:resources",RESOURCES_UPDATED:"resources:updated",COPPER_ID_ADDED:"copper:id:added",START_MENU_PAUSE:"menu:pause",START_MENU_RESUME:"menu:resume",START_MENU_STARTED:"menu:started",CONTROL_MODE_CHANGED:"control:mode:changed",GAME_STARTED:"game:started",GAME_ENDED:"game:ended"},Ws=(t,e)=>{Ja.emit(t,e)},Do=(t,e)=>{Ja.on(t,e)},Za=(t,e)=>{Ja.off(t,e)};class Jf{constructor(){this.queue=[],this.isProcessing=!1,this.handlers=new Map,this.sceneContext=null}setSceneContext(e){this.sceneContext=e}registerHandler(e,s){this.handlers.set(e,s)}enqueue(e){["handle_on_click_copper","on_game_start"].includes(e.type_msg)&&f("[MessageQueue] :",e.type_msg),this.queue.push(e),this.isProcessing||this.processNext()}async processNext(){if(this.queue.length===0){this.isProcessing=!1;return}this.isProcessing=!0;const e=50;let s=0;for(;this.queue.length>0&&s<e;){const n=this.queue.shift();s++;try{const{type_msg:o,content:a}=n,i=this.handlers.get(o);if(i){const r=JSON.parse(a),l=i(r,this.sceneContext||{});l&&typeof l.then=="function"&&await l}else f("[MessageQueue] :",o),f("[MessageQueue] :",Array.from(this.handlers.keys()))}catch(o){f("[MessageQueue] :",o),f("[MessageQueue] :",o.message),f("[MessageQueue] :",o.stack)}}this.queue.length>0?requestAnimationFrame(()=>this.processNext()):this.isProcessing=!1}}const Ee=new Jf;function Jn(t,e){return t.find(s=>s.id===e)}function Ji(t){return new Promise(e=>setTimeout(e,t))}function Bl(){f("[MessageQueue] ..."),Ee.registerHandler("handle_on_click_copper",async(a,i)=>{var u,d;const{copper:r,resources:l,has_attack_targets:c}=a;f(`[Handler] : ${((u=r.copper.copper_info)==null?void 0:u.name)||"Unknown"} (ID=${r.id})`),f(`[Handler] : HP=${r.now_health}/${r.copper.attribute.health}, =${r.can_move}, =${r.can_attack}, =${r.can_summon}, =${r.can_build}, =${c}`),f(`[Handler] : ${(d=r.copper)==null?void 0:d.copper_type}`),i.highlightSelectedCopper&&i.highlightSelectedCopper(r.id),i.onShowCopperInfo&&i.onShowCopperInfo(r,l,c)}),Ee.registerHandler("handle_on_click_enemy",async(a,i)=>{var m,g;const{enemy:r,resources:l,has_attack_targets:c}=a,u=r.owned||!1;f(`[Handler] ${u?"":""}: ${((m=r.enemy_base)==null?void 0:m.name)||"Unknown"} (ID=${r.id})`),f(`[Handler] : HP=${r.now_health}/${r.enemy_base.health}, =${r.can_move}, =${r.can_attack}, owned=${r.owned}, =${c}`);const h={id:r.id,now_health:r.now_health,can_move:u?r.can_move:!1,can_attack:u?r.can_attack:!1,can_summon:!1,position:r.position,isEnemy:!u,isOwnedEnemy:u,copper:{copper_info:{name:((g=r.enemy_base)==null?void 0:g.name)||(u?"":"")},attribute:{health:r.enemy_base.health,attack:r.enemy_base.attack,defense:r.enemy_base.defense,speed:r.enemy_base.speed}}};i.highlightSelectedCopper&&i.highlightSelectedCopper(r.id),i.onShowCopperInfo&&i.onShowCopperInfo(h,l,c)}),Ee.registerHandler("handle_on_click_structure",async(a,i)=>{var d;const{structure:r,resources:l}=a,u=r.owned||!1?"":"";f(`[Handler] ${u}: ${((d=r.structure_base)==null?void 0:d.name)||"Unknown"} (ID=${r.id})`),f(`[Handler] : HP=${r.now_health}/${r.structure_base.health}, =${r.can_move}, =${r.can_attack}, owned=${r.owned}, =${r.structure_base.has_storage}`),i.highlightSelectedCopper&&i.highlightSelectedCopper(r.id),i.onShowStructureInfo&&i.onShowStructureInfo(r,l)}),Ee.registerHandler("set_copper",async(a,i)=>{const{id:r,position:l,copper:c}=a;window.__ACTUAL_COPPER_IDS__||(window.__ACTUAL_COPPER_IDS__=[]),window.__ACTUAL_COPPER_IDS__.push(c.id),Ws(Ot.COPPER_ID_ADDED,c.id),i.onSetCopper&&await i.onSetCopper(r,l,c)}),Ee.registerHandler("set_enemy",async(a,i)=>{const{id:r,position:l,enemy:c}=a;i.onSetEnemy&&i.onSetEnemy(r,l,c),c.owned&&Ws(Ot.UPDATE_RESOURCES)}),Ee.registerHandler("set_material",async(a,i)=>{const{id:r,position:l,material:c}=a;i.onSetMaterial&&await i.onSetMaterial(r,l,c)}),Ee.registerHandler("set_structure",async(a,i)=>{const{id:r,position:l,structure:c}=a;i.onSetStructure&&await i.onSetStructure(r,l,c),c.owned&&Ws(Ot.UPDATE_RESOURCES)}),Ee.registerHandler("remove_unit",async(a,i)=>{const{id:r}=a,l=Jn(i.models||[],r),c=l&&l.type==="enemy"&&!l.isOwned,u=c?l.position:null;if(f(`[Handler] remove_unit: ID=${r}, type=${l==null?void 0:l.type}, isOwned=${l==null?void 0:l.isOwned}, isEnemyDeath=${c}, position=${JSON.stringify(u)}`),l&&l.object){l.object.traverse(m=>{m.material&&(Array.isArray(m.material)?m.material=m.material.map(g=>g.clone()):m.material=m.material.clone())});const d=500,h=performance.now();if(await new Promise(m=>{function g(){const E=performance.now()-h,S=Math.min(E/d,1);l.object&&l.object.traverse(_=>{_.material&&(Array.isArray(_.material)?_.material.forEach(M=>{M.transparent=!0,M.opacity=1-S}):(_.material.transparent=!0,_.material.opacity=1-S))}),S<1?requestAnimationFrame(g):m()}g()}),i.scene&&i.scene.remove(l.object),l.object.traverse(m=>{m.geometry&&m.geometry.dispose(),m.material&&(Array.isArray(m.material)?m.material.forEach(g=>{g.map&&g.map.dispose(),g.lightMap&&g.lightMap.dispose(),g.bumpMap&&g.bumpMap.dispose(),g.normalMap&&g.normalMap.dispose(),g.specularMap&&g.specularMap.dispose(),g.envMap&&g.envMap.dispose(),g.alphaMap&&g.alphaMap.dispose(),g.aoMap&&g.aoMap.dispose(),g.displacementMap&&g.displacementMap.dispose(),g.emissiveMap&&g.emissiveMap.dispose(),g.metalnessMap&&g.metalnessMap.dispose(),g.roughnessMap&&g.roughnessMap.dispose(),g.dispose()}):(m.material.map&&m.material.map.dispose(),m.material.lightMap&&m.material.lightMap.dispose(),m.material.bumpMap&&m.material.bumpMap.dispose(),m.material.normalMap&&m.material.normalMap.dispose(),m.material.specularMap&&m.material.specularMap.dispose(),m.material.envMap&&m.material.envMap.dispose(),m.material.alphaMap&&m.material.alphaMap.dispose(),m.material.aoMap&&m.material.aoMap.dispose(),m.material.displacementMap&&m.material.displacementMap.dispose(),m.material.emissiveMap&&m.material.emissiveMap.dispose(),m.material.metalnessMap&&m.material.metalnessMap.dispose(),m.material.roughnessMap&&m.material.roughnessMap.dispose(),m.material.dispose()))}),i.models){const m=i.models.indexOf(l);m>-1&&i.models.splice(m,1)}i.onClearState&&i.onClearState(r),i.onRemoveHealthBar&&i.onRemoveHealthBar(r),l.type==="copper"&&i.onRemoveCopper&&i.onRemoveCopper(r)}if(c&&u){f("[Handler] ...");const d=h=>{f("[Handler] :",h),i.onShowResourceGain&&Object.keys(h).length>0&&(f("[Handler] :",u,h),i.onShowResourceGain(u,h))};Do(Ot.RESOURCES_UPDATED,d),Ws(Ot.UPDATE_RESOURCES),setTimeout(()=>{Za(Ot.RESOURCES_UPDATED,d)},1e3)}}),Ee.registerHandler("change_direction",async(a,i)=>{const{id:r,direction:l}=a,c=Jn(i.models||[],r);if(c&&c.object){let u=0;switch(l){case"PositiveY":u=0;break;case"PositiveX":u=Math.PI/2;break;case"NegativeY":u=Math.PI;break;case"NegativeX":u=-Math.PI/2;break}let d=c.object.rotation.y;d=Math.atan2(Math.sin(d),Math.cos(d));let h=u-d;h>Math.PI?h-=2*Math.PI:h<-Math.PI&&(h+=2*Math.PI);const m=300,g=performance.now();await new Promise(E=>{function S(){const _=performance.now()-g,M=Math.min(_/m,1),b=1-Math.pow(1-M,2);c.object&&(c.object.rotation.y=d+h*b),M<1?requestAnimationFrame(S):(c.object&&(c.object.rotation.y=u),E())}S()})}}),Ee.registerHandler("move_to",async(a,i)=>{const{id:r,to:l}=a,c=Jn(i.models||[],r);if(c&&c.object&&i.gridCellSize){const[u,d]=l,h=u,m=d,g=c.object.position.y;c.position=[u,d],i.onMoveStart&&i.onMoveStart(r,c),i.animateModelMove&&await new Promise(E=>{i.animateModelMove(c,{x:h,y:g,z:m},E)}),i.onMoveComplete&&i.onMoveComplete(r)}}),Ee.registerHandler("display_can_move",(a,i)=>{const{id:r,can_move:l}=a,c=l==="true"||l===!0;i.onDisplayCanMove&&i.onDisplayCanMove(r,c)}),Ee.registerHandler("display_can_attack",(a,i)=>{const{id:r,can_attack:l}=a,c=l==="true"||l===!0;i.onDisplayCanAttack&&i.onDisplayCanAttack(r,c)}),Ee.registerHandler("display_can_summon",(a,i)=>{const{id:r,can_summon:l}=a,c=l==="true"||l===!0;f(`[Handler] display_can_summon id=${r}, can_summon=${c}`),i.onDisplayCanSummon&&i.onDisplayCanSummon(r,c)}),Ee.registerHandler("update_health",(a,i)=>{const{id:r,now_health:l,max_health:c}=a;i.onUpdateHealth&&i.onUpdateHealth(r,l,c)}),Ee.registerHandler("clear_state",(a,i)=>{const{id:r}=a;i.onClearState&&i.onClearState(r)}),Ee.registerHandler("animate_move",async(a,i)=>{const{id:r}=a,l=Jn(i.models||[],r);if(!l){f(`[Handler] animate_move:  ID=${r}`);return}if(window.disableAutoFocus){f(`[Handler] animate_move:  ID=${r}`);return}const c=i.followEnemies!==void 0?i.followEnemies:!1;if(l.type==="enemy"&&!c){f(`[Handler] animate_move:  ID=${r}  context.followEnemies = true `);return}if(i.camera&&i.focusOnModel){const u=i.focusOnModel(l.object,i.camera,i.controls);i.focusState&&(i.focusState.focusPosition=u.focusPosition,i.focusState.focusTarget=u.focusTarget,i.focusState.lerpFactor=u.lerpFactor,f(`[Handler] animate_move:  ID=${r} (${l.name})`)),await Ji(1e3)}}),Ee.registerHandler("animate_reset",async(a,i)=>{if(f("[Handler] animate_reset"),i.camera&&i.controls){const r={x:0,y:2,z:5},l={x:0,y:0,z:0};i.focusState&&(i.focusState.focusPosition=r,i.focusState.focusTarget=l,i.focusState.lerpFactor=.08),await Ji(1e3)}}),Ee.registerHandler("put_map_block",(a,i)=>{const{position:r}=a;i.onPutMapBlock&&i.onPutMapBlock(r)}),Ee.registerHandler("put_room_blocks",async(a,i)=>{const{room_position:r,size:l}=a,[c,u]=r;if(f(`[Handler]  : [${c}, ${u}], ${l}x${l}`),!i.onPutMapBlock){f("[Handler]  context.onPutMapBlock ");return}f("[Handler]  context.onPutMapBlock ...");const d=32,h=l*l;let m=0;for(let g=0;g<l;g++)for(let E=0;E<l;E++){const S=[c+g,u+E];i.onPutMapBlock(S),m++,m%d===0&&await new Promise(_=>requestAnimationFrame(_))}f(`[Handler]  : ${h}`)}),Ee.registerHandler("put_resource_marker",(a,i)=>{const{position:r}=a;i.onPutResourceMarker&&i.onPutResourceMarker(r)}),Ee.registerHandler("clear_resource_marker",(a,i)=>{const{position:r}=a;i.onClearResourceMarker&&i.onClearResourceMarker(r)});let t=0,e=0,s=0;Ee.registerHandler("set_move_block",(a,i)=>{const{position:r}=a;t++,i.onSetMoveBlock&&i.onSetMoveBlock(r)}),Ee.registerHandler("set_attack_block",(a,i)=>{const{position:r}=a;e++,i.onSetAttackBlock&&i.onSetAttackBlock(r),(e===1||e%10===0)&&f(`[Handler]  ${e} `)}),Ee.registerHandler("set_can_summon_blocks",(a,i)=>{const{position:r}=a;s++,i.onSetCanSummonBlock&&i.onSetCanSummonBlock(r),(s===1||s%10===0)&&f(`[Handler]  ${s} `)});let n=0,o=Date.now();Ee.registerHandler("clear_block",(a,i)=>{const{position:r}=a;i.onClearBlock&&i.onClearBlock(r),n++;const l=Date.now();l-o>500&&(n>1&&f(`[Handler]   ${n} `),n=0,t>0&&(f(`[Handler]  ${t} `),t=0),e>0&&(f(`[Handler]  ${e} `),e=0),s>0&&(f(`[Handler]  ${s} `),s=0)),o=l}),Ee.registerHandler("attack_complete",(a,i)=>{const{id:r}=a;i.onAttackComplete&&i.onAttackComplete(r)}),Ee.registerHandler("on_game_round_pass",(a,i)=>{}),Ee.registerHandler("craft_success",(a,i)=>{i.onCraftResult&&i.onCraftResult(!0,a.message||"")}),Ee.registerHandler("craft_failed",(a,i)=>{i.onCraftResult&&i.onCraftResult(!1,a.message||"")}),Ee.registerHandler("cannot_pick_up_item",(a,i)=>{f("[Handler] :",a.message||a)}),Ee.registerHandler("equipment_slot_full",(a,i)=>{f("[Handler] :",a.message||a)}),Ee.registerHandler("inventory_full",(a,i)=>{f("[Handler] :",a.message||a)}),Ee.registerHandler("resource_not_enough",(a,i)=>{let r="";if(a.missing&&Array.isArray(a.missing)&&a.missing.length>0){const l={HeartCrystalDust:"",RecallGear:"",SpiritalSpark:"",RefinedCopper:"",ResonantCrystal:""};r=`: ${a.missing.map(u=>{const d=l[u.type]||u.type,h=u.needed-u.current;return`${d} ( ${h})`}).join("")}`}f("[Handler] :",r),i.onResourceNotEnough&&i.onResourceNotEnough(r)}),Ee.registerHandler("summon_failed",(a,i)=>{f("[Handler] :",a.message||a),i.onSummonFailed&&i.onSummonFailed(a.message||"")}),Ee.registerHandler("summon_expired",(a,i)=>{const{id:r,message:l}=a;f(`[Handler] : ID=${r}, ${l}`)}),Ee.registerHandler("get_summon_menu",(a,i)=>{const{contents:r}=a;f("[Handler] :",r),i.onShowSummonMenu&&i.onShowSummonMenu(r)}),Ee.registerHandler("get_structure_menu",(a,i)=>{const{contents:r}=a;if(!r||r.length===0){f("[Handler]  ");return}const l=r.filter(c=>c.name!=="");f("[Handler] ",l.length,""),i.onShowStructureMenu&&i.onShowStructureMenu(l)}),Ee.registerHandler("drill_resource_generate",(a,i)=>{const{position:r,resource_type:l,amount:c}=a;f(`[Handler] : =${JSON.stringify(r)}, =${l}, =${c}`);const u={[l]:parseInt(c)};i.onShowResourceGain&&i.onShowResourceGain(r,u),Ws(Ot.UPDATE_RESOURCES)}),Ee.registerHandler("game_over",(a,i)=>{f("[Handler] "),i.onGameOver&&i.onGameOver()}),Ee.registerHandler("success",(a,i)=>{f("[Handler] "),i.onGameSuccess&&i.onGameSuccess()})}const Zf=Object.freeze(Object.defineProperty({__proto__:null,messageQueue:Ee,registerAllHandlers:Bl},Symbol.toStringTag,{value:"Module"}));Bl();let Ge=null,ps=null;ps=(async()=>{try{return Ge=await Fl(()=>import("./main-Bp8322Dw.js"),[],import.meta.url),f("[Glue] main.js "),Ge}catch(t){return f("[Glue] main.js :",t.message),null}})();async function Qf(){return await ps,Ge!=null&&Ge.global_gacha?JSON.parse(Ge.global_gacha()):{type:"error",content:""}}async function No(){return await ps,Ge!=null&&Ge.global_get_resource?JSON.parse(Ge.global_get_resource()):{}}async function ep(){return await ps,Ge!=null&&Ge.global_craft?JSON.parse(Ge.global_craft()):{type:"error",content:""}}async function oo(){return await ps,Ge!=null&&Ge.global_get_copper_list?JSON.parse(Ge.global_get_copper_list()):[]}async function tp(t){return await ps,Ge!=null&&Ge.global_upgrade_copper?JSON.parse(Ge.global_upgrade_copper(t)):{type:"error",content:""}}async function jl(t){await ps,Ge!=null&&Ge.global_info_subscribe?(Ge.global_info_subscribe(e=>{const s=JSON.parse(e);t(s),Ee.enqueue(s)}),f("[Glue] global_info_subscribe ")):f("[Glue] global_info_subscribe ")}async function sp(t){await ps,Ge!=null&&Ge.global_import_save&&Ge.global_import_save(t)}async function np(){return await ps,Ge!=null&&Ge.global_export_save?JSON.parse(Ge.global_export_save()):{type:"error",content:""}}async function xe(t){await ps,Ge!=null&&Ge.eventloop?Ge.eventloop(t):f("[Glue] eventloop ")}const op={class:"draw-screen"},ap={class:"draw-screen__body"},ip={class:"draw-card"},rp={class:"card-face card-back"},lp=["src"],cp={class:"card-face card-front"},up=["src"],dp={key:1,class:"card-icon"},fp=["src"],pp={class:"draw-cost"},hp=["src"],mp=["disabled","title"],gp={key:0,class:"toast"},_p={__name:"DrawScreen",emits:["draw"],setup(t,{emit:e}){const s=e,n=V(!1),o=V(!0),a=V(!1),i=V(""),r=V(""),l=V(""),c=V({left:0,top:0,width:0,height:0}),u=V(!1),d=V(!1),h=V(!1),m=V("");function g(M){m.value=M||"",h.value=!0,setTimeout(()=>{h.value=!1},1800)}async function E(){try{const b=await No(),v=Number((b==null?void 0:b.SpiritalSpark)??0);o.value=v>=10}catch{o.value=!1}}function S(){a.value=!1,u.value=!1,d.value=!1}function _(){if(n.value)return;if(E(),!o.value){g("");return}n.value=!0,f("[DrawScreen] runDrawSequence start");const M=document.querySelector(".draw-card");if(M){M.classList.add("is-shaking"),setTimeout(()=>M.classList.remove("is-shaking"),500);const b=M.getBoundingClientRect();c.value={left:Math.round(b.left),top:Math.round(b.top),width:Math.round(b.width),height:Math.round(b.height)}}setTimeout(async()=>{a.value=!0,u.value=!1,d.value=!0;try{const b=await Qf();if(b&&b.type==="success"&&b.copper&&b.copper.copper_info){const v=b.copper.copper_info;i.value=v.name||"",r.value="",l.value=N(v.icon_url||""),f("[DrawScreen] tempImage resolved:",l.value),await Ln(),setTimeout(()=>{d.value=!1,setTimeout(()=>{u.value=!0},350)},450),s("draw",{name:v.name,image:v.icon_url||""}),E()}else b&&b.type==="error"&&(a.value=!1,u.value=!1,d.value=!1,g(b.content||""),s("draw",{error:!0}),E())}catch{a.value=!1,u.value=!1,d.value=!1,g(""),s("draw",{error:!0}),E()}finally{setTimeout(()=>{n.value=!1},800)}},600)}return(M,b)=>(I(),H("div",op,[p("div",ap,[p("div",ip,[a.value?(I(),H("div",{key:0,class:"draw-temp",onClick:S},[b[3]||(b[3]=p("div",{class:"dim-backdrop"},null,-1)),p("div",{class:"temp-stack",style:zt({left:c.value.left+"px",top:c.value.top+"px",width:c.value.width+"px",height:c.value.height+"px"}),onClick:b[2]||(b[2]=bs(()=>{},["stop"]))},[p("div",{class:Je(["card",{flipped:d.value}]),onClick:b[0]||(b[0]=bs(v=>d.value=!d.value,["stop"]))},[p("div",rp,[p("img",{src:ue(N)("frontend_resource/gacha.webp"),alt:"back"},null,8,lp)]),p("div",cp,[l.value?(I(),H("img",{key:0,src:l.value,alt:"copper",class:"card-front-img"},null,8,up)):(I(),H("div",dp,Q(r.value||""),1))])],2),p("div",{class:Je(["card-name-below",{show:u.value}]),onClick:b[1]||(b[1]=bs(()=>{},["stop"]))},Q(i.value),3)],4)])):ve("",!0),p("img",{class:"draw-card__img",src:ue(N)("frontend_resource/gacha.webp"),alt:"card"},null,8,fp)]),p("div",pp,[p("img",{class:"draw-cost__icon",src:ue(N)("resource/spiritual_spark.webp"),alt:"cost"},null,8,hp),b[4]||(b[4]=p("span",{class:"draw-cost__times"},"X 10",-1))]),p("button",{class:"draw-action",disabled:n.value||!o.value,title:o.value?"":"",onClick:_},"  ",8,mp),h.value?(I(),H("div",gp,Q(m.value),1)):ve("",!0)])]))}},yp=mt(_p,[["__scopeId","data-v-5ea8b534"]]);function Zi(t,e){if(e===$c)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===ca||e===fr){let s=t.getIndex();if(s===null){const i=[],r=t.getAttribute("position");if(r!==void 0){for(let l=0;l<r.count;l++)i.push(l);t.setIndex(i),s=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const n=s.count-2,o=[];if(e===ca)for(let i=1;i<=n;i++)o.push(s.getX(0)),o.push(s.getX(i)),o.push(s.getX(i+1));else for(let i=0;i<n;i++)i%2===0?(o.push(s.getX(i)),o.push(s.getX(i+1)),o.push(s.getX(i+2))):(o.push(s.getX(i+2)),o.push(s.getX(i+1)),o.push(s.getX(i)));o.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=t.clone();return a.setIndex(o),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}class Go extends pr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(s){return new Mp(s)}),this.register(function(s){return new Tp(s)}),this.register(function(s){return new Lp(s)}),this.register(function(s){return new Ip(s)}),this.register(function(s){return new Op(s)}),this.register(function(s){return new Ep(s)}),this.register(function(s){return new xp(s)}),this.register(function(s){return new kp(s)}),this.register(function(s){return new Ap(s)}),this.register(function(s){return new Sp(s)}),this.register(function(s){return new Rp(s)}),this.register(function(s){return new Cp(s)}),this.register(function(s){return new Pp(s)}),this.register(function(s){return new $p(s)}),this.register(function(s){return new wp(s)}),this.register(function(s){return new Dp(s)}),this.register(function(s){return new Np(s)})}load(e,s,n,o){const a=this;let i;if(this.resourcePath!=="")i=this.resourcePath;else if(this.path!==""){const c=vn.extractUrlBase(e);i=vn.resolveURL(c,this.path)}else i=vn.extractUrlBase(e);this.manager.itemStart(e);const r=function(c){o?o(c):console.error(c),a.manager.itemError(e),a.manager.itemEnd(e)},l=new ao(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{a.parse(c,i,function(u){s(u),a.manager.itemEnd(e)},r)}catch(u){r(u)}},n,r)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,s,n,o){let a;const i={},r={},l=new TextDecoder;if(typeof e=="string")a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===zl){try{i[He.KHR_BINARY_GLTF]=new Gp(e)}catch(d){o&&o(d);return}a=JSON.parse(i[He.KHR_BINARY_GLTF].content)}else a=JSON.parse(l.decode(e));else a=e;if(a.asset===void 0||a.asset.version[0]<2){o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new Jp(a,{path:s||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const d=this.pluginCallbacks[u](c);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),r[d.name]=d,i[d.name]=!0}if(a.extensionsUsed)for(let u=0;u<a.extensionsUsed.length;++u){const d=a.extensionsUsed[u],h=a.extensionsRequired||[];switch(d){case He.KHR_MATERIALS_UNLIT:i[d]=new bp;break;case He.KHR_DRACO_MESH_COMPRESSION:i[d]=new Hp(a,this.dracoLoader);break;case He.KHR_TEXTURE_TRANSFORM:i[d]=new Up;break;case He.KHR_MESH_QUANTIZATION:i[d]=new Fp;break;default:h.indexOf(d)>=0&&r[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}c.setExtensions(i),c.setPlugins(r),c.parse(n,o)}parseAsync(e,s){const n=this;return new Promise(function(o,a){n.parse(e,s,o,a)})}}function vp(){let t={};return{get:function(e){return t[e]},add:function(e,s){t[e]=s},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const He={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class wp{constructor(e){this.parser=e,this.name=He.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,s=this.parser.json.nodes||[];for(let n=0,o=s.length;n<o;n++){const a=s[n];a.extensions&&a.extensions[this.name]&&a.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}_loadLight(e){const s=this.parser,n="light:"+e;let o=s.cache.get(n);if(o)return o;const a=s.json,l=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let c;const u=new ts(16777215);l.color!==void 0&&u.setRGB(l.color[0],l.color[1],l.color[2],us);const d=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new cs(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new Qs(u),c.distance=d;break;case"spot":c=new Pc(u),c.distance=d,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),is(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=s.createUniqueName(l.name||"light_"+e),o=Promise.resolve(c),s.cache.add(n,o),o}getDependency(e,s){if(e==="light")return this._loadLight(s)}createNodeAttachment(e){const s=this,n=this.parser,a=n.json.nodes[e],r=(a.extensions&&a.extensions[this.name]||{}).light;return r===void 0?null:this._loadLight(r).then(function(l){return n._getNodeRef(s.cache,r,l)})}}class bp{constructor(){this.name=He.KHR_MATERIALS_UNLIT}getMaterialType(){return ht}extendParams(e,s,n){const o=[];e.color=new ts(1,1,1),e.opacity=1;const a=s.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const i=a.baseColorFactor;e.color.setRGB(i[0],i[1],i[2],us),e.opacity=i[3]}a.baseColorTexture!==void 0&&o.push(n.assignTexture(e,"map",a.baseColorTexture,bt))}return Promise.all(o)}}class Sp{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,s){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=o.extensions[this.name].emissiveStrength;return a!==void 0&&(s.emissiveIntensity=a),Promise.resolve()}}class Mp{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],i=o.extensions[this.name];if(i.clearcoatFactor!==void 0&&(s.clearcoat=i.clearcoatFactor),i.clearcoatTexture!==void 0&&a.push(n.assignTexture(s,"clearcoatMap",i.clearcoatTexture)),i.clearcoatRoughnessFactor!==void 0&&(s.clearcoatRoughness=i.clearcoatRoughnessFactor),i.clearcoatRoughnessTexture!==void 0&&a.push(n.assignTexture(s,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),i.clearcoatNormalTexture!==void 0&&(a.push(n.assignTexture(s,"clearcoatNormalMap",i.clearcoatNormalTexture)),i.clearcoatNormalTexture.scale!==void 0)){const r=i.clearcoatNormalTexture.scale;s.clearcoatNormalScale=new Ct(r,r)}return Promise.all(a)}}class Tp{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=o.extensions[this.name];return s.dispersion=a.dispersion!==void 0?a.dispersion:0,Promise.resolve()}}class Cp{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],i=o.extensions[this.name];return i.iridescenceFactor!==void 0&&(s.iridescence=i.iridescenceFactor),i.iridescenceTexture!==void 0&&a.push(n.assignTexture(s,"iridescenceMap",i.iridescenceTexture)),i.iridescenceIor!==void 0&&(s.iridescenceIOR=i.iridescenceIor),s.iridescenceThicknessRange===void 0&&(s.iridescenceThicknessRange=[100,400]),i.iridescenceThicknessMinimum!==void 0&&(s.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),i.iridescenceThicknessMaximum!==void 0&&(s.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),i.iridescenceThicknessTexture!==void 0&&a.push(n.assignTexture(s,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(a)}}class Ep{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[];s.sheenColor=new ts(0,0,0),s.sheenRoughness=0,s.sheen=1;const i=o.extensions[this.name];if(i.sheenColorFactor!==void 0){const r=i.sheenColorFactor;s.sheenColor.setRGB(r[0],r[1],r[2],us)}return i.sheenRoughnessFactor!==void 0&&(s.sheenRoughness=i.sheenRoughnessFactor),i.sheenColorTexture!==void 0&&a.push(n.assignTexture(s,"sheenColorMap",i.sheenColorTexture,bt)),i.sheenRoughnessTexture!==void 0&&a.push(n.assignTexture(s,"sheenRoughnessMap",i.sheenRoughnessTexture)),Promise.all(a)}}class xp{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],i=o.extensions[this.name];return i.transmissionFactor!==void 0&&(s.transmission=i.transmissionFactor),i.transmissionTexture!==void 0&&a.push(n.assignTexture(s,"transmissionMap",i.transmissionTexture)),Promise.all(a)}}class kp{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],i=o.extensions[this.name];s.thickness=i.thicknessFactor!==void 0?i.thicknessFactor:0,i.thicknessTexture!==void 0&&a.push(n.assignTexture(s,"thicknessMap",i.thicknessTexture)),s.attenuationDistance=i.attenuationDistance||1/0;const r=i.attenuationColor||[1,1,1];return s.attenuationColor=new ts().setRGB(r[0],r[1],r[2],us),Promise.all(a)}}class Ap{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const o=this.parser.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=o.extensions[this.name];return s.ior=a.ior!==void 0?a.ior:1.5,Promise.resolve()}}class Rp{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],i=o.extensions[this.name];s.specularIntensity=i.specularFactor!==void 0?i.specularFactor:1,i.specularTexture!==void 0&&a.push(n.assignTexture(s,"specularIntensityMap",i.specularTexture));const r=i.specularColorFactor||[1,1,1];return s.specularColor=new ts().setRGB(r[0],r[1],r[2],us),i.specularColorTexture!==void 0&&a.push(n.assignTexture(s,"specularColorMap",i.specularColorTexture,bt)),Promise.all(a)}}class $p{constructor(e){this.parser=e,this.name=He.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],i=o.extensions[this.name];return s.bumpScale=i.bumpFactor!==void 0?i.bumpFactor:1,i.bumpTexture!==void 0&&a.push(n.assignTexture(s,"bumpMap",i.bumpTexture)),Promise.all(a)}}class Pp{constructor(e){this.parser=e,this.name=He.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:ds}extendMaterialParams(e,s){const n=this.parser,o=n.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const a=[],i=o.extensions[this.name];return i.anisotropyStrength!==void 0&&(s.anisotropy=i.anisotropyStrength),i.anisotropyRotation!==void 0&&(s.anisotropyRotation=i.anisotropyRotation),i.anisotropyTexture!==void 0&&a.push(n.assignTexture(s,"anisotropyMap",i.anisotropyTexture)),Promise.all(a)}}class Lp{constructor(e){this.parser=e,this.name=He.KHR_TEXTURE_BASISU}loadTexture(e){const s=this.parser,n=s.json,o=n.textures[e];if(!o.extensions||!o.extensions[this.name])return null;const a=o.extensions[this.name],i=s.options.ktx2Loader;if(!i){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return s.loadTextureImage(e,a.source,i)}}class Ip{constructor(e){this.parser=e,this.name=He.EXT_TEXTURE_WEBP}loadTexture(e){const s=this.name,n=this.parser,o=n.json,a=o.textures[e];if(!a.extensions||!a.extensions[s])return null;const i=a.extensions[s],r=o.images[i.source];let l=n.textureLoader;if(r.uri){const c=n.options.manager.getHandler(r.uri);c!==null&&(l=c)}return n.loadTextureImage(e,i.source,l)}}class Op{constructor(e){this.parser=e,this.name=He.EXT_TEXTURE_AVIF}loadTexture(e){const s=this.name,n=this.parser,o=n.json,a=o.textures[e];if(!a.extensions||!a.extensions[s])return null;const i=a.extensions[s],r=o.images[i.source];let l=n.textureLoader;if(r.uri){const c=n.options.manager.getHandler(r.uri);c!==null&&(l=c)}return n.loadTextureImage(e,i.source,l)}}class Dp{constructor(e){this.name=He.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const s=this.parser.json,n=s.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const o=n.extensions[this.name],a=this.parser.getDependency("buffer",o.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return a.then(function(r){const l=o.byteOffset||0,c=o.byteLength||0,u=o.count,d=o.byteStride,h=new Uint8Array(r,l,c);return i.decodeGltfBufferAsync?i.decodeGltfBufferAsync(u,d,h,o.mode,o.filter).then(function(m){return m.buffer}):i.ready.then(function(){const m=new ArrayBuffer(u*d);return i.decodeGltfBuffer(new Uint8Array(m),u,d,h,o.mode,o.filter),m})})}else return null}}class Np{constructor(e){this.name=He.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const s=this.parser.json,n=s.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const o=s.meshes[n.mesh];for(const c of o.primitives)if(c.mode!==jt.TRIANGLES&&c.mode!==jt.TRIANGLE_STRIP&&c.mode!==jt.TRIANGLE_FAN&&c.mode!==void 0)return null;const i=n.extensions[this.name].attributes,r=[],l={};for(const c in i)r.push(this.parser.getDependency("accessor",i[c]).then(u=>(l[c]=u,l[c])));return r.length<1?null:(r.push(this.parser.createNodeMesh(e)),Promise.all(r).then(c=>{const u=c.pop(),d=u.isGroup?u.children:[u],h=c[0].count,m=[];for(const g of d){const E=new Ks,S=new ke,_=new un,M=new ke(1,1,1),b=new hr(g.geometry,g.material,h);for(let v=0;v<h;v++)l.TRANSLATION&&S.fromBufferAttribute(l.TRANSLATION,v),l.ROTATION&&_.fromBufferAttribute(l.ROTATION,v),l.SCALE&&M.fromBufferAttribute(l.SCALE,v),b.setMatrixAt(v,E.compose(S,_,M));for(const v in l)if(v==="_COLOR_0"){const L=l[v];b.instanceColor=new Lc(L.array,L.itemSize,L.normalized)}else v!=="TRANSLATION"&&v!=="ROTATION"&&v!=="SCALE"&&g.geometry.setAttribute(v,l[v]);mr.prototype.copy.call(b,g),this.parser.assignFinalMaterial(b),m.push(b)}return u.isGroup?(u.clear(),u.add(...m),u):m[0]}))}}const zl="glTF",_n=12,Qi={JSON:1313821514,BIN:5130562};class Gp{constructor(e){this.name=He.KHR_BINARY_GLTF,this.content=null,this.body=null;const s=new DataView(e,0,_n),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:s.getUint32(4,!0),length:s.getUint32(8,!0)},this.header.magic!==zl)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const o=this.header.length-_n,a=new DataView(e,_n);let i=0;for(;i<o;){const r=a.getUint32(i,!0);i+=4;const l=a.getUint32(i,!0);if(i+=4,l===Qi.JSON){const c=new Uint8Array(e,_n+i,r);this.content=n.decode(c)}else if(l===Qi.BIN){const c=_n+i;this.body=e.slice(c,c+r)}i+=r}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Hp{constructor(e,s){if(!s)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=He.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=s,this.dracoLoader.preload()}decodePrimitive(e,s){const n=this.json,o=this.dracoLoader,a=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,r={},l={},c={};for(const u in i){const d=Aa[u]||u.toLowerCase();r[d]=i[u]}for(const u in e.attributes){const d=Aa[u]||u.toLowerCase();if(i[u]!==void 0){const h=n.accessors[e.attributes[u]],m=cn[h.componentType];c[d]=m.name,l[d]=h.normalized===!0}}return s.getDependency("bufferView",a).then(function(u){return new Promise(function(d,h){o.decodeDracoFile(u,function(m){for(const g in m.attributes){const E=m.attributes[g],S=l[g];S!==void 0&&(E.normalized=S)}d(m)},r,c,us,h)})})}}class Up{constructor(){this.name=He.KHR_TEXTURE_TRANSFORM}extendTexture(e,s){return(s.texCoord===void 0||s.texCoord===e.channel)&&s.offset===void 0&&s.rotation===void 0&&s.scale===void 0||(e=e.clone(),s.texCoord!==void 0&&(e.channel=s.texCoord),s.offset!==void 0&&e.offset.fromArray(s.offset),s.rotation!==void 0&&(e.rotation=s.rotation),s.scale!==void 0&&e.repeat.fromArray(s.scale),e.needsUpdate=!0),e}}class Fp{constructor(){this.name=He.KHR_MESH_QUANTIZATION}}class Vl extends su{constructor(e,s,n,o){super(e,s,n,o)}copySampleValue_(e){const s=this.resultBuffer,n=this.sampleValues,o=this.valueSize,a=e*o*3+o;for(let i=0;i!==o;i++)s[i]=n[a+i];return s}interpolate_(e,s,n,o){const a=this.resultBuffer,i=this.sampleValues,r=this.valueSize,l=r*2,c=r*3,u=o-s,d=(n-s)/u,h=d*d,m=h*d,g=e*c,E=g-c,S=-2*m+3*h,_=m-h,M=1-S,b=_-h+d;for(let v=0;v!==r;v++){const L=i[E+v+r],F=i[E+v+l]*u,j=i[g+v+r],re=i[g+v]*u;a[v]=M*L+b*F+S*j+_*re}return a}}const Bp=new un;class jp extends Vl{interpolate_(e,s,n,o){const a=super.interpolate_(e,s,n,o);return Bp.fromArray(a).normalize().toArray(a),a}}const jt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},cn={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},er={9728:_r,9729:ua,9984:Gc,9985:Nc,9986:Dc,9987:gr},tr={33071:Uc,33648:Hc,10497:Ss},na={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Aa={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},xs={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},zp={CUBICSPLINE:void 0,LINEAR:wr,STEP:Qc},oa={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Vp(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new pt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:tu})),t.DefaultMaterial}function js(t,e,s){for(const n in s.extensions)t[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=s.extensions[n])}function is(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Wp(t,e,s){let n=!1,o=!1,a=!1;for(let c=0,u=e.length;c<u;c++){const d=e[c];if(d.POSITION!==void 0&&(n=!0),d.NORMAL!==void 0&&(o=!0),d.COLOR_0!==void 0&&(a=!0),n&&o&&a)break}if(!n&&!o&&!a)return Promise.resolve(t);const i=[],r=[],l=[];for(let c=0,u=e.length;c<u;c++){const d=e[c];if(n){const h=d.POSITION!==void 0?s.getDependency("accessor",d.POSITION):t.attributes.position;i.push(h)}if(o){const h=d.NORMAL!==void 0?s.getDependency("accessor",d.NORMAL):t.attributes.normal;r.push(h)}if(a){const h=d.COLOR_0!==void 0?s.getDependency("accessor",d.COLOR_0):t.attributes.color;l.push(h)}}return Promise.all([Promise.all(i),Promise.all(r),Promise.all(l)]).then(function(c){const u=c[0],d=c[1],h=c[2];return n&&(t.morphAttributes.position=u),o&&(t.morphAttributes.normal=d),a&&(t.morphAttributes.color=h),t.morphTargetsRelative=!0,t})}function Kp(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let s=0,n=e.weights.length;s<n;s++)t.morphTargetInfluences[s]=e.weights[s];if(e.extras&&Array.isArray(e.extras.targetNames)){const s=e.extras.targetNames;if(t.morphTargetInfluences.length===s.length){t.morphTargetDictionary={};for(let n=0,o=s.length;n<o;n++)t.morphTargetDictionary[s[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function qp(t){let e;const s=t.extensions&&t.extensions[He.KHR_DRACO_MESH_COMPRESSION];if(s?e="draco:"+s.bufferView+":"+s.indices+":"+aa(s.attributes):e=t.indices+":"+aa(t.attributes)+":"+t.mode,t.targets!==void 0)for(let n=0,o=t.targets.length;n<o;n++)e+=":"+aa(t.targets[n]);return e}function aa(t){let e="";const s=Object.keys(t).sort();for(let n=0,o=s.length;n<o;n++)e+=s[n]+":"+t[s[n]]+";";return e}function Ra(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Xp(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":t.search(/\.ktx2($|\?)/i)>0||t.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const Yp=new Ks;class Jp{constructor(e={},s={}){this.json=e,this.extensions={},this.plugins={},this.options=s,this.cache=new vp,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,o=-1,a=!1,i=-1;if(typeof navigator<"u"){const r=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(r)===!0;const l=r.match(/Version\/(\d+)/);o=n&&l?parseInt(l[1],10):-1,a=r.indexOf("Firefox")>-1,i=a?r.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&o<17||a&&i<98?this.textureLoader=new dn(this.options.manager):this.textureLoader=new Ic(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new ao(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,s){const n=this,o=this.json,a=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(i){return i._markDefs&&i._markDefs()}),Promise.all(this._invokeAll(function(i){return i.beforeRoot&&i.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(i){const r={scene:i[0][o.scene||0],scenes:i[0],animations:i[1],cameras:i[2],asset:o.asset,parser:n,userData:{}};return js(a,r,o),is(r,o),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(r)})).then(function(){for(const l of r.scenes)l.updateMatrixWorld();e(r)})}).catch(s)}_markDefs(){const e=this.json.nodes||[],s=this.json.skins||[],n=this.json.meshes||[];for(let o=0,a=s.length;o<a;o++){const i=s[o].joints;for(let r=0,l=i.length;r<l;r++)e[i[r]].isBone=!0}for(let o=0,a=e.length;o<a;o++){const i=e[o];i.mesh!==void 0&&(this._addNodeRef(this.meshCache,i.mesh),i.skin!==void 0&&(n[i.mesh].isSkinnedMesh=!0)),i.camera!==void 0&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(e,s){s!==void 0&&(e.refs[s]===void 0&&(e.refs[s]=e.uses[s]=0),e.refs[s]++)}_getNodeRef(e,s,n){if(e.refs[s]<=1)return n;const o=n.clone(),a=(i,r)=>{const l=this.associations.get(i);l!=null&&this.associations.set(r,l);for(const[c,u]of i.children.entries())a(u,r.children[c])};return a(n,o),o.name+="_instance_"+e.uses[s]++,o}_invokeOne(e){const s=Object.values(this.plugins);s.push(this);for(let n=0;n<s.length;n++){const o=e(s[n]);if(o)return o}return null}_invokeAll(e){const s=Object.values(this.plugins);s.unshift(this);const n=[];for(let o=0;o<s.length;o++){const a=e(s[o]);a&&n.push(a)}return n}getDependency(e,s){const n=e+":"+s;let o=this.cache.get(n);if(!o){switch(e){case"scene":o=this.loadScene(s);break;case"node":o=this._invokeOne(function(a){return a.loadNode&&a.loadNode(s)});break;case"mesh":o=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(s)});break;case"accessor":o=this.loadAccessor(s);break;case"bufferView":o=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(s)});break;case"buffer":o=this.loadBuffer(s);break;case"material":o=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(s)});break;case"texture":o=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(s)});break;case"skin":o=this.loadSkin(s);break;case"animation":o=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(s)});break;case"camera":o=this.loadCamera(s);break;default:if(o=this._invokeOne(function(a){return a!=this&&a.getDependency&&a.getDependency(e,s)}),!o)throw new Error("Unknown type: "+e);break}this.cache.add(n,o)}return o}getDependencies(e){let s=this.cache.get(e);if(!s){const n=this,o=this.json[e+(e==="mesh"?"es":"s")]||[];s=Promise.all(o.map(function(a,i){return n.getDependency(e,i)})),this.cache.add(e,s)}return s}loadBuffer(e){const s=this.json.buffers[e],n=this.fileLoader;if(s.type&&s.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+s.type+" buffer type is not supported.");if(s.uri===void 0&&e===0)return Promise.resolve(this.extensions[He.KHR_BINARY_GLTF].body);const o=this.options;return new Promise(function(a,i){n.load(vn.resolveURL(s.uri,o.path),a,void 0,function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+s.uri+'".'))})})}loadBufferView(e){const s=this.json.bufferViews[e];return this.getDependency("buffer",s.buffer).then(function(n){const o=s.byteLength||0,a=s.byteOffset||0;return n.slice(a,a+o)})}loadAccessor(e){const s=this,n=this.json,o=this.json.accessors[e];if(o.bufferView===void 0&&o.sparse===void 0){const i=na[o.type],r=cn[o.componentType],l=o.normalized===!0,c=new r(o.count*i);return Promise.resolve(new wn(c,i,l))}const a=[];return o.bufferView!==void 0?a.push(this.getDependency("bufferView",o.bufferView)):a.push(null),o.sparse!==void 0&&(a.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(a).then(function(i){const r=i[0],l=na[o.type],c=cn[o.componentType],u=c.BYTES_PER_ELEMENT,d=u*l,h=o.byteOffset||0,m=o.bufferView!==void 0?n.bufferViews[o.bufferView].byteStride:void 0,g=o.normalized===!0;let E,S;if(m&&m!==d){const _=Math.floor(h/m),M="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+_+":"+o.count;let b=s.cache.get(M);b||(E=new c(r,_*m,o.count*m/u),b=new Oc(E,m/u),s.cache.add(M,b)),S=new eu(b,l,h%m/u,g)}else r===null?E=new c(o.count*l):E=new c(r,h,o.count*l),S=new wn(E,l,g);if(o.sparse!==void 0){const _=na.SCALAR,M=cn[o.sparse.indices.componentType],b=o.sparse.indices.byteOffset||0,v=o.sparse.values.byteOffset||0,L=new M(i[1],b,o.sparse.count*_),F=new c(i[2],v,o.sparse.count*l);r!==null&&(S=new wn(S.array.slice(),S.itemSize,S.normalized)),S.normalized=!1;for(let j=0,re=L.length;j<re;j++){const W=L[j];if(S.setX(W,F[j*l]),l>=2&&S.setY(W,F[j*l+1]),l>=3&&S.setZ(W,F[j*l+2]),l>=4&&S.setW(W,F[j*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}S.normalized=g}return S})}loadTexture(e){const s=this.json,n=this.options,a=s.textures[e].source,i=s.images[a];let r=this.textureLoader;if(i.uri){const l=n.manager.getHandler(i.uri);l!==null&&(r=l)}return this.loadTextureImage(e,a,r)}loadTextureImage(e,s,n){const o=this,a=this.json,i=a.textures[e],r=a.images[s],l=(r.uri||r.bufferView)+":"+i.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(s,n).then(function(u){u.flipY=!1,u.name=i.name||r.name||"",u.name===""&&typeof r.uri=="string"&&r.uri.startsWith("data:image/")===!1&&(u.name=r.uri);const h=(a.samplers||{})[i.sampler]||{};return u.magFilter=er[h.magFilter]||ua,u.minFilter=er[h.minFilter]||gr,u.wrapS=tr[h.wrapS]||Ss,u.wrapT=tr[h.wrapT]||Ss,u.generateMipmaps=!u.isCompressedTexture&&u.minFilter!==_r&&u.minFilter!==ua,o.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,s){const n=this,o=this.json,a=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());const i=o.images[e],r=self.URL||self.webkitURL;let l=i.uri||"",c=!1;if(i.bufferView!==void 0)l=n.getDependency("bufferView",i.bufferView).then(function(d){c=!0;const h=new Blob([d],{type:i.mimeType});return l=r.createObjectURL(h),l});else if(i.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(d){return new Promise(function(h,m){let g=h;s.isImageBitmapLoader===!0&&(g=function(E){const S=new ai(E);S.needsUpdate=!0,h(S)}),s.load(vn.resolveURL(d,a.path),g,void 0,m)})}).then(function(d){return c===!0&&r.revokeObjectURL(l),is(d,i),d.userData.mimeType=i.mimeType||Xp(i.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),d});return this.sourceCache[e]=u,u}assignTexture(e,s,n,o){const a=this;return this.getDependency("texture",n.index).then(function(i){if(!i)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(i=i.clone(),i.channel=n.texCoord),a.extensions[He.KHR_TEXTURE_TRANSFORM]){const r=n.extensions!==void 0?n.extensions[He.KHR_TEXTURE_TRANSFORM]:void 0;if(r){const l=a.associations.get(i);i=a.extensions[He.KHR_TEXTURE_TRANSFORM].extendTexture(i,r),a.associations.set(i,l)}}return o!==void 0&&(i.colorSpace=o),e[s]=i,i})}assignFinalMaterial(e){const s=e.geometry;let n=e.material;const o=s.attributes.tangent===void 0,a=s.attributes.color!==void 0,i=s.attributes.normal===void 0;if(e.isPoints){const r="PointsMaterial:"+n.uuid;let l=this.cache.get(r);l||(l=new Fc,jo.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(r,l)),n=l}else if(e.isLine){const r="LineBasicMaterial:"+n.uuid;let l=this.cache.get(r);l||(l=new Bc,jo.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,this.cache.add(r,l)),n=l}if(o||a||i){let r="ClonedMaterial:"+n.uuid+":";o&&(r+="derivative-tangents:"),a&&(r+="vertex-colors:"),i&&(r+="flat-shading:");let l=this.cache.get(r);l||(l=n.clone(),a&&(l.vertexColors=!0),i&&(l.flatShading=!0),o&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(r,l),this.associations.set(l,this.associations.get(n))),n=l}e.material=n}getMaterialType(){return pt}loadMaterial(e){const s=this,n=this.json,o=this.extensions,a=n.materials[e];let i;const r={},l=a.extensions||{},c=[];if(l[He.KHR_MATERIALS_UNLIT]){const d=o[He.KHR_MATERIALS_UNLIT];i=d.getMaterialType(),c.push(d.extendParams(r,a,s))}else{const d=a.pbrMetallicRoughness||{};if(r.color=new ts(1,1,1),r.opacity=1,Array.isArray(d.baseColorFactor)){const h=d.baseColorFactor;r.color.setRGB(h[0],h[1],h[2],us),r.opacity=h[3]}d.baseColorTexture!==void 0&&c.push(s.assignTexture(r,"map",d.baseColorTexture,bt)),r.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,r.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(c.push(s.assignTexture(r,"metalnessMap",d.metallicRoughnessTexture)),c.push(s.assignTexture(r,"roughnessMap",d.metallicRoughnessTexture))),i=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,r)})))}a.doubleSided===!0&&(r.side=Nt);const u=a.alphaMode||oa.OPAQUE;if(u===oa.BLEND?(r.transparent=!0,r.depthWrite=!1):(r.transparent=!1,u===oa.MASK&&(r.alphaTest=a.alphaCutoff!==void 0?a.alphaCutoff:.5)),a.normalTexture!==void 0&&i!==ht&&(c.push(s.assignTexture(r,"normalMap",a.normalTexture)),r.normalScale=new Ct(1,1),a.normalTexture.scale!==void 0)){const d=a.normalTexture.scale;r.normalScale.set(d,d)}if(a.occlusionTexture!==void 0&&i!==ht&&(c.push(s.assignTexture(r,"aoMap",a.occlusionTexture)),a.occlusionTexture.strength!==void 0&&(r.aoMapIntensity=a.occlusionTexture.strength)),a.emissiveFactor!==void 0&&i!==ht){const d=a.emissiveFactor;r.emissive=new ts().setRGB(d[0],d[1],d[2],us)}return a.emissiveTexture!==void 0&&i!==ht&&c.push(s.assignTexture(r,"emissiveMap",a.emissiveTexture,bt)),Promise.all(c).then(function(){const d=new i(r);return a.name&&(d.name=a.name),is(d,a),s.associations.set(d,{materials:e}),a.extensions&&js(o,d,a),d})}createUniqueName(e){const s=jc.sanitizeNodeName(e||"");return s in this.nodeNamesUsed?s+"_"+ ++this.nodeNamesUsed[s]:(this.nodeNamesUsed[s]=0,s)}loadGeometries(e){const s=this,n=this.extensions,o=this.primitiveCache;function a(r){return n[He.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(r,s).then(function(l){return sr(l,r,s)})}const i=[];for(let r=0,l=e.length;r<l;r++){const c=e[r],u=qp(c),d=o[u];if(d)i.push(d.promise);else{let h;c.extensions&&c.extensions[He.KHR_DRACO_MESH_COMPRESSION]?h=a(c):h=sr(new yr,c,s),o[u]={primitive:c,promise:h},i.push(h)}}return Promise.all(i)}loadMesh(e){const s=this,n=this.json,o=this.extensions,a=n.meshes[e],i=a.primitives,r=[];for(let l=0,c=i.length;l<c;l++){const u=i[l].material===void 0?Vp(this.cache):this.getDependency("material",i[l].material);r.push(u)}return r.push(s.loadGeometries(i)),Promise.all(r).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],d=[];for(let m=0,g=u.length;m<g;m++){const E=u[m],S=i[m];let _;const M=c[m];if(S.mode===jt.TRIANGLES||S.mode===jt.TRIANGLE_STRIP||S.mode===jt.TRIANGLE_FAN||S.mode===void 0)_=a.isSkinnedMesh===!0?new zc(E,M):new et(E,M),_.isSkinnedMesh===!0&&_.normalizeSkinWeights(),S.mode===jt.TRIANGLE_STRIP?_.geometry=Zi(_.geometry,fr):S.mode===jt.TRIANGLE_FAN&&(_.geometry=Zi(_.geometry,ca));else if(S.mode===jt.LINES)_=new Vc(E,M);else if(S.mode===jt.LINE_STRIP)_=new Wc(E,M);else if(S.mode===jt.LINE_LOOP)_=new Kc(E,M);else if(S.mode===jt.POINTS)_=new qc(E,M);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+S.mode);Object.keys(_.geometry.morphAttributes).length>0&&Kp(_,a),_.name=s.createUniqueName(a.name||"mesh_"+e),is(_,a),S.extensions&&js(o,_,S),s.assignFinalMaterial(_),d.push(_)}for(let m=0,g=d.length;m<g;m++)s.associations.set(d[m],{meshes:e,primitives:m});if(d.length===1)return a.extensions&&js(o,d[0],a),d[0];const h=new Jt;a.extensions&&js(o,h,a),s.associations.set(h,{meshes:e});for(let m=0,g=d.length;m<g;m++)h.add(d[m]);return h})}loadCamera(e){let s;const n=this.json.cameras[e],o=n[n.type];if(!o){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?s=new Hn(vr.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):n.type==="orthographic"&&(s=new Xc(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),n.name&&(s.name=this.createUniqueName(n.name)),is(s,n),Promise.resolve(s)}loadSkin(e){const s=this.json.skins[e],n=[];for(let o=0,a=s.joints.length;o<a;o++)n.push(this._loadNodeShallow(s.joints[o]));return s.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",s.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(o){const a=o.pop(),i=o,r=[],l=[];for(let c=0,u=i.length;c<u;c++){const d=i[c];if(d){r.push(d);const h=new Ks;a!==null&&h.fromArray(a.array,c*16),l.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[c])}return new Yc(r,l)})}loadAnimation(e){const s=this.json,n=this,o=s.animations[e],a=o.name?o.name:"animation_"+e,i=[],r=[],l=[],c=[],u=[];for(let d=0,h=o.channels.length;d<h;d++){const m=o.channels[d],g=o.samplers[m.sampler],E=m.target,S=E.node,_=o.parameters!==void 0?o.parameters[g.input]:g.input,M=o.parameters!==void 0?o.parameters[g.output]:g.output;E.node!==void 0&&(i.push(this.getDependency("node",S)),r.push(this.getDependency("accessor",_)),l.push(this.getDependency("accessor",M)),c.push(g),u.push(E))}return Promise.all([Promise.all(i),Promise.all(r),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(d){const h=d[0],m=d[1],g=d[2],E=d[3],S=d[4],_=[];for(let b=0,v=h.length;b<v;b++){const L=h[b],F=m[b],j=g[b],re=E[b],W=S[b];if(L===void 0)continue;L.updateMatrix&&L.updateMatrix();const q=n._createAnimationTracks(L,F,j,re,W);if(q)for(let se=0;se<q.length;se++)_.push(q[se])}const M=new Jc(a,void 0,_);return is(M,o),M})}createNodeMesh(e){const s=this.json,n=this,o=s.nodes[e];return o.mesh===void 0?null:n.getDependency("mesh",o.mesh).then(function(a){const i=n._getNodeRef(n.meshCache,o.mesh,a);return o.weights!==void 0&&i.traverse(function(r){if(r.isMesh)for(let l=0,c=o.weights.length;l<c;l++)r.morphTargetInfluences[l]=o.weights[l]}),i})}loadNode(e){const s=this.json,n=this,o=s.nodes[e],a=n._loadNodeShallow(e),i=[],r=o.children||[];for(let c=0,u=r.length;c<u;c++)i.push(n.getDependency("node",r[c]));const l=o.skin===void 0?Promise.resolve(null):n.getDependency("skin",o.skin);return Promise.all([a,Promise.all(i),l]).then(function(c){const u=c[0],d=c[1],h=c[2];h!==null&&u.traverse(function(m){m.isSkinnedMesh&&m.bind(h,Yp)});for(let m=0,g=d.length;m<g;m++)u.add(d[m]);return u})}_loadNodeShallow(e){const s=this.json,n=this.extensions,o=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const a=s.nodes[e],i=a.name?o.createUniqueName(a.name):"",r=[],l=o._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&r.push(l),a.camera!==void 0&&r.push(o.getDependency("camera",a.camera).then(function(c){return o._getNodeRef(o.cameraCache,a.camera,c)})),o._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){r.push(c)}),this.nodeCache[e]=Promise.all(r).then(function(c){let u;if(a.isBone===!0?u=new Zc:c.length>1?u=new Jt:c.length===1?u=c[0]:u=new mr,u!==c[0])for(let d=0,h=c.length;d<h;d++)u.add(c[d]);if(a.name&&(u.userData.name=a.name,u.name=i),is(u,a),a.extensions&&js(n,u,a),a.matrix!==void 0){const d=new Ks;d.fromArray(a.matrix),u.applyMatrix4(d)}else a.translation!==void 0&&u.position.fromArray(a.translation),a.rotation!==void 0&&u.quaternion.fromArray(a.rotation),a.scale!==void 0&&u.scale.fromArray(a.scale);if(!o.associations.has(u))o.associations.set(u,{});else if(a.mesh!==void 0&&o.meshCache.refs[a.mesh]>1){const d=o.associations.get(u);o.associations.set(u,{...d})}return o.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const s=this.extensions,n=this.json.scenes[e],o=this,a=new Jt;n.name&&(a.name=o.createUniqueName(n.name)),is(a,n),n.extensions&&js(s,a,n);const i=n.nodes||[],r=[];for(let l=0,c=i.length;l<c;l++)r.push(o.getDependency("node",i[l]));return Promise.all(r).then(function(l){for(let u=0,d=l.length;u<d;u++)a.add(l[u]);const c=u=>{const d=new Map;for(const[h,m]of o.associations)(h instanceof jo||h instanceof ai)&&d.set(h,m);return u.traverse(h=>{const m=o.associations.get(h);m!=null&&d.set(h,m)}),d};return o.associations=c(a),a})}_createAnimationTracks(e,s,n,o,a){const i=[],r=e.name?e.name:e.uuid,l=[];xs[a.path]===xs.weights?e.traverse(function(h){h.morphTargetInfluences&&l.push(h.name?h.name:h.uuid)}):l.push(r);let c;switch(xs[a.path]){case xs.weights:c=ri;break;case xs.rotation:c=li;break;case xs.translation:case xs.scale:c=ii;break;default:switch(n.itemSize){case 1:c=ri;break;case 2:case 3:default:c=ii;break}break}const u=o.interpolation!==void 0?zp[o.interpolation]:wr,d=this._getArrayFromAccessor(n);for(let h=0,m=l.length;h<m;h++){const g=new c(l[h]+"."+xs[a.path],s.array,d,u);o.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(g),i.push(g)}return i}_getArrayFromAccessor(e){let s=e.array;if(e.normalized){const n=Ra(s.constructor),o=new Float32Array(s.length);for(let a=0,i=s.length;a<i;a++)o[a]=s[a]*n;s=o}return s}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const o=this instanceof li?jp:Vl;return new o(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Zp(t,e,s){const n=e.attributes,o=new xt;if(n.POSITION!==void 0){const r=s.json.accessors[n.POSITION],l=r.min,c=r.max;if(l!==void 0&&c!==void 0){if(o.set(new ke(l[0],l[1],l[2]),new ke(c[0],c[1],c[2])),r.normalized){const u=Ra(cn[r.componentType]);o.min.multiplyScalar(u),o.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const a=e.targets;if(a!==void 0){const r=new ke,l=new ke;for(let c=0,u=a.length;c<u;c++){const d=a[c];if(d.POSITION!==void 0){const h=s.json.accessors[d.POSITION],m=h.min,g=h.max;if(m!==void 0&&g!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),h.normalized){const E=Ra(cn[h.componentType]);l.multiplyScalar(E)}r.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(r)}t.boundingBox=o;const i=new nu;o.getCenter(i.center),i.radius=o.min.distanceTo(o.max)/2,t.boundingSphere=i}function sr(t,e,s){const n=e.attributes,o=[];function a(i,r){return s.getDependency("accessor",i).then(function(l){t.setAttribute(r,l)})}for(const i in n){const r=Aa[i]||i.toLowerCase();r in t.attributes||o.push(a(n[i],r))}if(e.indices!==void 0&&!t.index){const i=s.getDependency("accessor",e.indices).then(function(r){t.setIndex(r)});o.push(i)}return da.workingColorSpace!==us&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${da.workingColorSpace}" not supported.`),is(t,e),Zp(t,e,s),Promise.all(o).then(function(){return e.targets!==void 0?Wp(t,e.targets,s):t})}const ia=new WeakMap;class Ho extends pr{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,s,n,o){const a=new ao(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,i=>{this.parse(i,s,o)},n,o)}parse(e,s,n=()=>{}){this.decodeDracoFile(e,s,null,null,bt,n).catch(n)}decodeDracoFile(e,s,n,o,a=us,i=()=>{}){const r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:a};return this.decodeGeometry(e,r).then(s).catch(i)}decodeGeometry(e,s){const n=JSON.stringify(s);if(ia.has(e)){const l=ia.get(e);if(l.key===n)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let o;const a=this.workerNextTaskID++,i=e.byteLength,r=this._getWorker(a,i).then(l=>(o=l,new Promise((c,u)=>{o._callbacks[a]={resolve:c,reject:u},o.postMessage({type:"decode",id:a,taskConfig:s,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return r.catch(()=>!0).then(()=>{o&&a&&this._releaseTask(o,a)}),ia.set(e,{key:n,promise:r}),r}_createGeometry(e){const s=new yr;e.index&&s.setIndex(new wn(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const o=e.attributes[n],a=o.name,i=o.array,r=o.itemSize,l=new wn(i,r);a==="color"&&(this._assignVertexColorSpace(l,o.vertexColorSpace),l.normalized=!(i instanceof Float32Array)),s.setAttribute(a,l)}return s}_assignVertexColorSpace(e,s){if(s!==bt)return;const n=new ts;for(let o=0,a=e.count;o<a;o++)n.fromBufferAttribute(e,o),da.colorSpaceToWorking(n,bt),e.setXYZ(o,n.r,n.g,n.b)}_loadLibrary(e,s){const n=new ao(this.manager);return n.setPath(this.decoderPath),n.setResponseType(s),n.setWithCredentials(this.withCredentials),new Promise((o,a)=>{n.load(e,o,void 0,a)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",s=[];return e?s.push(this._loadLibrary("draco_decoder.js","text")):(s.push(this._loadLibrary("draco_wasm_wrapper.js","text")),s.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(s).then(n=>{const o=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const a=Qp.toString(),i=["/* draco decoder */",o,"","/* worker */",a.substring(a.indexOf("{")+1,a.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([i]))}),this.decoderPending}_getWorker(e,s){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const o=new Worker(this.workerSourceURL);o._callbacks={},o._taskCosts={},o._taskLoad=0,o.postMessage({type:"init",decoderConfig:this.decoderConfig}),o.onmessage=function(a){const i=a.data;switch(i.type){case"decode":o._callbacks[i.id].resolve(i);break;case"error":o._callbacks[i.id].reject(i);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+i.type+'"')}},this.workerPool.push(o)}else this.workerPool.sort(function(o,a){return o._taskLoad>a._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=s,n._taskLoad+=s,n})}_releaseTask(e,s){e._taskLoad-=e._taskCosts[s],delete e._callbacks[s],delete e._taskCosts[s]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function Qp(){let t,e;onmessage=function(i){const r=i.data;switch(r.type){case"init":t=r.decoderConfig,e=new Promise(function(u){t.onModuleLoaded=function(d){u({draco:d})},DracoDecoderModule(t)});break;case"decode":const l=r.buffer,c=r.taskConfig;e.then(u=>{const d=u.draco,h=new d.Decoder;try{const m=s(d,h,new Int8Array(l),c),g=m.attributes.map(E=>E.array.buffer);m.index&&g.push(m.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:m},g)}catch(m){console.error(m),self.postMessage({type:"error",id:r.id,error:m.message})}finally{d.destroy(h)}});break}};function s(i,r,l,c){const u=c.attributeIDs,d=c.attributeTypes;let h,m;const g=r.GetEncodedGeometryType(l);if(g===i.TRIANGULAR_MESH)h=new i.Mesh,m=r.DecodeArrayToMesh(l,l.byteLength,h);else if(g===i.POINT_CLOUD)h=new i.PointCloud,m=r.DecodeArrayToPointCloud(l,l.byteLength,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const E={index:null,attributes:[]};for(const S in u){const _=self[d[S]];let M,b;if(c.useUniqueIDs)b=u[S],M=r.GetAttributeByUniqueId(h,b);else{if(b=r.GetAttributeId(h,i[u[S]]),b===-1)continue;M=r.GetAttribute(h,b)}const v=o(i,r,h,S,_,M);S==="color"&&(v.vertexColorSpace=c.vertexColorSpace),E.attributes.push(v)}return g===i.TRIANGULAR_MESH&&(E.index=n(i,r,h)),i.destroy(h),E}function n(i,r,l){const u=l.num_faces()*3,d=u*4,h=i._malloc(d);r.GetTrianglesUInt32Array(l,d,h);const m=new Uint32Array(i.HEAPF32.buffer,h,u).slice();return i._free(h),{array:m,itemSize:1}}function o(i,r,l,c,u,d){const h=d.num_components(),g=l.num_points()*h,E=g*u.BYTES_PER_ELEMENT,S=a(i,u),_=i._malloc(E);r.GetAttributeDataArrayForAllPoints(l,d,S,E,_);const M=new u(i.HEAPF32.buffer,_,g).slice();return i._free(_),{name:c,array:M,itemSize:h}}function a(i,r){switch(r){case Float32Array:return i.DT_FLOAT32;case Int8Array:return i.DT_INT8;case Int16Array:return i.DT_INT16;case Int32Array:return i.DT_INT32;case Uint8Array:return i.DT_UINT8;case Uint16Array:return i.DT_UINT16;case Uint32Array:return i.DT_UINT32}}}class eh{constructor(){this.gltfCache=new Map,this.modelPool=new Map,this.instancedMeshes=new Map,this.gltfLoader=null,this.dracoLoader=null,this.maxCacheSize=50,this.maxInstancesPerModel=1e3,this.preloadStatus=new Map,this.preloadQueue=[],this.initLoaders()}initLoaders(){this.gltfLoader||(this.gltfLoader=new Go,this.gltfLoader.setCrossOrigin("anonymous"),this.dracoLoader=new Ho,this.dracoLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),this.dracoLoader.setCrossOrigin("anonymous"),this.gltfLoader.setDRACOLoader(this.dracoLoader),f("[ModelCache] GLTFDraco"))}async loadModel(e,s=!0){if(s&&this.modelPool.has(e)){const a=this.modelPool.get(e);return f(`[ModelCache] : ${e}`),a.clone(!0)}let n;if(this.gltfCache.has(e))f(`[ModelCache] GLTF: ${e}`),n=this.gltfCache.get(e);else try{const i=await(await Hl(e)).arrayBuffer();f(`[ModelCache] GLTF: ${e}`),n=await new Promise((r,l)=>{this.gltfLoader.parse(i,"",c=>r(c),c=>l(c))}),this.cacheGLTF(e,n)}catch(a){throw f(`[ModelCache] : ${e}`,a),a}const o=n.scene.clone(!0);return s&&this.addToModelPool(e,o),o}async createInstancedMesh(e,s=100){if(this.instancedMeshes.has(e))return f(`[ModelCache] : ${e}`),this.instancedMeshes.get(e);const n=await this.loadModel(e,!0),o=[];if(n.traverse(l=>{l.isMesh&&o.push(l)}),o.length===0)throw new Error(`[ModelCache] : ${e}`);const a=o[0],i=new hr(a.geometry,a.material,s),r=new Ks;for(let l=0;l<s;l++)r.setPosition(0,-1e3,0),i.setMatrixAt(l,r);return i.instanceMatrix.needsUpdate=!0,this.instancedMeshes.set(e,i),f(`[ModelCache] : ${e}, : ${s}`),i}updateInstancedMeshInstance(e,s,n,o,a){const i=this.instancedMeshes.get(e);if(!i){f(`[ModelCache] : ${e}`);return}if(s>=i.count){f(`[ModelCache] : ${s}/${i.count}`);return}const r=new Ks;r.compose(n,new un().setFromEuler(o),a),i.setMatrixAt(s,r),i.instanceMatrix.needsUpdate=!0}hideInstancedMeshInstance(e,s){const n=this.instancedMeshes.get(e);if(!n)return;const o=new Ks;o.setPosition(0,-1e3,0),n.setMatrixAt(s,o),n.instanceMatrix.needsUpdate=!0}cacheGLTF(e,s){if(this.gltfCache.size>=this.maxCacheSize){const n=this.gltfCache.keys().next().value;this.gltfCache.delete(n),f(`[ModelCache] GLTF: ${n}`)}this.gltfCache.set(e,s),f(`[ModelCache] GLTF: ${e}`)}addToModelPool(e,s){if(this.modelPool.size>=this.maxCacheSize){const n=this.modelPool.keys().next().value,o=this.modelPool.get(n);this.disposeModel(o),this.modelPool.delete(n),f(`[ModelCache] : ${n}`)}this.modelPool.set(e,s),f(`[ModelCache] : ${e}`)}async preloadModels(e,s=null){f(`[ModelCache]  ${e.length} `);const n=e.length;let o=0;const a=e.filter(r=>{const l=this.preloadStatus.get(r);return!l||l==="failed"});f(`[ModelCache]  ${a.length} `);const i=3;for(let r=0;r<a.length;r+=i){const c=a.slice(r,r+i).map(async u=>{try{this.preloadStatus.set(u,"loading"),await this.loadModel(u,!0),this.preloadStatus.set(u,"loaded"),o++,s&&s(o,n,Math.round(o/n*100)),f(`[ModelCache] : ${u} (${o}/${n})`)}catch(d){f(`[ModelCache] : ${u}`,d),this.preloadStatus.set(u,"failed"),o++,s&&s(o,n,Math.round(o/n*100))}});await Promise.all(c),r+i<a.length&&await new Promise(u=>setTimeout(u,100))}f(`[ModelCache] : ${o}/${n} `)}isPreloaded(e){return this.preloadStatus.get(e)==="loaded"}getPreloadStatus(){const e={total:this.preloadStatus.size,loaded:0,loading:0,failed:0};for(const s of this.preloadStatus.values())e[s]++;return e}disposeModel(e){e&&e.traverse(s=>{s.isMesh&&(s.geometry&&s.geometry.dispose(),s.material&&(Array.isArray(s.material)?s.material.forEach(n=>{n.map&&n.map.dispose(),n.dispose&&n.dispose()}):(s.material.map&&s.material.map.dispose(),s.material.dispose&&s.material.dispose())))})}clearCache(){f("[ModelCache] ..."),this.modelPool.forEach(e=>{this.disposeModel(e)}),this.modelPool.clear(),this.instancedMeshes.forEach(e=>{this.disposeModel(e)}),this.instancedMeshes.clear(),this.gltfCache.clear(),this.preloadStatus.clear(),f("[ModelCache] ")}getCacheStatus(){return{gltfCacheSize:this.gltfCache.size,modelPoolSize:this.modelPool.size,instancedMeshesSize:this.instancedMeshes.size,preloadStatus:this.getPreloadStatus(),maxCacheSize:this.maxCacheSize,maxInstancesPerModel:this.maxInstancesPerModel,gltfLoaderInitialized:!!this.gltfLoader,dracoLoaderInitialized:!!this.dracoLoader}}updateConfig(e){e.maxCacheSize!==void 0&&(this.maxCacheSize=Math.max(10,e.maxCacheSize)),e.maxInstancesPerModel!==void 0&&(this.maxInstancesPerModel=Math.max(10,e.maxInstancesPerModel)),f("[ModelCache] :",this.getCacheStatus())}}const Ut=new eh,th={class:"model-wrapper"},sh={key:0,class:"model-loading"},nh={__name:"PuppetModelView",props:{puppet:{type:Object,default:null}},setup(t){const e=t,s=V(null),n=V(!1);let o=null,a=null,i=null,r=0,l=null,c=null,u=new au,d=null,h=null,m=0,g=!1;window.__GLTF_MEMORY_CACHE__||(window.__GLTF_MEMORY_CACHE__=new Map,f("[PuppetModelView] Initialized global GLTF memory cache"));function E(){if(g)return;const b=s.value;if(!b){f("[PuppetModelView] Container not ready for Three.js initialization");return}f("[PuppetModelView] Initializing Three.js..."),a=new wo,i=new Hn(45,1,.1,1e3),i.position.set(0,1,3),o=new bo({antialias:!0,alpha:!0}),o.setPixelRatio(window.devicePixelRatio||1),o.outputColorSpace=bt,h=new Ho,h.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),h.setCrossOrigin("anonymous"),f("[PuppetModelView] Draco loader initialized:",!!h),b.innerHTML="",b.appendChild(o.domElement);const v=new So(16777215,1.2),L=new cs(16777215,1.5);L.position.set(3,5,2);const F=new cs(16777215,.8);F.position.set(-2,3,4);const j=new Qs(16777215,1,10);j.position.set(0,2,3),a.add(v,L,F,j);const re=()=>{if(!b||!o)return;let q=b.clientWidth,se=b.clientHeight;if(!q||!se){const A=b.getBoundingClientRect();if(q=A.width||200,se=A.height||200,!A.width||!A.height){requestAnimationFrame(re);return}}o.setSize(q,se,!0),i.aspect=q/Math.max(1,se),i.updateProjectionMatrix()};re(),d=new ResizeObserver(re),d.observe(b),requestAnimationFrame(()=>{re(),requestAnimationFrame(()=>{re(),requestAnimationFrame(re)})});const W=()=>{if(!o||!a||!i)return;r=requestAnimationFrame(W);const q=u.getDelta();c&&c.update(q),l&&(l.rotation.y+=q*.6),o.render(a,i)};W(),g=!0,f("[PuppetModelView] Three.js initialized successfully, container size:",b.clientWidth,"x",b.clientHeight)}function S(){c&&(c.stopAllAction(),c=null),l&&(a.remove(l),l.traverse(b=>{b.isMesh&&(b.geometry&&b.geometry.dispose(),Array.isArray(b.material)?b.material.forEach(v=>{v.map&&v.map.dispose(),v&&v.dispose&&v.dispose()}):b.material&&(b.material.map&&b.material.map.dispose(),b.material.dispose&&b.material.dispose()))}),l=null)}function _(b){const v=new xt().setFromObject(b),L=new ke,F=new ke;v.getSize(L),v.getCenter(F),b.position.sub(F),b.position.add(new ke(0,0,0)),b.scale.multiplyScalar(.8);const re=o==null?void 0:o.domElement,W=re?re.clientWidth||re.width:200,q=re?re.clientHeight||re.height:200,se=Math.max(1e-6,W/Math.max(1,q)),A=i.fov*(Math.PI/180),ne=2*Math.atan(Math.tan(A/2)*se),Ie=1.05,Se=L.y/2/Math.tan(A/2),we=L.x/2/Math.tan(ne/2),J=Ie*Math.max(Se,we,.1);i.position.set(0,0,J),i.lookAt(0,0,0)}async function M(b){var F;if(!b)return;f("[PuppetModelView] Loading puppet:",b.name),n.value=!0,E(),S();const v=++m;f("[PuppetModelView] ");let L=b.modelUrl||"";if(f("[PuppetModelView] Original modelUrl:",L),f("[PuppetModelView] Puppet image:",b.image),f("[PuppetModelView] Puppet name:",b.name),f("[PuppetModelView] Puppet data:",b),!L||L.trim()===""){f("[PuppetModelView] No model URL found");return}f("[PuppetModelView] Final Model URL:",L);try{f("[PuppetModelView] Starting to load:",L),f("[PuppetModelView] Cache status:",Ut.getCacheStatus());const j=await Ut.loadModel(L);if(f("[PuppetModelView] Model loaded from cache manager:",j),v!==m){f("[PuppetModelView] Ignoring outdated load result for:",b.name),gltf&&gltf.scene&&gltf.scene.traverse(re=>{re.isMesh&&(re.geometry&&re.geometry.dispose(),Array.isArray(re.material)?re.material.forEach(W=>{W.map&&W.map.dispose(),W.dispose&&W.dispose()}):re.material&&(re.material.map&&re.material.map.dispose(),re.material.dispose&&re.material.dispose()))});return}if(f("[PuppetModelView] Applying model for:",b.name),!a){f("[PuppetModelView] Scene not ready, initializing..."),E();let re=0;for(;!a&&re<40;)await new Promise(W=>setTimeout(W,50)),re++;if(!a){f("[PuppetModelView] Scene initialization timeout");return}}if(l=j,!l){f("[PuppetModelView] No model instance received");return}a.add(l),_(l),f("[PuppetModelView] Model loaded successfully:",b.name,"Scene children:",a.children.length),n.value=!1}catch(j){if(f("[PuppetModelView] Load failed:",j),f("[PuppetModelView] Failed URL:",L),f("[PuppetModelView] Puppet data:",b),typeof(j==null?void 0:j.message)=="string"&&j.message.includes("DRACOLoader")){f("[PuppetModelView] Retrying without Draco decoder...");try{const re=new Go;re.setCrossOrigin("anonymous");const W=await re.loadAsync(L);if(v===m&&(l=W.scene||((F=W.scenes)==null?void 0:F[0]),l)){a.add(l),W.animations&&W.animations.length&&(c=new ou(l),c.clipAction(W.animations[0]).play()),_(l),f("[PuppetModelView] Model loaded successfully without Draco:",b.name);return}}catch(re){f("[PuppetModelView] Fallback load also failed:",re)}}if(v===m){const re=new rs(1,1,1),W=new pt({color:8947967});l=new et(re,W),a.add(l),_(l)}n.value=!1}}return Gt(()=>e.puppet,async b=>{await Ln(),M(b)},{immediate:!1}),$t(()=>{f("[PuppetModelView] Component mounted"),Ln(()=>{s.value&&(E(),e.puppet&&setTimeout(()=>{M(e.puppet)},0))})}),fs(()=>{if(f("[PuppetModelView] Cleaning up..."),cancelAnimationFrame(r),S(),d&&s.value)try{d.unobserve(s.value)}catch{}const b=a,v=o;o=null,a=null,i=null,g=!1,m=0;const L=()=>{if(f("[PuppetModelView] Starting deferred cleanup..."),b&&b.traverse(F=>{if(F.isMesh)try{if(F.geometry&&F.geometry.dispose(),Array.isArray(F.material))F.material.forEach(j=>{try{j.map&&j.map.dispose(),j.dispose&&j.dispose()}catch{}});else if(F.material)try{F.material.map&&F.material.map.dispose(),F.material.dispose&&F.material.dispose()}catch{}}catch{}}),v)try{v.dispose(),v.forceContextLoss&&v.forceContextLoss()}catch{}f("[PuppetModelView] Deferred cleanup completed")};typeof window<"u"&&window.requestIdleCallback?window.requestIdleCallback(L,{timeout:1e3}):setTimeout(L,100),f("[PuppetModelView] Quick cleanup completed, heavy cleanup deferred")}),(b,v)=>(I(),H("div",th,[p("div",{ref_key:"mountEl",ref:s,class:"model-canvas"},null,512),n.value?(I(),H("div",sh,[...v[0]||(v[0]=[p("div",{class:"loading-spinner"},null,-1)])])):ve("",!0)]))}},oh=mt(nh,[["__scopeId","data-v-0e860b93"]]),ah={class:"warehouse"},ih={class:"warehouse__resources"},rh={class:"resource-icon"},lh=["src","alt"],ch={class:"resource-value"},uh={class:"resource-tooltip"},dh={key:0,class:"warehouse__main"},fh={class:"warehouse__sidebar"},ph={class:"puppet-list"},hh=["onClick","onMouseenter"],mh={class:"puppet-card__quantity"},gh={class:"puppet-card__image"},_h=["src","alt"],yh={class:"puppet-card__info"},vh={class:"puppet-card__name"},wh={class:"puppet-card__level"},bh={class:"puppet-detail__header"},Sh={class:"puppet-detail__name"},Mh={class:"puppet-detail__content"},Th={class:"puppet-detail__row"},Ch={class:"puppet-detail__model"},Eh={class:"puppet-detail__description"},xh={class:"puppet-detail__row"},kh={class:"puppet-detail__stats"},Ah={class:"stats-section"},Rh={class:"stat-item"},$h={class:"stat-value"},Ph={class:"stat-item"},Lh={class:"stat-value"},Ih={class:"stat-item"},Oh={class:"stat-value"},Dh={class:"stat-item"},Nh={class:"stat-value"},Gh={class:"stat-item"},Hh={class:"stat-value"},Uh={class:"stat-item"},Fh={class:"stat-value"},Bh={class:"stat-item"},jh={class:"stat-value"},zh={class:"equipment-section"},Vh={class:"equipment-slots"},Wh=["src","alt"],Kh=["src"],qh=["src"],Xh={key:3,class:"equipment-icon"},Yh={key:0,class:"skill-section"},Jh={class:"skill-info"},Zh={class:"skill-text"},Qh={class:"skill-name"},em={class:"skill-cooldown"},tm={class:"skill-effect"},sm={class:"skill-icon"},nm=["src","alt"],om={key:1},am={class:"puppet-detail__upgrade"},im={class:"upgrade-cost"},rm=["src"],lm={class:"cost-amount"},cm=["disabled"],um=["src"],dm={class:"warehouse__placeholder",key:"placeholder"},fm=["src"],pm={__name:"Warehouse",props:{musicOn:{type:Boolean,default:!0}},setup(t,{expose:e}){Xt(J=>({v9925b07e:Ie,bf2e7e24:ne,bf31385e:q,bf304fa0:se,bf2f66e2:A}));const s=t,n=["SpiritalSpark","RecallGear","ResonantCrystal","RefinedCopper","HeartCrystalDust"];function o(J){return n.map($=>({icon:Zt[$].icon,name:Zt[$].name,value:Number((J==null?void 0:J[$])??0)}))}const a={IronWall:"",Arcanist:"",CraftsMan:"",Mechanic:"",Resonator:""};function i(J){const $=Number(J??1);return $===1?5:$===2?10:$===3?20:$===4?30:0}function r(J){return(J||[]).map(($,de)=>{var B,D,G,ie,Y,U;const z=($==null?void 0:$.copper_info)||{},O=(z==null?void 0:z.skill)||{},X=($==null?void 0:$.equipment_slot)||{},oe=(X==null?void 0:X.slot1)||null,Pe=(X==null?void 0:X.slot2)||null,Fe=($==null?void 0:$.attribute)||{},Ue=((B=oe==null?void 0:oe.equipment_base)==null?void 0:B.attribute)||{},Ne=((D=Pe==null?void 0:Pe.equipment_base)==null?void 0:D.attribute)||{},Qe=Number(Ue.attack||0)+Number(Ne.attack||0),at=Number(Ue.defense||0)+Number(Ne.defense||0),st=Number(Ue.dodge||0)+Number(Ne.dodge||0),Pt=$==null?void 0:$.copper_type,w=($==null?void 0:$.level)??1,T=(z==null?void 0:z.model_url)||"",x=T?N(T):"";return{id:Number(($==null?void 0:$.id)??de+1),name:(z==null?void 0:z.name)??"",level:w,suffix:($==null?void 0:$.suffix)??0,image:N((z==null?void 0:z.icon_url)||""),modelUrl:x,quantity:1,description:(z==null?void 0:z.description)||"",stats:{level:`${w}/5`,health:Number(Fe.health||0),live_left:Number(($==null?void 0:$.live_left)??0),attack:{base:Number(Fe.attack||0),bonus:Qe},defense:{base:Number(Fe.defense||0),bonus:at},dodge:{base:Number(Fe.dodge||0),bonus:st},class:a[Pt]||""},equipment:[oe?{name:((G=oe.equipment_base)==null?void 0:G.name)||"",icon:N(((ie=oe.equipment_base)==null?void 0:ie.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1},X!=null&&X.is_slot2_locked?{name:"",icon:"",equipped:!1,locked:!0}:Pe?{name:((Y=Pe.equipment_base)==null?void 0:Y.name)||"",icon:N(((U=Pe.equipment_base)==null?void 0:U.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1}],skill:{name:(O==null?void 0:O.name)||"",cooldown:(O==null?void 0:O.cool_down)!=null?`${O.cool_down}`:"",effect:(O==null?void 0:O.description)||"",icon:N((O==null?void 0:O.resource_url)||"")},upgradeCost:i(w)}})}function l(J,$,de=[]){if(!J||typeof J!="object")return null;if(Object.prototype.hasOwnProperty.call(J,$))return[...de,$];if(Array.isArray(J)){for(let z=0;z<J.length;z++){const O=l(J[z],$,[...de,z]);if(O)return O}return null}for(const z of Object.keys(J)){const O=l(J[z],$,[...de,z]);if(O)return O}return null}function c(J,$){return $.reduce((de,z)=>de!=null?de[z]:void 0,J)}const u=V([]);async function d(){try{const J=await No();J&&(u.value=o(J))}catch(J){console.error("[Warehouse] :",J),u.value=o({})}}$t(()=>{d(),Do(Ot.UPDATE_RESOURCES,d)});function h(J){let $=J;if(typeof J=="string")try{$=JSON.parse(J)}catch{}$&&$.type_msg&&($.type_msg==="upgrade_cost_error"?alert($.content||""):f("[GlobalInfo]",$))}$t(()=>{try{jl(h)}catch{}s.musicOn&&Se.value&&setTimeout(()=>{if(Se.value.readyState>=2)Se.value.play().then(()=>{f("[Warehouse] ")}).catch($=>{f("[Warehouse] :",$)});else{const $=()=>{Se.value.play().then(()=>{f("[Warehouse] ")}).catch(de=>{f("[Warehouse] :",de)}),Se.value.removeEventListener("canplay",$)};Se.value.addEventListener("canplay",$,{once:!0})}},200)}),Gt(()=>s.musicOn,J=>{if(Se.value)if(J)if(Se.value.readyState>=2)Se.value.play().catch($=>{f("[Warehouse] :",$)});else{const $=()=>{Se.value.play().catch(de=>{f("[Warehouse] :",de)}),Se.value.removeEventListener("canplay",$)};Se.value.addEventListener("canplay",$)}else Se.value.pause()}),fs(()=>{Se.value&&Se.value.pause(),Za(Ot.UPDATE_RESOURCES,d)});const m=V([]);$t(async()=>{try{const J=await oo();let $=J&&Array.isArray(J.coppers)?J.coppers:[];if(!Array.isArray($)){const de=l(J,"coppers");if(f("[Warehouse] copper key path:",de),de){const z=c(J,de);f("[Warehouse] copper found by path:",z),Array.isArray(z)&&($=z)}!Array.isArray($)&&J&&J.entries&&f("[Warehouse] copper entries sample:",J.entries)}Array.isArray($)||f("[Warehouse] copper list not array"),m.value=r($),Array.isArray(m.value)&&m.value.length>0&&(g.value=m.value[0]),!g.value&&Array.isArray(m.value)&&m.value.length>0&&(g.value=m.value[0])}catch{m.value=[]}});const g=V(null),E=V([]),S=V(null),_=V(null),M=V(null);function b(J,$){J&&(E.value[$]=J)}async function v(J,$){g.value=J,await Ln();const de=E.value[$];if(de&&typeof de.scrollIntoView=="function"&&de.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}),S.value=$,_.value)try{_.value.scrollTo({top:0,behavior:"smooth"})}catch{_.value.scrollTop=0}setTimeout(()=>{S.value===$&&(S.value=null)},320)}const L=V(!1);function F(){L.value=!0}function j(){return L.value?(L.value=!1,!0):!1}e({handleBack:j});async function re(J){try{await d();const $=await oo(),de=Array.isArray($==null?void 0:$.coppers)?$.coppers:[];m.value=r(de)}catch{}}async function W(){if(!g.value)return;if(Number(g.value.level||0)>=5){alert("");return}const J=g.value.id,$=await tp(J);if(!$||$.type!=="success"){alert($&&$.content?$.content:"");return}try{await d();const de=await oo(),z=Array.isArray(de==null?void 0:de.coppers)?de.coppers:[];m.value=r(z);const O=m.value.find(X=>X.id===J);O&&(g.value=O)}catch{}}const q=`url('${N("@assets/ui/panel2.png")}')`,se=`url('${N("@assets/ui/panel3.png")}')`,A=`url('${N("@assets/ui/panel4.png")}')`,ne=`url('${N("@assets/ui/panel5.png")}')`,Ie=`url('${N("@assets/frontend_resource/Gemini_Generated_Image_e03q5oe03q5oe03q.png")}')`,Se=V(null),we=N("assets/warehouse.mp3");return(J,$)=>(I(),H("div",ah,[p("div",ih,[(I(!0),H(Xe,null,qt(u.value,de=>(I(),H("div",{class:"resource-item",key:de.name},[p("div",rh,[p("img",{src:de.icon,alt:de.name},null,8,lh)]),p("div",ch,Q(de.value),1),p("div",uh,Q(de.name),1)]))),128))]),L.value?ve("",!0):(I(),H("div",dh,[p("div",fh,[$[2]||($[2]=p("div",{class:"warehouse__title"},"",-1)),p("div",ph,[(I(!0),H(Xe,null,qt(m.value,(de,z)=>{var O;return I(),H("div",{class:Je(["puppet-card",{"puppet-card--selected":((O=g.value)==null?void 0:O.id)===de.id,"puppet-card--pulse":S.value===z,"puppet-card--hover":M.value===z}]),key:de.id,ref_for:!0,ref:X=>b(X,z),onClick:X=>v(de,z),onMouseenter:X=>M.value=z,onMouseleave:$[0]||($[0]=X=>M.value=null)},[p("div",mh,Q(de.level),1),p("div",gh,[p("img",{src:de.image,alt:de.name},null,8,_h)]),p("div",yh,[p("div",vh,Q(de.name)+Q(de.suffix),1),p("div",wh,Q(de.level)+"",1)])],42,hh)}),128)),p("div",{class:"puppet-card puppet-card--add",onClick:F},[...$[1]||($[1]=[p("div",{class:"puppet-card__add-icon"},"+",-1),p("div",{class:"puppet-card__add-text"},"",-1)])])])]),p("div",{class:"warehouse__detail",ref_key:"detailWrap",ref:_},[tt(hf,{name:"fade-slide",mode:"out-in"},{default:Qr(()=>{var de,z,O,X;return[g.value?(I(),H("div",{class:"puppet-detail",key:((de=g.value)==null?void 0:de.id)||"none"},[p("div",bh,[p("h2",Sh,Q(g.value.name),1)]),p("div",Mh,[p("div",Th,[p("div",Ch,[tt(oh,{puppet:g.value},null,8,["puppet"])]),p("div",Eh,Q(g.value.description),1)]),p("div",xh,[p("div",kh,[p("div",Ah,[p("div",Rh,[$[3]||($[3]=p("span",{class:"stat-label"},":",-1)),p("span",$h,Q(g.value.stats.health),1)]),p("div",Ph,[$[4]||($[4]=p("span",{class:"stat-label"},":",-1)),p("span",Lh,Q(g.value.stats.level),1)]),p("div",Ih,[$[5]||($[5]=p("span",{class:"stat-label"},":",-1)),p("span",Oh,Q(g.value.stats.live_left),1)]),p("div",Dh,[$[6]||($[6]=p("span",{class:"stat-label"},":",-1)),p("span",Nh,Q(g.value.stats.attack.base),1)]),p("div",Gh,[$[7]||($[7]=p("span",{class:"stat-label"},":",-1)),p("span",Hh,Q(g.value.stats.defense.base),1)]),p("div",Uh,[$[8]||($[8]=p("span",{class:"stat-label"},":",-1)),p("span",Fh,Q(g.value.stats.dodge.base)+"% ",1)]),p("div",Bh,[$[9]||($[9]=p("span",{class:"stat-label"},":",-1)),p("span",jh,Q(g.value.stats.class),1)])])]),p("div",zh,[$[10]||($[10]=p("h4",{class:"section-title"},"",-1)),p("div",Vh,[(I(!0),H(Xe,null,qt(g.value.equipment,(oe,Pe)=>(I(),H("div",{key:Pe,class:Je(["equipment-slot",{"equipment-slot--empty":!oe.equipped&&!oe.locked,"equipment-slot--locked":oe.locked}])},[oe.equipped&&oe.icon&&(oe.icon.startsWith("/")||oe.icon.startsWith("http"))?(I(),H("img",{key:0,src:oe.icon,alt:oe.name,class:"equipment-icon"},null,8,Wh)):oe.locked?(I(),H("img",{key:1,src:ue(N)("@assets/ui/lock.png"),alt:"",class:"equipment-icon"},null,8,Kh)):oe.icon===""?(I(),H("img",{key:2,src:ue(N)("@assets/ui/jia.png"),alt:"",class:"equipment-icon"},null,8,qh)):(I(),H("span",Xh,Q(oe.icon),1))],2))),128))])])]),((O=(z=g.value)==null?void 0:z.stats)==null?void 0:O.class)!==""?(I(),H("div",Yh,[$[11]||($[11]=p("h4",{class:"section-title"},"",-1)),p("div",Jh,[p("div",Zh,[p("div",Qh,Q(g.value.skill.name),1),p("div",em," : "+Q(g.value.skill.cooldown),1),p("div",tm,Q(g.value.skill.effect),1)]),p("div",sm,[g.value.skill.icon&&(g.value.skill.icon.startsWith("/")||g.value.skill.icon.startsWith("http"))?(I(),H("img",{key:0,src:g.value.skill.icon,alt:g.value.skill.name,class:"skill-icon-img"},null,8,nm)):(I(),H("span",om,Q(g.value.skill.icon),1))])])])):ve("",!0)]),p("div",am,[p("div",im,[g.value.level<5?(I(),H("img",{key:0,src:ue(Zt).SpiritalSpark.icon,alt:"",class:"cost-icon-img"},null,8,rm)):ve("",!0),p("span",lm,Q(g.value.level>=5?"":"X "+g.value.upgradeCost),1)]),p("button",{class:"upgrade-btn",onClick:W,disabled:((X=g.value)==null?void 0:X.level)>=5},[p("img",{src:ue(N)("@assets/ui/upgrade.png"),class:"upgrade-icon",alt:""},null,8,um)],8,cm)])])):(I(),H("div",dm,[...$[12]||($[12]=[p("p",null,"",-1)])]))]}),_:1})],512)])),L.value?(I(),Dt(yp,{key:1,onDraw:re})):ve("",!0),p("audio",{ref_key:"audioRef",ref:Se,src:ue(we),loop:"",preload:"auto"},null,8,fm)]))}},hm=mt(pm,[["__scopeId","data-v-228931f6"]]),mm={class:"panel",style:{left:"24px",right:"auto"}},gm=["title"],_m={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ym={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},vm={class:"sr-only"},wm={__name:"TopLeftPanel",props:{musicOn:{type:Boolean,default:!0}},emits:["back","open-settings","toggle-music"],setup(t,{emit:e}){return(s,n)=>(I(),H("div",mm,[p("button",{class:"btn",onClick:n[0]||(n[0]=o=>s.$emit("back")),title:""},[...n[3]||(n[3]=[p("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[p("path",{d:"M15 18L9 12L15 6",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),p("span",{class:"sr-only"},"",-1)])]),p("button",{class:"btn",onClick:n[1]||(n[1]=o=>s.$emit("toggle-music")),title:t.musicOn?"":""},[t.musicOn?(I(),H("svg",_m,[...n[4]||(n[4]=[p("path",{d:"M9 18V5L21 3V16",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),p("circle",{cx:"6",cy:"18",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),p("circle",{cx:"18",cy:"16",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1)])])):(I(),H("svg",ym,[...n[5]||(n[5]=[p("path",{d:"M9 18V5L21 3V16",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),p("circle",{cx:"6",cy:"18",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),p("circle",{cx:"18",cy:"16",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),p("line",{x1:"2",y1:"2",x2:"22",y2:"22",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round"},null,-1)])])),p("span",vm,Q(t.musicOn?"":""),1)],8,gm),p("button",{class:"btn",onClick:n[2]||(n[2]=o=>s.$emit("open-settings")),title:""},[...n[6]||(n[6]=[p("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[p("path",{d:"M12 15.5C13.933 15.5 15.5 13.933 15.5 12C15.5 10.067 13.933 8.5 12 8.5C10.067 8.5 8.5 10.067 8.5 12C8.5 13.933 10.067 15.5 12 15.5Z",stroke:"#ffffff","stroke-width":"2"}),p("path",{d:"M19.4 15A7.964 7.964 0 0 0 20 12C20 11.49 19.95 10.99 19.86 10.5L22 8.5L20 5.5L17.34 6.07C16.78 5.58 16.14 5.18 15.44 4.9L15 2H9L8.56 4.9C7.86 5.18 7.22 5.58 6.66 6.07L4 5.5L2 8.5L4.14 10.5C4.05 10.99 4 11.49 4 12C4 12.51 4.05 13.01 4.14 13.5L2 15.5L4 18.5L6.66 17.93C7.22 18.42 7.86 18.82 8.56 19.1L9 22H15L15.44 19.1C16.14 18.82 16.78 18.42 17.34 17.93L20 18.5L22 15.5L19.86 13.5C19.95 13.01 20 12.51 20 12",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),p("span",{class:"sr-only"},"",-1)])])]))}},nr=mt(wm,[["__scopeId","data-v-8380a348"]]),bm=["automatic_loading_gun","charging_coil","heart_source_mineral_drill","mirro_light_refraction_tower","repair_workshop","resonance_alarm_bell","rivet_barrier","steam_mining_car","storm_anvil"];function Sm(){const t=[],e=[{type:"arcanist",name:"bubble"},{type:"craftsman",name:"coil"},{type:"iron_wall",name:"bell"},{type:"mechanic",name:"gyro"},{type:"resonator",name:"clawster"}];for(const n of e){const o=Io(n.type,n.name);t.push(o)}const s=["goblin","guard","demon"];for(const n of s){const o=Oo(n);t.push(o)}return f(`[ModelPreloadConfig]  ${t.length} URL`),t}function Mm(){const t=[],e=[{type:"arcanist",name:"glimmer"},{type:"arcanist",name:"spark"},{type:"craftsman",name:"artifex"},{type:"craftsman",name:"wrench"},{type:"iron_wall",name:"chief"},{type:"iron_wall",name:"rocky"},{type:"mechanic",name:"karin"},{type:"mechanic",name:"tricky"},{type:"resonator",name:"diggs"},{type:"resonator",name:"hive"}];for(const n of e){const o=Io(n.type,n.name);t.push(o)}const s=["assassin","boxer","cruiser","devourer","glutton"];for(const n of s){const o=Oo(n);t.push(o)}return f(`[ModelPreloadConfig]  ${t.length} URL`),t}function Tm(){const t=[],e=[{type:"arcanist",name:"syrup"},{type:"arcanist",name:"turner"},{type:"craftsman",name:"drillbit"},{type:"craftsman",name:"quickhand"},{type:"iron_wall",name:"tumble"},{type:"iron_wall",name:"wesley"},{type:"mechanic",name:"pendulum"},{type:"mechanic",name:"yoyo"},{type:"resonator",name:"melody"},{type:"resonator",name:"murmur"}];for(const n of e){const o=Io(n.type,n.name);t.push(o)}const s=["horn","mirror","scout","shatra","variant"];for(const n of s){const o=Oo(n);t.push(o)}for(const n of bm){const o=Ul(n);t.push(o)}return f(`[ModelPreloadConfig]  ${t.length} URL`),t}function Cm(t=["high","medium"]){const e=[];for(const n of t)switch(n){case"high":e.push(...Sm());break;case"medium":e.push(...Mm());break;case"low":e.push(...Tm());break}const s=[...new Set(e)];return f(`[ModelPreloadConfig]  ${t.join(", ")}  ${s.length} URL`),s}class Em{constructor(){this.isPreloading=!1,this.preloadProgress=0,this.preloadCallbacks=[]}async startPreload(e=["high","medium"],s=null){if(this.isPreloading){f("[ModelPreloadManager] ");return}this.isPreloading=!0,this.preloadProgress=0;try{const n=Cm(e);f(`[ModelPreloadManager]  ${n.length}  (: ${e.join(", ")})`),s&&this.preloadCallbacks.push(s),await Ut.preloadModels(n,(o,a,i)=>{this.preloadProgress=i,this.notifyProgress(o,a,i)}),f("[ModelPreloadManager] ")}catch(n){f("[ModelPreloadManager] :",n)}finally{this.isPreloading=!1,this.preloadCallbacks=[]}}notifyProgress(e,s,n){this.preloadCallbacks.forEach(o=>{try{o(e,s,n)}catch(a){f("[ModelPreloadManager] :",a)}})}getStatus(){return{isPreloading:this.isPreloading,progress:this.preloadProgress,cacheStatus:Ut.getCacheStatus()}}isModelPreloaded(e){return Ut.isPreloaded(e)}async preloadModel(e){try{await Ut.loadModel(e,!0),f(`[ModelPreloadManager] : ${e}`)}catch(s){f(`[ModelPreloadManager] : ${e}`,s)}}async preloadModels(e){const s=e.map(n=>this.preloadModel(n));await Promise.all(s),f(`[ModelPreloadManager] : ${e.length} `)}}const or=new Em,Wl="mgpic_game_settings",ar={controlMode:"touchpad",mouseSensitivity:.002};function Uo(){try{const t=localStorage.getItem(Wl);if(t){const e=JSON.parse(t);return{...ar,...e}}}catch(t){console.error("[GameSettings] :",t)}return{...ar}}function xm(t){try{return localStorage.setItem(Wl,JSON.stringify(t)),!0}catch(e){return console.error("[GameSettings] :",e),!1}}function ir(t){return Uo()[t]}function Kl(t,e){const s=Uo();return s[t]=e,xm(s)}const km={class:"startmenu"},Am={key:0,class:"download-banner"},Rm={key:1,class:"settings-local"},$m={class:"settings-local__card"},Pm={class:"settings-local__content"},Lm={class:"settings-local__row"},Im={class:"setting-options"},Om={__name:"StartMenu",props:{visible:{type:Boolean,default:!0}},emits:["started"],setup(t,{emit:e}){Xt(A=>({v51d6432e:S}));const s=t,n=V(null);let o=null,a=null,i=null,r=null,l=null,c=1.2;const u=V(!1),d=V(!1),h=V(!1),m=V("touchpad"),g=V(!1),E=V(N("ui/Gemini_Generated_Image_gtrehogtrehogtre (1).png")),S=`url('${N("@assets/ui/panel4.png")}')`,_=e;Gt(()=>s.visible,A=>{A&&o&&l?L():A||v()});function M(){if(r=requestAnimationFrame(M),l){const A=Date.now()*.001;l.position.y=Math.sin(A*.8)*.1,l.rotation.y=Math.sin(A*.6)*.1;const ne=c+Math.sin(A*1.2)*.04;l.scale.setScalar(ne)}i&&i.render(o,a)}function b(){!i||!a||(a.aspect=window.innerWidth/window.innerHeight,a.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight))}function v(){r&&(cancelAnimationFrame(r),r=null),i&&i.setAnimationLoop(null)}function L(){r||M()}function F(){try{v()}catch{}try{window.removeEventListener("resize",b)}catch{}try{o&&(o.traverse(A=>{if(A.isMesh){A.geometry&&A.geometry.dispose&&A.geometry.dispose();const ne=A.material;Array.isArray(ne)?ne.forEach(Ie=>Ie&&Ie.dispose&&Ie.dispose()):ne&&ne.dispose&&ne.dispose()}}),o.clear())}catch{}try{if(i){i.clear(!0,!0,!0),i.dispose();const A=i.getContext&&i.getContext(),ne=A&&A.getExtension&&A.getExtension("WEBGL_lose_context");ne&&ne.loseContext&&ne.loseContext()}}catch{}o=null,a=null,i=null,l=null}async function j(A=null){try{window.getAssetUrl=N,window.precacheAllResources=ka,window.getCacheStatus=Bf}catch{}if(!o||!i){f("[StartMenu] Scene or renderer not initialized in onMounted");return}if(A&&A(0,100,20),!o.children.some(Se=>Se.isLight)){const Se=new So(4210752,.4);o.add(Se);const we=new cs(16777215,12.5);we.position.set(-5,-2,1),o.add(we)}A&&A(0,100,50);const Ie=N("logo.glb");try{A&&A(0,100,60),f("[StartMenu] Logo...");const Se=await Ut.loadModel(Ie,!0);A&&A(0,100,80),Se.position.set(0,0,0),o.add(Se);const J=new xt().setFromObject(Se).getCenter(new ke);Se.position.set(-J.x,-J.y,-J.z-.3);try{Se.scale.setScalar(c)}catch{}l=Se,A&&A(0,100,80),f("[StartMenu] Logo ...");try{await or.startPreload(["high","medium"],($,de,z)=>{const O=80+z*.15;A&&A(0,100,Math.round(O)),f(`[StartMenu] : ${$}/${de} (${z}%)`)}),f("[StartMenu] ")}catch($){f("[StartMenu] :",$)}A&&A(0,100,100),u.value=!0,f("[StartMenu] "),d.value=!0}catch(Se){f("[StartMenu] 3D",Se);const we=new rs(1,1,1),J=new ht({color:16096779}),$=new et(we,J);o.add($),l=$,f("[StartMenu] ...");try{await or.startPreload(["high","medium"],(de,z,O)=>{const X=80+O*.15;A&&A(0,100,Math.round(X)),f(`[StartMenu] : ${de}/${z} (${O}%)`)}),f("[StartMenu] ")}catch(de){f("[StartMenu] :",de)}A&&A(0,100,100),u.value=!0,f("[StartMenu] "),d.value=!0}window.__START_MENU_PAUSE__=()=>v(),window.__START_MENU_RESUME__=()=>L()}function re(){_("started"),v()}function W(){const A=Uo();m.value=A.controlMode,h.value=!0}function q(){h.value=!1}function se(A){m.value=A,Kl("controlMode",A),window.updateControlMode&&window.updateControlMode(A),f(`[StartMenu] : ${A}`)}return $t(()=>{var A;d.value=!1,u.value=!1,g.value=typeof window<"u"&&(window.navigator.userAgent.toLowerCase().includes("electron")||((A=window.process)==null?void 0:A.type)==="renderer"||!!(window.require&&window.process&&window.process.versions&&window.process.versions.electron)),f("[StartMenu] ..."),f("[StartMenu] Electron :",g.value),!o&&n.value?(o=new wo,o.background=null,a=new Hn(50,window.innerWidth/window.innerHeight,.1,1e3),a.position.set(-3.655,.2,-.006),a.rotation.set(-1.618275,-1.538307,-1.6183,"XYZ"),i=new bo({antialias:!0,alpha:!0,canvas:n.value}),i.setSize(window.innerWidth,window.innerHeight),i.setPixelRatio(window.devicePixelRatio),i.setClearColor(0,0),window.addEventListener("resize",b),M(),f("[StartMenu] ")):o&&!l?f("[StartMenu] "):l&&(f("[StartMenu] Logo"),d.value=!0,u.value=!0),window.__INIT_THREE_SCENE__=async ne=>{if(o&&l){f("[StartMenu] Logo"),d.value=!0,u.value=!0;return}f("[StartMenu] 3D..."),await j(ne)}}),fs(()=>{F()}),(A,ne)=>(I(),H("div",km,[g.value?ve("",!0):(I(),H("div",Am,[...ne[2]||(ne[2]=[p("span",{class:"download-banner__text"},"  ",-1),p("a",{href:"https://github.com/MGPIC-2025/Cross/releases",target:"_blank",rel:"noopener noreferrer",class:"download-banner__link"},"  ",-1)])])),p("div",{class:"startmenu__bg",style:zt({backgroundImage:`url('${E.value}')`})},null,4),p("canvas",{ref_key:"canvasRef",ref:n,class:"startmenu__canvas"},null,512),el(p("div",{class:Je(["startmenu-ui",{"fade-in":d.value}])},[p("button",{id:"start-btn",class:"startmenu-btn","aria-label":"",onClick:re},"  "),p("button",{id:"settings-btn",class:"startmenu-btn","aria-label":"",onClick:W},"  ")],2),[[Nl,d.value]]),h.value?(I(),H("div",Rm,[p("div",$m,[p("div",{class:"settings-local__header"},[ne[3]||(ne[3]=p("div",{class:"settings-local__title"},"",-1)),p("button",{class:"settings-local__close",onClick:q,"aria-label":""},"  ")]),p("div",Pm,[p("div",Lm,[ne[6]||(ne[6]=p("div",{class:"setting-label"},"",-1)),p("div",Im,[p("button",{class:Je(["option-btn",{active:m.value==="touchpad"}]),onClick:ne[0]||(ne[0]=Ie=>se("touchpad"))},[...ne[4]||(ne[4]=[p("span",{class:"option-title"},"",-1),p("span",{class:"option-desc"},"",-1)])],2),p("button",{class:Je(["option-btn",{active:m.value==="mouse"}]),onClick:ne[1]||(ne[1]=Ie=>se("mouse"))},[...ne[5]||(ne[5]=[p("span",{class:"option-title"},"",-1),p("span",{class:"option-desc"},"",-1)])],2)])])])])])):ve("",!0)]))}},Dm=mt(Om,[["__scopeId","data-v-90f3002b"]]),rr={type:"change"},Qa={type:"start"},ql={type:"end"},Zn=new ru,lr=new br,Nm=Math.cos(70*vr.DEG2RAD),ft=new ke,Lt=2*Math.PI,Ke={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},ra=1e-6;class Gm extends iu{constructor(e,s=null){super(e,s),this.state=Ke.NONE,this.target=new ke,this.cursor=new ke,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:tn.ROTATE,MIDDLE:tn.DOLLY,RIGHT:tn.PAN},this.touches={ONE:en.ROTATE,TWO:en.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new ke,this._lastQuaternion=new un,this._lastTargetPosition=new ke,this._quat=new un().setFromUnitVectors(e.up,new ke(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new ci,this._sphericalDelta=new ci,this._scale=1,this._panOffset=new ke,this._rotateStart=new Ct,this._rotateEnd=new Ct,this._rotateDelta=new Ct,this._panStart=new Ct,this._panEnd=new Ct,this._panDelta=new Ct,this._dollyStart=new Ct,this._dollyEnd=new Ct,this._dollyDelta=new Ct,this._dollyDirection=new ke,this._mouse=new Ct,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Um.bind(this),this._onPointerDown=Hm.bind(this),this._onPointerUp=Fm.bind(this),this._onContextMenu=qm.bind(this),this._onMouseWheel=zm.bind(this),this._onKeyDown=Vm.bind(this),this._onTouchStart=Wm.bind(this),this._onTouchMove=Km.bind(this),this._onMouseDown=Bm.bind(this),this._onMouseMove=jm.bind(this),this._interceptControlDown=Xm.bind(this),this._interceptControlUp=Ym.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(rr),this.update(),this.state=Ke.NONE}update(e=null){const s=this.object.position;ft.copy(s).sub(this.target),ft.applyQuaternion(this._quat),this._spherical.setFromVector3(ft),this.autoRotate&&this.state===Ke.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,o=this.maxAzimuthAngle;isFinite(n)&&isFinite(o)&&(n<-Math.PI?n+=Lt:n>Math.PI&&(n-=Lt),o<-Math.PI?o+=Lt:o>Math.PI&&(o-=Lt),n<=o?this._spherical.theta=Math.max(n,Math.min(o,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+o)/2?Math.max(n,this._spherical.theta):Math.min(o,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let a=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const i=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),a=i!=this._spherical.radius}if(ft.setFromSpherical(this._spherical),ft.applyQuaternion(this._quatInverse),s.copy(this.target).add(ft),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let i=null;if(this.object.isPerspectiveCamera){const r=ft.length();i=this._clampDistance(r*this._scale);const l=r-i;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),a=!!l}else if(this.object.isOrthographicCamera){const r=new ke(this._mouse.x,this._mouse.y,0);r.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),a=l!==this.object.zoom;const c=new ke(this._mouse.x,this._mouse.y,0);c.unproject(this.object),this.object.position.sub(c).add(r),this.object.updateMatrixWorld(),i=ft.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;i!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(i).add(this.object.position):(Zn.origin.copy(this.object.position),Zn.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(Zn.direction))<Nm?this.object.lookAt(this.target):(lr.setFromNormalAndCoplanarPoint(this.object.up,this.target),Zn.intersectPlane(lr,this.target))))}else if(this.object.isOrthographicCamera){const i=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),i!==this.object.zoom&&(this.object.updateProjectionMatrix(),a=!0)}return this._scale=1,this._performCursorZoom=!1,a||this._lastPosition.distanceToSquared(this.object.position)>ra||8*(1-this._lastQuaternion.dot(this.object.quaternion))>ra||this._lastTargetPosition.distanceToSquared(this.target)>ra?(this.dispatchEvent(rr),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Lt/60*this.autoRotateSpeed*e:Lt/60/60*this.autoRotateSpeed}_getZoomScale(e){const s=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*s)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,s){ft.setFromMatrixColumn(s,0),ft.multiplyScalar(-e),this._panOffset.add(ft)}_panUp(e,s){this.screenSpacePanning===!0?ft.setFromMatrixColumn(s,1):(ft.setFromMatrixColumn(s,0),ft.crossVectors(this.object.up,ft)),ft.multiplyScalar(e),this._panOffset.add(ft)}_pan(e,s){const n=this.domElement;if(this.object.isPerspectiveCamera){const o=this.object.position;ft.copy(o).sub(this.target);let a=ft.length();a*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*a/n.clientHeight,this.object.matrix),this._panUp(2*s*a/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(s*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,s){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),o=e-n.left,a=s-n.top,i=n.width,r=n.height;this._mouse.x=o/i*2-1,this._mouse.y=-(a/r)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(Lt*this._rotateDelta.x/s.clientHeight),this._rotateUp(Lt*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let s=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Lt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),s=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Lt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),s=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Lt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),s=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Lt*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),s=!0;break}s&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),o=.5*(e.pageY+s.y);this._rotateStart.set(n,o)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),o=.5*(e.pageY+s.y);this._panStart.set(n,o)}}_handleTouchStartDolly(e){const s=this._getSecondPointerPosition(e),n=e.pageX-s.x,o=e.pageY-s.y,a=Math.sqrt(n*n+o*o);this._dollyStart.set(0,a)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),o=.5*(e.pageX+n.x),a=.5*(e.pageY+n.y);this._rotateEnd.set(o,a)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const s=this.domElement;this._rotateLeft(Lt*this._rotateDelta.x/s.clientHeight),this._rotateUp(Lt*this._rotateDelta.y/s.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),o=.5*(e.pageY+s.y);this._panEnd.set(n,o)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const s=this._getSecondPointerPosition(e),n=e.pageX-s.x,o=e.pageY-s.y,a=Math.sqrt(n*n+o*o);this._dollyEnd.set(0,a),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const i=(e.pageX+s.x)*.5,r=(e.pageY+s.y)*.5;this._updateZoomParameters(i,r)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==e.pointerId){this._pointers.splice(s,1);return}}_isTrackingPointer(e){for(let s=0;s<this._pointers.length;s++)if(this._pointers[s]==e.pointerId)return!0;return!1}_trackPointer(e){let s=this._pointerPositions[e.pointerId];s===void 0&&(s=new Ct,this._pointerPositions[e.pointerId]=s),s.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const s=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[s]}_customWheelEvent(e){const s=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(s){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function Hm(t){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(t.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(t)&&(this._addPointer(t),t.pointerType==="touch"?this._onTouchStart(t):this._onMouseDown(t)))}function Um(t){this.enabled!==!1&&(t.pointerType==="touch"?this._onTouchMove(t):this._onMouseMove(t))}function Fm(t){switch(this._removePointer(t),this._pointers.length){case 0:this.domElement.releasePointerCapture(t.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(ql),this.state=Ke.NONE;break;case 1:const e=this._pointers[0],s=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:s.x,pageY:s.y});break}}function Bm(t){let e;switch(t.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case tn.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(t),this.state=Ke.DOLLY;break;case tn.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=Ke.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=Ke.ROTATE}break;case tn.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=Ke.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=Ke.PAN}break;default:this.state=Ke.NONE}this.state!==Ke.NONE&&this.dispatchEvent(Qa)}function jm(t){switch(this.state){case Ke.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(t);break;case Ke.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(t);break;case Ke.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(t);break}}function zm(t){this.enabled===!1||this.enableZoom===!1||this.state!==Ke.NONE||(t.preventDefault(),this.dispatchEvent(Qa),this._handleMouseWheel(this._customWheelEvent(t)),this.dispatchEvent(ql))}function Vm(t){this.enabled!==!1&&this._handleKeyDown(t)}function Wm(t){switch(this._trackPointer(t),this._pointers.length){case 1:switch(this.touches.ONE){case en.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(t),this.state=Ke.TOUCH_ROTATE;break;case en.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(t),this.state=Ke.TOUCH_PAN;break;default:this.state=Ke.NONE}break;case 2:switch(this.touches.TWO){case en.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(t),this.state=Ke.TOUCH_DOLLY_PAN;break;case en.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(t),this.state=Ke.TOUCH_DOLLY_ROTATE;break;default:this.state=Ke.NONE}break;default:this.state=Ke.NONE}this.state!==Ke.NONE&&this.dispatchEvent(Qa)}function Km(t){switch(this._trackPointer(t),this.state){case Ke.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(t),this.update();break;case Ke.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(t),this.update();break;case Ke.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(t),this.update();break;case Ke.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(t),this.update();break;default:this.state=Ke.NONE}}function qm(t){this.enabled!==!1&&t.preventDefault()}function Xm(t){t.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Ym(t){t.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const Jm={class:"startgame-modal"},Zm={class:"card"},Qm={class:"card__header"},eg=["src"],tg={class:"card__body"},sg={class:"card__content"},ng={key:0,class:"loading"},og={key:1,class:"error"},ag={key:2,class:"list"},ig=["onClick"],rg={class:"item__img"},lg=["src","alt"],cg={class:"item__meta"},ug={class:"item__name"},dg={class:"item__level"},fg={class:"preview"},pg={class:"preview__info"},hg={key:0,class:"preview__empty"},mg={key:1,class:"preview__names"},gg={class:"preview__name-number"},_g={class:"preview__name-text"},yg={class:"card__footer"},vg=["disabled"],wg=["src"],bg={__name:"StartGame",props:{musicOn:{type:Boolean,default:!0},paused:{type:Boolean,default:!1}},emits:["confirm","close"],setup(t,{emit:e}){Xt(O=>({aa824e20:ne,aa807ca4:Se,aa7b0830:de,a5e82c30:z,aa7dc26a:we,aa7bf0ee:$,aa816562:Ie,aa7cd9ac:J}));const s=e,n=t,o=V(!0),a=V(""),i=V([]),r=V(new Set),l=V(null),c=V(null),u=N("@assets/frontend_resource/startgame.mp3");let d,h,m,g,E;const S=new Map,_=De(()=>r.value.size===3),M=De(()=>i.value.filter(O=>r.value.has(O.id)));function b(){if(!l.value)return;d=new wo,d.background=new ts(1710618),h=new Hn(45,l.value.clientWidth/l.value.clientHeight,.1,100),h.position.set(0,3,8),m=new bo({antialias:!0}),m.setSize(l.value.clientWidth,l.value.clientHeight),m.setPixelRatio(window.devicePixelRatio),l.value.appendChild(m.domElement),g=new Gm(h,m.domElement),g.enableDamping=!0,g.dampingFactor=.05,g.target.set(0,1,0);const O=new So(16777215,.5);d.add(O);const X=new cs(16777215,1);X.position.set(0,5,10),d.add(X);const oe=new cs(11193599,.4);oe.position.set(-5,3,5),d.add(oe);const Pe=new cs(16764074,.4);Pe.position.set(5,3,5),d.add(Pe);const Fe=new cs(16777215,.3);Fe.position.set(0,5,-5),d.add(Fe);const Ue=new Rn(20,20),Ne=new pt({color:2763306,side:Nt}),Qe=new et(Ue,Ne);Qe.rotation.x=-Math.PI/2,Qe.position.y=0,d.add(Qe),E=new Go;const at=new Ho;at.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),E.setDRACOLoader(at),v(),window.addEventListener("resize",L)}function v(){requestAnimationFrame(v),g&&g.update(),m&&d&&h&&m.render(d,h)}function L(){!l.value||!h||!m||(h.aspect=l.value.clientWidth/l.value.clientHeight,h.updateProjectionMatrix(),m.setSize(l.value.clientWidth,l.value.clientHeight))}function F(O){const X=r.value;if(X.has(O))X.delete(O);else{if(X.size>=3)return;X.add(O)}r.value=new Set(X)}async function j(O,X){if(!d||!E)return;let oe=O.modelUrl;f(`[StartGame] model_url: ${O.name}, URL: ${oe}`);try{const Pe=await Ut.loadModel(oe,!0);f(`[StartGame] : ${O.name}`);const Ue=new xt().setFromObject(Pe).getSize(new ke),Ne=new Jt;Ne.add(Pe);const Qe=2.5,at=-(M.value.length-1)*Qe/2;Ne.position.set(at+X*Qe,0,0),Ne.scale.set(1,1,1),Ne.rotation.y=-Math.PI/2;const st=new xt().setFromObject(Ne);Ne.position.y=-st.min.y,d.add(Ne),S.set(O.id,Ne),f(`[StartGame] : ${O.name}`)}catch(Pe){f(`[StartGame] : ${O.name}`,Pe),re(O,X)}}function re(O,X){if(!d)return;const oe=new rs(.8,.8,.8),Pe=new pt({color:4491519}),Fe=new et(oe,Pe),Ue=2.5,Ne=-(M.value.length-1)*Ue/2;Fe.position.set(Ne+X*Ue,.8,0),Fe.rotation.y=-Math.PI/2,d.add(Fe),S.set(O.id,Fe)}function W(){d&&(S.forEach(O=>{d.remove(O),O.geometry&&O.geometry.dispose(),O.material&&(Array.isArray(O.material)?O.material.forEach(X=>X.dispose()):O.material.dispose())}),S.clear(),M.value.forEach((O,X)=>{j(O,X)}))}async function q(){o.value=!0,a.value="";try{const O=await oo(),X=Array.isArray(O==null?void 0:O.coppers)?O.coppers:[];i.value=(X||[]).map((oe,Pe)=>{var Ue,Ne,Qe,at,st,Pt;const Fe=(Ue=oe==null?void 0:oe.copper_info)==null?void 0:Ue.model_url;return f(`[StartGame] Copper ${((Ne=oe==null?void 0:oe.copper_info)==null?void 0:Ne.name)||Pe+1}: model_url=${Fe}`),{id:Number((oe==null?void 0:oe.id)??Pe+1),name:((Qe=oe==null?void 0:oe.copper_info)==null?void 0:Qe.name)||`#${Pe+1}`,icon:N(((at=oe==null?void 0:oe.copper_info)==null?void 0:at.icon_url)||""),level:Number((oe==null?void 0:oe.level)??1),copperType:(oe==null?void 0:oe.copper_type)||"Arcanist",modelName:((Pt=(st=oe==null?void 0:oe.copper_info)==null?void 0:st.name)==null?void 0:Pt.toLowerCase())||"",modelUrl:Fe?N(Fe):""}})}catch(O){f("[StartGame] ",O),a.value=""}finally{o.value=!1}}async function se(){if(r.value.size!==3)return;const O=Array.from(r.value).map(X=>String(X));window.__ACTUAL_COPPER_IDS__=O,f("[StartGame] ID:",O),s("confirm",{ids:O})}function A(){s("close")}Gt(M,()=>{W()},{deep:!0}),$t(()=>{q(),setTimeout(()=>{b()},100),n.musicOn&&!n.paused&&c.value&&setTimeout(()=>{if(c.value.readyState>=2)c.value.play().then(()=>{f("[StartGame] ")}).catch(X=>{f("[StartGame] :",X)});else{const X=()=>{c.value.play().then(()=>{f("[StartGame] ")}).catch(oe=>{f("[StartGame] :",oe)}),c.value.removeEventListener("canplay",X)};c.value.addEventListener("canplay",X,{once:!0})}},200)}),Gt(()=>n.musicOn,O=>{if(c.value)if(O&&!n.paused)if(c.value.readyState>=2)c.value.play().catch(X=>{f("[StartGame] :",X)});else{const X=()=>{c.value.play().catch(oe=>{f("[StartGame] :",oe)}),c.value.removeEventListener("canplay",X)};c.value.addEventListener("canplay",X)}else c.value.pause()}),Gt(()=>n.paused,O=>{if(c.value){if(O)c.value.pause(),f("[StartGame] ");else if(n.musicOn){if(c.value.readyState>=2)c.value.play().catch(X=>{f("[StartGame] :",X)});else{const X=()=>{c.value.play().catch(oe=>{f("[StartGame] :",oe)}),c.value.removeEventListener("canplay",X)};c.value.addEventListener("canplay",X)}f("[StartGame] ")}}}),fs(()=>{window.removeEventListener("resize",L),c.value&&c.value.pause(),S.forEach(O=>{d&&d.remove(O)}),S.clear(),m&&m.dispose(),g&&g.dispose()});const ne=`url('${N("@assets/ui/panel1.png")}')`,Ie=`url('${N("@assets/ui/panel2.png")}')`,Se=`url('${N("@assets/ui/panel3.png")}')`,we=`url('${N("@assets/ui/panel6.png")}')`,J=`url('${N("@assets/ui/panel7.png")}')`,$=`url('${N("@assets/ui/panel8.png")}')`,de=`url('${N("@assets/ui/panel9.png")}')`,z=`url('${N("@assets/ui/panel10.png")}')`;return(O,X)=>(I(),H("div",Jm,[p("div",Zm,[p("div",Qm,[X[0]||(X[0]=p("div",{class:"card__title"},"",-1)),p("button",{class:"card__close",onClick:A,"aria-label":""},[p("img",{src:ue(N)("@assets/ui/close.png"),alt:""},null,8,eg)])]),p("div",tg,[p("div",sg,[o.value?(I(),H("div",ng,"...")):a.value?(I(),H("div",og,Q(a.value),1)):(I(),H("div",ag,[(I(!0),H(Xe,null,qt(i.value,oe=>(I(),H("div",{key:oe.id,class:Je(["item",{"item--selected":r.value.has(oe.id)}]),onClick:Pe=>F(oe.id)},[p("div",rg,[p("img",{src:oe.icon,alt:oe.name},null,8,lg)]),p("div",cg,[p("div",ug,Q(oe.name),1),p("div",dg,"Lv. "+Q(oe.level),1)])],10,ig))),128))])),X[1]||(X[1]=p("div",{class:"hint"},"3",-1))]),p("div",fg,[X[2]||(X[2]=p("div",{class:"preview__title"},"",-1)),p("div",{ref_key:"previewContainer",ref:l,class:"preview__scene"},null,512),p("div",pg,[M.value.length===0?(I(),H("div",hg,"  ")):(I(),H("div",mg,[(I(!0),H(Xe,null,qt(M.value,(oe,Pe)=>(I(),H("div",{key:oe.id,class:"preview__name"},[p("span",gg,Q(Pe+1),1),p("span",_g,Q(oe.name),1)]))),128))]))])])]),p("div",yg,[p("button",{class:"btn btn--primary",disabled:!_.value,onClick:se},"  ",8,vg),p("button",{class:"btn",onClick:A},"")])]),p("audio",{ref_key:"audioRef",ref:c,src:ue(u),loop:"",preload:"auto"},null,8,wg)]))}},Sg=mt(bg,[["__scopeId","data-v-5e159611"]]),Mg={:"spark",:"syrup",:"bubble",:"glimmer",:"turner",:"wrench",:"artifex",:"coil",:"drillbit",:"quickhand",:"rocky",:"wesley",:"bell",:"tumble",:"chief",:"gyro",:"tricky",:"pendulum",:"yoyo",:"karin",:"murmur",:"melody",:"clawster",:"diggs",:"hive"},Tg={IronWall:"iron_wall",Arcanist:"arcanist",Mechanic:"mechanic",Resonator:"resonator",CraftsMan:"craftsman"};function Cg(t){return Mg[t]||t.toLowerCase()}function Eg(t){return Tg[t]||t.toLowerCase()}const xg={:"rivet_barrier",:"gear_arrow_tower",:"heart_source_mineral_drill",:"steam_mining_car",:"charging_coil",:"repair_workshop",:"mirro_light_refraction_tower",:"resonance_alarm_bell",:"storm_anvil",:"automatic_loading_gun"};function kg(t){return xg[t]||t.toLowerCase().replace(/\s+/g,"_")}function Ag(t,e){const s=new Map;function n(c,u,d){if(s.has(c)){const L=s.get(c);L.maxHp=d,o(c,u,d);return}const h=1,m=.1,g=new Rn(h,m),E=new ht({color:4456448,side:Nt,depthTest:!1,depthWrite:!1,transparent:!1,toneMapped:!1}),S=new et(g,E),_=new Rn(h,m),M=new ht({color:a(u,d),side:Nt,depthTest:!1,depthWrite:!1,transparent:!1,toneMapped:!1}),b=new et(_,M);b.position.z=.001;const v=new Jt;v.add(S),v.add(b),v.renderOrder=999,S.renderOrder=999,b.renderOrder=1e3,t.add(v),s.set(c,{bar:b,background:S,container:v,maxHp:d}),o(c,u,d)}function o(c,u,d){const h=s.get(c);if(!h)return;const{bar:m}=h,g=Math.max(0,Math.min(1,u/d));m.scale.x=g,m.position.x=-(1-g)*.5,m.material.color.setHex(a(u,d))}function a(c,u){const d=c/u;return d>.6?65280:d>.3?16776960:16711680}function i(c){const u=s.get(c);if(!u)return;const{bar:d,background:h,container:m}=u;d.geometry.dispose(),d.material.dispose(),h.geometry.dispose(),h.material.dispose(),t.remove(m),s.delete(c)}function r(c){s.forEach((u,d)=>{const h=c.find(m=>m.id===d);if(h&&h.object){const{container:m}=u,g=h.object.position.clone();g.y+=1.5,m.position.copy(g),m.lookAt(e.position)}})}function l(){s.forEach((c,u)=>{i(u)}),s.clear()}return{healthBars:s,createOrUpdateHealthBar:n,updateHealthBarValue:o,removeHealthBar:i,updateHealthBarsPosition:r,dispose:l}}const Rg={url:N("@assets/ui/skybox.jpg"),radius:1e3,segments:32,hemisphere:!1},$g={ambient:{color:16777215,intensity:.5},mainDirectional:{color:16777215,intensity:1.2,position:{x:0,y:20,z:5},castShadow:!0},topLight:{color:16777215,intensity:.8,position:{x:0,y:30,z:0}},hemisphere:{skyColor:16777215,groundColor:4473924,intensity:.6,position:{x:0,y:20,z:0}}};function Pg(){return{...Rg}}const Lg={fov:60,near:.1,far:2e3,position:{x:0,y:5,z:10}},Ig={antialias:!0},Og={decoderPath:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},Dg={moveSpeed:.2,rotationSpeed:.003,focusLerpFactor:.08},Ng={enabled:!0,units:[{id:1,name:"1",color:4491519,position:{x:.5,y:.4,z:.5},size:.8},{id:2,name:"2",color:16729156,position:{x:4.5,y:.4,z:4.5},size:.8}]},Gg={enabled:!0,materialType:"standard",basic:{color:4868682,opacity:.8},standard:{color:5921386,roughness:.3,metalness:.7,opacity:.8},texture:{url:null,repeat:{x:1,y:1}},size:.95,height:.05,yOffset:-.02},Hg={enabled:!1,size:100,materialType:"standard",texture:{url:null,repeat:{x:10,y:10},wrapS:"RepeatWrapping",wrapT:"RepeatWrapping"},color:{value:2763306},standard:{color:3815994,roughness:.8,metalness:.1,normalMap:null,normalScale:{x:1,y:1},roughnessMap:null,aoMap:null},position:{x:0,y:0,z:0},rotation:{x:-Math.PI/2,y:0,z:0}};function Ug(){return{...$g}}function Fg(){return{...Lg}}function Bg(){return{...Ig}}function jg(){return{...Og}}function cr(){return{...Dg}}function zg(){return{...Ng}}function Vg(){return{...Hg}}function Xl(){return{...Gg}}function Wg(t){const e={move:[],attack:[],summon:[]},s=Xl();function n(d={}){var m;const h={...s,...d};if(!h.enabled)return new ht({transparent:!0,opacity:0});if(h.materialType==="texture"&&h.texture.url){const E=new dn().load(h.texture.url);return E.colorSpace=bt,E.wrapS=Ss,E.wrapT=Ss,E.repeat.set(h.texture.repeat.x,h.texture.repeat.y),new pt({map:E,side:Nt,transparent:!0,opacity:((m=h.standard)==null?void 0:m.opacity)||1})}else return h.materialType==="standard"?new pt({color:h.standard.color,roughness:h.standard.roughness,metalness:h.standard.metalness,side:Nt,transparent:!0,opacity:h.standard.opacity}):new ht({color:h.basic.color,side:Nt,transparent:!0,opacity:h.basic.opacity})}const o={move:{color:4521796,opacity:.6},attack:{color:16729156,opacity:.6},summon:{color:16776960,opacity:.6}};function a(d,h="move"){const[m,g]=d,E=o[h]||o.move,S=s.size||.9,_=s.height||.08,M=new Rn(S,S),b=new ht({color:E.color,side:Nt,transparent:!0,opacity:E.opacity}),v=new et(M,b);return v.rotation.x=-Math.PI/2,v.position.set(m,_,g),v.userData={position:d,type:h},t.add(v),e[h].push(v),v}function i(d){const[h,m]=d;let g=!1;return Object.keys(e).forEach(E=>{const S=e[E].findIndex(_=>{const M=_.userData.position;return M[0]===h&&M[1]===m});if(S!==-1){const _=e[E][S];t.remove(_),_.geometry.dispose(),_.material.dispose(),e[E].splice(S,1),g=!0}}),g}function r(d){e[d]&&(e[d].forEach(h=>{t.remove(h),h.geometry.dispose(),h.material.dispose()}),e[d]=[])}function l(){Object.keys(e).forEach(d=>{r(d)})}function c(d,h){var E;const[m,g]=d;return(E=e[h])==null?void 0:E.some(S=>{const _=S.userData.position;return _[0]===m&&_[1]===g})}function u(){l()}return{indicators:e,createIndicator:a,createCellMaterial:n,clearIndicatorAt:i,clearIndicators:r,clearAllIndicators:l,hasIndicatorAt:c,dispose:u}}function Kg(){const t={geometries:[],materials:[],meshes:[],maxSize:10},e={geometries:[],materials:[],meshes:[],maxSize:10};function s(r){let l;if(t.meshes.length>0)l=t.meshes.pop(),l.geometry.dispose(),l.geometry=new io(.05,.05,r,8),l.material.opacity=.9;else{const c=new io(.05,.05,r,8),u=new ht({color:16729156,transparent:!0,opacity:.9,emissive:16729156,emissiveIntensity:.5});l=new et(c,u)}return l}function n(r){t.meshes.length<t.maxSize?t.meshes.push(r):(r.geometry.dispose(),r.material.dispose())}function o(){let r;if(e.meshes.length>0)r=e.meshes.pop(),r.scale.set(1,1,1),r.material.opacity=.8;else{const l=new fa(.2,.4,32),c=new ht({color:16711680,side:Nt,transparent:!0,opacity:.8,emissive:16711680,emissiveIntensity:.5});r=new et(l,c),r.rotation.x=-Math.PI/2}return r}function a(r){e.meshes.length<e.maxSize?e.meshes.push(r):(r.geometry.dispose(),r.material.dispose())}function i(){t.meshes.forEach(r=>{r.geometry.dispose(),r.material.dispose()}),t.meshes=[],t.geometries=[],t.materials=[],e.meshes.forEach(r=>{r.geometry.dispose(),r.material.dispose()}),e.meshes=[],e.geometries=[],e.materials=[]}return{getAttackRay:s,recycleAttackRay:n,getExplosionRing:o,recycleExplosionRing:a,dispose:i}}function qg(t){const e=Kg();function s(a,i){const r=new ke(a[0],.5,a[1]),l=new ke(i[0],.5,i[1]),c=r.distanceTo(l),u=e.getAttackRay(c),d=new ke().addVectors(r,l).multiplyScalar(.5);u.position.copy(d);const h=new ke().subVectors(l,r).normalize(),m=new un;m.setFromUnitVectors(new ke(0,1,0),h),u.quaternion.copy(m),t.add(u);let g=.9;const E=()=>{g-=.05,u.material.opacity=g,g<=0?(t.remove(u),e.recycleAttackRay(u)):requestAnimationFrame(E)};setTimeout(E,300);const S=e.getExplosionRing();S.position.set(i[0],.1,i[1]),t.add(S);let _=1,M=.8;const b=()=>{_+=.1,M-=.08,S.scale.set(_,_,1),S.material.opacity=M,M<=0?(t.remove(S),e.recycleExplosionRing(S)):requestAnimationFrame(b)};b()}function n(a,i){const r=Object.entries(i).filter(([v,L])=>L>0).map(([v,L])=>{const F=vt(v);return`+${L} ${F}`});if(r.length===0)return;const l=r.join(`
`),c=document.createElement("canvas"),u=c.getContext("2d");c.width=512,c.height=256,u.fillStyle="rgba(0, 0, 0, 0)",u.fillRect(0,0,c.width,c.height),u.font="bold 48px Arial",u.fillStyle="#ffff00",u.strokeStyle="#000000",u.lineWidth=4,u.textAlign="center",u.textBaseline="middle";const d=l.split(`
`),h=60,m=c.height/2-(d.length-1)*h/2;d.forEach((v,L)=>{const F=m+L*h;u.strokeText(v,c.width/2,F),u.fillText(v,c.width/2,F)});const g=new lu(c),E=new cu({map:g,transparent:!0,opacity:1}),S=new uu(E);S.scale.set(2,1,1),S.position.set(a[0],1.5,a[1]),t.add(S);let _=1.5,M=1;const b=()=>{_+=.02,M-=.01,S.position.y=_,S.material.opacity=M,M<=0?(t.remove(S),S.material.map.dispose(),S.material.dispose()):requestAnimationFrame(b)};b()}function o(){e.dispose()}return{createAttackEffect:s,createResourceGainEffect:n,dispose:o}}const Xg={gameScene:N("@assets/frontend_resource/gamescene.mp3")},Yg={move:N("@assets/frontend_resource/move.mp3"),moveEnemy:N("@assets/frontend_resource/move_enemy.mp3"),attack:N("@assets/frontend_resource/attack.mp3"),attackEnemy:N("@assets/frontend_resource/attack_enemy.mp3"),meHurt:N("@assets/frontend_resource/me_hurt.mp3"),enemyHurt:N("@assets/frontend_resource/enemy_hurt.mp3")};function Jg(t){return Xg[t]||""}function Js(t){return Yg[t]||""}let it=null;function Zg(t,e,s={}){const{radius:n=1e3,segments:o=32,hemisphere:a=!1}=s;it&&(t.remove(it),it.geometry&&it.geometry.dispose(),it.material&&(it.material.map&&it.material.map.dispose(),it.material.dispose()),it=null),new dn().load(e,r=>{r.colorSpace=bt;const l=a?new pa(n,o,o,0,Math.PI*2,0,Math.PI/2):new pa(n,o,o),c=new ht({map:r,side:fu,depthWrite:!1});it=new et(l,c),it.position.set(0,0,0),t.add(it),f(`[SceneUtils] ${a?"":""}${n}`)},void 0,r=>{f("[SceneUtils] ",r),t.background=new ts(2236962)})}function Qg(t,e){if(!e||!e.url){t.background=new ts(2236962);return}Zg(t,e.url,{radius:e.radius||1e3,segments:e.segments||32,hemisphere:e.hemisphere||!1})}function e_(t,e){const s=new So(e.ambient.color,e.ambient.intensity);t.add(s);const n=new cs(e.mainDirectional.color,e.mainDirectional.intensity);n.position.set(e.mainDirectional.position.x,e.mainDirectional.position.y,e.mainDirectional.position.z),n.castShadow=e.mainDirectional.castShadow,t.add(n);const o=new cs(e.topLight.color,e.topLight.intensity);o.position.set(e.topLight.position.x,e.topLight.position.y,e.topLight.position.z),t.add(o);const a=new du(e.hemisphere.skyColor,e.hemisphere.groundColor,e.hemisphere.intensity);a.position.set(e.hemisphere.position.x,e.hemisphere.position.y,e.hemisphere.position.z),t.add(a)}function t_(t={}){const e={...Fg(),...t},s=window.innerWidth/window.innerHeight,n=new Hn(e.fov,s,e.near,e.far);return n.position.set(e.position.x,e.position.y,e.position.z),n}function s_(t,e={}){const s={...Bg(),...e},n=e.width||window.innerWidth,o=e.height||window.innerHeight,a=new bo({antialias:s.antialias});return a.setSize(n,o),a.setPixelRatio(window.devicePixelRatio),t.appendChild(a.domElement),a}function n_(t=null){const e=jg(),s=t||e.decoderPath,n=new Go,o=new Ho;return o.setDecoderPath(s),n.setDRACOLoader(o),n}function o_(t,e){const s=zg();s.enabled&&(s.units.forEach(n=>{const o=new rs(n.size,n.size,n.size),a=new pt({color:n.color}),i=new et(o,a);i.position.set(n.position.x,n.position.y,n.position.z),t.add(i),e.push({id:n.id,object:i,name:n.name,type:"test"})}),f("[SceneUtils] :",e.map(n=>`ID=${n.id}`)))}function a_(t,e={}){const s={...Vg(),...e};if(!s.enabled)return null;const n=new Rn(s.size,s.size);let o;if(s.materialType==="texture"&&s.texture.url){const r=new dn().load(s.texture.url);r.colorSpace=bt,r.wrapS=ui[s.texture.wrapS]||Ss,r.wrapT=ui[s.texture.wrapT]||Ss,r.repeat.set(s.texture.repeat.x,s.texture.repeat.y),o=new pt({map:r,side:Nt})}else if(s.materialType==="color")o=new ht({color:s.color.value,side:Nt});else{const i={color:s.standard.color,roughness:s.standard.roughness,metalness:s.standard.metalness,side:Nt},r=new dn;if(s.standard.normalMap){const l=r.load(s.standard.normalMap);l.colorSpace=bt,i.normalMap=l,i.normalScale=new Ct(s.standard.normalScale.x,s.standard.normalScale.y)}if(s.standard.roughnessMap){const l=r.load(s.standard.roughnessMap);l.colorSpace=bt,i.roughnessMap=l}if(s.standard.aoMap){const l=r.load(s.standard.aoMap);l.colorSpace=bt,i.aoMap=l}o=new pt(i)}const a=new et(n,o);return a.position.set(s.position.x,s.position.y,s.position.z),a.rotation.set(s.rotation.x,s.rotation.y,s.rotation.z),a.renderOrder=-200,t.add(a),f(`[SceneUtils] ${s.materialType}${s.size}`),a}function i_(t){it&&t&&(t.remove(it),it.geometry&&it.geometry.dispose(),it.material&&(it.material.map&&it.material.map.dispose(),it.material.dispose()),it=null)}const r_={key:0,class:"diamond-name"},l_={class:"diamond-row diamond-row--top"},c_=["title","aria-disabled"],u_={class:"diamond border-orange-red"},d_={class:"diamond-content"},f_={class:"diamond-text"},p_={class:"diamond-value"},h_={class:"diamond-row diamond-row--bottom"},m_={class:"diamond border-orange-red"},g_={class:"diamond-content"},__={class:"diamond-text"},y_={class:"diamond-value"},v_={class:"diamond border-green"},w_={class:"diamond-content"},b_={class:"diamond-text"},S_={class:"diamond-value"},M_={class:"diamond border-blue"},T_={class:"diamond-content"},C_={class:"diamond-text"},E_={class:"diamond-value"},x_={__name:"DiamondPanel",props:{copperInfo:{type:Object,required:!0},inventoryItems:{type:Array,default:()=>[]},inventoryCapacity:{type:Number,default:5}},emits:["inventory-click"],setup(t,{emit:e}){Xt(_=>({v2b14f7a8:h,v6dc22a41:s,v740cabaa:n,v4ea1daaa:o}));const s=`url('${N("ui/border-blue.png")}')`,n=`url('${N("ui/border-green.png")}')`,o=`url('${N("ui/border-orange-red.png")}')`,a=t,i=e,r=De(()=>{var _;return(((_=a.copperInfo)==null?void 0:_.name)||"").trim()}),l=De(()=>{var _,M;return((_=a.copperInfo)==null?void 0:_.isOwnedEnemy)===!0||((M=a.copperInfo)==null?void 0:M.isEnemy)===!0}),c=De(()=>l.value&&r.value!==""),u=De(()=>{var M;const _=(M=a.copperInfo)==null?void 0:M.position;return!Array.isArray(_)||_.length<2?"--":`${_[0]},${_[1]}`}),d=De(()=>l.value===!0),h=`url('${N("@assets/ui/panel4.png")}')`,m=V({SpiritalSpark:0,RecallGear:0,ResonantCrystal:0,RefinedCopper:0,HeartCrystalDust:0});async function g(){try{const _=await No();_&&Object.keys(m.value).forEach(M=>{m.value[M]=_[M]||0})}catch(_){console.error("[DiamondPanel] :",_)}}De(()=>Object.values(m.value).filter(_=>_>0).length);function E(){d.value||i("inventory-click")}const S=V(null);return $t(async()=>{if(g(),Do(Ot.UPDATE_RESOURCES,g),!S.value)return;function _(b){return new Promise((v,L)=>{const F=new Image;F.onload=()=>v(F),F.onerror=()=>L(),F.src=b})}function M(b,v){S.value&&S.value.style.setProperty(b,String(v))}try{const[b,v,L]=await Promise.all([_(N("ui/border-blue.png")),_(N("ui/border-green.png")),_(N("ui/border-orange-red.png"))]),F=Math.max(3,Math.round(b.naturalHeight/4)),j=Math.max(3,Math.round(v.naturalHeight/4)),re=Math.max(3,Math.round(L.naturalHeight/4));M("--border-blue-slice",F),M("--border-green-slice",j),M("--border-orange-red-slice",re)}catch{M("--border-blue-slice","8"),M("--border-green-slice","8"),M("--border-orange-red-slice","8")}}),(_,M)=>(I(),H("div",{ref_key:"diamondPanelRef",ref:S,class:"diamond-panel"},[c.value?(I(),H("div",r_,Q(r.value),1)):ve("",!0),p("div",l_,[p("div",{class:Je(["diamond","border-blue",{"diamond--disabled":d.value}]),onClick:E,title:d.value?"":"","aria-disabled":d.value?"true":"false"},[...M[0]||(M[0]=[p("div",{class:"diamond-content"},[p("div",{class:"diamond-text"},[p("div",{class:"diamond-label"},"")])],-1)])],10,c_),p("div",u_,[p("div",d_,[p("div",f_,[M[1]||(M[1]=p("div",{class:"diamond-label"},"",-1)),p("div",p_,Q(u.value),1)])])])]),p("div",h_,[p("div",m_,[p("div",g_,[p("div",__,[M[2]||(M[2]=p("div",{class:"diamond-label"},"",-1)),p("div",y_,Q(t.copperInfo.attack),1)])])]),p("div",v_,[p("div",w_,[p("div",b_,[M[3]||(M[3]=p("div",{class:"diamond-label"},"",-1)),p("div",S_,Q(t.copperInfo.defense),1)])])]),p("div",M_,[p("div",T_,[p("div",C_,[M[4]||(M[4]=p("div",{class:"diamond-label"},"",-1)),p("div",E_,Q(t.copperInfo.speed),1)])])])])],512))}},k_=mt(x_,[["__scopeId","data-v-94197fa6"]]),A_={class:"minecraft-inventory"},R_={class:"inventory-layout"},$_={class:"inventory-section"},P_={class:"equipment-header-mc"},L_={class:"copper-name"},I_={class:"inventory-grid"},O_={class:"slot-icon"},D_=["src","alt"],N_=["src"],G_=["src"],H_={key:3,class:"equipment-icon"},U_={class:"slot-tooltip"},F_={class:"tooltip-name"},B_={__name:"InventoryModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},equipment:{type:Array,default:()=>[]}},emits:["close"],setup(t,{emit:e}){const s=t,n=De(()=>s.equipment||[]),o=e;function a(){o("close")}return(i,r)=>t.visible?(I(),H("div",{key:0,class:"inventory-modal",onClick:bs(a,["self"])},[p("div",A_,[p("div",R_,[p("div",$_,[p("div",P_,[p("h4",null,[p("span",L_,Q(t.copperName),1),r[0]||(r[0]=Is("  ",-1))])]),p("div",I_,[(I(),H(Xe,null,qt(2,(l,c)=>{var u,d,h,m,g,E,S,_,M,b;return p("div",{key:c,class:Je(["inv-slot",{"has-item":c<n.value.length&&((u=n.value[c])==null?void 0:u.equipped),"slot-locked":(d=n.value[c])==null?void 0:d.locked}])},[c<n.value.length?(I(),H(Xe,{key:0},[p("div",O_,[(h=n.value[c])!=null&&h.equipped&&((m=n.value[c])!=null&&m.icon)&&n.value[c].icon!==""&&(n.value[c].icon.startsWith("/")||n.value[c].icon.startsWith("http")||n.value[c].icon.includes("."))?(I(),H("img",{key:0,src:n.value[c].icon,alt:((g=n.value[c])==null?void 0:g.name)||"",class:"equipment-icon"},null,8,D_)):(E=n.value[c])!=null&&E.locked?(I(),H("img",{key:1,src:ue(N)("@assets/ui/lock.png"),alt:"",class:"equipment-icon"},null,8,N_)):((S=n.value[c])==null?void 0:S.icon)===""?(I(),H("img",{key:2,src:ue(N)("@assets/ui/jia.png"),alt:"",class:"equipment-icon"},null,8,G_)):(I(),H("span",H_,Q(((_=n.value[c])==null?void 0:_.icon)||""),1))]),p("div",U_,[p("div",F_,Q(((M=n.value[c])==null?void 0:M.name)||((b=n.value[c])!=null&&b.locked?"":"")),1)])],64)):ve("",!0)],2)}),64))])])])])])):ve("",!0)}},j_=mt(B_,[["__scopeId","data-v-87970a7f"]]),z_={class:"health-bar","aria-label":"Health Bar"},V_={class:"health-bar__border"},W_={class:"health-bar__border-left"},K_=["src"],q_={class:"health-bar__border-right"},X_=["src"],Y_={class:"health-bar__text"},J_={__name:"HealthBar",props:{hp:{type:Number,default:0},maxHp:{type:Number,default:100}},setup(t){Xt(l=>({v3bf30af6:o,v3ceb41be:a}));const e=t,s=N("ui/blood-border-left.png"),n=N("ui/blood-border-right.png"),o=`url('${N("ui/blood-border-middle.png")}')`,a=`url('${N("ui/blood-bar.png")}')`,i=De(()=>{if(!e.maxHp||e.maxHp===0)return 0;const c=Math.max(0,Math.min(e.hp,e.maxHp))/e.maxHp*100;return Math.max(0,Math.min(100,c))}),r=De(()=>{const l=Math.max(0,Math.min(e.hp,e.maxHp)),c=e.maxHp||100;return`${Math.round(l)}/${Math.round(c)}`});return(l,c)=>(I(),H("div",z_,[p("div",V_,[p("div",W_,[p("img",{src:ue(s),alt:""},null,8,K_)]),c[0]||(c[0]=p("div",{class:"health-bar__border-middle"},null,-1)),p("div",q_,[p("img",{src:ue(n),alt:""},null,8,X_)]),p("div",{class:"health-bar__fill",style:zt({width:`calc(${i.value}% + 20px)`})},null,4),p("div",Y_,Q(r.value),1)])]))}},Z_=mt(J_,[["__scopeId","data-v-7b5f9ec2"]]),Q_={class:"tri-panel"},ey={class:"diamond","aria-label":""},ty=["src"],sy=["src"],ny=["title"],oy=["src"],ay=["src"],iy=["title"],ry=["src"],ly=["src","alt"],cy={__name:"TriPanel",props:{copperType:{type:String,default:""},canMove:{type:Boolean,default:!0},canAttack:{type:Boolean,default:!0},canSummon:{type:Boolean,default:!1}},emits:["move","wait","attack","summon","build"],setup(t,{emit:e}){const s=t,n=e,o=De(()=>s.copperType==="CraftsMan"?"build":s.copperType==="Resonator"?"summon":"attack"),a=De(()=>o.value==="build"?s.canSummon?"":"":o.value==="summon"?s.canSummon?"":"":s.canAttack?"":""),i=De(()=>o.value==="build"||o.value==="summon"?!s.canSummon:!s.canAttack),r=N("ui/your-image.png"),l=N("ui/boot.png"),c=N("ui/mushroom.png"),u=N("ui/sword.png"),d=N("@assets/ui/summon.png"),h=N("@assets/ui/build.png");function m(){s.canMove&&n("move")}function g(){n("wait")}function E(){if(o.value==="build"){if(!s.canSummon)return;n("build")}else if(o.value==="summon"){if(!s.canSummon)return;n("summon")}else{if(!s.canAttack)return;n("attack")}}return(S,_)=>(I(),H("div",Q_,[p("div",ey,[p("div",{class:"hex top",title:"",onClick:g},[p("img",{class:"hex-bg",src:ue(r),alt:""},null,8,ty),p("img",{class:"hex-icon",src:ue(l),alt:""},null,8,sy)]),p("div",{class:Je(["hex left",{"is-locked":t.canMove===!1}]),title:t.canMove?"":"",onClick:m},[p("img",{class:"hex-bg",src:ue(r),alt:""},null,8,oy),p("img",{class:"hex-icon",src:ue(c),alt:""},null,8,ay)],10,ny),p("div",{class:Je(["hex right",{"is-locked":i.value}]),title:a.value,onClick:E},[p("img",{class:"hex-bg",src:ue(r),alt:""},null,8,ry),p("img",{class:"hex-icon",src:o.value==="build"?ue(h):o.value==="summon"?ue(d):ue(u),alt:o.value==="build"?"":o.value==="summon"?"":""},null,8,ly)],10,iy)])]))}},uy=mt(cy,[["__scopeId","data-v-38a09e87"]]),dy={class:"modal-header"},fy=["src"],py={class:"modal-info"},hy={class:"info-text"},my={class:"copper-name"},gy={class:"modal-body"},_y={class:"structure-list"},yy=["onClick"],vy={class:"structure-header"},wy={class:"structure-name-row"},by={class:"structure-name"},Sy={class:"structure-type"},My={class:"structure-stats"},Ty={class:"stat"},Cy={class:"stat-value"},Ey={class:"stat"},xy={class:"stat-value"},ky={class:"stat"},Ay={class:"stat-value"},Ry={class:"stat"},$y={class:"stat-value"},Py={class:"structure-cost"},Ly={class:"cost-value"},Iy={class:"structure-desc"},Oy={key:0,class:"selected-badge"},Dy={class:"modal-footer"},Ny=["disabled"],Gy={__name:"BuildModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},structureList:{type:Array,default:()=>[]},position:{type:Array,default:null}},emits:["close","build"],setup(t,{emit:e}){Xt(S=>({b71f15e0:d,v26ebd2fa:g,v26e918c0:m,v26ea017e:h,b71e2d22:E}));const s=t,n=e,o=V(null),a=De(()=>[...s.structureList].sort((S,_)=>{const M=b=>{var L;const v=((L=b.cost)==null?void 0:L.cost)||b.cost;return!Array.isArray(v)||v.length===0?0:Array.isArray(v[0])?v[0][1]:v[0].count};return M(S)-M(_)}));function i(S){o.value=S}function r(){if(!o.value){f("[BuildModal] ");return}f("[BuildModal] :",o.value.name),n("build",o.value.name),l()}function l(){o.value=null,n("close")}function c(S){return{:"",:"",:"",:""}[S]||""}function u(S){if(!S)return"";const _=S.cost||S;return!Array.isArray(_)||_.length===0?"":_.map(M=>{var b;if(Array.isArray(M)){const v=M[0],L=M[1];return`${((b=Zt[v])==null?void 0:b.name)||v} x${L}`}return`${Ya(M)} x${M.count}`}).join(", ")}const d=`url('${N("@assets/ui/panel11.png")}')`,h=`url('${N("@assets/ui/panel7.png")}')`,m=`url('${N("@assets/ui/panel8.png")}')`,g=`url('${N("@assets/ui/panel5.png")}')`,E=`url('${N("@assets/ui/panel12.png")}')`;return(S,_)=>(I(),Dt(ol,{to:"body"},[t.visible?(I(),H("div",{key:0,class:"modal-overlay",onClick:bs(l,["self"])},[p("div",{class:"build-modal",onClick:_[0]||(_[0]=bs(()=>{},["stop"]))},[p("div",dy,[_[1]||(_[1]=p("h2",{class:"modal-title"}," ",-1)),p("button",{class:"close-btn",onClick:l,title:""},[p("img",{src:ue(N)("@assets/ui/close.png"),alt:""},null,8,fy)])]),p("div",py,[p("p",hy,[p("span",my,Q(t.copperName),1),_[2]||(_[2]=Is("  ",-1))]),_[3]||(_[3]=p("p",{class:"tip-text"},"   ",-1))]),p("div",gy,[p("div",_y,[(I(!0),H(Xe,null,qt(a.value,M=>{var b,v,L;return I(),H("div",{key:M.name,class:Je(["structure-card",{selected:((b=o.value)==null?void 0:b.name)===M.name}]),onClick:F=>i(M)},[p("div",vy,[p("div",wy,[p("span",by,Q(M.name),1)]),p("span",Sy,Q(c(M.name)),1)]),p("div",My,[p("div",Ty,[_[4]||(_[4]=p("span",{class:"stat-label"},"",-1)),p("span",Cy,Q(M.health),1)]),p("div",Ey,[_[5]||(_[5]=p("span",{class:"stat-label"},"",-1)),p("span",xy,Q(((v=M.attribute)==null?void 0:v.attack)||""),1)]),p("div",ky,[_[6]||(_[6]=p("span",{class:"stat-label"},"",-1)),p("span",Ay,Q(M.has_storage?"":""),1)]),p("div",Ry,[_[7]||(_[7]=p("span",{class:"stat-label"},"",-1)),p("span",$y,Q(M.attack_range||""),1)])]),p("div",Py,[_[8]||(_[8]=p("span",{class:"cost-label"}," ",-1)),p("span",Ly,Q(u(M.cost)),1)]),p("div",Iy,Q(M.description),1),((L=o.value)==null?void 0:L.name)===M.name?(I(),H("div",Oy,"  ")):ve("",!0)],10,yy)}),128))])]),p("div",Dy,[p("button",{class:"btn btn-cancel",onClick:l},""),p("button",{class:"btn btn-confirm",disabled:!o.value,onClick:r},"  ",8,Ny)])])])):ve("",!0)]))}},Hy=mt(Gy,[["__scopeId","data-v-96b14c10"]]),Uy={key:0,class:"copper-panel-parent"},Fy={key:0,class:"minimized-content"},By=["src"],jy={class:"minimized-info"},zy={class:"minimized-name"},Vy={class:"minimized-action"},Wy=["src"],Ky={class:"panel-content"},qy={key:0,class:"resources"},Xy={class:"resources-list"},Yy=["onClick"],Jy={class:"resource-name"},Zy={class:"resource-count"},Qy={key:2,class:"enemy-info-tip"},ev={__name:"ActionPanel",props:{copper:{type:Object,default:null},resources:{type:Array,default:()=>[]},hasAttackTargets:{type:Boolean,default:!0},onSelectCopper:{type:Function,default:null}},emits:["close","action","selectCopper"],setup(t,{expose:e,emit:s}){Xt(z=>({a4d8c7e2:a.value,e0fd0632:i.value,v58bba3fc:r.value,v1ac48a75:l.value,v27e0a61e:u.value,v0e219880:c.value}));const n=t,o=s,a=De(()=>`url('${N("ui/sword.png")}')`),i=De(()=>`url('${N("ui/red.png")}')`),r=De(()=>`url('${N("ui/boot.png")}')`),l=De(()=>`url('${N("ui/green.png")}')`),c=De(()=>`url('${N("@assets/ui/build.png")}')`),u=De(()=>`url('${N("@assets/ui/summon.png")}')`),d=N("@assets/ui/close.png"),h=V("full"),m=V(null),g=V(!1),E=V(!1),S=V([]),_=De(()=>{var O,X,oe,Pe,Fe,Ue,Ne,Qe,at,st,Pt,w,T,x,B,D,G,ie,Y,U,K,fe,le,pe,he,Re,be,Me,ce,Ve,nt,ct,Ht,hs,rt;if(!n.copper)return null;const z=((X=(O=n.copper.copper)==null?void 0:O.copper_info)==null?void 0:X.name)||((Pe=(oe=n.copper.enemy)==null?void 0:oe.enemy_base)==null?void 0:Pe.name)||((Fe=n.copper.enemy_base)==null?void 0:Fe.name)||n.copper.name||` #${n.copper.id}`;return{id:n.copper.id,name:z,level:((Ue=n.copper.copper)==null?void 0:Ue.level)??((Ne=n.copper.enemy)==null?void 0:Ne.level)??((Qe=n.copper.enemy_base)==null?void 0:Qe.level)??1,hp:n.copper.now_health,maxHp:((st=(at=n.copper.copper)==null?void 0:at.attribute)==null?void 0:st.health)??((w=(Pt=n.copper.enemy)==null?void 0:Pt.enemy_base)==null?void 0:w.health)??((T=n.copper.enemy_base)==null?void 0:T.health)??100,attack:((B=(x=n.copper.copper)==null?void 0:x.attribute)==null?void 0:B.attack)??((G=(D=n.copper.enemy)==null?void 0:D.enemy_base)==null?void 0:G.attack)??((ie=n.copper.enemy_base)==null?void 0:ie.attack)??0,defense:((U=(Y=n.copper.copper)==null?void 0:Y.attribute)==null?void 0:U.defense)??((fe=(K=n.copper.enemy)==null?void 0:K.enemy_base)==null?void 0:fe.defense)??((le=n.copper.enemy_base)==null?void 0:le.defense)??0,speed:((he=(pe=n.copper.copper)==null?void 0:pe.attribute)==null?void 0:he.speed)??((be=(Re=n.copper.enemy)==null?void 0:Re.enemy_base)==null?void 0:be.speed)??((Me=n.copper.enemy_base)==null?void 0:Me.speed)??0,canMove:n.copper.can_move,canAttack:n.copper.can_attack,canSummon:n.copper.can_summon,position:Array.isArray(n.copper.position)&&n.copper.position.length>=2?n.copper.position:Array.isArray((ce=n.copper.enemy)==null?void 0:ce.position)&&n.copper.enemy.position.length>=2?n.copper.enemy.position:Array.isArray((Ve=n.copper.enemy_base)==null?void 0:Ve.position)&&n.copper.enemy_base.position.length>=2?n.copper.enemy_base.position:[0,0],inventoryCapacity:((nt=n.copper.inventory)==null?void 0:nt.capacity)||0,copperType:((ct=n.copper.copper)==null?void 0:ct.copper_type)||((hs=(Ht=n.copper.enemy)==null?void 0:Ht.enemy_base)==null?void 0:hs.enemy_type)||((rt=n.copper.enemy_base)==null?void 0:rt.enemy_type)||"",isOwnedEnemy:n.copper.isOwnedEnemy===!0,isEnemy:n.copper.isEnemy===!0}}),M=De(()=>{var oe,Pe,Fe,Ue,Ne;if(!n.copper)return[];const z=((oe=n.copper.copper)==null?void 0:oe.equipment_slot)||{},O=(z==null?void 0:z.slot1)||null,X=(z==null?void 0:z.slot2)||null;return[O?{name:((Pe=O.equipment_base)==null?void 0:Pe.name)||"",icon:N(((Fe=O.equipment_base)==null?void 0:Fe.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1},z!=null&&z.is_slot2_locked?{name:"",icon:"",equipped:!1,locked:!0}:X?{name:((Ue=X.equipment_base)==null?void 0:Ue.name)||"",icon:N(((Ne=X.equipment_base)==null?void 0:Ne.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1}]});Gt(()=>{var z;return(z=n.copper)==null?void 0:z.id},(z,O)=>{z!==O&&(h.value="full",m.value=null,g.value=!1,E.value=!1)});async function b(){if(!_.value.canMove)return;f("[ActionPanel] ");const z=n.copper.isOwnedEnemy===!0,O=z?"on_enemy_move_start":"on_move_start";f(`[ActionPanel] : ${z?"":""}, : ${O}`);const X=JSON.stringify({type:O,content:{id:String(_.value.id)}});await xe(X),h.value="minimized",m.value="moving",o("action",{type:"moveStart",copperId:_.value.id})}async function v(){if(f("[ActionPanel] ",{canAttack:_.value.canAttack,copperId:_.value.id,name:_.value.name}),!_.value.canAttack){f("[ActionPanel] : ");return}f("[ActionPanel] ");const z=n.copper.isOwnedEnemy===!0,O=z?"on_enemy_attack_start":"on_attack_start";f(`[ActionPanel] : ${z?"":""}, : ${O}`);const X=JSON.stringify({type:O,content:{id:String(_.value.id)}});await xe(X),h.value="minimized",m.value="attacking",o("action",{type:"attackStart",copperId:_.value.id})}async function L(){if(f("[ActionPanel] ",{canSummon:_.value.canSummon,copperId:_.value.id,name:_.value.name}),!_.value.canSummon){f("[ActionPanel] : ");return}f("[ActionPanel] ");const z=JSON.stringify({type:"on_summon_start",content:{id:String(_.value.id)}});await xe(z),h.value="minimized",m.value="summoning",o("action",{type:"summonStart",copperId:_.value.id})}async function F(){if(f("[ActionPanel] ",{copperId:_.value.id,name:_.value.name}),!_.value.canSummon){f("[ActionPanel] : /");return}o("action",{type:"buildRequest",copperId:_.value.id})}function j(z){f("[ActionPanel] ",(z==null?void 0:z.length)||0,""),S.value=z||[],E.value=!0}async function re(z){f("[ActionPanel] :",z),E.value=!1;const O=JSON.stringify({type:"on_structure_build_start",content:{id:String(_.value.id),name:z}});await xe(O),h.value="minimized",m.value="building",o("action",{type:"buildStart",copperId:_.value.id,structureName:z})}function W(){f("[ActionPanel] "),g.value=!0}async function q(z){f(`[ActionPanel] : index=${z}`);const O=JSON.stringify({type:"on_copper_pick_up",content:{id:String(_.value.id),index:String(z)}});await xe(O),await ne()}async function se(){f("[ActionPanel] ");const z=JSON.stringify({type:"on_copper_craft",content:{id:String(_.value.id)}});await xe(z),await ne()}async function A(){await se()}async function ne(){const O=n.copper.isOwnedEnemy===!0?"on_click_enemy":"on_click_copper",X=JSON.stringify({type:O,content:{id:String(_.value.id)}});await xe(X)}function Ie(){f("[ActionPanel] "),o("action",{type:"wait",copperId:_.value.id})}function Se(){h.value="full",m.value=null,g.value=!1,o("close")}function we(){g.value=!1}function J(){h.value="full",m.value=null,o("action",{type:"cancel",copperId:_.value.id})}function $(){J(),Se()}async function de(z){n.onSelectCopper?await n.onSelectCopper(z):o("selectCopper",z)}return e({cancelAction:J,handleSelectCopper:de,showBuildMenu:j}),(z,O)=>{var X,oe,Pe,Fe,Ue,Ne,Qe,at;return I(),H(Xe,null,[t.copper?(I(),H("div",Uy,[tt(k_,{"copper-info":_.value,"inventory-items":[],"inventory-capacity":5,onInventoryClick:W},null,8,["copper-info"]),tt(Z_,{hp:((X=_.value)==null?void 0:X.hp)||0,"max-hp":((oe=_.value)==null?void 0:oe.maxHp)||100},null,8,["hp","max-hp"]),h.value==="minimized"||t.resources&&t.resources.length>0&&h.value==="full"?(I(),H("div",{key:0,class:Je(["copper-panel",{"copper-panel--minimized":h.value==="minimized","copper-panel--min-attack":h.value==="minimized"&&m.value==="attacking","copper-panel--min-move":h.value==="minimized"&&m.value==="moving","copper-panel--min-summon":h.value==="minimized"&&m.value==="summoning","copper-panel--min-build":h.value==="minimized"&&m.value==="building"}]),onClick:O[0]||(O[0]=bs(()=>{},["stop"]))},[h.value==="minimized"?(I(),H("div",Fy,[p("button",{class:"minimized-close",type:"button",onClick:$,title:""},[p("img",{src:ue(d),alt:""},null,8,By)]),p("div",jy,[p("span",zy,Q(_.value.name),1),p("span",Vy,Q(m.value==="moving"?"...":m.value==="attacking"?"...":m.value==="summoning"?"...":m.value==="building"?"...":""),1)])])):(I(),H(Xe,{key:1},[p("button",{class:"close-btn",onClick:Se,title:""},[p("img",{src:ue(d),alt:""},null,8,Wy)]),p("div",Ky,[t.resources&&t.resources.length>0?(I(),H("div",qy,[O[3]||(O[3]=p("div",{class:"resources-header"}," ",-1)),p("div",Xy,[(I(!0),H(Xe,null,qt(t.resources,(st,Pt)=>(I(),H("div",{key:Pt,class:"resource-item",onClick:w=>q(Pt),title:""},[p("span",Jy,Q(ue(Ya)(st)),1),p("span",Zy,"x"+Q(st.count||1),1),O[2]||(O[2]=p("span",{class:"resource-pickup"},"",-1))],8,Yy))),128))])])):ve("",!0)])],64))],2)):ve("",!0),n.copper.isEnemy?ve("",!0):(I(),Dt(uy,{key:1,"copper-type":(Pe=_.value)==null?void 0:Pe.copperType,"can-move":((Fe=_.value)==null?void 0:Fe.canMove)!==!1,"can-attack":((Ue=_.value)==null?void 0:Ue.canAttack)!==!1,"can-summon":((Ne=_.value)==null?void 0:Ne.canSummon)!==!1,onMove:b,onWait:Ie,onAttack:v,onSummon:L,onBuild:F},null,8,["copper-type","can-move","can-attack","can-summon"])),n.copper.isEnemy?(I(),H("div",Qy,[...O[4]||(O[4]=[p("span",null," ",-1)])])):ve("",!0)])):ve("",!0),tt(j_,{visible:g.value,"copper-name":((Qe=_.value)==null?void 0:Qe.name)||"",equipment:M.value,onClose:we,onCraft:A},null,8,["visible","copper-name","equipment"]),tt(Hy,{visible:E.value,"copper-name":((at=_.value)==null?void 0:at.name)||"","structure-list":S.value,onClose:O[1]||(O[1]=st=>E.value=!1),onBuild:re},null,8,["visible","copper-name","structure-list"])],64)}}},tv=mt(ev,[["__scopeId","data-v-3fc53dbe"]]),sv={class:"panel"},nv={class:"panel-inner"},ov={class:"section section-header"},av=["aria-label"],iv={class:"section section-body"},rv={class:"current-doll",role:"status","aria-live":"polite"},lv={key:0},cv={class:"section section-choices",role:"group","aria-label":"Character Queue"},uv=["aria-pressed","data-copper-id","title","onClick"],dv=["alt","src","data-default-src","data-selected-src"],fv={class:"actions"},pv=["disabled"],hv=["disabled"],mv={__name:"TurnSystem",props:{currentCopperId:{type:Number,default:null},copperList:{type:Array,default:()=>[]},roundNumber:{type:Number,default:1},isEnemyMoving:{type:Boolean,default:!1}},emits:["nextCopper","endRound","selectCopper"],setup(t,{emit:e}){Xt(M=>({v47a453cf:r,v1e3f2614:c,c03019fe:l,v4742a9d0:u,v0776a3a9:d,v9cd100b8:h,baf36480:m}));const s=t,n=e,o=V(null),a=N("ui/choice.png"),i=N("ui/choice-active.png"),r=`url('${N("ui/ribbon-left.png")}')`,l=`url('${N("ui/ribbon-middle.png")}')`,c=`url('${N("ui/ribbon-right.png")}')`,u=`url('${N("ui/panel.png")}')`,d=`url('${N("ui/round1.png")}')`,h=`url('${N("ui/currentcupper.png")}')`,m=`url('${N("ui/btn.png")}')`,g=De(()=>{if(!s.currentCopperId)return null;const M=s.copperList.find(b=>b.id===s.currentCopperId);return M?{id:M.id,name:M.name||` #${M.id}`,level:M.level??0,isSummon:M.type==="summon"}:null});function E(){n("nextCopper")}async function S(){const M=JSON.stringify({type:"on_game_round_pass"});await xe(M),n("endRound")}function _(M){n("selectCopper",M)}return $t(async()=>{if(!o.value)return;function M(v){return new Promise((L,F)=>{const j=new Image;j.onload=()=>L(j),j.onerror=re=>{f(":",v,re),F(re)},j.src=v})}function b(v,L){o.value&&(o.value.style.setProperty(v,String(L)),f(` CSS  ${v} = ${L}`))}try{const[v,L,F]=await Promise.all([M(N("ui/panel.png")),M(N("ui/btn.png")),M(N("ui/currentcupper.png"))]),j=Math.max(4,Math.round(v.naturalHeight/4)),re=Math.max(3,Math.round(L.naturalHeight/3)),W=Math.max(3,Math.round(F.naturalHeight/4));f(":",{panelSlice:j,btnSlice:re,currentSlice:W,currentImgSize:`${F.naturalWidth}x${F.naturalHeight}`}),b("--panel-slice",j),b("--btn-slice",re),b("--current-slice",W),setTimeout(()=>{const q=getComputedStyle(o.value);f("CSS :",{"--current-slice":q.getPropertyValue("--current-slice"),"--panel-slice":q.getPropertyValue("--panel-slice"),"--btn-slice":q.getPropertyValue("--btn-slice")})},100)}catch(v){f(":",v),b("--panel-slice","8"),b("--btn-slice","11"),b("--current-slice","8")}}),(M,b)=>(I(),H("div",{ref_key:"turnSystemRef",ref:o,class:"turn-system"},[b[0]||(b[0]=p("div",{class:"ribbon","aria-hidden":"true"},[p("div",{class:"ribbon-cap left"}),p("div",{class:"ribbon-fill"},"CONTROL"),p("div",{class:"ribbon-cap right"})],-1)),p("div",sv,[p("div",nv,[p("section",ov,[p("div",{class:"round-header",role:"img","aria-label":`Round ${t.roundNumber}`}," Round "+Q(t.roundNumber),9,av)]),p("section",iv,[p("div",rv,[p("span",null,Q(g.value?`${g.value.name||` #${t.currentCopperId}`}`:""),1),g.value&&!g.value.isSummon?(I(),H("span",lv," Lv."+Q(g.value.level??0)+" ",1)):ve("",!0)])]),p("section",cv,[(I(!0),H(Xe,null,qt(t.copperList,v=>(I(),H("button",{key:v.id,class:"choice",type:"button","aria-pressed":String(v.id===t.currentCopperId),"data-copper-id":v.id,title:v.name||` #${v.id}`,onClick:L=>_(v.id)},[p("img",{alt:v.name||`Character ${v.id}`,src:v.id===t.currentCopperId?ue(i):ue(a),"data-default-src":ue(a),"data-selected-src":ue(i)},null,8,dv)],8,uv))),128))])])]),p("div",fv,[p("button",{class:"btn btn-primary",onClick:E,disabled:!t.currentCopperId||t.isEnemyMoving},"  ",8,pv),p("button",{class:"btn btn-secondary",onClick:S,disabled:t.isEnemyMoving},"  ",8,hv)])],512))}},gv=mt(mv,[["__scopeId","data-v-a62c4b3a"]]),_v={class:"modal-info"},yv={class:"info-text"},vv={class:"copper-name"},wv={class:"cost-text"},bv=["src"],Sv={class:"modal-body"},Mv={class:"enemy-list"},Tv=["onClick"],Cv={class:"enemy-header"},Ev={class:"enemy-name-row"},xv={class:"enemy-name"},kv={class:"enemy-level"},Av={class:"enemy-type"},Rv={class:"enemy-stats"},$v={class:"stat"},Pv={class:"stat-value"},Lv={class:"stat"},Iv={class:"stat-value"},Ov={class:"stat"},Dv={class:"stat-value"},Nv={class:"stat"},Gv={class:"stat-value"},Hv={class:"stat"},Uv={class:"stat-value"},Fv={class:"enemy-desc"},Bv={key:0,class:"selected-badge"},jv={class:"modal-footer"},zv=["disabled"],Vv={__name:"SummonModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},enemyList:{type:Array,default:()=>[]},position:{type:Array,default:null}},emits:["close","summon"],setup(t,{emit:e}){Xt(d=>({v30033463:s}));const s=`url('${N("@assets/ui/panel6.png")}')`,n=t,o=e,a=V(null),i=De(()=>[...n.enemyList].sort((d,h)=>d.level-h.level));function r(d){a.value=d}function l(){if(!a.value){f("[SummonModal] ");return}f("[SummonModal] :",a.value.name),o("summon",a.value.name),c()}function c(){a.value=null,o("close")}function u(d){return{goblin:"",cruiser:"",scout:"",boxer:"",horn:"",assassin:"",devourer:"",mirror:"",guard:"",demon:"",variant:"",shatra:"BOSS",glutton:"BOSS"}[d]||d}return(d,h)=>(I(),Dt(ol,{to:"body"},[t.visible?(I(),H("div",{key:0,class:"modal-overlay",onClick:bs(c,["self"])},[p("div",{class:"summon-modal",onClick:h[0]||(h[0]=bs(()=>{},["stop"]))},[p("div",{class:"modal-header"},[h[1]||(h[1]=p("h2",{class:"modal-title"}," ",-1)),p("button",{class:"close-btn",onClick:c,title:""},"")]),p("div",_v,[p("p",yv,[p("span",vv,Q(t.copperName),1),h[2]||(h[2]=Is("  ",-1))]),p("p",wv,[p("img",{class:"cost-icon",src:ue(N)("resource/spiritual_spark.webp"),alt:""},null,8,bv),h[3]||(h[3]=Is(" ",-1)),h[4]||(h[4]=p("strong",null,"1 ",-1))])]),p("div",Sv,[p("div",Mv,[(I(!0),H(Xe,null,qt(i.value,m=>{var g,E;return I(),H("div",{key:m.name,class:Je(["enemy-card",{selected:((g=a.value)==null?void 0:g.name)===m.name}]),onClick:S=>r(m)},[p("div",Cv,[p("div",Ev,[p("span",xv,Q(m.name),1),p("span",kv,"Lv."+Q(m.level),1)]),p("span",Av,Q(u(m.enemy_type)),1)]),p("div",Rv,[p("div",$v,[h[5]||(h[5]=p("span",{class:"stat-label"},"",-1)),p("span",Pv,Q(m.health),1)]),p("div",Lv,[h[6]||(h[6]=p("span",{class:"stat-label"},"",-1)),p("span",Iv,Q(m.attack),1)]),p("div",Ov,[h[7]||(h[7]=p("span",{class:"stat-label"},"",-1)),p("span",Dv,Q(m.defense),1)]),p("div",Nv,[h[8]||(h[8]=p("span",{class:"stat-label"},"",-1)),p("span",Gv,Q(m.attack_range),1)]),p("div",Hv,[h[9]||(h[9]=p("span",{class:"stat-label"},"",-1)),p("span",Uv,Q(m.move_range),1)])]),p("div",Fv,Q(m.description),1),((E=a.value)==null?void 0:E.name)===m.name?(I(),H("div",Bv,"   ")):ve("",!0)],10,Tv)}),128))])]),p("div",jv,[p("button",{class:"btn btn-cancel",onClick:c},""),p("button",{class:"btn btn-confirm",disabled:!a.value,onClick:l},"  ",8,zv)])])])):ve("",!0)]))}},Wv=mt(Vv,[["__scopeId","data-v-4a0a4142"]]),Kv={key:0,class:"minimized-content"},qv={class:"minimized-info"},Xv={class:"minimized-name"},Yv={class:"minimized-action"},Jv={key:1},Zv={class:"structure-panel__header"},Qv={class:"structure-panel__title"},e0={class:"structure-panel__body"},t0={class:"structure-panel__health"},s0={class:"structure-panel__health-bar"},n0={class:"structure-panel__health-text"},o0={key:0,class:"structure-panel__storage"},a0={class:"structure-panel__storage-content"},i0={key:0,class:"structure-panel__storage-item"},r0={class:"structure-panel__storage-name"},l0={class:"structure-panel__storage-count"},c0={key:1,class:"structure-panel__storage-empty"},u0={key:1,class:"structure-panel__ground-resources"},d0={class:"structure-panel__ground-list"},f0={class:"structure-panel__resource-name"},p0={class:"structure-panel__resource-count"},h0={key:2,class:"structure-panel__actions"},m0={__name:"StructurePanel",props:{structure:{type:Object,required:!0},resources:{type:Array,default:()=>[]},actionMode:{type:String,default:null}},emits:["close","action","cancel"],setup(t,{emit:e}){Xt(v=>({v31b4b180:g}));const s=t,n=e,o=De(()=>{var v;return((v=s.structure.structure_base)==null?void 0:v.name)||""}),a=De(()=>s.structure.owned||!1),i=De(()=>{var v;return((v=s.structure.structure_base)==null?void 0:v.has_storage)||!1}),r=De(()=>s.structure.storage||null),l=De(()=>s.structure.can_move||!1),c=De(()=>s.structure.can_attack||!1),u=De(()=>s.structure.now_health||0),d=De(()=>{var v;return((v=s.structure.structure_base)==null?void 0:v.health)||100}),h=De(()=>d.value===0?0:Math.max(0,Math.min(100,u.value/d.value*100))),m=De(()=>{const v=h.value;return v>60?"#4ade80":v>30?"#facc15":"#ef4444"});N("@assets/ui/panel.png");const g=`url('${N("@assets/ui/panel11.png")}')`,E=De(()=>s.actionMode!==null),S=De(()=>s.actionMode==="move"?"...":s.actionMode==="attack"?"...":s.actionMode==="extract"?"...":s.actionMode==="transfer"?"...":"");function _(v){f(`[StructurePanel] : ${v}`),n("action",{type:v})}function M(){f("[StructurePanel] "),n("cancel")}function b(){n("close")}return(v,L)=>(I(),H("div",{class:Je(["structure-panel",{"structure-panel--minimized":E.value}])},[E.value?(I(),H("div",Kv,[p("div",qv,[p("span",Xv,Q(o.value),1),p("span",Yv,Q(S.value),1)]),p("div",{class:"minimized-actions"},[p("button",{class:"mini-btn mini-btn--cancel",onClick:M,title:""},"  ")])])):(I(),H("div",Jv,[p("div",Zv,[p("div",Qv,[Is(Q(o.value)+" ",1),p("span",{class:Je(["structure-panel__badge",{"structure-panel__badge--owned":a.value}])},Q(a.value?"":""),3)]),p("button",{class:"structure-panel__close",onClick:b,"aria-label":""},"  ")]),p("div",e0,[p("div",t0,[L[4]||(L[4]=p("div",{class:"structure-panel__health-label"},"",-1)),p("div",s0,[p("div",{class:"structure-panel__health-fill",style:zt({width:h.value+"%",backgroundColor:m.value})},null,4)]),p("div",n0,Q(Math.ceil(u.value))+" / "+Q(Math.ceil(d.value)),1)]),i.value?(I(),H("div",o0,[L[5]||(L[5]=p("div",{class:"structure-panel__storage-label"},"",-1)),p("div",a0,[r.value?(I(),H("div",i0,[p("span",r0,Q(ue(Ya)(r.value)),1),p("span",l0,"x"+Q(r.value.count||0),1)])):(I(),H("div",c0,""))])])):ve("",!0),t.resources&&t.resources.length>0?(I(),H("div",u0,[L[6]||(L[6]=p("div",{class:"structure-panel__ground-label"},"",-1)),p("div",d0,[(I(!0),H(Xe,null,qt(t.resources,(F,j)=>(I(),H("div",{key:j,class:"structure-panel__ground-item"},[p("span",f0,Q(F.name||""),1),p("span",p0,"x"+Q(F.count||0),1)]))),128))])])):ve("",!0),a.value?(I(),H("div",h0,[l.value?(I(),H("button",{key:0,class:"structure-panel__action-btn structure-panel__action-btn--move",onClick:L[0]||(L[0]=F=>_("move"))},"  ")):ve("",!0),c.value?(I(),H("button",{key:1,class:"structure-panel__action-btn structure-panel__action-btn--attack",onClick:L[1]||(L[1]=F=>_("attack"))},"  ")):ve("",!0),i.value&&r.value?(I(),H("button",{key:2,class:"structure-panel__action-btn structure-panel__action-btn--transfer",onClick:L[2]||(L[2]=F=>_("transfer"))},"  ")):ve("",!0),i.value?(I(),H("button",{key:3,class:"structure-panel__action-btn structure-panel__action-btn--extract",onClick:L[3]||(L[3]=F=>_("extract"))},"  ")):ve("",!0)])):ve("",!0)])]))],2))}},g0=mt(m0,[["__scopeId","data-v-c3c198e2"]]),_0={class:"resource-panel"},y0={class:"resource-list"},v0={class:"resource-layout"},w0={class:"row row-top"},b0=["title"],S0=["src","alt"],M0={class:"resource-count"},T0={class:"resource-tooltip"},C0=["title"],E0=["src","alt"],x0={class:"resource-count"},k0={class:"resource-tooltip"},A0={class:"row row-middle"},R0=["title"],$0=["src","alt"],P0={class:"resource-count"},L0={class:"resource-tooltip"},I0={class:"row row-bottom"},O0=["title"],D0=["src","alt"],N0={class:"resource-count"},G0={class:"resource-tooltip"},H0=["title"],U0=["src","alt"],F0={class:"resource-count"},B0={class:"resource-tooltip"},j0={class:"crafting-section"},z0={class:"crafting-grid"},V0=["src"],W0={class:"craft-count"},K0={class:"craft-arrow-group"},q0=["src","alt"],X0={class:"craft-result"},Y0={class:"recipe-display"},J0=["src"],Z0={class:"craft-count"},Q0={__name:"ResourcePanel",setup(t,{expose:e}){Xt(d=>({v6e6b9dca:n}));const n=`url('${N("@assets/ui/panel5.png")}')`,o=V({SpiritalSpark:0,RecallGear:0,ResonantCrystal:0,RefinedCopper:0,HeartCrystalDust:0}),a=["HeartCrystalDust","RecallGear","ResonantCrystal","RefinedCopper"],i=V(!1),r=V({visible:!1,success:!0,text:""});function l(d,h=!0,m=1500){r.value={visible:!0,success:h,text:d},window.clearTimeout(l._timer),l._timer=window.setTimeout(()=>{r.value.visible=!1},m)}async function c(){if(!i.value){i.value=!0;try{const d=await ep();Ws(Ot.UPDATE_RESOURCES),(d==null?void 0:d.type)==="error"?(console.warn("[ResourcePanel] :",(d==null?void 0:d.content)||d),l("",!1)):(console.log("[ResourcePanel] :",d),l("",!0))}catch(d){console.error("[ResourcePanel] :",d),l("",!1)}finally{i.value=!1}}}async function u(){try{const d=await No();if(d){const h={},m={};return Object.keys(o.value).forEach(g=>{const E=o.value[g],S=d[g]||0;m[g]=S;const _=S-E;_>0&&(h[g]=_)}),o.value=m,Ws(Ot.RESOURCES_UPDATED,h),h}}catch(d){console.error("[ResourcePanel] :",d)}return{}}return $t(()=>{u(),Do(Ot.UPDATE_RESOURCES,u)}),fs(()=>{Za(Ot.UPDATE_RESOURCES,u)}),e({updateResources:u}),(d,h)=>{var m;return I(),H("div",_0,[h[0]||(h[0]=p("div",{class:"resource-header"},[p("span",{class:"header-text"},"")],-1)),p("div",y0,[p("div",v0,[p("div",w0,[p("div",{class:"resource-slot small",title:ue(vt)("RecallGear")},[ue(os)("RecallGear")?(I(),H("img",{key:0,src:ue(os)("RecallGear"),alt:ue(vt)("RecallGear"),class:"resource-icon"},null,8,S0)):ve("",!0),p("div",M0,Q(o.value.RecallGear||0),1),p("div",T0,Q(ue(vt)("RecallGear")),1)],8,b0),p("div",{class:"resource-slot small",title:ue(vt)("HeartCrystalDust")},[ue(os)("HeartCrystalDust")?(I(),H("img",{key:0,src:ue(os)("HeartCrystalDust"),alt:ue(vt)("HeartCrystalDust"),class:"resource-icon"},null,8,E0)):ve("",!0),p("div",x0,Q(o.value.HeartCrystalDust||0),1),p("div",k0,Q(ue(vt)("HeartCrystalDust")),1)],8,C0)]),p("div",A0,[p("div",{class:"resource-slot large",title:ue(vt)("SpiritalSpark")},[ue(os)("SpiritalSpark")?(I(),H("img",{key:0,src:ue(os)("SpiritalSpark"),alt:ue(vt)("SpiritalSpark"),class:"resource-icon"},null,8,$0)):ve("",!0),p("div",P0,Q(o.value.SpiritalSpark||0),1),p("div",L0,Q(ue(vt)("SpiritalSpark")),1)],8,R0)]),p("div",I0,[p("div",{class:"resource-slot small",title:ue(vt)("ResonantCrystal")},[ue(os)("ResonantCrystal")?(I(),H("img",{key:0,src:ue(os)("ResonantCrystal"),alt:ue(vt)("ResonantCrystal"),class:"resource-icon"},null,8,D0)):ve("",!0),p("div",N0,Q(o.value.ResonantCrystal||0),1),p("div",G0,Q(ue(vt)("ResonantCrystal")),1)],8,O0),p("div",{class:"resource-slot small",title:ue(vt)("RefinedCopper")},[ue(os)("RefinedCopper")?(I(),H("img",{key:0,src:ue(os)("RefinedCopper"),alt:ue(vt)("RefinedCopper"),class:"resource-icon"},null,8,U0)):ve("",!0),p("div",F0,Q(o.value.RefinedCopper||0),1),p("div",B0,Q(ue(vt)("RefinedCopper")),1)],8,H0)])])]),p("div",j0,[p("div",z0,[(I(),H(Xe,null,qt(a,(g,E)=>{var S;return p("div",{class:"craft-slot",key:E},[(S=ue(Zt)[g])!=null&&S.icon?(I(),H("img",{key:0,src:ue(Zt)[g].icon,class:"craft-icon"},null,8,V0)):ve("",!0),p("div",W0,Q(o.value[g]||0),1)])}),64))]),p("div",K0,[p("img",{class:Je(["craft-arrow-img",{disabled:i.value}]),src:ue(N)("@assets/ui/upgrade.png"),alt:i.value?"":"",onClick:c},null,10,q0),r.value.visible?(I(),H("div",{key:0,class:Je(["craft-toast",{success:r.value.success,error:!r.value.success}])},Q(r.value.text),3)):ve("",!0)]),p("div",X0,[p("div",Y0,[(m=ue(Zt).SpiritalSpark)!=null&&m.icon?(I(),H("img",{key:0,src:ue(Zt).SpiritalSpark.icon,class:"recipe-icon"},null,8,J0)):ve("",!0),p("div",Z0,Q(o.value.SpiritalSpark||0),1)])])])])}}},ew=mt(Q0,[["__scopeId","data-v-f3ce41a7"]]),tw={class:"game-scene"},sw={key:6,class:"info-panel"},nw={key:7,class:"game-over-overlay"},ow={key:8,class:"game-over-overlay"},aw={key:9,class:"credits-overlay"},iw={key:10,class:"game-over-overlay"},rw=["src"],lw=["src"],cw=["src"],uw=["src"],dw=["src"],fw=["src"],pw=["src"],hw={__name:"GameScene",props:{isGameMode:{type:Boolean,default:!1},musicOn:{type:Boolean,default:!0}},emits:["back"],setup(t,{emit:e}){Xt(k=>({v3a52a000:Ac,v3a51b742:Rc}));const s=t,n=V(null),o=e,a=V(null),i=Jg("gameScene"),r=V(null),l=V(null),c=V(null),u=V(null),d=V(null),h=V(null),m=Js("move"),g=Js("moveEnemy"),E=Js("attack"),S=Js("attackEnemy"),_=Js("meHurt"),M=Js("enemyHurt");let b,v,L,F,j=[],W={focusPosition:null,focusTarget:null,lerpFactor:cr().focusLerpFactor},q=null,se=new Ct,A=null,ne=null,Ie=null;const Se=new Map,we={w:!1,a:!1,s:!1,d:!1,shift:!1,space:!1},$=cr().moveSpeed,de=V(ir("controlMode")||"touchpad"),z=V(ir("mouseSensitivity")||.002);window.updateControlMode=k=>{de.value=k,f(`[GameScene] : ${k}`)},window.updateMouseSensitivity=k=>{z.value=k};function O(k){const R=k.key.toLowerCase();R==="w"||R==="a"||R==="s"||R==="d"?we[R]=!0:R==="shift"?we.shift=!0:R===" "?(we.space=!0,k.preventDefault()):R==="escape"&&document.pointerLockElement&&document.exitPointerLock()}function X(k){const R=k.key.toLowerCase();R==="w"||R==="a"||R==="s"||R==="d"?we[R]=!1:R==="shift"?we.shift=!1:R===" "&&(we.space=!1)}let oe=!1,Pe=0,Fe=0,Ue=0,Ne=0,Qe=!1;function at(k){k.button===0&&(de.value==="mouse"&&n.value&&n.value.requestPointerLock(),oe=!0,Pe=k.clientX,Fe=k.clientY)}function st(){oe=!1}function Pt(k){if(de.value==="touchpad"){if(!oe)return;const R=k.clientX-Pe,te=k.clientY-Fe;Ne-=R*z.value,Ue-=te*z.value,Pe=k.clientX,Fe=k.clientY}else if(de.value==="mouse"&&Qe){const R=k.movementX||0,te=k.movementY||0;Ne-=R*z.value,Ue-=te*z.value}Ue=Math.max(-Math.PI/2,Math.min(Math.PI/2,Ue)),v.rotation.order="YXZ",v.rotation.y=Ne,v.rotation.x=Ue}function w(){Qe=document.pointerLockElement===n.value,f(Qe?"[GameScene] ":"[GameScene] ")}function T(){f("[GameScene] ")}const x=V(null),B=V([]),D=V(null),G=V(!1),ie=V([]),Y=V([]),U=V(null),K=V(null),fe=V(!1),le=V(null),pe=V([]),he=V(null),Re=V(1),be=V([]),Me=V(-1),ce=V(null),Ve=V(!1),nt=V(new Set),ct=V(!1),Ht=new Map,hs=V(!1),rt=V(!1),Mt=V(!1),Ds=V(!1),Bn=De(()=>{if(be.value.length===0||Me.value<0||Me.value>=be.value.length)return null;const k=be.value[Me.value];return k?k.id:null});$t(async()=>{var R;f("[GameScene] "),Jl(),f("[GameScene] "),tc(),f("[GameScene] ");const{messageQueue:k}=await Fl(async()=>{const{messageQueue:te}=await Promise.resolve().then(()=>Zf);return{messageQueue:te}},void 0,import.meta.url);if((R=k.sceneContext)!=null&&R.setTestMode&&k.sceneContext.setTestMode("eventloop"),window.__ACTUAL_COPPER_IDS__){const te=window.__ACTUAL_COPPER_IDS__;f("[GameScene] ID:",te);const ee=JSON.stringify({type:"on_game_start",content:{ids:te}});xe(ee).catch(me=>{f("[GameScene] ",me)}),delete window.__ACTUAL_COPPER_IDS__}else f("[GameScene] ID");window.addEventListener("keydown",O),window.addEventListener("keyup",X),window.addEventListener("mousedown",at),window.addEventListener("mouseup",st),window.addEventListener("mousemove",Pt),document.addEventListener("pointerlockchange",w),document.addEventListener("pointerlockerror",T),ti(),s.musicOn&&a.value&&setTimeout(()=>{if(a.value.readyState>=2)a.value.play().then(()=>{f("[GameScene] ")}).catch(ee=>{f("[GameScene] :",ee)});else{const ee=()=>{a.value.play().then(()=>{f("[GameScene] ")}).catch(me=>{f("[GameScene] :",me)}),a.value.removeEventListener("canplay",ee)};a.value.addEventListener("canplay",ee,{once:!0})}},200)}),Gt(()=>s.musicOn,k=>{if(a.value)if(k)if(a.value.readyState>=2)a.value.play().catch(R=>{f("[GameScene] :",R)});else{const R=()=>{a.value.play().catch(te=>{f("[GameScene] :",te)}),a.value.removeEventListener("canplay",R)};a.value.addEventListener("canplay",R)}else a.value.pause()}),fs(()=>{window.removeEventListener("resize",ei),window.removeEventListener("click",si),window.removeEventListener("keydown",O),window.removeEventListener("keyup",X),window.removeEventListener("mousedown",at),window.removeEventListener("mouseup",st),window.removeEventListener("mousemove",Pt),document.removeEventListener("pointerlockchange",w),document.removeEventListener("pointerlockerror",T),document.pointerLockElement&&document.exitPointerLock(),a.value&&a.value.pause(),A&&A.dispose(),ne&&ne.dispose(),Ie&&Ie.dispose(),b&&i_(b),L&&L.dispose()});function Jl(){b=new wo;const k=Pg();Qg(b,k),v=t_(),q=new di,L=s_(n.value),F=null;const R=Ug();e_(b,R),a_(b),n_(),s.isGameMode&&window.addEventListener("click",si),o_(b,j),A=Ag(b,v),ne=Wg(b),Ie=qg(b),f("[GameScene] "),f('[GameScene] - /(ID=1,2)""'),f("[GameScene] - EventLoop"),window.addEventListener("resize",ei)}async function Zl(k,R,te,ee=1){const me=Io(k,R);try{const y=await Ut.loadModel(me,!0);f(`[GameScene] : ${R}`);const C=y.clone(!0);C.traverse(_e=>{_e.material&&(Array.isArray(_e.material)?_e.material=_e.material.map(ye=>ye.clone()):_e.material=_e.material.clone())});const Z=new xt().setFromObject(C).getSize(new ke),ae=new Jt;ae.add(C),ae.position.set(te[0],0,te[1]),ae.scale.set(ee,ee,ee),ae.rotation.y=0;const ge=new xt().setFromObject(ae);return ae.position.y=-ge.min.y,f(`[GameScene] : ${R}, URL: ${me}`),ae}catch(y){return f(`[GameScene] : ${R}`,y),null}}async function Ql(k,R,te=1,ee="model"){try{const me=await Ut.loadModel(k,!0);f(`[GameScene] : ${ee}, url=${k}`);const y=me.clone(!0);y.traverse(ae=>{ae.material&&(Array.isArray(ae.material)?ae.material=ae.material.map(ge=>ge.clone()):ae.material=ae.material.clone())});const P=new xt().setFromObject(y).getSize(new ke),Z=new Jt;return Z.add(y),Z.position.set(R[0],0,R[1]),Z.scale.set(te,te,te),Z}catch(me){return f(`[GameScene] : ${ee}, url=${k}, error=${me}`),null}}async function ec(k,R,te=1){const ee=Oo(k);try{const me=await Ut.loadModel(ee,!0);f(`[GameScene] : ${k}`);const y=me.clone(!0);y.traverse(_e=>{_e.material&&(Array.isArray(_e.material)?_e.material=_e.material.map(ye=>ye.clone()):_e.material=_e.material.clone())});const P=new xt().setFromObject(y).getSize(new ke),Z=new Jt;Z.add(y),Z.position.set(R[0],0,R[1]),Z.scale.set(te,te,te),Z.rotation.y=0;const ae=new xt().setFromObject(Z);Z.position.y=-ae.min.y;const ge=new Qs(16729156,2.5,12);return ge.position.set(0,P.y*te*.8,0),Z.add(ge),f(`[GameScene] : ${k}, URL: ${ee}`),Z}catch(me){return f(`[GameScene] : ${k}`,me),null}}let jn=null;function tc(){const k=new Map,R=new Map,te=new Map;function ee(y,C,P){const Z=j.find(ye=>ye.id===y);if(!Z||!Z.object)return;let ae,ge;C==="move"?(ae=65280,ge=.8):C==="attack"?(ae=16711680,ge=1):C==="summon"?(ae=16776960,ge=1.2):(ae=16777215,ge=1),k.has(y)||k.set(y,{});const _e=k.get(y);if(_e[C]&&(b.remove(_e[C]),_e[C].geometry.dispose(),_e[C].material.dispose(),delete _e[C]),P){const ye=new fa(ge-.1,ge,32),$e=new ht({color:ae,side:Nt,transparent:!0,opacity:.6}),Le=new et(ye,$e);Le.rotation.x=-Math.PI/2,Le.position.set(Z.object.position.x,.1,Z.object.position.z),b.add(Le),_e[C]=Le}}const me=y=>{if(j.forEach(C=>{C.object&&(C.object.scale.set(1,1,1),C.object.traverse(P=>{var Z;P.material&&((Z=P.material.emissive)==null||Z.setHex(0),P.material.emissiveIntensity!==void 0&&(P.material.emissiveIntensity=0))}))}),y!==null){const C=j.find(P=>P.id===y);if(C){C.object.scale.set(1.1,1.1,1.1),C.object.traverse(Z=>{Z.material&&Z.material.emissive&&(Z.material.emissive.setHex(16755200),Z.material.emissiveIntensity=.5)});const P=C.type==="summon"?"":C.type==="copper"?"":"";f(`[GameScene] ${P}: ${C.name} (ID=${y})`)}}};jn=(y,C)=>{const P=j.find(lt=>lt.id===y);if(!P)return;const Z=new Map;P.object.traverse(lt=>{lt.material&&lt.material.emissive&&(Z.set(lt,{color:lt.material.emissive.getHex(),intensity:lt.material.emissiveIntensity||0}),lt.material.emissive.setHex(16711680),lt.material.emissiveIntensity=.8)}),setTimeout(()=>{Z.forEach((lt,Yt)=>{Yt.material&&Yt.material.emissive&&(Yt.material.emissive.setHex(lt.color),Yt.material.emissiveIntensity=lt.intensity)})},500);const ae=new ke(P.object.position.x,.5,P.object.position.z),ge=new ke(C[0],.5,C[1]),_e=new ke().subVectors(ge,ae),ye=_e.length(),$e=new ke().addVectors(ae,ge).multiplyScalar(.5),Le=new io(.05,.05,ye,8),Ce=new ht({color:16729156,transparent:!0,opacity:.9,emissive:16729156,emissiveIntensity:.5}),Oe=new et(Le,Ce);Oe.position.copy($e),Oe.quaternion.setFromUnitVectors(new ke(0,1,0),_e.normalize()),b.add(Oe);const Be=new fa(.2,.4,32),We=new ht({color:16711680,side:Nt,transparent:!0,opacity:.8,emissive:16711680,emissiveIntensity:.5}),yt=new et(Be,We);yt.rotation.x=-Math.PI/2,yt.position.copy(ge),b.add(yt);const Gs=performance.now(),ut=300;function dt(){const Yt=(performance.now()-Gs)/ut;if(Yt<1){const pn=1-Yt;Ce&&(Ce.opacity=pn),We&&(We.opacity=pn),yt.scale.set(1+Yt*2,1+Yt*2,1),requestAnimationFrame(dt)}else b.remove(Oe),b.remove(yt),Le.dispose(),Ce.dispose(),Be.dispose(),We.dispose()}dt(),f(`[GameScene] : ID=${y}, =${ae.x.toFixed(1)},${ae.z.toFixed(1)}  [${C[0]},${C[1]}]`)},Ee.setSceneContext({scene:b,camera:v,controls:F,models:j,gridCellSize:1,focusState:W,focusOnModel:sc,onShowCopperInfo:(y,C,P)=>{var ae,ge,_e,ye,$e,Le,Ce,Oe,Be,We,yt;f(`[GameScene] onShowCopperInfo : type=${(ae=y.copper)==null?void 0:ae.copper_type}, can_build=${y.can_build}, can_summon=${y.can_summon}`),((ge=y.copper)==null?void 0:ge.copper_type)==="CraftsMan"&&y.id!==void 0&&Ht.set(y.id,y.can_build===!0);const Z=((ye=(_e=y.copper)==null?void 0:_e.copper_info)==null?void 0:ye.name)||y.name||((Le=($e=y.enemy)==null?void 0:$e.enemy_base)==null?void 0:Le.name)||((Oe=(Ce=y.enemy)==null?void 0:Ce.enemy_base)==null?void 0:Oe.enemy_type)||((Be=y.enemy_base)==null?void 0:Be.name)||((We=y.enemy_base)==null?void 0:We.enemy_type)||` #${y.id}`;((yt=y.copper)==null?void 0:yt.copper_type)==="CraftsMan"?(f(`[GameScene]  can_build=${y.can_build}  can_summon`),x.value={...y,name:Z,can_summon:y.can_build===!0}):x.value={...y,name:Z},B.value=C||[],G.value=P||!1,f(`[GameScene] : ID=${x.value.id}, has_attack_targets=${G.value}, can_summon=${x.value.can_summon}`)},onShowStructureInfo:(y,C)=>{var P;U.value=y,K.value={structure:y,resources:C},f(`[GameScene] : ID=${y.id}, =${(P=y.structure_base)==null?void 0:P.name}, =${y.now_health}/${y.structure_base.health}`)},highlightSelectedCopper:me,createAttackEffect:jn,onMoveStart:(y,C)=>{s.isGameMode&&Ve.value&&(C==null?void 0:C.type)==="enemy"&&!(C!=null&&C.isOwned)&&(f(`[GameScene]  ${y} `),nt.value.add(y))},onMoveComplete:y=>{if(!s.isGameMode)return;const C=j.find(ge=>ge.id===y);if((C==null?void 0:C.type)==="structure"){f("[GameScene] "),ce.value=null,ct.value=!1,setTimeout(async()=>{await fn(y)},300);return}if((C==null?void 0:C.type)==="enemy"&&!(C!=null&&C.isOwned)){Ve.value&&nt.value.has(y)?(f(`[GameScene]  ${y} `),nt.value.delete(y),nt.value.size===0&&(f("[GameScene] "),Ve.value=!1)):f(`[GameScene]  ${y} `);return}const Z=be.value.some(ge=>ge.id===y),ae=(C==null?void 0:C.type)==="summon"||(C==null?void 0:C.isOwned);!Z&&!ae||(ct.value=!1,f("[GameScene] "),ce.value=null,D.value&&D.value.cancelAction(),setTimeout(async()=>{(C==null?void 0:C.type)==="summon"?await zn(y,!1):await Ns(y),setTimeout(()=>{if(B.value&&B.value.length>0){f("[GameScene] ");return}oi()},100)},300))},onCraftResult:(y,C)=>{f(`[GameScene] : ${y?"":""} - ${C}`),alert(C)},onResourceNotEnough:y=>{f(`[GameScene] : ${y}`),alert(` ${y}`),ce.value=null,he.value=null,fe.value=!1,le.value=null},onSummonFailed:y=>{f(`[GameScene] : ${y}`),alert(` ${y}`),ce.value=null,fe.value=!1,le.value=null},onShowSummonMenu:y=>{f("[GameScene] :",y),pe.value=y||[]},onShowStructureMenu:y=>{var C;f("[GameScene] ",(y==null?void 0:y.length)||0,""),(C=D.value)!=null&&C.showBuildMenu?D.value.showBuildMenu(y||[]):f("[GameScene]  copperActionPanelRef.value.showBuildMenu ")},onRemoveCopper:y=>{const C=be.value.findIndex(P=>P.id===y);C>-1&&(f(`[GameScene] : ID=${y}`),be.value.splice(C,1),x.value&&x.value.id===y&&Fo(),be.value.length===0||Me.value===C?Me.value=-1:Me.value>C?Me.value-=1:Me.value>=be.value.length&&(Me.value=be.value.length-1))},onShowResourceGain:(y,C)=>{f("[GameScene] :",y,C),Ie&&Object.keys(C).length>0&&Ie.createResourceGainEffect(y,C)},onGameOver:()=>{f("[GameScene] "),hs.value=!0},onGameSuccess:()=>{f("[GameScene] "),rt.value=!0},onAttackComplete:y=>{if(!s.isGameMode)return;const C=j.find(Z=>Z.id===y);if((C==null?void 0:C.type)==="structure"){f("[GameScene] "),ce.value=null,setTimeout(async()=>{await fn(y)},300);return}if(!be.value.some(Z=>Z.id===y)){f("[GameScene] ");return}f("[GameScene] "),ce.value=null,D.value&&D.value.cancelAction(),setTimeout(async()=>{(C==null?void 0:C.type)==="summon"?await zn(y,!1):await Ns(y),setTimeout(()=>{if(B.value&&B.value.length>0){f("[GameScene] ");return}oi()},100)},300)},onSetMoveBlock:y=>{ne&&ne.createIndicator(y,"move"),f(`[GameScene] : =${y}`)},onSetAttackBlock:y=>{if(ce.value==="transferring"){ie.value.push(y);const C=j.find(P=>{if(P.type==="copper"&&P.object){const Z=P.object.position;return Math.abs(Z.x-y[0])<.1&&Math.abs(Z.z-y[1])<.1}return!1});if(C){const P=be.value.find(ae=>ae.id===C.id);Y.value.find(ae=>ae.id===C.id)||(Y.value.push({id:C.id,name:C.name||(P?P.name:` #${C.id}`)||` #${C.id}`,position:y}),f(`[GameScene] : ${C.name||C.id} (ID=${C.id}), =${Y.value.length}`))}else f(`[GameScene]  ${y} `)}else ne&&ne.createIndicator(y,"attack"),G.value=!0,f(`[GameScene] : ${y}`)},onSetCanSummonBlock:y=>{ne&&ne.createIndicator(y,"summon"),f(`[GameScene] : =${y}`)},onClearBlock:y=>{ne&&ne.clearIndicatorAt(y)},onSetCopper:async(y,C,P)=>{var Ce,Oe,Be,We,yt,Gs;if(f(`[GameScene] : id=${P.id}, pos=${C}`),j.find(ut=>ut.id===P.id)){f(`[GameScene] ID=${P.id}`);return}if(((Ce=P.copper)==null?void 0:Ce.copper_type)==="CraftsMan"&&(Ht.set(P.id,P.can_build===!0),f(`[GameScene]  can_build : id=${P.id}, can_build=${P.can_build}`)),s.isGameMode){const ut={id:P.id,name:((Oe=P.copper.copper_info)==null?void 0:Oe.name)||` #${P.id}`,level:Number(((Be=P.copper)==null?void 0:Be.level)??0),turnDone:!1};be.value.find(dt=>dt.id===P.id)||(be.value.push(ut),f(`[GameScene] : ${ut.name}`))}const ae=P.copper.copper_type||"Arcanist",ge=((We=P.copper.copper_info)==null?void 0:We.name)||"default",_e=(yt=P.copper.copper_info)==null?void 0:yt.model_url;let ye=1;switch(ae){case"IronWall":ye=1.2;break;case"Arcanist":ye=1;break;case"Mechanic":ye=1.1;break;case"Resonator":ye=1;break;case"CraftsMan":ye=1;break;default:ye=1}let $e;if(_e&&_e.includes("/enemy/")){const ut=N(_e);if(f(`[GameScene] URL: ${_e} -> ${ut}`),$e=await Ql(ut,C,ye,ge),$e){const lt=new xt().setFromObject($e).getSize(new ke),Yt=new xt().setFromObject($e);$e.position.y=-Yt.min.y;const pn=new Qs(4474111,2.5,12);pn.position.set(0,lt.y*ye*.8,0),$e.add(pn)}}else{const ut=Cg(ge),dt=Eg(ae);f(`[GameScene] : =${ge}, =${ut}, type=${ae}, typeFolder=${dt}`),$e=await Zl(dt,ut,C,ye)}if(!$e){f(`[GameScene] : ${ge}`);const ut=new rs(.8,.8,.8);let dt=4491519;switch(ae){case"IronWall":dt=8947848;break;case"Arcanist":dt=16729224;break;case"Mechanic":dt=4521864;break;case"Resonator":dt=16755268;break;case"CraftsMan":dt=4474111;break}const lt=new pt({color:dt});$e=new et(ut,lt),$e.position.set(C[0],.4,C[1])}$e.userData.modelId=P.id,b.add($e);const Le={id:P.id,object:$e,name:((Gs=P.copper.copper_info)==null?void 0:Gs.name)||`Copper_${P.id}`,type:"copper"};j.push(Le),f(`[GameScene] : ${Le.name} (ID=${P.id})`)},onSetEnemy:async(y,C,P)=>{var Oe,Be,We,yt,Gs;const Z=P.id,ae=P.owned||!1;if(f(`[GameScene] : id=${Z}, pos=${C}, owned=${ae}`),j.find(ut=>ut.id===Z)){f(`[GameScene] ID=${Z}`);return}const ye=(((Oe=P.enemy_base)==null?void 0:Oe.enemy_type)||"").toLowerCase()||"goblin";let $e=1;switch(ye){case"demon":case"glutton":case"devourer":$e=1.5;break;case"guard":case"horn":$e=1.2;break;default:$e=1}const Le={id:Z,object:null,name:((Be=P.enemy_base)==null?void 0:Be.enemy_type)||`Enemy_${Z}`,type:ae?"summon":"enemy",position:C,isOwned:ae,isLoading:!0};j.push(Le);let Ce=await ec(ye,C,$e);if(!Ce){f(`[GameScene] : ${ye}`);const ut=new rs(.8,.8,.8),dt=new pt({color:ae?4474111:16711680});Ce=new et(ut,dt),Ce.position.set(C[0],.4,C[1])}if(ae&&Ce){const dt=new xt().setFromObject(Ce).getSize(new ke),lt=new Qs(4474111,2.5,12);lt.position.set(0,dt.y*$e*.8,0),Ce.add(lt),f(`[GameScene] : ${ye}`)}Ce.userData.modelId=Z,b.add(Ce),Le.object=Ce,Le.isLoading=!1,P.now_health!==void 0&&((We=P.enemy_base)==null?void 0:We.health)!==void 0&&A&&(A.createOrUpdateHealthBar(Z,P.now_health,P.enemy_base.health),f(`[GameScene] : ${ye} (${P.now_health}/${P.enemy_base.health})`)),ae&&(be.value.push({id:Z,name:((yt=P.enemy_base)==null?void 0:yt.name)||ye,type:"summon",enemy:P}),f(`[GameScene] : ${ye} (ID=${Z})`)),f(`[GameScene] : ${((Gs=P.enemy_base)==null?void 0:Gs.enemy_type)||Z}, owned=${ae}`)},onSetMaterial:async(y,C,P)=>{var $e,Le,Ce;if(f(`[GameScene] : id=${y}, pos=${C}, name=${($e=P.material_base)==null?void 0:$e.name}`),j.find(Oe=>Oe.id===y)){f(`[GameScene] ID=${y}`);return}const ae=((Le=P.material_base)==null?void 0:Le.name)||"",ge=(Ce=P.material_base)==null?void 0:Ce.model_url;if(!ge){f("[GameScene] model_url");const Oe=new rs(.5,.5,.5),Be=new pt({color:16755200,metalness:.3,roughness:.7}),We=new et(Oe,Be);We.position.set(C[0],.25,C[1]),We.userData.modelId=y,b.add(We),j.push({id:y,object:We,name:ae||`Material_${y}`,type:"material"});return}const _e=jf(ge);let ye=null;try{const Oe=await Ut.loadModel(_e,!0),Be=new Jt;Be.add(Oe),Be.position.set(C[0],0,C[1]),Be.scale.set(1,1,1),Be.rotation.y=0;const We=new xt().setFromObject(Be);Be.position.y=-We.min.y,ye=Be,f(`[GameScene] : ${ae}, URL: ${_e}`)}catch(Oe){f(`[GameScene] : ${ae}`,Oe);const Be=new rs(.5,.5,.5),We=new pt({color:16755200,metalness:.3,roughness:.7});ye=new et(Be,We),ye.position.set(C[0],.25,C[1])}ye.userData.modelId=y,b.add(ye),j.push({id:y,object:ye,name:ae||`Material_${y}`,type:"material"}),f(`[GameScene] : ${ae}`)},onSetStructure:async(y,C,P)=>{var $e,Le;if(f(`[GameScene] : id=${y}, pos=${C}`),j.find(Ce=>Ce.id===y)){f(`[GameScene] ID=${y}`);return}const ae=(($e=P.structure_base)==null?void 0:$e.name)||"",ge=kg(ae),_e=Ul(ge);let ye=null;try{const Ce=await Ut.loadModel(_e,!0),Oe=new Jt;Oe.add(Ce),Oe.position.set(C[0],0,C[1]),Oe.scale.set(1,1,1),Oe.rotation.y=0;const Be=new xt().setFromObject(Oe);Oe.position.y=-Be.min.y,ye=Oe,f(`[GameScene] : ${ae}, URL: ${_e}`)}catch(Ce){f(`[GameScene] : ${ae}`,Ce);const Oe=new rs(.9,1.2,.9),Be=new pt({color:6710886,metalness:.5,roughness:.6});ye=new et(Oe,Be),ye.position.set(C[0],.6,C[1])}ye.userData.modelId=y,b.add(ye),j.push({id:y,object:ye,name:ae||`Structure_${y}`,type:"structure"}),f(`[GameScene] : ${ae}`),P.now_health!==void 0&&((Le=P.structure_base)!=null&&Le.health)&&A&&(A.createOrUpdateHealthBar(y,P.now_health,P.structure_base.health),f(`[GameScene] : ${ae} (${P.now_health}/${P.structure_base.health})`))},onPutResourceMarker:y=>{const C=`${y[0]},${y[1]}`;if(te.has(C)){const Be=te.get(C);b.remove(Be),Be.traverse(We=>{We.geometry&&We.geometry.dispose(),We.material&&(Array.isArray(We.material)?We.material.forEach(yt=>yt.dispose()):We.material.dispose())}),te.delete(C)}const P=new Jt,Z=new io(.15,.2,.25,8),ae=new pt({color:16766720,emissive:16755200,emissiveIntensity:.6,metalness:.7,roughness:.3}),ge=new et(Z,ae);ge.position.y=.125,P.add(ge);const _e=new pa(.08,8,8),ye=new pt({color:16776960,emissive:16776960,emissiveIntensity:1}),$e=new et(_e,ye);$e.position.y=.3,P.add($e);const Le=y[0],Ce=y[1];P.position.set(Le,.15,Ce);const Oe=new Qs(16766720,1.5,3);Oe.position.set(0,.3,0),P.add(Oe),b.add(P),te.set(C,P)},onClearResourceMarker:y=>{const C=`${y[0]},${y[1]}`;if(te.has(C)){const P=te.get(C);b.remove(P),P.traverse(Z=>{Z.geometry&&Z.geometry.dispose(),Z.material&&(Array.isArray(Z.material)?Z.material.forEach(ae=>ae.dispose()):Z.material.dispose())}),te.delete(C)}},onDisplayCanMove:(y,C)=>{f(`[GameScene] : id=${y}, show=${C}`),ee(y,"move",C),x.value&&x.value.id===y&&(x.value={...x.value,can_move:C},f(`[GameScene] selectedCopper.can_move=${C}`))},onDisplayCanAttack:(y,C)=>{f(`[GameScene] : id=${y}, show=${C}`),ee(y,"attack",C),x.value&&x.value.id===y&&(x.value={...x.value,can_attack:C},f(`[GameScene] selectedCopper.can_attack=${C}`))},onDisplayCanSummon:(y,C)=>{var ge;let P=C,Z=!1,ae=!1;x.value&&x.value.id===y?(Z=((ge=x.value.copper)==null?void 0:ge.copper_type)==="CraftsMan",ae=x.value.can_build===!0):Ht.has(y)&&(Z=!0,ae=Ht.get(y)),Z&&(P=ae,f(`[GameScene] : id=${y}, can_build=${P}`)),f(`[GameScene] /: id=${y}, show=${P}`),ee(y,"summon",P),x.value&&x.value.id===y&&(x.value={...x.value,can_summon:P},f(`[GameScene] selectedCopper.can_summon=${P}`))},onClearState:y=>{if(f(`[GameScene] : id=${y}`),k.has(y)){const C=k.get(y);C.move&&(b.remove(C.move),C.move.geometry.dispose(),C.move.material.dispose(),delete C.move),C.attack&&(b.remove(C.attack),C.attack.geometry.dispose(),C.attack.material.dispose(),delete C.attack),C.summon&&(b.remove(C.summon),C.summon.geometry.dispose(),C.summon.material.dispose(),delete C.summon),k.delete(y)}},onUpdateHealth:(y,C,P)=>{f(`[GameScene] : id=${y}, hp=${C}/${P}`);const Z=Se.get(y);if(Z!==void 0&&C<Z&&C>0){const ae=j.find(ge=>ge.id===y);if(ae){const ge=ae.type==="copper",_e=ge?d.value:h.value;_e&&(_e.currentTime=0,_e.play().catch(ye=>{f(`[GameScene]  (${ge?"":""}):`,ye)}),f(`[GameScene] : ${ge?"":""} (ID=${y})`))}}Se.set(y,C),A&&A.createOrUpdateHealthBar(y,C,P)},onRemoveHealthBar:y=>{f(`[GameScene] : id=${y}`),A&&A.removeHealthBar(y),Se.delete(y)},onPutMapBlock:y=>{const C=`${y[0]},${y[1]}`;if(R.has(C)){const Le=R.get(C);b.remove(Le),Le.geometry.dispose(),Le.material&&(Le.material.map&&Le.material.map.dispose(),Array.isArray(Le.material)?Le.material.forEach(Ce=>{Ce.map&&Ce.map.dispose(),Ce.dispose()}):Le.material.dispose())}const P=Xl();if(!P.enabled)return;const Z=P.size||.9,ae=.05,ge=new rs(Z,ae,Z);let _e;if(P.materialType==="texture"&&P.texture.url){const Ce=new dn().load(P.texture.url);Ce.colorSpace=bt,Ce.wrapS=Ss,Ce.wrapT=Ss,Ce.repeat.set(P.texture.repeat.x,P.texture.repeat.y);const Oe=1;_e=new pt({map:Ce,transparent:!1,opacity:Oe,depthTest:!0,depthWrite:!0})}else P.materialType==="standard"?_e=new pt({color:P.standard.color,roughness:P.standard.roughness,metalness:P.standard.metalness,transparent:!1,opacity:1,depthTest:!0,depthWrite:!0}):_e=new ht({color:P.basic.color,transparent:!1,opacity:1,depthTest:!0,depthWrite:!0});const ye=new et(ge,_e);ye.renderOrder=-100;const $e=P.yOffset||0;ye.position.set(y[0],ae/2+$e,y[1]),b.add(ye),R.set(C,ye)},animateModelMove:(y,C,P)=>{if(!y||!y.object)return;const Z=y.type==="enemy",ae=Z?l.value:r.value;ae&&(ae.currentTime=0,ae.play().catch(Ce=>{f(`[GameScene]  (${Z?"":""}):`,Ce)})),y.isMoving=!0;const ge=y.object.position.clone(),_e=new ke(C.x,C.y,C.z),ye=500,$e=performance.now();function Le(){if(!y||!y.object){P&&P();return}const Ce=performance.now()-$e,Oe=Math.min(Ce/ye,1),Be=1-Math.pow(1-Oe,2);y.object.position.lerpVectors(ge,_e,Be),Oe<1?requestAnimationFrame(Le):(y.object.position.copy(_e),y.isMoving=!1,P&&P())}Le()},setTestMode:y=>{f(`[GameScene] ${y==="backend"?"":"EventLoop"}`),j.forEach(C=>{C.type==="test"?C.object.visible=y==="backend":(C.type==="copper"||C.type==="enemy")&&(C.object.visible=y==="eventloop")}),f(`[GameScene] ${y==="backend"?"":""}${y==="eventloop"?"":""}EventLoop`)}}),f("[GameScene] ")}function sc(k,R,te){const ee=new ke;k.getWorldPosition(ee);const me=window.cameraFocusDistance||8,y=window.cameraFocusHeight||6,C=0,P=me;return{focusPosition:new ke(ee.x+C,ee.y+y,ee.z+P).clone(),focusTarget:ee.clone(),lerpFactor:.1}}function ei(){v.aspect=window.innerWidth/window.innerHeight,v.updateProjectionMatrix(),L.setSize(window.innerWidth,window.innerHeight)}function ti(){if(requestAnimationFrame(ti),we.w||we.a||we.s||we.d||we.shift||we.space){const k=new ke;we.w&&(k.z-=1),we.s&&(k.z+=1),we.a&&(k.x-=1),we.d&&(k.x+=1),we.shift&&(k.y-=1),we.space&&(k.y+=1),k.applyQuaternion(v.quaternion),k.y=we.shift?-1:we.space?1:0,v.position.add(k.multiplyScalar($))}W.focusPosition&&W.focusTarget&&(v.position.lerp(W.focusPosition,W.lerpFactor),v.lookAt(W.focusTarget),Ne=v.rotation.y,Ue=v.rotation.x,v.position.distanceTo(W.focusPosition)<.5&&(f("[GameScene] "),W.focusPosition=null,W.focusTarget=null)),A&&A.updateHealthBarsPosition(j),L.render(b,v)}function si(k){if(k.target.tagName!=="CANVAS")return;if(se.x=k.clientX/window.innerWidth*2-1,se.y=-(k.clientY/window.innerHeight)*2+1,q.setFromCamera(se,v),ce.value==="moving"||ce.value==="attacking"||ce.value==="summoning"||ce.value==="building"||ce.value==="transferring"||ce.value==="structureMoving"||ce.value==="structureAttacking"||ce.value==="structureExtract"||ce.value==="structureTransfer"){nc(se);return}const R=j.filter(ee=>(ee.type==="copper"||ee.type==="summon"||ee.type==="enemy"||ee.type==="structure")&&ee.object).map(ee=>ee.object),te=q.intersectObjects(R,!0);if(te.length>0){let ee=te[0].object;for(;ee.parent&&!ee.userData.modelId;)ee=ee.parent;const me=ee.userData.modelId;if(me!==void 0){const y=j.find(Z=>Z.id===me),P={copper:"",summon:"",enemy:"",structure:""}[y==null?void 0:y.type]||"";f(`[GameScene] ${P}ID:`,me),(y==null?void 0:y.type)==="summon"||(y==null?void 0:y.type)==="enemy"?zn(me,(y==null?void 0:y.type)==="enemy"):(y==null?void 0:y.type)==="structure"?fn(me):Ns(me)}}else x.value=null,U.value=null}async function nc(k){const R=new br(new ke(0,1,0),0),te=new di;if(te.setFromCamera(k,v),ce.value==="moving"&&ct.value){f("[GameScene] ");return}const ee=new ke;if(te.ray.intersectPlane(R,ee),ee){const me=Math.round(ee.x),y=Math.round(ee.z);f(`[GameScene] : (${me}, ${y})`);const C={moving:"move",attacking:"attack",summoning:"summon",building:"summon",structureMoving:"move",structureAttacking:"attack",structureExtract:"attack",structureTransfer:"attack"}[ce.value];if(!ne||!ne.hasIndicatorAt([me,y],C)){f(`[GameScene]  (${me}, ${y}) `);return}ce.value==="moving"?await oc(me,y):ce.value==="attacking"?await ac(me,y):ce.value==="summoning"?await ic(me,y):ce.value==="building"?await rc(me,y):ce.value==="structureMoving"?await gc(me,y):ce.value==="structureAttacking"?await _c(me,y):ce.value==="structureExtract"?await yc(me,y):ce.value==="structureTransfer"&&await vc(me,y)}}async function oc(k,R){if(!x.value)return;if(ct.value){f("[GameScene] ");return}const te=x.value.isOwnedEnemy===!0,ee=te?"on_enemy_move_apply":"on_move_apply";f(`[GameScene] : (${k}, ${R}), =${te?"":""}, =${ee}`);const me=JSON.stringify({type:ee,content:{id:String(x.value.id),position:{x:String(k),y:String(R)}}});ct.value=!0,await xe(me)}async function ac(k,R){if(!x.value)return;const te=x.value.isOwnedEnemy===!0,ee=te?"on_enemy_attack_apply":"on_attack_apply";f(`[GameScene] : (${k}, ${R}), =${te?"":""}, =${ee}`);const me=x.value.id,y=j.find(P=>P.id===me);if(y){const P=y.type==="enemy",Z=P?u.value:c.value;Z&&(Z.currentTime=0,Z.play().catch(ae=>{f(`[GameScene]  (${P?"":""}):`,ae)})),jn&&jn(me,[k,R])}const C=JSON.stringify({type:ee,content:{id:String(x.value.id),position:{x:String(k),y:String(R)}}});await xe(C)}async function ic(k,R){if(!x.value)return;f(`[GameScene] : (${k}, ${R})`),le.value=[k,R];const te=JSON.stringify({type:"on_get_summon_menu"});await xe(te),await new Promise(ee=>setTimeout(ee,100)),fe.value=!0}async function rc(k,R){if(!x.value||!he.value)return;f(`[GameScene]  ${he.value} : (${k}, ${R})`);const te=x.value.id,ee=JSON.stringify({type:"on_structure_build_apply",content:{id:String(te),position:{x:String(k),y:String(R)},name:he.value}});await xe(ee),ce.value=null,he.value=null,D.value&&D.value.cancelAction(),await new Promise(me=>setTimeout(me,100)),f("[GameScene] "),await Ns(te)}async function lc(k){if(!x.value||!le.value)return;const[R,te]=le.value;f(`[GameScene]  ${k} : (${R}, ${te})`);try{const ee=JSON.stringify({type:"on_summon_apply",content:{id:String(x.value.id),position:{x:String(R),y:String(te)},name:k}});await xe(ee)}catch(ee){f("[GameScene] :",ee)}finally{fe.value=!1,ce.value=null,le.value=null,D.value&&D.value.cancelAction();try{const ee=JSON.stringify({type:"on_summon_end"});await xe(ee)}catch(ee){f("[GameScene] :",ee)}}}function cc(){fe.value=!1,le.value=null,ce.value=null;const k=JSON.stringify({type:"on_summon_end"});xe(k).catch(R=>{f("[GameScene] ",R)})}function ni(){if(f("[GameScene] "),ce.value==="structureMoving"){const k=JSON.stringify({type:"on_structure_move_end"});xe(k).catch(R=>{f("[GameScene] ",R)})}else if(ce.value==="structureAttacking"){const k=JSON.stringify({type:"on_structure_attack_end"});xe(k).catch(R=>{f("[GameScene] ",R)})}else if(ce.value==="structureExtract"){const k=JSON.stringify({type:"on_structure_extract_end"});xe(k).catch(R=>{f("[GameScene] ",R)})}else if(ce.value==="structureTransfer"){const k=JSON.stringify({type:"on_structure_transfer_end"});xe(k).catch(R=>{f("[GameScene] ",R)})}ce.value=null}function uc(){ni(),U.value=null,K.value=null,f("[GameScene] ")}async function dc(k){if(!U.value)return;const R=U.value.id;switch(f(`[GameScene] : ${k.type}, ID=${R}`),k.type){case"move":await fc(R);break;case"attack":await pc(R);break;case"transfer":await mc(R);break;case"extract":await hc(R);break;default:f("[GameScene] :",k.type)}}async function fc(k){f(`[GameScene]  ${k} `);const R=JSON.stringify({type:"on_structure_move_start",content:{id:String(k)}});await xe(R),ce.value="structureMoving"}async function pc(k){f(`[GameScene]  ${k} `);const R=JSON.stringify({type:"on_structure_attack_start",content:{id:String(k)}});await xe(R),ce.value="structureAttacking"}async function hc(k){f(`[GameScene]  ${k} `);const R=JSON.stringify({type:"on_structure_extract_start",content:{id:String(k)}});await xe(R),ce.value="structureExtract"}async function mc(k){f(`[GameScene]  ${k} `);const R=JSON.stringify({type:"on_structure_transfer_start",content:{id:String(k)}});await xe(R),ce.value="structureTransfer"}async function gc(k,R){if(!U.value)return;f(`[GameScene]  ${U.value.id}  (${k}, ${R})`);const te=JSON.stringify({type:"on_structure_move_apply",content:{id:String(U.value.id),position:{x:String(k),y:String(R)}}});await xe(te),ce.value=null}async function _c(k,R){if(!U.value)return;f(`[GameScene]  ${U.value.id}  (${k}, ${R})`);const te=JSON.stringify({type:"on_structure_attack_apply",content:{id:String(U.value.id),position:{x:String(k),y:String(R)}}});await xe(te),ce.value=null}async function yc(k,R){if(!U.value)return;f(`[GameScene]  ${U.value.id}  (${k}, ${R}) `);const te=U.value.id,ee=JSON.stringify({type:"on_structure_extract_apply",content:{id:String(te),position:{x:String(k),y:String(R)}}});await xe(ee),f("[GameScene] ");const me=JSON.stringify({type:"on_structure_extract_end"});await xe(me),await new Promise(y=>setTimeout(y,100)),f("[GameScene] "),ce.value=null,setTimeout(async()=>{f("[GameScene] "),await fn(te)},300)}async function vc(k,R){if(!U.value)return;f(`[GameScene]  ${U.value.id}  (${k}, ${R}) `);const te=U.value.id,ee=JSON.stringify({type:"on_structure_transfer_apply",content:{id:String(te),position:{x:String(k),y:String(R)}}});await xe(ee),f("[GameScene] ");const me=JSON.stringify({type:"on_structure_transfer_end"});await xe(me),await new Promise(y=>setTimeout(y,100)),f("[GameScene] "),ce.value=null,setTimeout(async()=>{f("[GameScene] "),await fn(te)},300)}async function Ns(k){const R=be.value.findIndex(ee=>ee.id===k);R!==-1&&(Me.value=R),U.value=null;const te=JSON.stringify({type:"on_click_copper",content:{id:String(k)}});await xe(te)}async function fn(k){f(`[GameScene] : ID=${k}`),x.value=null;const R=JSON.stringify({type:"on_click_structure",content:{id:String(k)}});await xe(R)}async function zn(k,R=!1){if(R)Me.value=-1,Fo();else{const ee=be.value.findIndex(me=>me.id===k);ee!==-1&&(Me.value=ee)}U.value=null;const te=JSON.stringify({type:"on_click_enemy",content:{id:String(k)}});await xe(te)}function Fo(){x.value=null,B.value=[],ce.value=null}async function wc(k){if(f("[GameScene] :",k),k.type==="moveStart")ce.value="moving";else if(k.type==="attackStart")ce.value="attacking";else if(k.type==="summonStart")ce.value="summoning";else if(k.type==="buildRequest"){f("[GameScene] ");const R=JSON.stringify({type:"on_get_structure_menu"});await xe(R)}else if(k.type==="buildStart")ce.value="building",he.value=k.structureName||null;else if(k.type==="transferring"||k.type==="transferStart")ce.value="transferring",ie.value=[],Y.value=[];else if(k.type==="transferComplete")ce.value=null,ie.value=[],Y.value=[];else if(k.type==="cancel"){const R=ce.value;if(R==="moving"){const te=JSON.stringify({type:"on_move_end"});xe(te).catch(ee=>{f("[GameScene] ",ee)})}else if(R==="attacking"){const te=JSON.stringify({type:"on_attack_end"});xe(te).catch(ee=>{f("[GameScene] ",ee)})}else if(R==="transferring"){const te=JSON.stringify({type:"on_transfer_end"});xe(te).catch(ee=>{f("[GameScene] ",ee)}),ie.value=[],Y.value=[]}else if(R==="summoning"){const te=JSON.stringify({type:"on_summon_end"});xe(te).catch(ee=>{f("[GameScene] ",ee)}),fe.value=!1}else if(R==="building"){const te=JSON.stringify({type:"on_structure_build_end"});xe(te).catch(ee=>{f("[GameScene] ",ee)}),he.value=null,le.value=null}ce.value=null}else k.type==="wait"&&(f("[GameScene] "),Bo())}function oi(){if(be.value.length!==0){if(x.value){const k=x.value.can_move,R=x.value.can_attack,te=x.value.can_summon;if(f(`[GameScene] : ID=${x.value.id}, can_move=${k}, can_attack=${R}, can_summon=${te}, hasAttackTargets=${G.value}`),k||R&&G.value||te){f("[GameScene] ");return}}f("[GameScene] "),Bo()}}async function Bo(){var te,ee,me;if(be.value.length===0)return;x.value=null,ce.value=null,Me.value;let k=0;const R=be.value.length;for(;k<R;){Me.value=(Me.value+1)%be.value.length;const y=be.value[Me.value];f(`[GameScene] : ${y.name||y.id} ( ${k+1}/${R})`),await new Promise(ge=>{setTimeout(async()=>{const _e=j.find($e=>$e.id===y.id);(_e==null?void 0:_e.type)==="summon"?await zn(y.id,!1):await Ns(y.id),ge()},300)}),await new Promise(ge=>setTimeout(ge,200));const C=((te=x.value)==null?void 0:te.can_move)||!1,P=((ee=x.value)==null?void 0:ee.can_attack)||!1,Z=((me=x.value)==null?void 0:me.can_summon)||!1,ae=C||P&&G.value||Z;if(f(`[GameScene]  ${y.name}: can_move=${C}, can_attack=${P}, can_summon=${Z}, hasTargets=${G.value}, valid=${ae}`),x.value&&ae){f(`[GameScene] : ${y.name||y.id}`);return}k++}f("[GameScene] "),x.value=null,s.isGameMode&&f('[GameScene] ""')}function bc(){Re.value++,Me.value=-1,x.value=null,ce.value=null,be.value.forEach(R=>R.turnDone=!1),f(`[GameScene]  ${Re.value}`);const k=j.filter(R=>R.type==="enemy"&&!R.isOwned);if(f(`[GameScene]  ${k.length} `),k.length===0)f("[GameScene] "),Ve.value=!1;else{Ve.value=!0,nt.value.clear(),f("[GameScene] ");let R=setTimeout(()=>{Ve.value&&nt.value.size>0&&(f("[GameScene] "),Ve.value=!1,nt.value.clear())},3e3),te=setInterval(()=>{Ve.value||(clearTimeout(R),clearInterval(te))},100);setTimeout(()=>{Ve.value&&nt.value.size===0&&(f("[GameScene] "),Ve.value=!1,clearTimeout(R),clearInterval(te))},1e3)}}async function Sc(){f("[GameScene] "),hs.value=!1;const k=JSON.stringify({type:"on_game_over"});await xe(k).catch(R=>{f("[GameScene]  on_game_over ",R)}),o("back")}async function Mc(){f("[GameScene] game over"),rt.value=!1;const k=JSON.stringify({type:"on_game_over"});await xe(k).catch(R=>{f("[GameScene]  on_game_over ",R)}),Tc()}function Tc(){f("[GameScene] "),Mt.value=!0,setTimeout(()=>{f("[GameScene] "),Mt.value=!1,o("back")},5e3)}function Cc(){f("[GameScene] "),Mt.value=!1,o("back")}function Ec(){f("[GameScene] "),Ds.value=!0}function xc(){f("[GameScene] "),Ds.value=!1}async function kc(){f("[GameScene]  game_over "),Ds.value=!1;const k=JSON.stringify({type:"on_game_over"});await xe(k).catch(R=>{f("[GameScene]  on_game_over ",R)}),o("back")}const Ac=`url('${N("@assets/ui/panel7.png")}')`,Rc=`url('${N("@assets/ui/panel8.png")}')`;return(k,R)=>{var te,ee,me,y;return I(),H("div",tw,[p("div",{ref_key:"container",ref:n,class:"scene-container"},null,512),t.isGameMode?(I(),Dt(gv,{key:0,currentCopperId:Bn.value,copperList:be.value,roundNumber:Re.value,isEnemyMoving:Ve.value,onNextCopper:Bo,onEndRound:bc,onSelectCopper:Ns},null,8,["currentCopperId","copperList","roundNumber","isEnemyMoving"])):ve("",!0),t.isGameMode?(I(),H("button",{key:1,class:"withdraw-button",onClick:Ec},"  ")):ve("",!0),t.isGameMode?(I(),Dt(ew,{key:2})):ve("",!0),t.isGameMode&&x.value?(I(),Dt(tv,{key:3,ref_key:"copperActionPanelRef",ref:D,copper:x.value,resources:B.value,hasAttackTargets:G.value,transferTargets:Y.value,onSelectCopper:Ns,onClose:Fo,onAction:wc},null,8,["copper","resources","hasAttackTargets","transferTargets"])):ve("",!0),t.isGameMode?(I(),Dt(Wv,{key:4,visible:fe.value,"copper-name":((me=(ee=(te=x.value)==null?void 0:te.copper)==null?void 0:ee.copper_info)==null?void 0:me.name)||"","enemy-list":pe.value,position:le.value,onClose:cc,onSummon:lc},null,8,["visible","copper-name","enemy-list","position"])):ve("",!0),t.isGameMode&&U.value?(I(),Dt(g0,{key:5,structure:U.value,resources:((y=K.value)==null?void 0:y.resources)||[],"action-mode":ce.value==="structureMoving"?"move":ce.value==="structureAttacking"?"attack":ce.value==="structureExtract"?"extract":ce.value==="structureTransfer"?"transfer":null,onClose:uc,onAction:dc,onCancel:ni},null,8,["structure","resources","action-mode"])):ve("",!0),t.isGameMode?ve("",!0):(I(),H("div",sw,[...R[0]||(R[0]=[go('<h3 data-v-792a0769>3D</h3><p style="color:#ffd700;font-weight:600;" data-v-792a0769> </p><div style="margin:8px 0;padding:8px;background:rgba(255, 255, 255, 0.1);border-radius:6px;" data-v-792a0769><p style="font-weight:600;" data-v-792a0769> </p><p style="font-size:12px;" data-v-792a0769>  = ID:1</p><p style="font-size:12px;" data-v-792a0769>  = ID:2</p></div><div style="margin:8px 0;padding:8px;background:rgba(255, 255, 255, 0.1);border-radius:6px;" data-v-792a0769><p style="font-weight:600;" data-v-792a0769> EventLoop</p><p style="font-size:12px;" data-v-792a0769>1.   EventLoop</p><p style="font-size:12px;" data-v-792a0769>2. &quot; &quot;</p><p style="font-size:12px;" data-v-792a0769>3. 3</p><p style="font-size:11px;" data-v-792a0769>  =IronWall  =Arcanist  =CraftsMan </p></div>',4)])])),hs.value?(I(),H("div",nw,[p("div",{class:"game-over-dialog"},[R[1]||(R[1]=p("h2",{class:"game-over-title"},"",-1)),R[2]||(R[2]=p("p",{class:"game-over-message"},"",-1)),p("button",{class:"game-over-button",onClick:Sc},"  ")])])):ve("",!0),rt.value?(I(),H("div",ow,[p("div",{class:"game-over-dialog success-dialog"},[R[3]||(R[3]=p("h2",{class:"success-title"},"  ",-1)),R[4]||(R[4]=p("p",{class:"game-over-message"},"",-1)),p("button",{class:"game-over-button success-button",onClick:Mc},"  ")])])):ve("",!0),Mt.value?(I(),H("div",aw,[p("div",{class:"credits-container"},[R[5]||(R[5]=go('<h1 class="credits-title" data-v-792a0769></h1><div class="credits-content" data-v-792a0769><div class="credits-section" data-v-792a0769><h2 data-v-792a0769></h2><p data-v-792a0769>MGPIC Team</p></div><div class="credits-section" data-v-792a0769><h2 data-v-792a0769></h2><p data-v-792a0769>Backend Developer</p><p data-v-792a0769>Frontend Developer</p></div><div class="credits-section" data-v-792a0769><h2 data-v-792a0769></h2><p data-v-792a0769>3D Artist</p><p data-v-792a0769>UI Designer</p></div><div class="credits-section" data-v-792a0769><h2 data-v-792a0769></h2><p data-v-792a0769>Sound Designer</p></div><div class="credits-section" data-v-792a0769><h2 data-v-792a0769></h2><p data-v-792a0769></p></div></div>',2)),p("button",{class:"skip-credits-button",onClick:Cc},"")])])):ve("",!0),Ds.value?(I(),H("div",iw,[p("div",{class:"game-over-dialog"},[R[6]||(R[6]=p("h2",{class:"withdraw-title"},"",-1)),R[7]||(R[7]=p("p",{class:"game-over-message"},[Is(""),p("br"),Is("")],-1)),p("div",{class:"dialog-buttons"},[p("button",{class:"dialog-button cancel-button",onClick:xc},"  "),p("button",{class:"dialog-button confirm-button",onClick:kc},"  ")])])])):ve("",!0),p("audio",{ref_key:"audioRef",ref:a,src:ue(i),loop:"",preload:"auto"},null,8,rw),p("audio",{ref_key:"moveSoundRef",ref:r,src:ue(m),preload:"auto"},null,8,lw),p("audio",{ref_key:"moveEnemySoundRef",ref:l,src:ue(g),preload:"auto"},null,8,cw),p("audio",{ref_key:"attackSoundRef",ref:c,src:ue(E),preload:"auto"},null,8,uw),p("audio",{ref_key:"attackEnemySoundRef",ref:u,src:ue(S),preload:"auto"},null,8,dw),p("audio",{ref_key:"meHurtSoundRef",ref:d,src:ue(_),preload:"auto"},null,8,fw),p("audio",{ref_key:"enemyHurtSoundRef",ref:h,src:ue(M),preload:"auto"},null,8,pw)])}}},mw=mt(hw,[["__scopeId","data-v-792a0769"]]),gw={class:"stage"},_w={key:0,style:{position:"relative",width:"100%",height:"100%"}},yw={key:2,class:"modal"},vw={class:"modal-title"},ww={key:2,class:"overlay",style:{"z-index":"30000","align-items":"flex-start","justify-content":"flex-start",background:"rgba(0, 0, 0, 0.25)"}},bw={class:"settings"},Sw={class:"settings__header"},Mw=["src"],Tw={class:"settings__content"},Cw={class:"settings__section"},Ew={class:"settings__control-options"},xw={__name:"App",setup(t){const e=V(!1),s=V(null),n=V(!1),o=V(null),a=V([]);V(0);const i=V(!0),r=V(!1),l=V("touchpad"),c=V(!1);let u=null;function d(q){s.value!==q&&(a.value.push(s.value),s.value=q),window.__START_MENU_PAUSE__&&window.__START_MENU_PAUSE__(),e.value=!0}function h(){i.value=!1,u&&clearTimeout(u),u=setTimeout(()=>{i.value||(f("[App] StartMenu"),c.value=!0)},5*60*1e3)}function m(){s.value=null,a.value=[],window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__(),e.value=!1}function g(q){f("[App] ID:",q.ids),m(),r.value=!0,f("[App] ")}function E(){r.value=!1}function S(){const q=Uo();l.value=q.controlMode,n.value=!0,e.value=!0}function _(){n.value=!1,s.value||(window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__(),e.value=!1)}function M(q){l.value=q,Kl("controlMode",q),window.updateControlMode&&window.updateControlMode(q),f(`[App] : ${q}`)}function b(){if(n.value){_();return}if(s.value){if(s.value==="warehouse"&&o.value&&o.value.handleBack&&o.value.handleBack())return;const q=a.value.pop()??null;s.value=q,q||(e.value=!1);return}if(!i.value){u&&(clearTimeout(u),u=null),c.value&&(c.value=!1,f("[App] StartMenu")),i.value=!0,setTimeout(()=>{window.__INIT_THREE_SCENE__?window.__INIT_THREE_SCENE__().then(()=>{window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}).catch(()=>{window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}):window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()},100),e.value=!1;return}}const v=V(!0),L=V(null);function F(){v.value=!v.value,f("[App] :",v.value?"":"")}async function j(){try{f("[App] ...");const q=await np();if(q.type==="error"){f("[App] :",q.content),alert(": "+q.content);return}f("[App] ...");const se=new Blob([JSON.stringify(q,null,2)],{type:"application/json"}),A=document.createElement("a");A.href=URL.createObjectURL(se);const ne=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);A.download=`mgpic-save-${ne}.json`,A.click(),URL.revokeObjectURL(A.href),f("[App] ")}catch(q){f("[App] :",q),alert("")}}function re(){try{L.value&&L.value.click()}catch{}}async function W(q){try{const se=q.target&&q.target.files&&q.target.files[0];if(!se)return;f("[App] ...");const A=new FileReader;A.onload=async()=>{try{const ne=String(A.result||"{}"),Ie=JSON.parse(ne);f("[App] ..."),await sp(ne),f("[App] "),alert("")}catch(ne){f("[App] :",ne),alert(": "+ne.message)}q.target.value=""},A.onerror=()=>{f("[App] "),alert(""),q.target.value=""},A.readAsText(se)}catch(se){f("[App] :",se),alert("")}}return $t(()=>{jl(q=>{})}),fs(()=>{u&&(clearTimeout(u),u=null)}),(q,se)=>(I(),H("div",gw,[r.value?(I(),Dt(mw,{key:0,isGameMode:!0,"music-on":v.value,onBack:E},null,8,["music-on"])):ve("",!0),r.value?ve("",!0):(I(),H(Xe,{key:1},[c.value?ve("",!0):el((I(),Dt(Dm,{key:0,visible:i.value,onStarted:h},null,8,["visible"])),[[Nl,i.value]]),i.value?ve("",!0):(I(),Dt(nr,{key:1,"music-on":v.value,onBack:b,onOpenSettings:S,onToggleMusic:F},null,8,["music-on"])),tt(Kf,{"music-on":v.value,paused:s.value==="start"||s.value==="warehouse"||r.value,onStartGame:se[0]||(se[0]=A=>d("start")),onOpenWarehouse:se[1]||(se[1]=A=>d("warehouse")),onOpenTutorial:se[2]||(se[2]=A=>d("tutorial")),onOpenEncyclopedia:se[3]||(se[3]=A=>d("encyclopedia")),onToggleMusic:F},null,8,["music-on","paused"]),s.value?(I(),H("div",{key:2,class:Je(["overlay",{"overlay--warehouse":s.value==="warehouse"}])},[s.value==="warehouse"?(I(),H("div",_w,[tt(nr,{"music-on":v.value,onBack:b,onOpenSettings:S,onToggleMusic:F},null,8,["music-on"]),tt(hm,{ref_key:"warehouseRef",ref:o,"music-on":v.value},null,8,["music-on"])])):s.value==="start"?(I(),Dt(Sg,{key:1,"music-on":v.value,paused:r.value,onClose:m,onConfirm:g},null,8,["music-on","paused"])):(I(),H("div",yw,[p("h2",vw,Q(s.value==="warehouse"?"  Copper Warehouse":s.value==="tutorial"?"  Tutorial":s.value==="encyclopedia"?"  Game Encyclopedia":"  Start Game"),1),se[6]||(se[6]=p("p",{class:"modal-body"},"",-1)),p("button",{class:"close-btn",onClick:m},"")]))],2)):ve("",!0)],64)),n.value?(I(),H("div",ww,[p("div",bw,[p("div",Sw,[se[7]||(se[7]=p("div",{class:"settings__title"},"",-1)),p("button",{class:"settings__close",onClick:_,"aria-label":""},[p("img",{src:ue(N)("@assets/ui/close.png"),alt:""},null,8,Mw)])]),p("div",Tw,[p("div",Cw,[se[10]||(se[10]=p("div",{class:"settings__section-title"},"",-1)),p("div",Ew,[p("button",{class:Je(["settings__control-btn",{active:l.value==="touchpad"}]),onClick:se[4]||(se[4]=A=>M("touchpad"))},[...se[8]||(se[8]=[p("span",{class:"control-title"},"",-1),p("span",{class:"control-desc"},"",-1)])],2),p("button",{class:Je(["settings__control-btn",{active:l.value==="mouse"}]),onClick:se[5]||(se[5]=A=>M("mouse"))},[...se[9]||(se[9]=[p("span",{class:"control-title"},"",-1),p("span",{class:"control-desc"},"",-1)])],2)])]),p("button",{class:"settings__item",onClick:j},[...se[11]||(se[11]=[go('<span class="settings__icon" data-v-6f1cd762><svg width="44" height="44" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6f1cd762><path d="M12 3v12m0 0l-4-4m4 4l4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6f1cd762></path><path d="M4 19h16" stroke="#fff" stroke-width="2" stroke-linecap="round" data-v-6f1cd762></path></svg></span><span class="settings__label" data-v-6f1cd762></span>',2)])]),p("button",{class:"settings__item",onClick:re},[...se[12]||(se[12]=[go('<span class="settings__icon" data-v-6f1cd762><svg width="44" height="44" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6f1cd762><path d="M12 21V9m0 0l4 4m-4-4L8 13" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6f1cd762></path><path d="M4 5h16" stroke="#fff" stroke-width="2" stroke-linecap="round" data-v-6f1cd762></path></svg></span><span class="settings__label" data-v-6f1cd762></span>',2)])]),p("input",{ref_key:"fileInput",ref:L,type:"file",accept:".json",onChange:W,style:{display:"none"}},null,544)])])])):ve("",!0)]))}},ur=mt(xw,[["__scopeId","data-v-6f1cd762"]]);function kw(){const t=navigator.userAgent;return/Safari/.test(t)&&!/Chrome/.test(t)&&!/Chromium/.test(t)}function Aw(){const t=document.getElementById("safari-warning"),e=document.getElementById("loading-screen");t.style.display="flex",e.style.display="none",document.getElementById("download-local").addEventListener("click",()=>{window.open("https://github.com/MGPIC-2025/Cross/releases","_blank")}),document.getElementById("continue-safari").addEventListener("click",()=>{t.style.display="none",e.style.display="flex",Yl()}),document.getElementById("download-chrome").addEventListener("click",()=>{window.open("https://www.google.com/chrome/","_blank")})}function la(t,e,s,n=""){const o=document.getElementById("progress-bar"),a=document.getElementById("progress-text"),i=document.querySelector(".loading-subtitle");o&&(o.style.width=s+"%"),a&&(t===0&&e===0?a.textContent=`${s}%`:a.textContent=`${t} / ${e} (${s}%)`),i&&n&&(i.textContent=n)}function dr(){const t=document.getElementById("loading-screen");t&&(t.classList.add("fade-out"),setTimeout(()=>{t.style.display="none"},500))}async function Yl(){try{f("..."),await ka(la,["high"]),f(""),la(0,100,100,"..."),qi(ur).mount("#app"),await new Promise(e=>setTimeout(e,200)),window.__INIT_THREE_SCENE__&&await window.__INIT_THREE_SCENE__((e,s,n)=>{la(0,0,n,`3D... ${n}%`)}),f(""),setTimeout(()=>{dr()},300),setTimeout(async()=>{try{f("..."),await ka(null,["medium"]),f("")}catch(e){f(":",e)}},1e3)}catch(t){f(":",t),qi(ur).mount("#app"),dr()}}kw()?(f("Safari"),Aw()):(f("Safari"),Yl());
