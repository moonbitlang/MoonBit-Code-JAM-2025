import{T as Xh,a as gl,b as od,L as id,c as Wi,F as ha,M as xs,V as _n,C as as,d as ks,S as en,e as Yh,P as _i,D as ys,f as Ho,g as Be,I as rd,Q as Si,h as Zh,O as ad,i as ki,j as Qh,B as Ki,k as e0,l as cd,N as t0,m as n0,n as s0,o as bl,p as ld,R as Bs,q as o0,r as i0,s as r0,t as Fc,u as a0,v as Ut,w as Cn,x as Bt,y as c0,z as ud,A as l0,E as St,G as u0,H as _0,J as $0,K as d0,U as ts,W as Ir,X as _d,Y as p0,Z as m0,_ as f0,$ as h0,a0 as g0,a1 as $d,a2 as b0,a3 as u_,a4 as __,a5 as $_,a6 as d_,a7 as yl,a8 as y0,a9 as w0,aa as dn,ab as v0,ac as S0,ad as hs,ae as qa,af as Wa,ag as Ka,ah as k0,ai as M0,aj as di,ak as $i,al as p_,am as C0,an as dd,ao as cr,ap as wl,aq as ga,ar as x0,as as P0,at as L0,au as I0,av as m_,aw as vl,ax as T0,ay as f_}from"./three-DALeLLf3.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const E0="release";function f(...e){switch(E0){case"debug":console.log(...e);break}}/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ru(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return n=>n in t}const pt={},pi=[],ss=()=>{},pd=()=>!1,Ja=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),au=e=>e.startsWith("onUpdate:"),Xt=Object.assign,cu=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},A0=Object.prototype.hasOwnProperty,rt=(e,t)=>A0.call(e,t),Oe=Array.isArray,mi=e=>Xa(e)==="[object Map]",md=e=>Xa(e)==="[object Set]",ze=e=>typeof e=="function",Tt=e=>typeof e=="string",So=e=>typeof e=="symbol",vt=e=>e!==null&&typeof e=="object",fd=e=>(vt(e)||ze(e))&&ze(e.then)&&ze(e.catch),hd=Object.prototype.toString,Xa=e=>hd.call(e),G0=e=>Xa(e).slice(8,-1),gd=e=>Xa(e)==="[object Object]",lu=e=>Tt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ji=ru(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ya=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},R0=/-\w/g,mo=Ya(e=>e.replace(R0,t=>t.slice(1).toUpperCase())),O0=/\B([A-Z])/g,Yo=Ya(e=>e.replace(O0,"-$1").toLowerCase()),bd=Ya(e=>e.charAt(0).toUpperCase()+e.slice(1)),Uc=Ya(e=>e?`on${bd(e)}`:""),lo=(e,t)=>!Object.is(e,t),Bc=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},yd=(e,t,n,o=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:o,value:n})},D0=e=>{const t=parseFloat(e);return isNaN(t)?e:t},N0=e=>{const t=Tt(e)?Number(e):NaN;return isNaN(t)?e:t};let h_;const Za=()=>h_||(h_=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Bn(e){if(Oe(e)){const t={};for(let n=0;n<e.length;n++){const o=e[n],s=Tt(o)?U0(o):Bn(o);if(s)for(const i in s)t[i]=s[i]}return t}else if(Tt(e)||vt(e))return e}const j0=/;(?![^(]*\))/g,H0=/:([^]+)/,F0=/\/\*[^]*?\*\//g;function U0(e){const t={};return e.replace(F0,"").split(j0).forEach(n=>{if(n){const o=n.split(H0);o.length>1&&(t[o[0].trim()]=o[1].trim())}}),t}function wt(e){let t="";if(Tt(e))t=e;else if(Oe(e))for(let n=0;n<e.length;n++){const o=wt(e[n]);o&&(t+=o+" ")}else if(vt(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const B0="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",z0=ru(B0);function wd(e){return!!e||e===""}const vd=e=>!!(e&&e.__v_isRef===!0),ce=e=>Tt(e)?e:e==null?"":Oe(e)||vt(e)&&(e.toString===hd||!ze(e.toString))?vd(e)?ce(e.value):JSON.stringify(e,Sd,2):String(e),Sd=(e,t)=>vd(t)?Sd(e,t.value):mi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[o,s],i)=>(n[zc(o,i)+" =>"]=s,n),{})}:md(t)?{[`Set(${t.size})`]:[...t.values()].map(n=>zc(n))}:So(t)?zc(t):vt(t)&&!Oe(t)&&!gd(t)?String(t):t,zc=(e,t="")=>{var n;return So(e)?`Symbol(${(n=e.description)!=null?n:t})`:e};function V0(e){return e==null?"initial":typeof e=="string"?e===""?" ":e:String(e)}/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let wn;class q0{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=wn,!t&&wn&&(this.index=(wn.scopes||(wn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].pause();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,n;if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].resume();for(t=0,n=this.effects.length;t<n;t++)this.effects[t].resume()}}run(t){if(this._active){const n=wn;try{return wn=this,t()}finally{wn=n}}}on(){++this._on===1&&(this.prevScope=wn,wn=this)}off(){this._on>0&&--this._on===0&&(wn=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let n,o;for(n=0,o=this.effects.length;n<o;n++)this.effects[n].stop();for(this.effects.length=0,n=0,o=this.cleanups.length;n<o;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,o=this.scopes.length;n<o;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function W0(){return wn}let gt;const Vc=new WeakSet;class kd{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,wn&&wn.active&&wn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Vc.has(this)&&(Vc.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Cd(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,g_(this),xd(this);const t=gt,n=os;gt=this,os=!0;try{return this.fn()}finally{Pd(this),gt=t,os=n,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)$u(t);this.deps=this.depsTail=void 0,g_(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Vc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Sl(this)&&this.run()}get dirty(){return Sl(this)}}let Md=0,Xi,Yi;function Cd(e,t=!1){if(e.flags|=8,t){e.next=Yi,Yi=e;return}e.next=Xi,Xi=e}function uu(){Md++}function _u(){if(--Md>0)return;if(Yi){let t=Yi;for(Yi=void 0;t;){const n=t.next;t.next=void 0,t.flags&=-9,t=n}}let e;for(;Xi;){let t=Xi;for(Xi=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(o){e||(e=o)}t=n}}if(e)throw e}function xd(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Pd(e){let t,n=e.depsTail,o=n;for(;o;){const s=o.prevDep;o.version===-1?(o===n&&(n=s),$u(o),K0(o)):t=o,o.dep.activeLink=o.prevActiveLink,o.prevActiveLink=void 0,o=s}e.deps=t,e.depsTail=n}function Sl(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Ld(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Ld(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===lr)||(e.globalVersion=lr,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Sl(e))))return;e.flags|=2;const t=e.dep,n=gt,o=os;gt=e,os=!0;try{xd(e);const s=e.fn(e._value);(t.version===0||lo(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(s){throw t.version++,s}finally{gt=n,os=o,Pd(e),e.flags&=-3}}function $u(e,t=!1){const{dep:n,prevSub:o,nextSub:s}=e;if(o&&(o.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=o,e.nextSub=void 0),n.subs===e&&(n.subs=o,!o&&n.computed)){n.computed.flags&=-5;for(let i=n.computed.deps;i;i=i.nextDep)$u(i,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function K0(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let os=!0;const Id=[];function zs(){Id.push(os),os=!1}function Vs(){const e=Id.pop();os=e===void 0?!0:e}function g_(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const n=gt;gt=void 0;try{t()}finally{gt=n}}}let lr=0;class J0{constructor(t,n){this.sub=t,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class du{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!gt||!os||gt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==gt)n=this.activeLink=new J0(gt,this),gt.deps?(n.prevDep=gt.depsTail,gt.depsTail.nextDep=n,gt.depsTail=n):gt.deps=gt.depsTail=n,Td(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const o=n.nextDep;o.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=o),n.prevDep=gt.depsTail,n.nextDep=void 0,gt.depsTail.nextDep=n,gt.depsTail=n,gt.deps===n&&(gt.deps=o)}return n}trigger(t){this.version++,lr++,this.notify(t)}notify(t){uu();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{_u()}}}function Td(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let o=t.deps;o;o=o.nextDep)Td(o)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const kl=new WeakMap,Fo=Symbol(""),Ml=Symbol(""),ur=Symbol("");function Qt(e,t,n){if(os&&gt){let o=kl.get(e);o||kl.set(e,o=new Map);let s=o.get(n);s||(o.set(n,s=new du),s.map=o,s.key=n),s.track()}}function js(e,t,n,o,s,i){const r=kl.get(e);if(!r){lr++;return}const a=c=>{c&&c.trigger()};if(uu(),t==="clear")r.forEach(a);else{const c=Oe(e),l=c&&lu(n);if(c&&n==="length"){const u=Number(o);r.forEach((_,$)=>{($==="length"||$===ur||!So($)&&$>=u)&&a(_)})}else switch((n!==void 0||r.has(void 0))&&a(r.get(n)),l&&a(r.get(ur)),t){case"add":c?l&&a(r.get("length")):(a(r.get(Fo)),mi(e)&&a(r.get(Ml)));break;case"delete":c||(a(r.get(Fo)),mi(e)&&a(r.get(Ml)));break;case"set":mi(e)&&a(r.get(Fo));break}}_u()}function si(e){const t=ot(e);return t===e?t:(Qt(t,"iterate",ur),Jn(e)?t:t.map(Jt))}function Qa(e){return Qt(e=ot(e),"iterate",ur),e}const X0={__proto__:null,[Symbol.iterator](){return qc(this,Symbol.iterator,Jt)},concat(...e){return si(this).concat(...e.map(t=>Oe(t)?si(t):t))},entries(){return qc(this,"entries",e=>(e[1]=Jt(e[1]),e))},every(e,t){return Gs(this,"every",e,t,void 0,arguments)},filter(e,t){return Gs(this,"filter",e,t,n=>n.map(Jt),arguments)},find(e,t){return Gs(this,"find",e,t,Jt,arguments)},findIndex(e,t){return Gs(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Gs(this,"findLast",e,t,Jt,arguments)},findLastIndex(e,t){return Gs(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Gs(this,"forEach",e,t,void 0,arguments)},includes(...e){return Wc(this,"includes",e)},indexOf(...e){return Wc(this,"indexOf",e)},join(e){return si(this).join(e)},lastIndexOf(...e){return Wc(this,"lastIndexOf",e)},map(e,t){return Gs(this,"map",e,t,void 0,arguments)},pop(){return Ai(this,"pop")},push(...e){return Ai(this,"push",e)},reduce(e,...t){return b_(this,"reduce",e,t)},reduceRight(e,...t){return b_(this,"reduceRight",e,t)},shift(){return Ai(this,"shift")},some(e,t){return Gs(this,"some",e,t,void 0,arguments)},splice(...e){return Ai(this,"splice",e)},toReversed(){return si(this).toReversed()},toSorted(e){return si(this).toSorted(e)},toSpliced(...e){return si(this).toSpliced(...e)},unshift(...e){return Ai(this,"unshift",e)},values(){return qc(this,"values",Jt)}};function qc(e,t,n){const o=Qa(e),s=o[t]();return o!==e&&!Jn(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.done||(i.value=n(i.value)),i}),s}const Y0=Array.prototype;function Gs(e,t,n,o,s,i){const r=Qa(e),a=r!==e&&!Jn(e),c=r[t];if(c!==Y0[t]){const _=c.apply(e,i);return a?Jt(_):_}let l=n;r!==e&&(a?l=function(_,$){return n.call(this,Jt(_),$,e)}:n.length>2&&(l=function(_,$){return n.call(this,_,$,e)}));const u=c.call(r,l,o);return a&&s?s(u):u}function b_(e,t,n,o){const s=Qa(e);let i=n;return s!==e&&(Jn(e)?n.length>3&&(i=function(r,a,c){return n.call(this,r,a,c,e)}):i=function(r,a,c){return n.call(this,r,Jt(a),c,e)}),s[t](i,...o)}function Wc(e,t,n){const o=ot(e);Qt(o,"iterate",ur);const s=o[t](...n);return(s===-1||s===!1)&&hu(n[0])?(n[0]=ot(n[0]),o[t](...n)):s}function Ai(e,t,n=[]){zs(),uu();const o=ot(e)[t].apply(e,n);return _u(),Vs(),o}const Z0=ru("__proto__,__v_isRef,__isVue"),Ed=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(So));function Q0(e){So(e)||(e=String(e));const t=ot(this);return Qt(t,"has",e),t.hasOwnProperty(e)}class Ad{constructor(t=!1,n=!1){this._isReadonly=t,this._isShallow=n}get(t,n,o){if(n==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return i;if(n==="__v_raw")return o===(s?i?lg:Dd:i?Od:Rd).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(o)?t:void 0;const r=Oe(t);if(!s){let c;if(r&&(c=X0[n]))return c;if(n==="hasOwnProperty")return Q0}const a=Reflect.get(t,n,an(t)?t:o);if((So(n)?Ed.has(n):Z0(n))||(s||Qt(t,"get",n),i))return a;if(an(a)){const c=r&&lu(n)?a:a.value;return s&&vt(c)?xl(c):c}return vt(a)?s?xl(a):mu(a):a}}class Gd extends Ad{constructor(t=!1){super(!1,t)}set(t,n,o,s){let i=t[n];if(!this._isShallow){const c=fo(i);if(!Jn(o)&&!fo(o)&&(i=ot(i),o=ot(o)),!Oe(t)&&an(i)&&!an(o))return c||(i.value=o),!0}const r=Oe(t)&&lu(n)?Number(n)<t.length:rt(t,n),a=Reflect.set(t,n,o,an(t)?t:s);return t===ot(s)&&(r?lo(o,i)&&js(t,"set",n,o):js(t,"add",n,o)),a}deleteProperty(t,n){const o=rt(t,n);t[n];const s=Reflect.deleteProperty(t,n);return s&&o&&js(t,"delete",n,void 0),s}has(t,n){const o=Reflect.has(t,n);return(!So(n)||!Ed.has(n))&&Qt(t,"has",n),o}ownKeys(t){return Qt(t,"iterate",Oe(t)?"length":Fo),Reflect.ownKeys(t)}}class eg extends Ad{constructor(t=!1){super(!0,t)}set(t,n){return!0}deleteProperty(t,n){return!0}}const tg=new Gd,ng=new eg,sg=new Gd(!0);const Cl=e=>e,Fr=e=>Reflect.getPrototypeOf(e);function og(e,t,n){return function(...o){const s=this.__v_raw,i=ot(s),r=mi(i),a=e==="entries"||e===Symbol.iterator&&r,c=e==="keys"&&r,l=s[e](...o),u=n?Cl:t?ba:Jt;return!t&&Qt(i,"iterate",c?Ml:Fo),{next(){const{value:_,done:$}=l.next();return $?{value:_,done:$}:{value:a?[u(_[0]),u(_[1])]:u(_),done:$}},[Symbol.iterator](){return this}}}}function Ur(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function ig(e,t){const n={get(s){const i=this.__v_raw,r=ot(i),a=ot(s);e||(lo(s,a)&&Qt(r,"get",s),Qt(r,"get",a));const{has:c}=Fr(r),l=t?Cl:e?ba:Jt;if(c.call(r,s))return l(i.get(s));if(c.call(r,a))return l(i.get(a));i!==r&&i.get(s)},get size(){const s=this.__v_raw;return!e&&Qt(ot(s),"iterate",Fo),s.size},has(s){const i=this.__v_raw,r=ot(i),a=ot(s);return e||(lo(s,a)&&Qt(r,"has",s),Qt(r,"has",a)),s===a?i.has(s):i.has(s)||i.has(a)},forEach(s,i){const r=this,a=r.__v_raw,c=ot(a),l=t?Cl:e?ba:Jt;return!e&&Qt(c,"iterate",Fo),a.forEach((u,_)=>s.call(i,l(u),l(_),r))}};return Xt(n,e?{add:Ur("add"),set:Ur("set"),delete:Ur("delete"),clear:Ur("clear")}:{add(s){!t&&!Jn(s)&&!fo(s)&&(s=ot(s));const i=ot(this);return Fr(i).has.call(i,s)||(i.add(s),js(i,"add",s,s)),this},set(s,i){!t&&!Jn(i)&&!fo(i)&&(i=ot(i));const r=ot(this),{has:a,get:c}=Fr(r);let l=a.call(r,s);l||(s=ot(s),l=a.call(r,s));const u=c.call(r,s);return r.set(s,i),l?lo(i,u)&&js(r,"set",s,i):js(r,"add",s,i),this},delete(s){const i=ot(this),{has:r,get:a}=Fr(i);let c=r.call(i,s);c||(s=ot(s),c=r.call(i,s)),a&&a.call(i,s);const l=i.delete(s);return c&&js(i,"delete",s,void 0),l},clear(){const s=ot(this),i=s.size!==0,r=s.clear();return i&&js(s,"clear",void 0,void 0),r}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=og(s,e,t)}),n}function pu(e,t){const n=ig(e,t);return(o,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?o:Reflect.get(rt(n,s)&&s in o?n:o,s,i)}const rg={get:pu(!1,!1)},ag={get:pu(!1,!0)},cg={get:pu(!0,!1)};const Rd=new WeakMap,Od=new WeakMap,Dd=new WeakMap,lg=new WeakMap;function ug(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function _g(e){return e.__v_skip||!Object.isExtensible(e)?0:ug(G0(e))}function mu(e){return fo(e)?e:fu(e,!1,tg,rg,Rd)}function $g(e){return fu(e,!1,sg,ag,Od)}function xl(e){return fu(e,!0,ng,cg,Dd)}function fu(e,t,n,o,s){if(!vt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=_g(e);if(i===0)return e;const r=s.get(e);if(r)return r;const a=new Proxy(e,i===2?o:n);return s.set(e,a),a}function fi(e){return fo(e)?fi(e.__v_raw):!!(e&&e.__v_isReactive)}function fo(e){return!!(e&&e.__v_isReadonly)}function Jn(e){return!!(e&&e.__v_isShallow)}function hu(e){return e?!!e.__v_raw:!1}function ot(e){const t=e&&e.__v_raw;return t?ot(t):e}function dg(e){return!rt(e,"__v_skip")&&Object.isExtensible(e)&&yd(e,"__v_skip",!0),e}const Jt=e=>vt(e)?mu(e):e,ba=e=>vt(e)?xl(e):e;function an(e){return e?e.__v_isRef===!0:!1}function oe(e){return pg(e,!1)}function pg(e,t){return an(e)?e:new mg(e,t)}class mg{constructor(t,n){this.dep=new du,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?t:ot(t),this._value=n?t:Jt(t),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(t){const n=this._rawValue,o=this.__v_isShallow||Jn(t)||fo(t);t=o?t:ot(t),lo(t,n)&&(this._rawValue=t,this._value=o?t:Jt(t),this.dep.trigger())}}function ye(e){return an(e)?e.value:e}const fg={get:(e,t,n)=>t==="__v_raw"?e:ye(Reflect.get(e,t,n)),set:(e,t,n,o)=>{const s=e[t];return an(s)&&!an(n)?(s.value=n,!0):Reflect.set(e,t,n,o)}};function Nd(e){return fi(e)?e:new Proxy(e,fg)}class hg{constructor(t,n,o){this.fn=t,this.setter=n,this._value=void 0,this.dep=new du(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=lr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=o}notify(){if(this.flags|=16,!(this.flags&8)&&gt!==this)return Cd(this,!0),!0}get value(){const t=this.dep.track();return Ld(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function gg(e,t,n=!1){let o,s;return ze(e)?o=e:(o=e.get,s=e.set),new hg(o,s,n)}const Br={},ya=new WeakMap;let Eo;function bg(e,t=!1,n=Eo){if(n){let o=ya.get(n);o||ya.set(n,o=[]),o.push(e)}}function yg(e,t,n=pt){const{immediate:o,deep:s,once:i,scheduler:r,augmentJob:a,call:c}=n,l=v=>s?v:Jn(v)||s===!1||s===0?Hs(v,1):Hs(v);let u,_,$,d,p=!1,b=!1;if(an(e)?(_=()=>e.value,p=Jn(e)):fi(e)?(_=()=>l(e),p=!0):Oe(e)?(b=!0,p=e.some(v=>fi(v)||Jn(v)),_=()=>e.map(v=>{if(an(v))return v.value;if(fi(v))return l(v);if(ze(v))return c?c(v,2):v()})):ze(e)?t?_=c?()=>c(e,2):e:_=()=>{if($){zs();try{$()}finally{Vs()}}const v=Eo;Eo=u;try{return c?c(e,3,[d]):e(d)}finally{Eo=v}}:_=ss,t&&s){const v=_,k=s===!0?1/0:s;_=()=>Hs(v(),k)}const g=W0(),m=()=>{u.stop(),g&&g.active&&cu(g.effects,u)};if(i&&t){const v=t;t=(...k)=>{v(...k),m()}}let w=b?new Array(e.length).fill(Br):Br;const y=v=>{if(!(!(u.flags&1)||!u.dirty&&!v))if(t){const k=u.run();if(s||p||(b?k.some((L,P)=>lo(L,w[P])):lo(k,w))){$&&$();const L=Eo;Eo=u;try{const P=[k,w===Br?void 0:b&&w[0]===Br?[]:w,d];w=k,c?c(t,3,P):t(...P)}finally{Eo=L}}}else u.run()};return a&&a(y),u=new kd(_),u.scheduler=r?()=>r(y,!1):y,d=v=>bg(v,!1,u),$=u.onStop=()=>{const v=ya.get(u);if(v){if(c)c(v,4);else for(const k of v)k();ya.delete(u)}},t?o?y(!0):w=u.run():r?r(y.bind(null,!0),!0):u.run(),m.pause=u.pause.bind(u),m.resume=u.resume.bind(u),m.stop=m,m}function Hs(e,t=1/0,n){if(t<=0||!vt(e)||e.__v_skip||(n=n||new Map,(n.get(e)||0)>=t))return e;if(n.set(e,t),t--,an(e))Hs(e.value,t,n);else if(Oe(e))for(let o=0;o<e.length;o++)Hs(e[o],t,n);else if(md(e)||mi(e))e.forEach(o=>{Hs(o,t,n)});else if(gd(e)){for(const o in e)Hs(e[o],t,n);for(const o of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,o)&&Hs(e[o],t,n)}return e}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Tr(e,t,n,o){try{return o?e(...o):e()}catch(s){ec(s,t,n)}}function cs(e,t,n,o){if(ze(e)){const s=Tr(e,t,n,o);return s&&fd(s)&&s.catch(i=>{ec(i,t,n)}),s}if(Oe(e)){const s=[];for(let i=0;i<e.length;i++)s.push(cs(e[i],t,n,o));return s}}function ec(e,t,n,o=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:r}=t&&t.appContext.config||pt;if(t){let a=t.parent;const c=t.proxy,l=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const u=a.ec;if(u){for(let _=0;_<u.length;_++)if(u[_](e,c,l)===!1)return}a=a.parent}if(i){zs(),Tr(i,null,10,[e,c,l]),Vs();return}}wg(e,n,s,o,r)}function wg(e,t,n,o=!0,s=!1){if(s)throw e;console.error(e)}const pn=[];let ms=-1;const hi=[];let eo=null,ri=0;const jd=Promise.resolve();let wa=null;function _r(e){const t=wa||jd;return e?t.then(this?e.bind(this):e):t}function vg(e){let t=ms+1,n=pn.length;for(;t<n;){const o=t+n>>>1,s=pn[o],i=$r(s);i<e||i===e&&s.flags&2?t=o+1:n=o}return t}function gu(e){if(!(e.flags&1)){const t=$r(e),n=pn[pn.length-1];!n||!(e.flags&2)&&t>=$r(n)?pn.push(e):pn.splice(vg(t),0,e),e.flags|=1,Hd()}}function Hd(){wa||(wa=jd.then(Bd))}function Fd(e){Oe(e)?hi.push(...e):eo&&e.id===-1?eo.splice(ri+1,0,e):e.flags&1||(hi.push(e),e.flags|=1),Hd()}function y_(e,t,n=ms+1){for(;n<pn.length;n++){const o=pn[n];if(o&&o.flags&2){if(e&&o.id!==e.uid)continue;pn.splice(n,1),n--,o.flags&4&&(o.flags&=-2),o(),o.flags&4||(o.flags&=-2)}}}function Ud(e){if(hi.length){const t=[...new Set(hi)].sort((n,o)=>$r(n)-$r(o));if(hi.length=0,eo){eo.push(...t);return}for(eo=t,ri=0;ri<eo.length;ri++){const n=eo[ri];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}eo=null,ri=0}}const $r=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Bd(e){try{for(ms=0;ms<pn.length;ms++){const t=pn[ms];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Tr(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;ms<pn.length;ms++){const t=pn[ms];t&&(t.flags&=-2)}ms=-1,pn.length=0,Ud(),wa=null,(pn.length||hi.length)&&Bd()}}let Vn=null,zd=null;function va(e){const t=Vn;return Vn=e,zd=e&&e.type.__scopeId||null,t}function Vd(e,t=Vn,n){if(!t||e._n)return e;const o=(...s)=>{o._d&&Ma(-1);const i=va(t);let r;try{r=e(...s)}finally{va(i),o._d&&Ma(1)}return r};return o._n=!0,o._c=!0,o._d=!0,o}function qd(e,t){if(Vn===null)return e;const n=ic(Vn),o=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,r,a,c=pt]=t[s];i&&(ze(i)&&(i={mounted:i,updated:i}),i.deep&&Hs(r),o.push({dir:i,instance:n,value:r,oldValue:void 0,arg:a,modifiers:c}))}return e}function xo(e,t,n,o){const s=e.dirs,i=t&&t.dirs;for(let r=0;r<s.length;r++){const a=s[r];i&&(a.oldValue=i[r].value);let c=a.dir[o];c&&(zs(),cs(c,n,8,[e.el,a,e,t]),Vs())}}const Wd=Symbol("_vte"),Kd=e=>e.__isTeleport,Zi=e=>e&&(e.disabled||e.disabled===""),w_=e=>e&&(e.defer||e.defer===""),v_=e=>typeof SVGElement<"u"&&e instanceof SVGElement,S_=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,Pl=(e,t)=>{const n=e&&e.to;return Tt(n)?t?t(n):null:n},Jd={name:"Teleport",__isTeleport:!0,process(e,t,n,o,s,i,r,a,c,l){const{mc:u,pc:_,pbc:$,o:{insert:d,querySelector:p,createText:b,createComment:g}}=l,m=Zi(t.props);let{shapeFlag:w,children:y,dynamicChildren:v}=t;if(e==null){const k=t.el=b(""),L=t.anchor=b("");d(k,n,o),d(L,n,o);const P=(I,R)=>{w&16&&u(y,I,R,s,i,r,a,c)},O=()=>{const I=t.target=Pl(t.props,p),R=Yd(I,t,b,d);I&&(r!=="svg"&&v_(I)?r="svg":r!=="mathml"&&S_(I)&&(r="mathml"),s&&s.isCE&&(s.ce._teleportTargets||(s.ce._teleportTargets=new Set)).add(I),m||(P(I,R),ia(t,!1)))};m&&(P(n,L),ia(t,!0)),w_(t.props)?(t.el.__isMounted=!1,$n(()=>{O(),delete t.el.__isMounted},i)):O()}else{if(w_(t.props)&&e.el.__isMounted===!1){$n(()=>{Jd.process(e,t,n,o,s,i,r,a,c,l)},i);return}t.el=e.el,t.targetStart=e.targetStart;const k=t.anchor=e.anchor,L=t.target=e.target,P=t.targetAnchor=e.targetAnchor,O=Zi(e.props),I=O?n:L,R=O?k:P;if(r==="svg"||v_(L)?r="svg":(r==="mathml"||S_(L))&&(r="mathml"),v?($(e.dynamicChildren,v,I,s,i,r,a),vu(e,t,!0)):c||_(e,t,I,R,s,i,r,a,!1),m)O?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):zr(t,n,k,l,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const D=t.target=Pl(t.props,p);D&&zr(t,D,null,l,0)}else O&&zr(t,L,P,l,1);ia(t,m)}},remove(e,t,n,{um:o,o:{remove:s}},i){const{shapeFlag:r,children:a,anchor:c,targetStart:l,targetAnchor:u,target:_,props:$}=e;if(_&&(s(l),s(u)),i&&s(c),r&16){const d=i||!Zi($);for(let p=0;p<a.length;p++){const b=a[p];o(b,t,n,d,!!b.dynamicChildren)}}},move:zr,hydrate:Sg};function zr(e,t,n,{o:{insert:o},m:s},i=2){i===0&&o(e.targetAnchor,t,n);const{el:r,anchor:a,shapeFlag:c,children:l,props:u}=e,_=i===2;if(_&&o(r,t,n),(!_||Zi(u))&&c&16)for(let $=0;$<l.length;$++)s(l[$],t,n,2);_&&o(a,t,n)}function Sg(e,t,n,o,s,i,{o:{nextSibling:r,parentNode:a,querySelector:c,insert:l,createText:u}},_){function $(b,g,m,w){g.anchor=_(r(b),g,a(b),n,o,s,i),g.targetStart=m,g.targetAnchor=w}const d=t.target=Pl(t.props,c),p=Zi(t.props);if(d){const b=d._lpa||d.firstChild;if(t.shapeFlag&16)if(p)$(e,t,b,b&&r(b));else{t.anchor=r(e);let g=b;for(;g;){if(g&&g.nodeType===8){if(g.data==="teleport start anchor")t.targetStart=g;else if(g.data==="teleport anchor"){t.targetAnchor=g,d._lpa=t.targetAnchor&&r(t.targetAnchor);break}}g=r(g)}t.targetAnchor||Yd(d,t,u,l),_(b&&r(b),t,d,n,o,s,i)}ia(t,p)}else p&&t.shapeFlag&16&&$(e,t,e,r(e));return t.anchor&&r(t.anchor)}const Xd=Jd;function ia(e,t){const n=e.ctx;if(n&&n.ut){let o,s;for(t?(o=e.el,s=e.anchor):(o=e.targetStart,s=e.targetAnchor);o&&o!==s;)o.nodeType===1&&o.setAttribute("data-v-owner",n.uid),o=o.nextSibling;n.ut()}}function Yd(e,t,n,o){const s=t.targetStart=n(""),i=t.targetAnchor=n("");return s[Wd]=i,e&&(o(s,e),o(i,e)),i}const Ds=Symbol("_leaveCb"),Vr=Symbol("_enterCb");function kg(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return hn(()=>{e.isMounted=!0}),Ps(()=>{e.isUnmounting=!0}),e}const Fn=[Function,Array],Zd={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Fn,onEnter:Fn,onAfterEnter:Fn,onEnterCancelled:Fn,onBeforeLeave:Fn,onLeave:Fn,onAfterLeave:Fn,onLeaveCancelled:Fn,onBeforeAppear:Fn,onAppear:Fn,onAfterAppear:Fn,onAppearCancelled:Fn},Qd=e=>{const t=e.subTree;return t.component?Qd(t.component):t},Mg={name:"BaseTransition",props:Zd,setup(e,{slots:t}){const n=ku(),o=kg();return()=>{const s=t.default&&np(t.default(),!0);if(!s||!s.length)return;const i=ep(s),r=ot(e),{mode:a}=r;if(o.isLeaving)return Kc(i);const c=k_(i);if(!c)return Kc(i);let l=Ll(c,r,o,n,_=>l=_);c.type!==mn&&dr(c,l);let u=n.subTree&&k_(n.subTree);if(u&&u.type!==mn&&!Oo(u,c)&&Qd(n).type!==mn){let _=Ll(u,r,o,n);if(dr(u,_),a==="out-in"&&c.type!==mn)return o.isLeaving=!0,_.afterLeave=()=>{o.isLeaving=!1,n.job.flags&8||n.update(),delete _.afterLeave,u=void 0},Kc(i);a==="in-out"&&c.type!==mn?_.delayLeave=($,d,p)=>{const b=tp(o,u);b[String(u.key)]=u,$[Ds]=()=>{d(),$[Ds]=void 0,delete l.delayedLeave,u=void 0},l.delayedLeave=()=>{p(),delete l.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return i}}};function ep(e){let t=e[0];if(e.length>1){for(const n of e)if(n.type!==mn){t=n;break}}return t}const Cg=Mg;function tp(e,t){const{leavingVNodes:n}=e;let o=n.get(t.type);return o||(o=Object.create(null),n.set(t.type,o)),o}function Ll(e,t,n,o,s){const{appear:i,mode:r,persisted:a=!1,onBeforeEnter:c,onEnter:l,onAfterEnter:u,onEnterCancelled:_,onBeforeLeave:$,onLeave:d,onAfterLeave:p,onLeaveCancelled:b,onBeforeAppear:g,onAppear:m,onAfterAppear:w,onAppearCancelled:y}=t,v=String(e.key),k=tp(n,e),L=(I,R)=>{I&&cs(I,o,9,R)},P=(I,R)=>{const D=R[1];L(I,R),Oe(I)?I.every(x=>x.length<=1)&&D():I.length<=1&&D()},O={mode:r,persisted:a,beforeEnter(I){let R=c;if(!n.isMounted)if(i)R=g||c;else return;I[Ds]&&I[Ds](!0);const D=k[v];D&&Oo(e,D)&&D.el[Ds]&&D.el[Ds](),L(R,[I])},enter(I){let R=l,D=u,x=_;if(!n.isMounted)if(i)R=m||l,D=w||u,x=y||_;else return;let z=!1;const ge=I[Vr]=re=>{z||(z=!0,re?L(x,[I]):L(D,[I]),O.delayedLeave&&O.delayedLeave(),I[Vr]=void 0)};R?P(R,[I,ge]):ge()},leave(I,R){const D=String(e.key);if(I[Vr]&&I[Vr](!0),n.isUnmounting)return R();L($,[I]);let x=!1;const z=I[Ds]=ge=>{x||(x=!0,R(),ge?L(b,[I]):L(p,[I]),I[Ds]=void 0,k[D]===e&&delete k[D])};k[D]=e,d?P(d,[I,z]):z()},clone(I){const R=Ll(I,t,n,o,s);return s&&s(R),R}};return O}function Kc(e){if(tc(e))return e=ho(e),e.children=null,e}function k_(e){if(!tc(e))return Kd(e.type)&&e.children?ep(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:n}=e;if(n){if(t&16)return n[0];if(t&32&&ze(n.default))return n.default()}}function dr(e,t){e.shapeFlag&6&&e.component?(e.transition=t,dr(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function np(e,t=!1,n){let o=[],s=0;for(let i=0;i<e.length;i++){let r=e[i];const a=n==null?r.key:String(n)+String(r.key!=null?r.key:i);r.type===mt?(r.patchFlag&128&&s++,o=o.concat(np(r.children,t,a))):(t||r.type!==mn)&&o.push(a!=null?ho(r,{key:a}):r)}if(s>1)for(let i=0;i<o.length;i++)o[i].patchFlag=-2;return o}function sp(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Sa=new WeakMap;function Qi(e,t,n,o,s=!1){if(Oe(e)){e.forEach((p,b)=>Qi(p,t&&(Oe(t)?t[b]:t),n,o,s));return}if(er(o)&&!s){o.shapeFlag&512&&o.type.__asyncResolved&&o.component.subTree.component&&Qi(e,t,n,o.component.subTree);return}const i=o.shapeFlag&4?ic(o.component):o.el,r=s?null:i,{i:a,r:c}=e,l=t&&t.r,u=a.refs===pt?a.refs={}:a.refs,_=a.setupState,$=ot(_),d=_===pt?pd:p=>rt($,p);if(l!=null&&l!==c){if(M_(t),Tt(l))u[l]=null,d(l)&&(_[l]=null);else if(an(l)){l.value=null;const p=t;p.k&&(u[p.k]=null)}}if(ze(c))Tr(c,a,12,[r,u]);else{const p=Tt(c),b=an(c);if(p||b){const g=()=>{if(e.f){const m=p?d(c)?_[c]:u[c]:c.value;if(s)Oe(m)&&cu(m,i);else if(Oe(m))m.includes(i)||m.push(i);else if(p)u[c]=[i],d(c)&&(_[c]=u[c]);else{const w=[i];c.value=w,e.k&&(u[e.k]=w)}}else p?(u[c]=r,d(c)&&(_[c]=r)):b&&(c.value=r,e.k&&(u[e.k]=r))};if(r){const m=()=>{g(),Sa.delete(e)};m.id=-1,Sa.set(e,m),$n(m,n)}else M_(e),g()}}}function M_(e){const t=Sa.get(e);t&&(t.flags|=8,Sa.delete(e))}Za().requestIdleCallback;Za().cancelIdleCallback;const er=e=>!!e.type.__asyncLoader,tc=e=>e.type.__isKeepAlive;function xg(e,t){op(e,"a",t)}function Pg(e,t){op(e,"da",t)}function op(e,t,n=fn){const o=e.__wdc||(e.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(nc(t,o,n),n){let s=n.parent;for(;s&&s.parent;)tc(s.parent.vnode)&&Lg(o,t,n,s),s=s.parent}}function Lg(e,t,n,o){const s=nc(t,e,o,!0);bu(()=>{cu(o[t],s)},n)}function nc(e,t,n=fn,o=!1){if(n){const s=n[e]||(n[e]=[]),i=t.__weh||(t.__weh=(...r)=>{zs();const a=Er(n),c=cs(t,n,e,r);return a(),Vs(),c});return o?s.unshift(i):s.push(i),i}}const qs=e=>(t,n=fn)=>{(!mr||e==="sp")&&nc(e,(...o)=>t(...o),n)},Ig=qs("bm"),hn=qs("m"),ip=qs("bu"),Tg=qs("u"),Ps=qs("bum"),bu=qs("um"),Eg=qs("sp"),Ag=qs("rtg"),Gg=qs("rtc");function Rg(e,t=fn){nc("ec",e,t)}const Og=Symbol.for("v-ndc");function Xn(e,t,n,o){let s;const i=n,r=Oe(e);if(r||Tt(e)){const a=r&&fi(e);let c=!1,l=!1;a&&(c=!Jn(e),l=fo(e),e=Qa(e)),s=new Array(e.length);for(let u=0,_=e.length;u<_;u++)s[u]=t(c?l?ba(Jt(e[u])):Jt(e[u]):e[u],u,void 0,i)}else if(typeof e=="number"){s=new Array(e);for(let a=0;a<e;a++)s[a]=t(a+1,a,void 0,i)}else if(vt(e))if(e[Symbol.iterator])s=Array.from(e,(a,c)=>t(a,c,void 0,i));else{const a=Object.keys(e);s=new Array(a.length);for(let c=0,l=a.length;c<l;c++){const u=a[c];s[c]=t(e[u],u,c,i)}}else s=[];return s}const Il=e=>e?kp(e)?ic(e):Il(e.parent):null,tr=Xt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Il(e.parent),$root:e=>Il(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>ap(e),$forceUpdate:e=>e.f||(e.f=()=>{gu(e.update)}),$nextTick:e=>e.n||(e.n=_r.bind(e.proxy)),$watch:e=>ob.bind(e)}),Jc=(e,t)=>e!==pt&&!e.__isScriptSetup&&rt(e,t),Dg={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:n,setupState:o,data:s,props:i,accessCache:r,type:a,appContext:c}=e;let l;if(t[0]!=="$"){const d=r[t];if(d!==void 0)switch(d){case 1:return o[t];case 2:return s[t];case 4:return n[t];case 3:return i[t]}else{if(Jc(o,t))return r[t]=1,o[t];if(s!==pt&&rt(s,t))return r[t]=2,s[t];if((l=e.propsOptions[0])&&rt(l,t))return r[t]=3,i[t];if(n!==pt&&rt(n,t))return r[t]=4,n[t];Tl&&(r[t]=0)}}const u=tr[t];let _,$;if(u)return t==="$attrs"&&Qt(e.attrs,"get",""),u(e);if((_=a.__cssModules)&&(_=_[t]))return _;if(n!==pt&&rt(n,t))return r[t]=4,n[t];if($=c.config.globalProperties,rt($,t))return $[t]},set({_:e},t,n){const{data:o,setupState:s,ctx:i}=e;return Jc(s,t)?(s[t]=n,!0):o!==pt&&rt(o,t)?(o[t]=n,!0):rt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:o,appContext:s,propsOptions:i,type:r}},a){let c,l;return!!(n[a]||e!==pt&&a[0]!=="$"&&rt(e,a)||Jc(t,a)||(c=i[0])&&rt(c,a)||rt(o,a)||rt(tr,a)||rt(s.config.globalProperties,a)||(l=r.__cssModules)&&l[a])},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:rt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function C_(e){return Oe(e)?e.reduce((t,n)=>(t[n]=null,t),{}):e}let Tl=!0;function Ng(e){const t=ap(e),n=e.proxy,o=e.ctx;Tl=!1,t.beforeCreate&&x_(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:r,watch:a,provide:c,inject:l,created:u,beforeMount:_,mounted:$,beforeUpdate:d,updated:p,activated:b,deactivated:g,beforeDestroy:m,beforeUnmount:w,destroyed:y,unmounted:v,render:k,renderTracked:L,renderTriggered:P,errorCaptured:O,serverPrefetch:I,expose:R,inheritAttrs:D,components:x,directives:z,filters:ge}=t;if(l&&jg(l,o,null),r)for(const q in r){const G=r[q];ze(G)&&(o[q]=G.bind(n))}if(s){const q=s.call(n,n);vt(q)&&(e.data=mu(q))}if(Tl=!0,i)for(const q in i){const G=i[q],Y=ze(G)?G.bind(n,n):ze(G.get)?G.get.bind(n,n):ss,U=!ze(G)&&ze(G.set)?G.set.bind(n):ss,j=Xe({get:Y,set:U});Object.defineProperty(o,q,{enumerable:!0,configurable:!0,get:()=>j.value,set:J=>j.value=J})}if(a)for(const q in a)rp(a[q],o,n,q);if(c){const q=ze(c)?c.call(n):c;Reflect.ownKeys(q).forEach(G=>{Vg(G,q[G])})}u&&x_(u,e,"c");function he(q,G){Oe(G)?G.forEach(Y=>q(Y.bind(n))):G&&q(G.bind(n))}if(he(Ig,_),he(hn,$),he(ip,d),he(Tg,p),he(xg,b),he(Pg,g),he(Rg,O),he(Gg,L),he(Ag,P),he(Ps,w),he(bu,v),he(Eg,I),Oe(R))if(R.length){const q=e.exposed||(e.exposed={});R.forEach(G=>{Object.defineProperty(q,G,{get:()=>n[G],set:Y=>n[G]=Y,enumerable:!0})})}else e.exposed||(e.exposed={});k&&e.render===ss&&(e.render=k),D!=null&&(e.inheritAttrs=D),x&&(e.components=x),z&&(e.directives=z),I&&sp(e)}function jg(e,t,n=ss){Oe(e)&&(e=El(e));for(const o in e){const s=e[o];let i;vt(s)?"default"in s?i=ra(s.from||o,s.default,!0):i=ra(s.from||o):i=ra(s),an(i)?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>i.value,set:r=>i.value=r}):t[o]=i}}function x_(e,t,n){cs(Oe(e)?e.map(o=>o.bind(t.proxy)):e.bind(t.proxy),t,n)}function rp(e,t,n,o){let s=o.includes(".")?bp(n,o):()=>n[o];if(Tt(e)){const i=t[e];ze(i)&&Ln(s,i)}else if(ze(e))Ln(s,e.bind(n));else if(vt(e))if(Oe(e))e.forEach(i=>rp(i,t,n,o));else{const i=ze(e.handler)?e.handler.bind(n):t[e.handler];ze(i)&&Ln(s,i,e)}}function ap(e){const t=e.type,{mixins:n,extends:o}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:r}}=e.appContext,a=i.get(t);let c;return a?c=a:!s.length&&!n&&!o?c=t:(c={},s.length&&s.forEach(l=>ka(c,l,r,!0)),ka(c,t,r)),vt(t)&&i.set(t,c),c}function ka(e,t,n,o=!1){const{mixins:s,extends:i}=t;i&&ka(e,i,n,!0),s&&s.forEach(r=>ka(e,r,n,!0));for(const r in t)if(!(o&&r==="expose")){const a=Hg[r]||n&&n[r];e[r]=a?a(e[r],t[r]):t[r]}return e}const Hg={data:P_,props:L_,emits:L_,methods:Hi,computed:Hi,beforeCreate:un,created:un,beforeMount:un,mounted:un,beforeUpdate:un,updated:un,beforeDestroy:un,beforeUnmount:un,destroyed:un,unmounted:un,activated:un,deactivated:un,errorCaptured:un,serverPrefetch:un,components:Hi,directives:Hi,watch:Ug,provide:P_,inject:Fg};function P_(e,t){return t?e?function(){return Xt(ze(e)?e.call(this,this):e,ze(t)?t.call(this,this):t)}:t:e}function Fg(e,t){return Hi(El(e),El(t))}function El(e){if(Oe(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function un(e,t){return e?[...new Set([].concat(e,t))]:t}function Hi(e,t){return e?Xt(Object.create(null),e,t):t}function L_(e,t){return e?Oe(e)&&Oe(t)?[...new Set([...e,...t])]:Xt(Object.create(null),C_(e),C_(t??{})):t}function Ug(e,t){if(!e)return t;if(!t)return e;const n=Xt(Object.create(null),e);for(const o in t)n[o]=un(e[o],t[o]);return n}function cp(){return{app:null,config:{isNativeTag:pd,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Bg=0;function zg(e,t){return function(o,s=null){ze(o)||(o=Xt({},o)),s!=null&&!vt(s)&&(s=null);const i=cp(),r=new WeakSet,a=[];let c=!1;const l=i.app={_uid:Bg++,_component:o,_props:s,_container:null,_context:i,_instance:null,version:Cb,get config(){return i.config},set config(u){},use(u,..._){return r.has(u)||(u&&ze(u.install)?(r.add(u),u.install(l,..._)):ze(u)&&(r.add(u),u(l,..._))),l},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),l},component(u,_){return _?(i.components[u]=_,l):i.components[u]},directive(u,_){return _?(i.directives[u]=_,l):i.directives[u]},mount(u,_,$){if(!c){const d=l._ceVNode||Ct(o,s);return d.appContext=i,$===!0?$="svg":$===!1&&($=void 0),e(d,u,$),c=!0,l._container=u,u.__vue_app__=l,ic(d.component)}},onUnmount(u){a.push(u)},unmount(){c&&(cs(a,l._instance,16),e(null,l._container),delete l._container.__vue_app__)},provide(u,_){return i.provides[u]=_,l},runWithContext(u){const _=gi;gi=l;try{return u()}finally{gi=_}}};return l}}let gi=null;function Vg(e,t){if(fn){let n=fn.provides;const o=fn.parent&&fn.parent.provides;o===n&&(n=fn.provides=Object.create(o)),n[e]=t}}function ra(e,t,n=!1){const o=ku();if(o||gi){let s=gi?gi._context.provides:o?o.parent==null||o.ce?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return n&&ze(t)?t.call(o&&o.proxy):t}}const lp={},up=()=>Object.create(lp),_p=e=>Object.getPrototypeOf(e)===lp;function qg(e,t,n,o=!1){const s={},i=up();e.propsDefaults=Object.create(null),$p(e,t,s,i);for(const r in e.propsOptions[0])r in s||(s[r]=void 0);n?e.props=o?s:$g(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function Wg(e,t,n,o){const{props:s,attrs:i,vnode:{patchFlag:r}}=e,a=ot(s),[c]=e.propsOptions;let l=!1;if((o||r>0)&&!(r&16)){if(r&8){const u=e.vnode.dynamicProps;for(let _=0;_<u.length;_++){let $=u[_];if(sc(e.emitsOptions,$))continue;const d=t[$];if(c)if(rt(i,$))d!==i[$]&&(i[$]=d,l=!0);else{const p=mo($);s[p]=Al(c,a,p,d,e,!1)}else d!==i[$]&&(i[$]=d,l=!0)}}}else{$p(e,t,s,i)&&(l=!0);let u;for(const _ in a)(!t||!rt(t,_)&&((u=Yo(_))===_||!rt(t,u)))&&(c?n&&(n[_]!==void 0||n[u]!==void 0)&&(s[_]=Al(c,a,_,void 0,e,!0)):delete s[_]);if(i!==a)for(const _ in i)(!t||!rt(t,_))&&(delete i[_],l=!0)}l&&js(e.attrs,"set","")}function $p(e,t,n,o){const[s,i]=e.propsOptions;let r=!1,a;if(t)for(let c in t){if(Ji(c))continue;const l=t[c];let u;s&&rt(s,u=mo(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:sc(e.emitsOptions,c)||(!(c in o)||l!==o[c])&&(o[c]=l,r=!0)}if(i){const c=ot(n),l=a||pt;for(let u=0;u<i.length;u++){const _=i[u];n[_]=Al(s,c,_,l[_],e,!rt(l,_))}}return r}function Al(e,t,n,o,s,i){const r=e[n];if(r!=null){const a=rt(r,"default");if(a&&o===void 0){const c=r.default;if(r.type!==Function&&!r.skipFactory&&ze(c)){const{propsDefaults:l}=s;if(n in l)o=l[n];else{const u=Er(s);o=l[n]=c.call(null,t),u()}}else o=c;s.ce&&s.ce._setProp(n,o)}r[0]&&(i&&!a?o=!1:r[1]&&(o===""||o===Yo(n))&&(o=!0))}return o}const Kg=new WeakMap;function dp(e,t,n=!1){const o=n?Kg:t.propsCache,s=o.get(e);if(s)return s;const i=e.props,r={},a=[];let c=!1;if(!ze(e)){const u=_=>{c=!0;const[$,d]=dp(_,t,!0);Xt(r,$),d&&a.push(...d)};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!i&&!c)return vt(e)&&o.set(e,pi),pi;if(Oe(i))for(let u=0;u<i.length;u++){const _=mo(i[u]);I_(_)&&(r[_]=pt)}else if(i)for(const u in i){const _=mo(u);if(I_(_)){const $=i[u],d=r[_]=Oe($)||ze($)?{type:$}:Xt({},$),p=d.type;let b=!1,g=!0;if(Oe(p))for(let m=0;m<p.length;++m){const w=p[m],y=ze(w)&&w.name;if(y==="Boolean"){b=!0;break}else y==="String"&&(g=!1)}else b=ze(p)&&p.name==="Boolean";d[0]=b,d[1]=g,(b||rt(d,"default"))&&a.push(_)}}const l=[r,a];return vt(e)&&o.set(e,l),l}function I_(e){return e[0]!=="$"&&!Ji(e)}const yu=e=>e==="_"||e==="_ctx"||e==="$stable",wu=e=>Oe(e)?e.map(gs):[gs(e)],Jg=(e,t,n)=>{if(t._n)return t;const o=Vd((...s)=>wu(t(...s)),n);return o._c=!1,o},pp=(e,t,n)=>{const o=e._ctx;for(const s in e){if(yu(s))continue;const i=e[s];if(ze(i))t[s]=Jg(s,i,o);else if(i!=null){const r=wu(i);t[s]=()=>r}}},mp=(e,t)=>{const n=wu(t);e.slots.default=()=>n},fp=(e,t,n)=>{for(const o in t)(n||!yu(o))&&(e[o]=t[o])},Xg=(e,t,n)=>{const o=e.slots=up();if(e.vnode.shapeFlag&32){const s=t._;s?(fp(o,t,n),n&&yd(o,"_",s,!0)):pp(t,o)}else t&&mp(e,t)},Yg=(e,t,n)=>{const{vnode:o,slots:s}=e;let i=!0,r=pt;if(o.shapeFlag&32){const a=t._;a?n&&a===1?i=!1:fp(s,t,n):(i=!t.$stable,pp(t,s)),r=t}else t&&(mp(e,t),r={default:1});if(i)for(const a in s)!yu(a)&&r[a]==null&&delete s[a]},$n=$b;function Zg(e){return Qg(e)}function Qg(e,t){const n=Za();n.__VUE__=!0;const{insert:o,remove:s,patchProp:i,createElement:r,createText:a,createComment:c,setText:l,setElementText:u,parentNode:_,nextSibling:$,setScopeId:d=ss,insertStaticContent:p}=e,b=(C,T,A,te=null,K=null,X=null,_e=void 0,ie=null,Z=!!T.dynamicChildren)=>{if(C===T)return;C&&!Oo(C,T)&&(te=Fe(C),J(C,K,X,!0),C=null),T.patchFlag===-2&&(Z=!1,T.dynamicChildren=null);const{type:se,ref:ve,shapeFlag:de}=T;switch(se){case oc:g(C,T,A,te);break;case mn:m(C,T,A,te);break;case nr:C==null&&w(T,A,te,_e);break;case mt:x(C,T,A,te,K,X,_e,ie,Z);break;default:de&1?k(C,T,A,te,K,X,_e,ie,Z):de&6?z(C,T,A,te,K,X,_e,ie,Z):(de&64||de&128)&&se.process(C,T,A,te,K,X,_e,ie,Z,$t)}ve!=null&&K?Qi(ve,C&&C.ref,X,T||C,!T):ve==null&&C&&C.ref!=null&&Qi(C.ref,null,X,C,!0)},g=(C,T,A,te)=>{if(C==null)o(T.el=a(T.children),A,te);else{const K=T.el=C.el;T.children!==C.children&&l(K,T.children)}},m=(C,T,A,te)=>{C==null?o(T.el=c(T.children||""),A,te):T.el=C.el},w=(C,T,A,te)=>{[C.el,C.anchor]=p(C.children,T,A,te,C.el,C.anchor)},y=({el:C,anchor:T},A,te)=>{let K;for(;C&&C!==T;)K=$(C),o(C,A,te),C=K;o(T,A,te)},v=({el:C,anchor:T})=>{let A;for(;C&&C!==T;)A=$(C),s(C),C=A;s(T)},k=(C,T,A,te,K,X,_e,ie,Z)=>{T.type==="svg"?_e="svg":T.type==="math"&&(_e="mathml"),C==null?L(T,A,te,K,X,_e,ie,Z):I(C,T,K,X,_e,ie,Z)},L=(C,T,A,te,K,X,_e,ie)=>{let Z,se;const{props:ve,shapeFlag:de,transition:Se,dirs:Ce}=C;if(Z=C.el=r(C.type,X,ve&&ve.is,ve),de&8?u(Z,C.children):de&16&&O(C.children,Z,null,te,K,Xc(C,X),_e,ie),Ce&&xo(C,null,te,"created"),P(Z,C,C.scopeId,_e,te),ve){for(const Te in ve)Te!=="value"&&!Ji(Te)&&i(Z,Te,null,ve[Te],X,te);"value"in ve&&i(Z,"value",null,ve.value,X),(se=ve.onVnodeBeforeMount)&&us(se,te,C)}Ce&&xo(C,null,te,"beforeMount");const Ve=eb(K,Se);Ve&&Se.beforeEnter(Z),o(Z,T,A),((se=ve&&ve.onVnodeMounted)||Ve||Ce)&&$n(()=>{se&&us(se,te,C),Ve&&Se.enter(Z),Ce&&xo(C,null,te,"mounted")},K)},P=(C,T,A,te,K)=>{if(A&&d(C,A),te)for(let X=0;X<te.length;X++)d(C,te[X]);if(K){let X=K.subTree;if(T===X||wp(X.type)&&(X.ssContent===T||X.ssFallback===T)){const _e=K.vnode;P(C,_e,_e.scopeId,_e.slotScopeIds,K.parent)}}},O=(C,T,A,te,K,X,_e,ie,Z=0)=>{for(let se=Z;se<C.length;se++){const ve=C[se]=ie?to(C[se]):gs(C[se]);b(null,ve,T,A,te,K,X,_e,ie)}},I=(C,T,A,te,K,X,_e)=>{const ie=T.el=C.el;let{patchFlag:Z,dynamicChildren:se,dirs:ve}=T;Z|=C.patchFlag&16;const de=C.props||pt,Se=T.props||pt;let Ce;if(A&&Po(A,!1),(Ce=Se.onVnodeBeforeUpdate)&&us(Ce,A,T,C),ve&&xo(T,C,A,"beforeUpdate"),A&&Po(A,!0),(de.innerHTML&&Se.innerHTML==null||de.textContent&&Se.textContent==null)&&u(ie,""),se?R(C.dynamicChildren,se,ie,A,te,Xc(T,K),X):_e||G(C,T,ie,null,A,te,Xc(T,K),X,!1),Z>0){if(Z&16)D(ie,de,Se,A,K);else if(Z&2&&de.class!==Se.class&&i(ie,"class",null,Se.class,K),Z&4&&i(ie,"style",de.style,Se.style,K),Z&8){const Ve=T.dynamicProps;for(let Te=0;Te<Ve.length;Te++){const Ge=Ve[Te],be=de[Ge],at=Se[Ge];(at!==be||Ge==="value")&&i(ie,Ge,be,at,K,A)}}Z&1&&C.children!==T.children&&u(ie,T.children)}else!_e&&se==null&&D(ie,de,Se,A,K);((Ce=Se.onVnodeUpdated)||ve)&&$n(()=>{Ce&&us(Ce,A,T,C),ve&&xo(T,C,A,"updated")},te)},R=(C,T,A,te,K,X,_e)=>{for(let ie=0;ie<T.length;ie++){const Z=C[ie],se=T[ie],ve=Z.el&&(Z.type===mt||!Oo(Z,se)||Z.shapeFlag&198)?_(Z.el):A;b(Z,se,ve,null,te,K,X,_e,!0)}},D=(C,T,A,te,K)=>{if(T!==A){if(T!==pt)for(const X in T)!Ji(X)&&!(X in A)&&i(C,X,T[X],null,K,te);for(const X in A){if(Ji(X))continue;const _e=A[X],ie=T[X];_e!==ie&&X!=="value"&&i(C,X,ie,_e,K,te)}"value"in A&&i(C,"value",T.value,A.value,K)}},x=(C,T,A,te,K,X,_e,ie,Z)=>{const se=T.el=C?C.el:a(""),ve=T.anchor=C?C.anchor:a("");let{patchFlag:de,dynamicChildren:Se,slotScopeIds:Ce}=T;Ce&&(ie=ie?ie.concat(Ce):Ce),C==null?(o(se,A,te),o(ve,A,te),O(T.children||[],A,ve,K,X,_e,ie,Z)):de>0&&de&64&&Se&&C.dynamicChildren?(R(C.dynamicChildren,Se,A,K,X,_e,ie),(T.key!=null||K&&T===K.subTree)&&vu(C,T,!0)):G(C,T,A,ve,K,X,_e,ie,Z)},z=(C,T,A,te,K,X,_e,ie,Z)=>{T.slotScopeIds=ie,C==null?T.shapeFlag&512?K.ctx.activate(T,A,te,_e,Z):ge(T,A,te,K,X,_e,Z):re(C,T,Z)},ge=(C,T,A,te,K,X,_e)=>{const ie=C.component=bb(C,te,K);if(tc(C)&&(ie.ctx.renderer=$t),yb(ie,!1,_e),ie.asyncDep){if(K&&K.registerDep(ie,he,_e),!C.el){const Z=ie.subTree=Ct(mn);m(null,Z,T,A),C.placeholder=Z.el}}else he(ie,C,T,A,K,X,_e)},re=(C,T,A)=>{const te=T.component=C.component;if(ub(C,T,A))if(te.asyncDep&&!te.asyncResolved){q(te,T,A);return}else te.next=T,te.update();else T.el=C.el,te.vnode=T},he=(C,T,A,te,K,X,_e)=>{const ie=()=>{if(C.isMounted){let{next:de,bu:Se,u:Ce,parent:Ve,vnode:Te}=C;{const Dt=hp(C);if(Dt){de&&(de.el=Te.el,q(C,de,_e)),Dt.asyncDep.then(()=>{C.isUnmounted||ie()});return}}let Ge=de,be;Po(C,!1),de?(de.el=Te.el,q(C,de,_e)):de=Te,Se&&Bc(Se),(be=de.props&&de.props.onVnodeBeforeUpdate)&&us(be,Ve,de,Te),Po(C,!0);const at=E_(C),Pt=C.subTree;C.subTree=at,b(Pt,at,_(Pt.el),Fe(Pt),C,K,X),de.el=at.el,Ge===null&&_b(C,at.el),Ce&&$n(Ce,K),(be=de.props&&de.props.onVnodeUpdated)&&$n(()=>us(be,Ve,de,Te),K)}else{let de;const{el:Se,props:Ce}=T,{bm:Ve,m:Te,parent:Ge,root:be,type:at}=C,Pt=er(T);Po(C,!1),Ve&&Bc(Ve),!Pt&&(de=Ce&&Ce.onVnodeBeforeMount)&&us(de,Ge,T),Po(C,!0);{be.ce&&be.ce._def.shadowRoot!==!1&&be.ce._injectChildStyle(at);const Dt=C.subTree=E_(C);b(null,Dt,A,te,C,K,X),T.el=Dt.el}if(Te&&$n(Te,K),!Pt&&(de=Ce&&Ce.onVnodeMounted)){const Dt=T;$n(()=>us(de,Ge,Dt),K)}(T.shapeFlag&256||Ge&&er(Ge.vnode)&&Ge.vnode.shapeFlag&256)&&C.a&&$n(C.a,K),C.isMounted=!0,T=A=te=null}};C.scope.on();const Z=C.effect=new kd(ie);C.scope.off();const se=C.update=Z.run.bind(Z),ve=C.job=Z.runIfDirty.bind(Z);ve.i=C,ve.id=C.uid,Z.scheduler=()=>gu(ve),Po(C,!0),se()},q=(C,T,A)=>{T.component=C;const te=C.vnode.props;C.vnode=T,C.next=null,Wg(C,T.props,te,A),Yg(C,T.children,A),zs(),y_(C),Vs()},G=(C,T,A,te,K,X,_e,ie,Z=!1)=>{const se=C&&C.children,ve=C?C.shapeFlag:0,de=T.children,{patchFlag:Se,shapeFlag:Ce}=T;if(Se>0){if(Se&128){U(se,de,A,te,K,X,_e,ie,Z);return}else if(Se&256){Y(se,de,A,te,K,X,_e,ie,Z);return}}Ce&8?(ve&16&&Ke(se,K,X),de!==se&&u(A,de)):ve&16?Ce&16?U(se,de,A,te,K,X,_e,ie,Z):Ke(se,K,X,!0):(ve&8&&u(A,""),Ce&16&&O(de,A,te,K,X,_e,ie,Z))},Y=(C,T,A,te,K,X,_e,ie,Z)=>{C=C||pi,T=T||pi;const se=C.length,ve=T.length,de=Math.min(se,ve);let Se;for(Se=0;Se<de;Se++){const Ce=T[Se]=Z?to(T[Se]):gs(T[Se]);b(C[Se],Ce,A,null,K,X,_e,ie,Z)}se>ve?Ke(C,K,X,!0,!1,de):O(T,A,te,K,X,_e,ie,Z,de)},U=(C,T,A,te,K,X,_e,ie,Z)=>{let se=0;const ve=T.length;let de=C.length-1,Se=ve-1;for(;se<=de&&se<=Se;){const Ce=C[se],Ve=T[se]=Z?to(T[se]):gs(T[se]);if(Oo(Ce,Ve))b(Ce,Ve,A,null,K,X,_e,ie,Z);else break;se++}for(;se<=de&&se<=Se;){const Ce=C[de],Ve=T[Se]=Z?to(T[Se]):gs(T[Se]);if(Oo(Ce,Ve))b(Ce,Ve,A,null,K,X,_e,ie,Z);else break;de--,Se--}if(se>de){if(se<=Se){const Ce=Se+1,Ve=Ce<ve?T[Ce].el:te;for(;se<=Se;)b(null,T[se]=Z?to(T[se]):gs(T[se]),A,Ve,K,X,_e,ie,Z),se++}}else if(se>Se)for(;se<=de;)J(C[se],K,X,!0),se++;else{const Ce=se,Ve=se,Te=new Map;for(se=Ve;se<=Se;se++){const At=T[se]=Z?to(T[se]):gs(T[se]);At.key!=null&&Te.set(At.key,se)}let Ge,be=0;const at=Se-Ve+1;let Pt=!1,Dt=0;const An=new Array(at);for(se=0;se<at;se++)An[se]=0;for(se=Ce;se<=de;se++){const At=C[se];if(be>=at){J(At,K,X,!0);continue}let ln;if(At.key!=null)ln=Te.get(At.key);else for(Ge=Ve;Ge<=Se;Ge++)if(An[Ge-Ve]===0&&Oo(At,T[Ge])){ln=Ge;break}ln===void 0?J(At,K,X,!0):(An[ln-Ve]=se+1,ln>=Dt?Dt=ln:Pt=!0,b(At,T[ln],A,null,K,X,_e,ie,Z),be++)}const As=Pt?tb(An):pi;for(Ge=As.length-1,se=at-1;se>=0;se--){const At=Ve+se,ln=T[At],ko=T[At+1],ni=At+1<ve?ko.el||ko.placeholder:te;An[se]===0?b(null,ln,A,ni,K,X,_e,ie,Z):Pt&&(Ge<0||se!==As[Ge]?j(ln,A,ni,2):Ge--)}}},j=(C,T,A,te,K=null)=>{const{el:X,type:_e,transition:ie,children:Z,shapeFlag:se}=C;if(se&6){j(C.component.subTree,T,A,te);return}if(se&128){C.suspense.move(T,A,te);return}if(se&64){_e.move(C,T,A,$t);return}if(_e===mt){o(X,T,A);for(let de=0;de<Z.length;de++)j(Z[de],T,A,te);o(C.anchor,T,A);return}if(_e===nr){y(C,T,A);return}if(te!==2&&se&1&&ie)if(te===0)ie.beforeEnter(X),o(X,T,A),$n(()=>ie.enter(X),K);else{const{leave:de,delayLeave:Se,afterLeave:Ce}=ie,Ve=()=>{C.ctx.isUnmounted?s(X):o(X,T,A)},Te=()=>{X._isLeaving&&X[Ds](!0),de(X,()=>{Ve(),Ce&&Ce()})};Se?Se(X,Ve,Te):Te()}else o(X,T,A)},J=(C,T,A,te=!1,K=!1)=>{const{type:X,props:_e,ref:ie,children:Z,dynamicChildren:se,shapeFlag:ve,patchFlag:de,dirs:Se,cacheIndex:Ce}=C;if(de===-2&&(K=!1),ie!=null&&(zs(),Qi(ie,null,A,C,!0),Vs()),Ce!=null&&(T.renderCache[Ce]=void 0),ve&256){T.ctx.deactivate(C);return}const Ve=ve&1&&Se,Te=!er(C);let Ge;if(Te&&(Ge=_e&&_e.onVnodeBeforeUnmount)&&us(Ge,T,C),ve&6)De(C.component,A,te);else{if(ve&128){C.suspense.unmount(A,te);return}Ve&&xo(C,null,T,"beforeUnmount"),ve&64?C.type.remove(C,T,A,$t,te):se&&!se.hasOnce&&(X!==mt||de>0&&de&64)?Ke(se,T,A,!1,!0):(X===mt&&de&384||!K&&ve&16)&&Ke(Z,T,A),te&&W(C)}(Te&&(Ge=_e&&_e.onVnodeUnmounted)||Ve)&&$n(()=>{Ge&&us(Ge,T,C),Ve&&xo(C,null,T,"unmounted")},A)},W=C=>{const{type:T,el:A,anchor:te,transition:K}=C;if(T===mt){we(A,te);return}if(T===nr){v(C);return}const X=()=>{s(A),K&&!K.persisted&&K.afterLeave&&K.afterLeave()};if(C.shapeFlag&1&&K&&!K.persisted){const{leave:_e,delayLeave:ie}=K,Z=()=>_e(A,X);ie?ie(C.el,X,Z):Z()}else X()},we=(C,T)=>{let A;for(;C!==T;)A=$(C),s(C),C=A;s(T)},De=(C,T,A)=>{const{bum:te,scope:K,job:X,subTree:_e,um:ie,m:Z,a:se}=C;T_(Z),T_(se),te&&Bc(te),K.stop(),X&&(X.flags|=8,J(_e,C,T,A)),ie&&$n(ie,T),$n(()=>{C.isUnmounted=!0},T)},Ke=(C,T,A,te=!1,K=!1,X=0)=>{for(let _e=X;_e<C.length;_e++)J(C[_e],T,A,te,K)},Fe=C=>{if(C.shapeFlag&6)return Fe(C.component.subTree);if(C.shapeFlag&128)return C.suspense.next();const T=$(C.anchor||C.el),A=T&&T[Wd];return A?$(A):T};let it=!1;const ht=(C,T,A)=>{C==null?T._vnode&&J(T._vnode,null,null,!0):b(T._vnode||null,C,T,null,null,null,A),T._vnode=C,it||(it=!0,y_(),Ud(),it=!1)},$t={p:b,um:J,m:j,r:W,mt:ge,mc:O,pc:G,pbc:R,n:Fe,o:e};return{render:ht,hydrate:void 0,createApp:zg(ht)}}function Xc({type:e,props:t},n){return n==="svg"&&e==="foreignObject"||n==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Po({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function eb(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function vu(e,t,n=!1){const o=e.children,s=t.children;if(Oe(o)&&Oe(s))for(let i=0;i<o.length;i++){const r=o[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=to(s[i]),a.el=r.el),!n&&a.patchFlag!==-2&&vu(r,a)),a.type===oc&&a.patchFlag!==-1&&(a.el=r.el),a.type===mn&&!a.el&&(a.el=r.el)}}function tb(e){const t=e.slice(),n=[0];let o,s,i,r,a;const c=e.length;for(o=0;o<c;o++){const l=e[o];if(l!==0){if(s=n[n.length-1],e[s]<l){t[o]=s,n.push(o);continue}for(i=0,r=n.length-1;i<r;)a=i+r>>1,e[n[a]]<l?i=a+1:r=a;l<e[n[i]]&&(i>0&&(t[o]=n[i-1]),n[i]=o)}}for(i=n.length,r=n[i-1];i-- >0;)n[i]=r,r=t[r];return n}function hp(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:hp(t)}function T_(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const nb=Symbol.for("v-scx"),sb=()=>ra(nb);function Ln(e,t,n){return gp(e,t,n)}function gp(e,t,n=pt){const{immediate:o,deep:s,flush:i,once:r}=n,a=Xt({},n),c=t&&o||!t&&i!=="post";let l;if(mr){if(i==="sync"){const d=sb();l=d.__watcherHandles||(d.__watcherHandles=[])}else if(!c){const d=()=>{};return d.stop=ss,d.resume=ss,d.pause=ss,d}}const u=fn;a.call=(d,p,b)=>cs(d,u,p,b);let _=!1;i==="post"?a.scheduler=d=>{$n(d,u&&u.suspense)}:i!=="sync"&&(_=!0,a.scheduler=(d,p)=>{p?d():gu(d)}),a.augmentJob=d=>{t&&(d.flags|=4),_&&(d.flags|=2,u&&(d.id=u.uid,d.i=u))};const $=yg(e,t,a);return mr&&(l?l.push($):c&&$()),$}function ob(e,t,n){const o=this.proxy,s=Tt(e)?e.includes(".")?bp(o,e):()=>o[e]:e.bind(o,o);let i;ze(t)?i=t:(i=t.handler,n=t);const r=Er(this),a=gp(s,i.bind(o),n);return r(),a}function bp(e,t){const n=t.split(".");return()=>{let o=e;for(let s=0;s<n.length&&o;s++)o=o[n[s]];return o}}const ib=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${mo(t)}Modifiers`]||e[`${Yo(t)}Modifiers`];function rb(e,t,...n){if(e.isUnmounted)return;const o=e.vnode.props||pt;let s=n;const i=t.startsWith("update:"),r=i&&ib(o,t.slice(7));r&&(r.trim&&(s=n.map(u=>Tt(u)?u.trim():u)),r.number&&(s=n.map(D0)));let a,c=o[a=Uc(t)]||o[a=Uc(mo(t))];!c&&i&&(c=o[a=Uc(Yo(t))]),c&&cs(c,e,6,s);const l=o[a+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[a])return;e.emitted[a]=!0,cs(l,e,6,s)}}const ab=new WeakMap;function yp(e,t,n=!1){const o=n?ab:t.emitsCache,s=o.get(e);if(s!==void 0)return s;const i=e.emits;let r={},a=!1;if(!ze(e)){const c=l=>{const u=yp(l,t,!0);u&&(a=!0,Xt(r,u))};!n&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}return!i&&!a?(vt(e)&&o.set(e,null),null):(Oe(i)?i.forEach(c=>r[c]=null):Xt(r,i),vt(e)&&o.set(e,r),r)}function sc(e,t){return!e||!Ja(t)?!1:(t=t.slice(2).replace(/Once$/,""),rt(e,t[0].toLowerCase()+t.slice(1))||rt(e,Yo(t))||rt(e,t))}function E_(e){const{type:t,vnode:n,proxy:o,withProxy:s,propsOptions:[i],slots:r,attrs:a,emit:c,render:l,renderCache:u,props:_,data:$,setupState:d,ctx:p,inheritAttrs:b}=e,g=va(e);let m,w;try{if(n.shapeFlag&4){const v=s||o,k=v;m=gs(l.call(k,v,u,_,d,$,p)),w=a}else{const v=t;m=gs(v.length>1?v(_,{attrs:a,slots:r,emit:c}):v(_,null)),w=t.props?a:cb(a)}}catch(v){sr.length=0,ec(v,e,1),m=Ct(mn)}let y=m;if(w&&b!==!1){const v=Object.keys(w),{shapeFlag:k}=y;v.length&&k&7&&(i&&v.some(au)&&(w=lb(w,i)),y=ho(y,w,!1,!0))}return n.dirs&&(y=ho(y,null,!1,!0),y.dirs=y.dirs?y.dirs.concat(n.dirs):n.dirs),n.transition&&dr(y,n.transition),m=y,va(g),m}const cb=e=>{let t;for(const n in e)(n==="class"||n==="style"||Ja(n))&&((t||(t={}))[n]=e[n]);return t},lb=(e,t)=>{const n={};for(const o in e)(!au(o)||!(o.slice(9)in t))&&(n[o]=e[o]);return n};function ub(e,t,n){const{props:o,children:s,component:i}=e,{props:r,children:a,patchFlag:c}=t,l=i.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return o?A_(o,r,l):!!r;if(c&8){const u=t.dynamicProps;for(let _=0;_<u.length;_++){const $=u[_];if(r[$]!==o[$]&&!sc(l,$))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:o===r?!1:o?r?A_(o,r,l):!0:!!r;return!1}function A_(e,t,n){const o=Object.keys(t);if(o.length!==Object.keys(e).length)return!0;for(let s=0;s<o.length;s++){const i=o[s];if(t[i]!==e[i]&&!sc(n,i))return!0}return!1}function _b({vnode:e,parent:t},n){for(;t;){const o=t.subTree;if(o.suspense&&o.suspense.activeBranch===e&&(o.el=e.el),o===e)(e=t.vnode).el=n,t=t.parent;else break}}const wp=e=>e.__isSuspense;function $b(e,t){t&&t.pendingBranch?Oe(e)?t.effects.push(...e):t.effects.push(e):Fd(e)}const mt=Symbol.for("v-fgt"),oc=Symbol.for("v-txt"),mn=Symbol.for("v-cmt"),nr=Symbol.for("v-stc"),sr=[];let On=null;function V(e=!1){sr.push(On=e?null:[])}function db(){sr.pop(),On=sr[sr.length-1]||null}let pr=1;function Ma(e,t=!1){pr+=e,e<0&&On&&t&&(On.hasOnce=!0)}function vp(e){return e.dynamicChildren=pr>0?On||pi:null,db(),pr>0&&On&&On.push(e),e}function ee(e,t,n,o,s,i){return vp(h(e,t,n,o,s,i,!0))}function kn(e,t,n,o,s){return vp(Ct(e,t,n,o,s,!0))}function Ca(e){return e?e.__v_isVNode===!0:!1}function Oo(e,t){return e.type===t.type&&e.key===t.key}const Sp=({key:e})=>e??null,aa=({ref:e,ref_key:t,ref_for:n})=>(typeof e=="number"&&(e=""+e),e!=null?Tt(e)||an(e)||ze(e)?{i:Vn,r:e,k:t,f:!!n}:e:null);function h(e,t=null,n=null,o=0,s=null,i=e===mt?0:1,r=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Sp(t),ref:t&&aa(t),scopeId:zd,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:o,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Vn};return a?(Su(c,n),i&128&&e.normalize(c)):n&&(c.shapeFlag|=Tt(n)?8:16),pr>0&&!r&&On&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&On.push(c),c}const Ct=pb;function pb(e,t=null,n=null,o=0,s=null,i=!1){if((!e||e===Og)&&(e=mn),Ca(e)){const a=ho(e,t,!0);return n&&Su(a,n),pr>0&&!i&&On&&(a.shapeFlag&6?On[On.indexOf(e)]=a:On.push(a)),a.patchFlag=-2,a}if(kb(e)&&(e=e.__vccOpts),t){t=mb(t);let{class:a,style:c}=t;a&&!Tt(a)&&(t.class=wt(a)),vt(c)&&(hu(c)&&!Oe(c)&&(c=Xt({},c)),t.style=Bn(c))}const r=Tt(e)?1:wp(e)?128:Kd(e)?64:vt(e)?4:ze(e)?2:0;return h(e,t,n,o,s,r,i,!0)}function mb(e){return e?hu(e)||_p(e)?Xt({},e):e:null}function ho(e,t,n=!1,o=!1){const{props:s,ref:i,patchFlag:r,children:a,transition:c}=e,l=t?fb(s||{},t):s,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&Sp(l),ref:t&&t.ref?n&&i?Oe(i)?i.concat(aa(t)):[i,aa(t)]:aa(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==mt?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:c,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ho(e.ssContent),ssFallback:e.ssFallback&&ho(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return c&&o&&dr(u,c.clone(u)),u}function Vo(e=" ",t=0){return Ct(oc,null,e,t)}function xa(e,t){const n=Ct(nr,null,e);return n.staticCount=t,n}function Ie(e="",t=!1){return t?(V(),kn(mn,null,e)):Ct(mn,null,e)}function gs(e){return e==null||typeof e=="boolean"?Ct(mn):Oe(e)?Ct(mt,null,e.slice()):Ca(e)?to(e):Ct(oc,null,String(e))}function to(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ho(e)}function Su(e,t){let n=0;const{shapeFlag:o}=e;if(t==null)t=null;else if(Oe(t))n=16;else if(typeof t=="object")if(o&65){const s=t.default;s&&(s._c&&(s._d=!1),Su(e,s()),s._c&&(s._d=!0));return}else{n=32;const s=t._;!s&&!_p(t)?t._ctx=Vn:s===3&&Vn&&(Vn.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ze(t)?(t={default:t,_ctx:Vn},n=32):(t=String(t),o&64?(n=16,t=[Vo(t)]):n=8);e.children=t,e.shapeFlag|=n}function fb(...e){const t={};for(let n=0;n<e.length;n++){const o=e[n];for(const s in o)if(s==="class")t.class!==o.class&&(t.class=wt([t.class,o.class]));else if(s==="style")t.style=Bn([t.style,o.style]);else if(Ja(s)){const i=t[s],r=o[s];r&&i!==r&&!(Oe(i)&&i.includes(r))&&(t[s]=i?[].concat(i,r):r)}else s!==""&&(t[s]=o[s])}return t}function us(e,t,n,o=null){cs(e,t,7,[n,o])}const hb=cp();let gb=0;function bb(e,t,n){const o=e.type,s=(t?t.appContext:e.appContext)||hb,i={uid:gb++,vnode:e,type:o,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new q0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:dp(o,s),emitsOptions:yp(o,s),emit:null,emitted:null,propsDefaults:pt,inheritAttrs:o.inheritAttrs,ctx:pt,data:pt,props:pt,attrs:pt,slots:pt,refs:pt,setupState:pt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=rb.bind(null,i),e.ce&&e.ce(i),i}let fn=null;const ku=()=>fn||Vn;let Pa,Gl;{const e=Za(),t=(n,o)=>{let s;return(s=e[n])||(s=e[n]=[]),s.push(o),i=>{s.length>1?s.forEach(r=>r(i)):s[0](i)}};Pa=t("__VUE_INSTANCE_SETTERS__",n=>fn=n),Gl=t("__VUE_SSR_SETTERS__",n=>mr=n)}const Er=e=>{const t=fn;return Pa(e),e.scope.on(),()=>{e.scope.off(),Pa(t)}},G_=()=>{fn&&fn.scope.off(),Pa(null)};function kp(e){return e.vnode.shapeFlag&4}let mr=!1;function yb(e,t=!1,n=!1){t&&Gl(t);const{props:o,children:s}=e.vnode,i=kp(e);qg(e,o,i,t),Xg(e,s,n||t);const r=i?wb(e,t):void 0;return t&&Gl(!1),r}function wb(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Dg);const{setup:o}=n;if(o){zs();const s=e.setupContext=o.length>1?Sb(e):null,i=Er(e),r=Tr(o,e,0,[e.props,s]),a=fd(r);if(Vs(),i(),(a||e.sp)&&!er(e)&&sp(e),a){if(r.then(G_,G_),t)return r.then(c=>{R_(e,c)}).catch(c=>{ec(c,e,0)});e.asyncDep=r}else R_(e,r)}else Mp(e)}function R_(e,t,n){ze(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:vt(t)&&(e.setupState=Nd(t)),Mp(e)}function Mp(e,t,n){const o=e.type;e.render||(e.render=o.render||ss);{const s=Er(e);zs();try{Ng(e)}finally{Vs(),s()}}}const vb={get(e,t){return Qt(e,"get",""),e[t]}};function Sb(e){const t=n=>{e.exposed=n||{}};return{attrs:new Proxy(e.attrs,vb),slots:e.slots,emit:e.emit,expose:t}}function ic(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Nd(dg(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in tr)return tr[n](e)},has(t,n){return n in t||n in tr}})):e.proxy}function kb(e){return ze(e)&&"__vccOpts"in e}const Xe=(e,t)=>gg(e,t,mr);function Mb(e,t,n){try{Ma(-1);const o=arguments.length;return o===2?vt(t)&&!Oe(t)?Ca(t)?Ct(e,null,[t]):Ct(e,t):Ct(e,null,t):(o>3?n=Array.prototype.slice.call(arguments,2):o===3&&Ca(n)&&(n=[n]),Ct(e,t,n))}finally{Ma(1)}}const Cb="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Rl;const O_=typeof window<"u"&&window.trustedTypes;if(O_)try{Rl=O_.createPolicy("vue",{createHTML:e=>e})}catch{}const Cp=Rl?e=>Rl.createHTML(e):e=>e,xb="http://www.w3.org/2000/svg",Pb="http://www.w3.org/1998/Math/MathML",Os=typeof document<"u"?document:null,D_=Os&&Os.createElement("template"),Lb={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,o)=>{const s=t==="svg"?Os.createElementNS(xb,e):t==="mathml"?Os.createElementNS(Pb,e):n?Os.createElement(e,{is:n}):Os.createElement(e);return e==="select"&&o&&o.multiple!=null&&s.setAttribute("multiple",o.multiple),s},createText:e=>Os.createTextNode(e),createComment:e=>Os.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Os.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,o,s,i){const r=n?n.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),n),!(s===i||!(s=s.nextSibling)););else{D_.innerHTML=Cp(o==="svg"?`<svg>${e}</svg>`:o==="mathml"?`<math>${e}</math>`:e);const a=D_.content;if(o==="svg"||o==="mathml"){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}t.insertBefore(a,n)}return[r?r.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Xs="transition",Gi="animation",fr=Symbol("_vtc"),xp={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Ib=Xt({},Zd,xp),Tb=e=>(e.displayName="Transition",e.props=Ib,e),Eb=Tb((e,{slots:t})=>Mb(Cg,Ab(e),t)),Lo=(e,t=[])=>{Oe(e)?e.forEach(n=>n(...t)):e&&e(...t)},N_=e=>e?Oe(e)?e.some(t=>t.length>1):e.length>1:!1;function Ab(e){const t={};for(const x in e)x in xp||(t[x]=e[x]);if(e.css===!1)return t;const{name:n="v",type:o,duration:s,enterFromClass:i=`${n}-enter-from`,enterActiveClass:r=`${n}-enter-active`,enterToClass:a=`${n}-enter-to`,appearFromClass:c=i,appearActiveClass:l=r,appearToClass:u=a,leaveFromClass:_=`${n}-leave-from`,leaveActiveClass:$=`${n}-leave-active`,leaveToClass:d=`${n}-leave-to`}=e,p=Gb(s),b=p&&p[0],g=p&&p[1],{onBeforeEnter:m,onEnter:w,onEnterCancelled:y,onLeave:v,onLeaveCancelled:k,onBeforeAppear:L=m,onAppear:P=w,onAppearCancelled:O=y}=t,I=(x,z,ge,re)=>{x._enterCancelled=re,Io(x,z?u:a),Io(x,z?l:r),ge&&ge()},R=(x,z)=>{x._isLeaving=!1,Io(x,_),Io(x,d),Io(x,$),z&&z()},D=x=>(z,ge)=>{const re=x?P:w,he=()=>I(z,x,ge);Lo(re,[z,he]),j_(()=>{Io(z,x?c:i),Rs(z,x?u:a),N_(re)||H_(z,o,b,he)})};return Xt(t,{onBeforeEnter(x){Lo(m,[x]),Rs(x,i),Rs(x,r)},onBeforeAppear(x){Lo(L,[x]),Rs(x,c),Rs(x,l)},onEnter:D(!1),onAppear:D(!0),onLeave(x,z){x._isLeaving=!0;const ge=()=>R(x,z);Rs(x,_),x._enterCancelled?(Rs(x,$),B_(x)):(B_(x),Rs(x,$)),j_(()=>{x._isLeaving&&(Io(x,_),Rs(x,d),N_(v)||H_(x,o,g,ge))}),Lo(v,[x,ge])},onEnterCancelled(x){I(x,!1,void 0,!0),Lo(y,[x])},onAppearCancelled(x){I(x,!0,void 0,!0),Lo(O,[x])},onLeaveCancelled(x){R(x),Lo(k,[x])}})}function Gb(e){if(e==null)return null;if(vt(e))return[Yc(e.enter),Yc(e.leave)];{const t=Yc(e);return[t,t]}}function Yc(e){return N0(e)}function Rs(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e[fr]||(e[fr]=new Set)).add(t)}function Io(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.remove(o));const n=e[fr];n&&(n.delete(t),n.size||(e[fr]=void 0))}function j_(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Rb=0;function H_(e,t,n,o){const s=e._endId=++Rb,i=()=>{s===e._endId&&o()};if(n!=null)return setTimeout(i,n);const{type:r,timeout:a,propCount:c}=Ob(e,t);if(!r)return o();const l=r+"end";let u=0;const _=()=>{e.removeEventListener(l,$),i()},$=d=>{d.target===e&&++u>=c&&_()};setTimeout(()=>{u<c&&_()},a+1),e.addEventListener(l,$)}function Ob(e,t){const n=window.getComputedStyle(e),o=p=>(n[p]||"").split(", "),s=o(`${Xs}Delay`),i=o(`${Xs}Duration`),r=F_(s,i),a=o(`${Gi}Delay`),c=o(`${Gi}Duration`),l=F_(a,c);let u=null,_=0,$=0;t===Xs?r>0&&(u=Xs,_=r,$=i.length):t===Gi?l>0&&(u=Gi,_=l,$=c.length):(_=Math.max(r,l),u=_>0?r>l?Xs:Gi:null,$=u?u===Xs?i.length:c.length:0);const d=u===Xs&&/\b(?:transform|all)(?:,|$)/.test(o(`${Xs}Property`).toString());return{type:u,timeout:_,propCount:$,hasTransform:d}}function F_(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,o)=>U_(n)+U_(e[o])))}function U_(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function B_(e){return(e?e.ownerDocument:document).body.offsetHeight}function Db(e,t,n){const o=e[fr];o&&(t=(t?[t,...o]:[...o]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}const La=Symbol("_vod"),Pp=Symbol("_vsh"),Lp={name:"show",beforeMount(e,{value:t},{transition:n}){e[La]=e.style.display==="none"?"":e.style.display,n&&t?n.beforeEnter(e):Ri(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:o}){!t!=!n&&(o?t?(o.beforeEnter(e),Ri(e,!0),o.enter(e)):o.leave(e,()=>{Ri(e,!1)}):Ri(e,t))},beforeUnmount(e,{value:t}){Ri(e,t)}};function Ri(e,t){e.style.display=t?e[La]:"none",e[Pp]=!t}const Ip=Symbol("");function Zn(e){const t=ku();if(!t)return;const n=t.ut=(s=e(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(i=>Ia(i,s))},o=()=>{const s=e(t.proxy);t.ce?Ia(t.ce,s):Ol(t.subTree,s),n(s)};ip(()=>{Fd(o)}),hn(()=>{Ln(o,ss,{flush:"post"});const s=new MutationObserver(o);s.observe(t.subTree.el.parentNode,{childList:!0}),bu(()=>s.disconnect())})}function Ol(e,t){if(e.shapeFlag&128){const n=e.suspense;e=n.activeBranch,n.pendingBranch&&!n.isHydrating&&n.effects.push(()=>{Ol(n.activeBranch,t)})}for(;e.component;)e=e.component.subTree;if(e.shapeFlag&1&&e.el)Ia(e.el,t);else if(e.type===mt)e.children.forEach(n=>Ol(n,t));else if(e.type===nr){let{el:n,anchor:o}=e;for(;n&&(Ia(n,t),n!==o);)n=n.nextSibling}}function Ia(e,t){if(e.nodeType===1){const n=e.style;let o="";for(const s in t){const i=V0(t[s]);n.setProperty(`--${s}`,i),o+=`--${s}: ${i};`}n[Ip]=o}}const Nb=/(?:^|;)\s*display\s*:/;function jb(e,t,n){const o=e.style,s=Tt(n);let i=!1;if(n&&!s){if(t)if(Tt(t))for(const r of t.split(";")){const a=r.slice(0,r.indexOf(":")).trim();n[a]==null&&ca(o,a,"")}else for(const r in t)n[r]==null&&ca(o,r,"");for(const r in n)r==="display"&&(i=!0),ca(o,r,n[r])}else if(s){if(t!==n){const r=o[Ip];r&&(n+=";"+r),o.cssText=n,i=Nb.test(n)}}else t&&e.removeAttribute("style");La in e&&(e[La]=i?o.display:"",e[Pp]&&(o.display="none"))}const z_=/\s*!important$/;function ca(e,t,n){if(Oe(n))n.forEach(o=>ca(e,t,o));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const o=Hb(e,t);z_.test(n)?e.setProperty(Yo(o),n.replace(z_,""),"important"):e[o]=n}}const V_=["Webkit","Moz","ms"],Zc={};function Hb(e,t){const n=Zc[t];if(n)return n;let o=mo(t);if(o!=="filter"&&o in e)return Zc[t]=o;o=bd(o);for(let s=0;s<V_.length;s++){const i=V_[s]+o;if(i in e)return Zc[t]=i}return t}const q_="http://www.w3.org/1999/xlink";function W_(e,t,n,o,s,i=z0(t)){o&&t.startsWith("xlink:")?n==null?e.removeAttributeNS(q_,t.slice(6,t.length)):e.setAttributeNS(q_,t,n):n==null||i&&!wd(n)?e.removeAttribute(t):e.setAttribute(t,i?"":So(n)?String(n):n)}function K_(e,t,n,o,s){if(t==="innerHTML"||t==="textContent"){n!=null&&(e[t]=t==="innerHTML"?Cp(n):n);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const a=i==="OPTION"?e.getAttribute("value")||"":e.value,c=n==null?e.type==="checkbox"?"on":"":String(n);(a!==c||!("_value"in e))&&(e.value=c),n==null&&e.removeAttribute(t),e._value=n;return}let r=!1;if(n===""||n==null){const a=typeof e[t];a==="boolean"?n=wd(n):n==null&&a==="string"?(n="",r=!0):a==="number"&&(n=0,r=!0)}try{e[t]=n}catch{}r&&e.removeAttribute(s||t)}function Fb(e,t,n,o){e.addEventListener(t,n,o)}function Ub(e,t,n,o){e.removeEventListener(t,n,o)}const J_=Symbol("_vei");function Bb(e,t,n,o,s=null){const i=e[J_]||(e[J_]={}),r=i[t];if(o&&r)r.value=o;else{const[a,c]=zb(t);if(o){const l=i[t]=Wb(o,s);Fb(e,a,l,c)}else r&&(Ub(e,a,r,c),i[t]=void 0)}}const X_=/(?:Once|Passive|Capture)$/;function zb(e){let t;if(X_.test(e)){t={};let o;for(;o=e.match(X_);)e=e.slice(0,e.length-o[0].length),t[o[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Yo(e.slice(2)),t]}let Qc=0;const Vb=Promise.resolve(),qb=()=>Qc||(Vb.then(()=>Qc=0),Qc=Date.now());function Wb(e,t){const n=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=n.attached)return;cs(Kb(o,n.value),t,5,[o])};return n.value=e,n.attached=qb(),n}function Kb(e,t){if(Oe(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(o=>s=>!s._stopped&&o&&o(s))}else return t}const Y_=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Jb=(e,t,n,o,s,i)=>{const r=s==="svg";t==="class"?Db(e,o,r):t==="style"?jb(e,n,o):Ja(t)?au(t)||Bb(e,t,n,o,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Xb(e,t,o,r))?(K_(e,t,o),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&W_(e,t,o,r,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Tt(o))?K_(e,mo(t),o,i,t):(t==="true-value"?e._trueValue=o:t==="false-value"&&(e._falseValue=o),W_(e,t,o,r))};function Xb(e,t,n,o){if(o)return!!(t==="innerHTML"||t==="textContent"||t in e&&Y_(t)&&ze(n));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Y_(t)&&Tt(n)?!1:t in e}const Yb=["ctrl","shift","alt","meta"],Zb={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>Yb.some(n=>e[`${n}Key`]&&!t.includes(n))},Fs=(e,t)=>{const n=e._withMods||(e._withMods={}),o=t.join(".");return n[o]||(n[o]=(s,...i)=>{for(let r=0;r<t.length;r++){const a=Zb[t[r]];if(a&&a(s,t))return}return e(s,...i)})},Qb=Xt({patchProp:Jb},Lb);let Z_;function e1(){return Z_||(Z_=Zg(Qb))}const Q_=(...e)=>{const t=e1().createApp(...e),{mount:n}=t;return t.mount=o=>{const s=n1(o);if(!s)return;const i=t._component;!ze(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const r=n(s,!1,t1(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),r},t};function t1(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function n1(e){return Tt(e)?document.querySelector(e):e}const la={maxRetries:3,retryDelay:1e3,timeout:1e4};let el=null;const bi={enabled:!0,maxCacheSize:50*1024*1024,cachePrefix:"mgpic_",version:"1.0.0",loadInterval:50,batchSize:3};class s1{constructor(){this.cache=new Map,this.totalSize=0}isSupported(){return"caches"in window}getCacheName(){return`${bi.cachePrefix}${bi.version}`}async isCached(t){if(!this.isSupported())return!1;try{return await(await caches.open(this.getCacheName())).match(t)!==void 0}catch(n){return f(":",n.message),!1}}async cacheResource(t,n){if(!this.isSupported())return!1;try{const o=await caches.open(this.getCacheName());if(await o.match(t))return f(`: ${t}`),!0;await o.put(t,n.clone());const i=n.headers.get("content-length");return i&&(this.totalSize+=parseInt(i)),f(`: ${t}`),!0}catch(o){return f(":",o.message),!1}}async getCachedResource(t){if(!this.isSupported())return null;try{return await(await caches.open(this.getCacheName())).match(t)}catch(n){return f(":",n.message),null}}async cleanupCache(){if(this.isSupported())try{const t=await caches.keys(),n=this.getCacheName();for(const o of t)o.startsWith(bi.cachePrefix)&&o!==n&&(await caches.delete(o),f(`: ${o}`))}catch(t){f(":",t.message)}}}const qn=new s1;let qr=null;function o1(){return qr||(f("R2 URL"),qr="https://pub-6f9181bda40946ea92b5e87fe84e27d4.r2.dev",qr)}function Q(e){let t=e;e.startsWith("/assets/")?t=e.slice(7):e.startsWith("@assets/")&&(t=e.slice(8));const n=o1(),o=t.startsWith("/")?t.slice(1):t;return`${n}/${o}`}async function Tp(e,t={}){if(qn.isSupported()){const s=await qn.getCachedResource(e);if(s)return f(` Cache Storage : ${e}`),s}const{maxRetries:n=la.maxRetries,retryDelay:o=la.retryDelay}=t;for(let s=1;s<=n;s++)try{f(` (${s}/${n}): ${e}`);const i=new AbortController,r=setTimeout(()=>i.abort(),la.timeout),a=await fetch(e,{method:"GET",mode:"cors",credentials:"omit",cache:"no-cache",signal:i.signal,...t});if(clearTimeout(r),a.ok)return qn.isSupported()&&await qn.cacheResource(e,a),f(`: ${e}`),a;throw new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(i){if(f(` (${s}/${n}): ${e}`,i.message),s===n)throw f(`: ${e}`,i.message),i;const r=o*s;f(` ${r}ms ...`),await new Promise(a=>setTimeout(a,r))}}async function i1(e=["high","medium"]){try{if(el){f("");const i=e$(el,e);return f(` ${i.length}  (: ${e.join(", ")})`),i}const t=Q("asset-list.json");f(` R2 CDN : ${t}`);const n=await Tp(t);if(!n.ok)throw new Error(`: HTTP ${n.status}`);const o=await n.json();el=o,f("");const s=e$(o,e);return f(` ${s.length}  (: ${e.join(", ")})`),s}catch(t){return f(":",t.message),["logo.glb","frontend_resource/start_game.webp","frontend_resource/copper_warehouse.webp","frontend_resource/game_wiki.webp","frontend_resource/Tutorial.webp","frontend_resource/gacha.webp"]}}function e$(e,t){const n=[];for(const o of t)if(e.categories&&e.categories[o]){const s=e.categories[o].resources||[];n.push(...s.map(i=>i.path))}return n}async function Dl(e=null,t=["high","medium"]){f("..."),await qn.cleanupCache();const n=await i1(t),o=bi.batchSize,s=bi.loadInterval,i=n.length;let r=0;e&&e(0,i,0);for(let a=0;a<n.length;a+=o){const c=n.slice(a,a+o);f(` ${Math.floor(a/o)+1}/${Math.ceil(n.length/o)}: ${c.length} `);const l=c.map(async(g,m)=>{const w=Q(g);try{if(await qn.isCached(w))return f(`Cache Storage: ${g}`),{success:!0,path:g,cached:!0,source:"cache"};const v=new AbortController,k=setTimeout(()=>v.abort(),la.timeout),L=await fetch(w,{method:"GET",mode:"cors",credentials:"omit",cache:"no-cache",signal:v.signal});if(clearTimeout(k),L.ok){const P=L.headers.get("x-cache")||L.headers.get("cf-cache-status")||L.type==="basic"&&!L.redirected;return qn.isSupported()&&await qn.cacheResource(w,L),f(`: ${g}${P?" ()":""}`),{success:!0,path:g,cached:!1,fromBrowserCache:!!P}}else throw new Error(`HTTP ${L.status}: ${L.statusText}`)}catch(y){return f(`: ${g}`,y.message),{success:!1,path:g,error:y.message}}}),u=await Promise.all(l);r+=c.length;const _=Math.round(r/i*100);e&&e(r,i,_);const $=u.filter(g=>g.success).length,d=u.filter(g=>g.cached).length,p=u.filter(g=>g.fromBrowserCache).length,b=u.filter(g=>!g.success).length;f(`:  ${$}, Cache Storage ${d},  ${p},  ${b}`),a+o<n.length&&(f(` ${s}ms ...`),await new Promise(g=>setTimeout(g,s)))}f(""),e&&e(i,i,100)}async function r1(){if(!qn.isSupported())return{supported:!1,message:"API"};try{const t=await(await caches.open(qn.getCacheName())).keys();return{supported:!0,cacheName:qn.getCacheName(),resourceCount:t.length,totalSize:qn.totalSize,maxSize:bi.maxCacheSize}}catch(e){return{supported:!0,error:e.message}}}function rc(e,t){return Q(`copper/${e.toLowerCase()}/${t}/${t}.glb`)}function ac(e){return Q(`enemy/${e}/${e}.glb`)}function Ep(e){return Q(`structure/${e}/${e}.glb`)}function a1(e){return Q(e)}const Vt=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n},c1={class:"hall-container"},l1=["src"],u1={__name:"Hall",props:{musicOn:{type:Boolean,default:!0},paused:{type:Boolean,default:!1}},emits:["startGame","openWarehouse","openTutorial","openEncyclopedia","toggle-music"],setup(e,{emit:t}){const n=t,o=e;function s(){n("startGame")}function i(){n("openWarehouse")}function r(){n("openTutorial")}function a(){const g="https://mgpic-2025.github.io/CopperPuppetry-Wiki/";f(`[Hall] : ${g}`),window!=null&&window.open?window.open(g,"_blank","noopener"):window.location.href=g}const c=oe(Q("@assets/frontend_resource/start_game.webp")),l=oe(Q("@assets/frontend_resource/copper_warehouse.webp")),u=oe(Q("@assets/frontend_resource/game_wiki.webp")),_=oe(Q("@assets/frontend_resource/Tutorial.webp")),$=oe(Q("ui/Gemini_Generated_Image_gtrehogtrehogtre (1).png")),d=oe(!1),p=oe(null),b=Q("@assets/frontend_resource/hall.mp3");return hn(()=>{setTimeout(()=>{d.value=!0,f("HallUI")},100),o.musicOn&&!o.paused&&p.value&&setTimeout(()=>{if(p.value.readyState>=2)p.value.play().then(()=>{f("[Hall] ")}).catch(m=>{f("[Hall] :",m)});else{const m=()=>{p.value.play().then(()=>{f("[Hall] ")}).catch(w=>{f("[Hall] :",w)}),p.value.removeEventListener("canplay",m)};p.value.addEventListener("canplay",m,{once:!0})}},200)}),Ln(()=>o.musicOn,g=>{if(p.value)if(g&&!o.paused)if(p.value.readyState>=2)p.value.play().catch(m=>{f("[Hall] :",m)});else{const m=()=>{p.value.play().catch(w=>{f("[Hall] :",w)}),p.value.removeEventListener("canplay",m)};p.value.addEventListener("canplay",m)}else p.value.pause()}),Ln(()=>o.paused,g=>{if(p.value){if(g)p.value.pause(),f("[Hall] ");else if(o.musicOn){if(p.value.readyState>=2)p.value.play().catch(m=>{f("[Hall] :",m)});else{const m=()=>{p.value.play().catch(w=>{f("[Hall] :",w)}),p.value.removeEventListener("canplay",m)};p.value.addEventListener("canplay",m)}f("[Hall] ")}}}),Ps(()=>{p.value&&p.value.pause()}),(g,m)=>(V(),ee("div",c1,[h("div",{class:"hall-bg",style:Bn({backgroundImage:`url('${$.value}')`})},null,4),h("div",{class:wt(["menu",{"menu--loaded":d.value}])},[h("button",{class:"tile tile--start",style:Bn({backgroundImage:`url('${c.value}')`}),onClick:s},[...m[0]||(m[0]=[h("div",{class:"tile__mask"},null,-1),h("div",{class:"tile__caption tile__caption--bottom"},[h("div",{class:"tile__title"},""),h("div",{class:"tile__subtitle"},"Begin Adventure")],-1)])],4),h("button",{class:"tile tile--warehouse",style:Bn({backgroundImage:`url('${l.value}')`}),onClick:i},[...m[1]||(m[1]=[h("div",{class:"tile__mask"},null,-1),h("div",{class:"tile__caption tile__caption--top"},[h("div",{class:"tile__title"},""),h("div",{class:"tile__subtitle"},"Character Collection")],-1)])],4),h("button",{class:"tile tile--wiki",style:Bn({backgroundImage:`url('${u.value}')`}),onClick:a},[...m[2]||(m[2]=[h("div",{class:"tile__mask"},null,-1),h("div",{class:"tile__caption tile__caption--bottom"},[h("div",{class:"tile__title"},""),h("div",{class:"tile__subtitle"},"Encyclopedia")],-1)])],4),h("button",{class:"tile tile--tutorial",style:Bn({backgroundImage:`url('${_.value}')`}),onClick:r},[...m[3]||(m[3]=[h("div",{class:"tile__mask"},null,-1),h("div",{class:"tile__caption tile__caption--top"},[h("div",{class:"tile__title"},""),h("div",{class:"tile__subtitle"},"Tutorial")],-1)])],4)],2),h("audio",{ref_key:"audioRef",ref:p,src:ye(b),loop:"",preload:"auto"},null,8,l1)]))}},_1=Vt(u1,[["__scopeId","data-v-f6623161"]]),Wn={HeartCrystalDust:{name:"",icon:Q("resource/heart_crystal_dust.webp")},RecallGear:{name:"",icon:Q("resource/recall_gear.webp")},ResonantCrystal:{name:"",icon:Q("resource/resonant_star_crystal/resonant_star_crystal.webp")},RefinedCopper:{name:"",icon:Q("resource/refined_copper_ingot/refined_copper_ingot.webp")},SpiritalSpark:{name:"",icon:Q("resource/spiritual_spark.webp")}};function cc(e){var t;if(Array.isArray(e==null?void 0:e.item_type)&&e.item_type[0]==="Resource"){const n=e.item_type[1];return((t=Wn[n])==null?void 0:t.name)||n}else if(Array.isArray(e==null?void 0:e.item_type)&&e.item_type[0]==="Equipment")return"";return""}function Zt(e){var t;return((t=Wn[e])==null?void 0:t.name)||e}function _s(e){var t;return((t=Wn[e])==null?void 0:t.icon)||""}function $1(e){return{all:e=e||new Map,on:function(t,n){var o=e.get(t);o?o.push(n):e.set(t,[n])},off:function(t,n){var o=e.get(t);o&&(n?o.splice(o.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var o=e.get(t);o&&o.slice().map(function(s){s(n)}),(o=e.get("*"))&&o.slice().map(function(s){s(t,n)})}}}const Mu=$1(),vn={UPDATE_RESOURCES:"update:resources",RESOURCES_UPDATED:"resources:updated",COPPER_ID_ADDED:"copper:id:added",START_MENU_PAUSE:"menu:pause",START_MENU_RESUME:"menu:resume",START_MENU_STARTED:"menu:started",CONTROL_MODE_CHANGED:"control:mode:changed",GAME_STARTED:"game:started",GAME_ENDED:"game:ended"},Do=(e,t)=>{Mu.emit(e,t)},lc=(e,t)=>{Mu.on(e,t)},Cu=(e,t)=>{Mu.off(e,t)};class d1{constructor(){this.queue=[],this.isProcessing=!1,this.handlers=new Map,this.sceneContext=null}setSceneContext(t){this.sceneContext=t}registerHandler(t,n){this.handlers.set(t,n)}enqueue(t){["handle_on_click_copper","on_game_start"].includes(t.type_msg)&&f("[MessageQueue] :",t.type_msg),this.queue.push(t),this.isProcessing||this.processNext()}async processNext(){if(this.queue.length===0){this.isProcessing=!1;return}this.isProcessing=!0;const t=50;let n=0;for(;this.queue.length>0&&n<t;){const o=this.queue.shift();n++;try{const{type_msg:s,content:i}=o,r=this.handlers.get(s);if(r){const a=JSON.parse(i),c=r(a,this.sceneContext||{});c&&typeof c.then=="function"&&await c}else f("[MessageQueue] :",s),f("[MessageQueue] :",Array.from(this.handlers.keys()))}catch(s){f("[MessageQueue] :",s),f("[MessageQueue] :",s.message),f("[MessageQueue] :",s.stack)}}this.queue.length>0?requestAnimationFrame(()=>this.processNext()):this.isProcessing=!1}}const He=new d1;function Wr(e,t){return e.find(n=>n.id===t)}function t$(e){return new Promise(t=>setTimeout(t,e))}function p1(){f("[MessageQueue] ..."),He.registerHandler("handle_on_click_copper",async(i,r)=>{var u,_;const{copper:a,resources:c,has_attack_targets:l}=i;f(`[Handler] : ${((u=a.copper.copper_info)==null?void 0:u.name)||"Unknown"} (ID=${a.id})`),f(`[Handler] : HP=${a.now_health}/${a.copper.attribute.health}, =${a.can_move}, =${a.can_attack}, =${a.can_summon}, =${a.can_build}, =${l}`),f(`[Handler] : ${(_=a.copper)==null?void 0:_.copper_type}`),r.highlightSelectedCopper&&r.highlightSelectedCopper(a.id),r.onShowCopperInfo&&r.onShowCopperInfo(a,c,l)}),He.registerHandler("handle_on_click_enemy",async(i,r)=>{var d,p;const{enemy:a,resources:c,has_attack_targets:l}=i,u=a.owned||!1;f(`[Handler] ${u?"":""}: ${((d=a.enemy_base)==null?void 0:d.name)||"Unknown"} (ID=${a.id})`),f(`[Handler] : HP=${a.now_health}/${a.enemy_base.health}, =${a.can_move}, =${a.can_attack}, owned=${a.owned}, =${l}`);const $={id:a.id,now_health:a.now_health,can_move:u?a.can_move:!1,can_attack:u?a.can_attack:!1,can_summon:!1,position:a.position,isEnemy:!u,isOwnedEnemy:u,copper:{copper_info:{name:((p=a.enemy_base)==null?void 0:p.name)||(u?"":"")},attribute:{health:a.enemy_base.health,attack:a.enemy_base.attack,defense:a.enemy_base.defense,speed:a.enemy_base.speed}}};r.highlightSelectedCopper&&r.highlightSelectedCopper(a.id),r.onShowCopperInfo&&r.onShowCopperInfo($,c,l)}),He.registerHandler("handle_on_click_structure",async(i,r)=>{var _;const{structure:a,resources:c}=i,u=a.owned||!1?"":"";f(`[Handler] ${u}: ${((_=a.structure_base)==null?void 0:_.name)||"Unknown"} (ID=${a.id})`),f(`[Handler] : HP=${a.now_health}/${a.structure_base.health}, =${a.can_move}, =${a.can_attack}, owned=${a.owned}, =${a.structure_base.has_storage}`),r.highlightSelectedCopper&&r.highlightSelectedCopper(a.id),r.onShowStructureInfo&&r.onShowStructureInfo(a,c)}),He.registerHandler("set_copper",async(i,r)=>{const{id:a,position:c,copper:l}=i;window.__ACTUAL_COPPER_IDS__||(window.__ACTUAL_COPPER_IDS__=[]),window.__ACTUAL_COPPER_IDS__.push(l.id),Do(vn.COPPER_ID_ADDED,l.id),r.onSetCopper&&await r.onSetCopper(a,c,l)}),He.registerHandler("set_enemy",async(i,r)=>{const{id:a,position:c,enemy:l}=i;r.onSetEnemy&&r.onSetEnemy(a,c,l),l.owned&&Do(vn.UPDATE_RESOURCES)}),He.registerHandler("set_material",async(i,r)=>{const{id:a,position:c,material:l}=i;r.onSetMaterial&&await r.onSetMaterial(a,c,l)}),He.registerHandler("set_structure",async(i,r)=>{const{id:a,position:c,structure:l}=i;r.onSetStructure&&await r.onSetStructure(a,c,l),l.owned&&Do(vn.UPDATE_RESOURCES)}),He.registerHandler("remove_unit",async(i,r)=>{const{id:a}=i,c=Wr(r.models||[],a),l=c&&c.type==="enemy"&&!c.isOwned,u=l?c.position:null;if(f(`[Handler] remove_unit: ID=${a}, type=${c==null?void 0:c.type}, isOwned=${c==null?void 0:c.isOwned}, isEnemyDeath=${l}, position=${JSON.stringify(u)}`),c&&c.object){c.object.traverse(d=>{d.material&&(Array.isArray(d.material)?d.material=d.material.map(p=>p.clone()):d.material=d.material.clone())});const _=500,$=performance.now();if(await new Promise(d=>{function p(){const b=performance.now()-$,g=Math.min(b/_,1);c.object&&c.object.traverse(m=>{m.material&&(Array.isArray(m.material)?m.material.forEach(w=>{w.transparent=!0,w.opacity=1-g}):(m.material.transparent=!0,m.material.opacity=1-g))}),g<1?requestAnimationFrame(p):d()}p()}),r.scene&&r.scene.remove(c.object),c.object.traverse(d=>{d.geometry&&d.geometry.dispose(),d.material&&(Array.isArray(d.material)?d.material.forEach(p=>{p.map&&p.map.dispose(),p.lightMap&&p.lightMap.dispose(),p.bumpMap&&p.bumpMap.dispose(),p.normalMap&&p.normalMap.dispose(),p.specularMap&&p.specularMap.dispose(),p.envMap&&p.envMap.dispose(),p.alphaMap&&p.alphaMap.dispose(),p.aoMap&&p.aoMap.dispose(),p.displacementMap&&p.displacementMap.dispose(),p.emissiveMap&&p.emissiveMap.dispose(),p.metalnessMap&&p.metalnessMap.dispose(),p.roughnessMap&&p.roughnessMap.dispose(),p.dispose()}):(d.material.map&&d.material.map.dispose(),d.material.lightMap&&d.material.lightMap.dispose(),d.material.bumpMap&&d.material.bumpMap.dispose(),d.material.normalMap&&d.material.normalMap.dispose(),d.material.specularMap&&d.material.specularMap.dispose(),d.material.envMap&&d.material.envMap.dispose(),d.material.alphaMap&&d.material.alphaMap.dispose(),d.material.aoMap&&d.material.aoMap.dispose(),d.material.displacementMap&&d.material.displacementMap.dispose(),d.material.emissiveMap&&d.material.emissiveMap.dispose(),d.material.metalnessMap&&d.material.metalnessMap.dispose(),d.material.roughnessMap&&d.material.roughnessMap.dispose(),d.material.dispose()))}),r.models){const d=r.models.indexOf(c);d>-1&&r.models.splice(d,1)}r.onClearState&&r.onClearState(a),r.onRemoveHealthBar&&r.onRemoveHealthBar(a),c.type==="copper"&&r.onRemoveCopper&&r.onRemoveCopper(a)}if(l&&u){f("[Handler] ...");const _=$=>{f("[Handler] :",$),r.onShowResourceGain&&Object.keys($).length>0&&(f("[Handler] :",u,$),r.onShowResourceGain(u,$))};lc(vn.RESOURCES_UPDATED,_),Do(vn.UPDATE_RESOURCES),setTimeout(()=>{Cu(vn.RESOURCES_UPDATED,_)},1e3)}}),He.registerHandler("change_direction",async(i,r)=>{const{id:a,direction:c}=i,l=Wr(r.models||[],a);if(l&&l.object){let u=0;switch(c){case"PositiveY":u=0;break;case"PositiveX":u=Math.PI/2;break;case"NegativeY":u=Math.PI;break;case"NegativeX":u=-Math.PI/2;break}let _=l.object.rotation.y;_=Math.atan2(Math.sin(_),Math.cos(_));let $=u-_;$>Math.PI?$-=2*Math.PI:$<-Math.PI&&($+=2*Math.PI);const d=300,p=performance.now();await new Promise(b=>{function g(){const m=performance.now()-p,w=Math.min(m/d,1),y=1-Math.pow(1-w,2);l.object&&(l.object.rotation.y=_+$*y),w<1?requestAnimationFrame(g):(l.object&&(l.object.rotation.y=u),b())}g()})}}),He.registerHandler("move_to",async(i,r)=>{const{id:a,to:c}=i,l=Wr(r.models||[],a);if(l&&l.object&&r.gridCellSize){const[u,_]=c,$=u,d=_,p=l.object.position.y;l.position=[u,_],r.onMoveStart&&r.onMoveStart(a,l),r.animateModelMove&&await new Promise(b=>{r.animateModelMove(l,{x:$,y:p,z:d},b)}),r.onMoveComplete&&r.onMoveComplete(a)}}),He.registerHandler("display_can_move",(i,r)=>{const{id:a,can_move:c}=i,l=c==="true"||c===!0;r.onDisplayCanMove&&r.onDisplayCanMove(a,l)}),He.registerHandler("display_can_attack",(i,r)=>{const{id:a,can_attack:c}=i,l=c==="true"||c===!0;r.onDisplayCanAttack&&r.onDisplayCanAttack(a,l)}),He.registerHandler("display_can_summon",(i,r)=>{const{id:a,can_summon:c}=i,l=c==="true"||c===!0;f(`[Handler] display_can_summon id=${a}, can_summon=${l}`),r.onDisplayCanSummon&&r.onDisplayCanSummon(a,l)}),He.registerHandler("update_health",(i,r)=>{const{id:a,now_health:c,max_health:l}=i;r.onUpdateHealth&&r.onUpdateHealth(a,c,l)}),He.registerHandler("clear_state",(i,r)=>{const{id:a}=i;r.onClearState&&r.onClearState(a)}),He.registerHandler("animate_move",async(i,r)=>{const{id:a}=i,c=Wr(r.models||[],a);if(!c){f(`[Handler] animate_move:  ID=${a}`);return}if(window.disableAutoFocus){f(`[Handler] animate_move:  ID=${a}`);return}const l=r.followEnemies!==void 0?r.followEnemies:!1;if(c.type==="enemy"&&!l){f(`[Handler] animate_move:  ID=${a}  context.followEnemies = true `);return}if(r.camera&&r.focusOnModel){const u=r.focusOnModel(c.object,r.camera,r.controls);r.focusState&&(r.focusState.focusPosition=u.focusPosition,r.focusState.focusTarget=u.focusTarget,r.focusState.lerpFactor=u.lerpFactor,f(`[Handler] animate_move:  ID=${a} (${c.name})`)),await t$(1e3)}}),He.registerHandler("animate_reset",async(i,r)=>{if(f("[Handler] animate_reset"),r.camera&&r.controls){const a={x:0,y:2,z:5},c={x:0,y:0,z:0};r.focusState&&(r.focusState.focusPosition=a,r.focusState.focusTarget=c,r.focusState.lerpFactor=.08),await t$(1e3)}}),He.registerHandler("put_map_block",(i,r)=>{const{position:a}=i;r.onPutMapBlock&&r.onPutMapBlock(a)}),He.registerHandler("put_room_blocks",async(i,r)=>{const{room_position:a,size:c}=i,[l,u]=a;if(f(`[Handler]  : [${l}, ${u}], ${c}x${c}`),!r.onPutMapBlock){f("[Handler]  context.onPutMapBlock ");return}f("[Handler]  context.onPutMapBlock ...");const _=32,$=c*c;let d=0;for(let p=0;p<c;p++)for(let b=0;b<c;b++){const g=[l+p,u+b];r.onPutMapBlock(g),d++,d%_===0&&await new Promise(m=>requestAnimationFrame(m))}f(`[Handler]  : ${$}`)}),He.registerHandler("put_resource_marker",(i,r)=>{const{position:a}=i;r.onPutResourceMarker&&r.onPutResourceMarker(a)}),He.registerHandler("clear_resource_marker",(i,r)=>{const{position:a}=i;r.onClearResourceMarker&&r.onClearResourceMarker(a)});let e=0,t=0,n=0;He.registerHandler("set_move_block",(i,r)=>{const{position:a}=i;e++,r.onSetMoveBlock&&r.onSetMoveBlock(a)}),He.registerHandler("set_attack_block",(i,r)=>{const{position:a}=i;t++,r.onSetAttackBlock&&r.onSetAttackBlock(a),(t===1||t%10===0)&&f(`[Handler]  ${t} `)}),He.registerHandler("set_can_summon_blocks",(i,r)=>{const{position:a}=i;n++,r.onSetCanSummonBlock&&r.onSetCanSummonBlock(a),(n===1||n%10===0)&&f(`[Handler]  ${n} `)});let o=0,s=Date.now();He.registerHandler("clear_block",(i,r)=>{const{position:a}=i;r.onClearBlock&&r.onClearBlock(a),o++;const c=Date.now();c-s>500&&(o>1&&f(`[Handler]   ${o} `),o=0,e>0&&(f(`[Handler]  ${e} `),e=0),t>0&&(f(`[Handler]  ${t} `),t=0),n>0&&(f(`[Handler]  ${n} `),n=0)),s=c}),He.registerHandler("attack_complete",(i,r)=>{const{id:a}=i;r.onAttackComplete&&r.onAttackComplete(a)}),He.registerHandler("on_game_round_pass",(i,r)=>{}),He.registerHandler("craft_success",(i,r)=>{r.onCraftResult&&r.onCraftResult(!0,i.message||"")}),He.registerHandler("craft_failed",(i,r)=>{r.onCraftResult&&r.onCraftResult(!1,i.message||"")}),He.registerHandler("cannot_pick_up_item",(i,r)=>{f("[Handler] :",i.message||i)}),He.registerHandler("equipment_slot_full",(i,r)=>{f("[Handler] :",i.message||i)}),He.registerHandler("inventory_full",(i,r)=>{f("[Handler] :",i.message||i)}),He.registerHandler("resource_not_enough",(i,r)=>{let a="";if(i.missing&&Array.isArray(i.missing)&&i.missing.length>0){const c={HeartCrystalDust:"",RecallGear:"",SpiritalSpark:"",RefinedCopper:"",ResonantCrystal:""};a=`: ${i.missing.map(u=>{const _=c[u.type]||u.type,$=u.needed-u.current;return`${_} ( ${$})`}).join("")}`}f("[Handler] :",a),r.onResourceNotEnough&&r.onResourceNotEnough(a)}),He.registerHandler("summon_failed",(i,r)=>{f("[Handler] :",i.message||i),r.onSummonFailed&&r.onSummonFailed(i.message||"")}),He.registerHandler("summon_expired",(i,r)=>{const{id:a,message:c}=i;f(`[Handler] : ID=${a}, ${c}`)}),He.registerHandler("get_summon_menu",(i,r)=>{const{contents:a}=i;f("[Handler] :",a),r.onShowSummonMenu&&r.onShowSummonMenu(a)}),He.registerHandler("get_structure_menu",(i,r)=>{const{contents:a}=i;if(!a||a.length===0){f("[Handler]  ");return}const c=a.filter(l=>l.name!=="");f("[Handler] ",c.length,""),r.onShowStructureMenu&&r.onShowStructureMenu(c)}),He.registerHandler("drill_resource_generate",(i,r)=>{const{position:a,resource_type:c,amount:l}=i;f(`[Handler] : =${JSON.stringify(a)}, =${c}, =${l}`);const u={[c]:parseInt(l)};r.onShowResourceGain&&r.onShowResourceGain(a,u),Do(vn.UPDATE_RESOURCES)}),He.registerHandler("game_over",(i,r)=>{f("[Handler] "),r.onGameOver&&r.onGameOver()}),He.registerHandler("success",(i,r)=>{f("[Handler] "),r.onGameSuccess&&r.onGameSuccess()})}const Ap={hi:-1,lo:-1},m1={hi:232830643,lo:-1486618624},Mt={hi:0,lo:0},cn={hi:0,lo:1},tn={hi:0,lo:10},f1={hi:0,lo:100},h1={hi:0,lo:1e3},g1={hi:0,lo:1e4},b1={hi:0,lo:1e5},y1={hi:0,lo:1e6},w1={hi:0,lo:1e7},v1={hi:0,lo:1e8},S1={hi:0,lo:1e9},k1={hi:2,lo:1410065408},M1={hi:23,lo:1215752192},C1={hi:232,lo:-727379968},x1={hi:2328,lo:1316134912},P1={hi:23283,lo:276447232},L1={hi:232830,lo:-1530494976},I1={hi:0,lo:22},T1={hi:0,lo:37},E1={hi:-1,lo:-22},n$=new DataView(new ArrayBuffer(8));function xu(e){return n$.setInt32(0,e,!0),n$.getFloat32(0,!0)}const A1={$tag:0},Gp={$tag:1},Rp={$tag:2};function Ar(e,t){this._0=e,this._1=t}Ar.prototype.$tag=3;function Ae(e){this._0=e}Ae.prototype.$tag=4;function In(e){this._0=e}In.prototype.$tag=5;function ke(e){this._0=e}ke.prototype.$tag=6;const G1={hi:-1048576,lo:0},R1={hi:2146435072,lo:0},O1={hi:2146959360,lo:1},Op={hi:0,lo:2};class D1 extends Error{}function ne(){throw new D1}function S(e,t){if(t<0||t>=e.length)throw new Error("Index out of bounds")}function lt(e,t){const n=new Array(e);return n.fill(t),n}const N1=e=>e.slice(0);function Fi(e){this._0=e}Fi.prototype.$tag=1;function je(e){this._0=e}je.prototype.$tag=6;function Gr(e,t){this._0=e,this._1=t}Gr.prototype.$tag=5;const Tn={$tag:4},Dp={$tag:1};function Ws(e){this._0=e}Ws.prototype.$tag=0;function Np(e){this._0=e}Np.prototype.$tag=0;function uc(e){this._0=e}uc.prototype.$tag=0;function Pu(e){this._0=e}Pu.prototype.$tag=1;function jp(e){this._0=e}jp.prototype.$tag=0;function Hp(e){this._0=e}Hp.prototype.$tag=1;function Lu(e){this._0=e}Lu.prototype.$tag=0;function uo(e){this._0=e}uo.prototype.$tag=1;function Fp(e){this._0=e}Fp.prototype.$tag=0;function Ao(e){this._0=e}Ao.prototype.$tag=1;function Up(e){this._0=e}Up.prototype.$tag=0;function Bp(e){this._0=e}Bp.prototype.$tag=0;function zp(e){this._0=e}zp.prototype.$tag=1;const tl={hi:2147483647,lo:-1},s$={hi:0,lo:16},nl={hi:-2147483648,lo:0};function j1(e,t){return new Uint8Array(e)}const H1={hi:0,lo:65536},ua={$tag:0};function Iu(e){this._0=e}Iu.prototype.$tag=1;function _c(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63}function F1(e){return e>>>=0,e===0?32:(e&=-e,31-Math.clz32(e))}function qo(e,t,n){this._0=e,this._1=t,this._2=n}qo.prototype.$tag=0;function _o(e,t,n){this._0=e,this._1=t,this._2=n}_o.prototype.$tag=1;function Mi(e){this._0=e}Mi.prototype.$tag=2;const yi={$tag:0};function hr(e,t){this._0=e,this._1=t}hr.prototype.$tag=1;function $c(e){this._0=e}$c.prototype.$tag=0;function bs(e){this._0=e}bs.prototype.$tag=1;function dc(e){this._0=e}dc.prototype.$tag=0;function Tu(e){this._0=e}Tu.prototype.$tag=1;function Rr(e){this._0=e}Rr.prototype.$tag=0;function Dn(e){this._0=e}Dn.prototype.$tag=1;function go(e){this._0=e}go.prototype.$tag=0;function Ft(e){this._0=e}Ft.prototype.$tag=1;function Vp(e){this._0=e}Vp.prototype.$tag=0;function qp(e){this._0=e}qp.prototype.$tag=1;function Wp(e){this._0=e}Wp.prototype.$tag=0;function Kp(e){this._0=e}Kp.prototype.$tag=0;function Ui(e){this._0=e}Ui.prototype.$tag=1;function Jp(e){this._0=e}Jp.prototype.$tag=0;function Nl(e){this._0=e}Nl.prototype.$tag=1;function Xp(e){this._0=e}Xp.prototype.$tag=0;function Yp(e){this._0=e}Yp.prototype.$tag=1;const U1={hi:2097151,lo:-1},B1={hi:-2097152,lo:1};function Zp(e){this._0=e}Zp.prototype.$tag=0;function Qp(e){this._0=e}Qp.prototype.$tag=1;function jl(e){this._0=e}jl.prototype.$tag=0;function em(e){this._0=e}em.prototype.$tag=1;const z1={$tag:0},V1={$tag:1},q1={$tag:2};function Bi(e,t){this._0=e,this._1=t}Bi.prototype.$tag=3;function pc(e){this._0=e}pc.prototype.$tag=4;const W1={$tag:5},tm={$tag:6},K1={$tag:7},nm={$tag:8},sm={$tag:9};function om(e,t){this._0=e,this._1=t}om.prototype.$tag=0;function im(e,t){this._0=e,this._1=t}im.prototype.$tag=1;const rm={$tag:0};function et(e,t){this._0=e,this._1=t}et.prototype.$tag=1;const J1={$tag:0};function am(e){this._0=e}am.prototype.$tag=1;const sl={hi:0,lo:-1},X1=new Uint8Array([65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,49,50,51,52,53,54]),Y1=()=>{var e;if((e=globalThis.crypto)!=null&&e.getRandomValues){const t=new Uint32Array(1);return globalThis.crypto.getRandomValues(t),t[0]|0}else return Math.floor(Math.random()*4294967296)|0},Z1=(e,t)=>e.toString(t),Q1=e=>(e.hi>>>0)*4294967296+(e.lo>>>0),e2=function e(t){let n=e._view;return n===void 0&&(n=e._view=new DataView(new ArrayBuffer(8))),n.setUint32(0,t.hi),n.setUint32(4,t.lo),n.getFloat64(0)},gn=(e,t)=>{e.push(t)},Eu=function e(){return e._exports?e._exports:e._exports=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports},t2=(e,t)=>{const n=e.hi,o=t.hi;if(n<o)return-1;if(n>o)return 1;const s=e.lo>>>0,i=t.lo>>>0;return s<i?-1:s>i?1:0},n2=(e,t)=>{const n=e.hi>>>0,o=t.hi>>>0;if(n<o)return-1;if(n>o)return 1;const s=e.lo>>>0,i=t.lo>>>0;return s<i?-1:s>i?1:0},s2=e=>e.hi*4294967296+(e.lo>>>0),o2=e=>e.pop(),i2=(e,t,n)=>e.splice(t,n),Kr={$tag:0};function zi(e){this._0=e}zi.prototype.$tag=1;function Go(e){this._0=e}Go.prototype.$tag=0;function cm(e){this._0=e}cm.prototype.$tag=1;function _a(e){this._0=e}_a.prototype.$tag=0;function lm(e){this._0=e}lm.prototype.$tag=1;function ai(e){this._0=e}ai.prototype.$tag=0;function um(e){this._0=e}um.prototype.$tag=1;function ds(e){this._0=e}ds.prototype.$tag=0;function _m(e){this._0=e}_m.prototype.$tag=1;function Vi(e){this._0=e}Vi.prototype.$tag=0;function ci(e){this._0=e}ci.prototype.$tag=1;const o$={$tag:0};function Hl(e){this._0=e}Hl.prototype.$tag=1;function Fl(e){this._0=e}Fl.prototype.$tag=0;function $m(e){this._0=e}$m.prototype.$tag=1;const r2={$tag:0};function dm(e){this._0=e}dm.prototype.$tag=1;const pm={$tag:0};function Au(e){this._0=e}Au.prototype.$tag=1;function Ro(e){this._0=e}Ro.prototype.$tag=0;function mm(e){this._0=e}mm.prototype.$tag=1;function qi(e){this._0=e}qi.prototype.$tag=0;function fm(e){this._0=e}fm.prototype.$tag=1;function Wo(e){this._0=e}Wo.prototype.$tag=0;function Ci(e){this._0=e}Ci.prototype.$tag=1;function Ko(e){this._0=e}Ko.prototype.$tag=2;function $o(e){this._0=e}$o.prototype.$tag=0;function wi(e){this._0=e}wi.prototype.$tag=1;function Ul(e){this._0=e}Ul.prototype.$tag=2;function Gu(e){this._0=e}Gu.prototype.$tag=3;const gr={$tag:4};function hm(e){this._0=e}hm.prototype.$tag=0;const a2=Ap,gm="value out of range",xi="invalid syntax",i$="",bm=m1,c2=Mt,l2=Mt,Kt={mantissa_bits:52,exponent_bits:11,bias:-1023},Jr=[1,3,6,9,13,16,19,23,26,29,33,36,39,43,46,49,53,56,59],u2={_0:0,_1:""},_2={_0:1,_1:"5"},$2={_0:1,_1:"25"},d2={_0:1,_1:"125"},p2={_0:2,_1:"625"},m2={_0:2,_1:"3125"},f2={_0:2,_1:"15625"},h2={_0:3,_1:"78125"},g2={_0:3,_1:"390625"},b2={_0:3,_1:"1953125"},y2={_0:4,_1:"9765625"},w2={_0:4,_1:"48828125"},v2={_0:4,_1:"244140625"},S2={_0:4,_1:"1220703125"},k2={_0:5,_1:"6103515625"},M2={_0:5,_1:"30517578125"},C2={_0:5,_1:"152587890625"},x2={_0:6,_1:"762939453125"},P2={_0:6,_1:"3814697265625"},L2={_0:6,_1:"19073486328125"},I2={_0:7,_1:"95367431640625"},T2={_0:7,_1:"476837158203125"},E2={_0:7,_1:"2384185791015625"},A2={_0:7,_1:"11920928955078125"},G2={_0:8,_1:"59604644775390625"},R2={_0:8,_1:"298023223876953125"},O2={_0:8,_1:"1490116119384765625"},D2={_0:9,_1:"7450580596923828125"},N2={_0:9,_1:"37252902984619140625"},j2={_0:9,_1:"186264514923095703125"},H2={_0:10,_1:"931322574615478515625"},F2={_0:10,_1:"4656612873077392578125"},U2={_0:10,_1:"23283064365386962890625"},B2={_0:10,_1:"116415321826934814453125"},z2={_0:11,_1:"582076609134674072265625"},V2={_0:11,_1:"2910383045673370361328125"},q2={_0:11,_1:"14551915228366851806640625"},W2={_0:12,_1:"72759576141834259033203125"},K2={_0:12,_1:"363797880709171295166015625"},J2={_0:12,_1:"1818989403545856475830078125"},X2={_0:13,_1:"9094947017729282379150390625"},Y2={_0:13,_1:"45474735088646411895751953125"},Z2={_0:13,_1:"227373675443232059478759765625"},Q2={_0:13,_1:"1136868377216160297393798828125"},ey={_0:14,_1:"5684341886080801486968994140625"},ty={_0:14,_1:"28421709430404007434844970703125"},ny={_0:14,_1:"142108547152020037174224853515625"},sy={_0:15,_1:"710542735760100185871124267578125"},oy={_0:15,_1:"3552713678800500929355621337890625"},iy={_0:15,_1:"17763568394002504646778106689453125"},ry={_0:16,_1:"88817841970012523233890533447265625"},ay={_0:16,_1:"444089209850062616169452667236328125"},cy={_0:16,_1:"2220446049250313080847263336181640625"},ly={_0:16,_1:"11102230246251565404236316680908203125"},uy={_0:17,_1:"55511151231257827021181583404541015625"},_y={_0:17,_1:"277555756156289135105907917022705078125"},$y={_0:17,_1:"1387778780781445675529539585113525390625"},dy={_0:18,_1:"6938893903907228377647697925567626953125"},py={_0:18,_1:"34694469519536141888238489627838134765625"},my={_0:18,_1:"173472347597680709441192448139190673828125"},fy={_0:19,_1:"867361737988403547205962240695953369140625"},Xr=[u2,_2,$2,d2,p2,m2,f2,h2,g2,b2,y2,w2,v2,S2,k2,M2,C2,x2,P2,L2,I2,T2,E2,A2,G2,R2,O2,D2,N2,j2,H2,F2,U2,B2,z2,V2,q2,W2,K2,J2,X2,Y2,Z2,Q2,ey,ty,ny,sy,oy,iy,ry,ay,cy,ly,uy,_y,$y,dy,py,my,fy],r$=[cn,tn,f1,h1,g1,b1,y1,w1,v1,S1,k1,M1,C1,x1,P1,L1],ol=I1,a$=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16,1e17,1e18,1e19,1e20,1e21,1e22,0,0,0,0,0,0,0,0,0],hy=T1,gy=E1,by=Mt,yy={_0:160,_1:160},wy={_0:5760,_1:5760},vy={_0:8192,_1:8202},Sy={_0:8232,_1:8233},ky={_0:8239,_1:8239},My={_0:8287,_1:8287},Cy={_0:12288,_1:12288},xy={_0:65279,_1:65279},c$=".",l$="e",u$="E",Py=xu(2143289344),Ly=xu(2139095040),Iy=xu(-8388608),Ty=0,Ey=0,Ay=A1,Gy="",Ry="",Oy="/assets/copper/iron_wall/rocky/rocky.webp",Dy="/assets/copper/iron_wall/rocky/rocky.glb",Ny="",jy="",Hy="/assets/copper/iron_wall/wesley/wesley.webp",Fy="/assets/copper/iron_wall/wesley/wesley.glb",Uy="",By="",zy="/assets/copper/iron_wall/bell/bell.webp",Vy="/assets/copper/iron_wall/bell/bell.glb",qy="",Wy="",Ky="/assets/copper/iron_wall/tumble/tumble.webp",Jy="/assets/copper/iron_wall/tumble/tumble.glb",Xy="",Yy="",Zy="/assets/copper/iron_wall/chief/chief.webp",Qy="/assets/copper/iron_wall/chief/chief.glb",e4="",t4="1001",n4="/assets/copper/arcanist/spark/spark.webp",s4="/assets/copper/arcanist/spark/spark.glb",o4="",i4="",r4="/assets/copper/arcanist/syrup/syrup.webp",a4="/assets/copper/arcanist/syrup/syrup.glb",c4="",l4="",u4="/assets/copper/arcanist/bubble/bubble.webp",_4="/assets/copper/arcanist/bubble/bubble.glb",$4="",d4="",p4="/assets/copper/arcanist/glimmer/glimmer.webp",m4="/assets/copper/arcanist/glimmer/glimmer.glb",f4="",h4="",g4="/assets/copper/arcanist/turner/turner.webp",b4="/assets/copper/arcanist/turner/turner.glb",y4="",w4="",v4="/assets/copper/resonator/murmur/murmur.webp",S4="/assets/copper/resonator/murmur/murmur.glb",k4="",M4="",C4="/assets/copper/resonator/melody/melody.webp",x4="/assets/copper/resonator/melody/melody.glb",P4="",L4="",I4="/assets/copper/resonator/clawster/clawster.webp",T4="/assets/copper/resonator/clawster/clawster.glb",E4="",A4=" 3*3 ",G4="/assets/copper/resonator/diggs/diggs.webp",R4="/assets/copper/resonator/diggs/diggs.glb",O4="",D4="",N4="/assets/copper/resonator/hive/hive.webp",j4="/assets/copper/resonator/hive/hive.glb",H4="",F4="",U4="/assets/copper/mechanic/gyro/gyro.webp",B4="/assets/copper/mechanic/gyro/gyro.glb",z4="",V4="",q4="/assets/copper/mechanic/tricky/tricky.webp",W4="/assets/copper/mechanic/tricky/tricky.glb",K4="",J4="",X4="/assets/copper/mechanic/pendulum/pendulum.webp",Y4="/assets/copper/mechanic/pendulum/pendulum.glb",Z4="",Q4="",ew="/assets/copper/mechanic/yoyo/yoyo.webp",tw="/assets/copper/mechanic/yoyo/yoyo.glb",nw="",sw="",ow="/assets/copper/mechanic/karin/karin.webp",iw="/assets/copper/mechanic/karin/karin.glb",rw="",aw="",cw="/assets/copper/craftsman/wrench/wrench.webp",lw="/assets/copper/craftsman/wrench/wrench.glb",uw="",_w="",$w="/assets/copper/craftsman/coil/coil.webp",dw="/assets/copper/craftsman/coil/coil.glb",pw="",mw="",fw="/assets/copper/craftsman/artifex/artifex.webp",hw="/assets/copper/craftsman/artifex/artifex.glb",gw="",bw="",yw="/assets/copper/craftsman/drillbit/drillbit.webp",ww="/assets/copper/craftsman/drillbit/drillbit.glb",vw="",Sw="",kw="/assets/copper/craftsman/quickhand/quickhand.webp",Mw="/assets/copper/craftsman/quickhand/quickhand.glb",Cw=10,xw={name:"",description:"1082",resource_url:"/assets/copper/iron_wall/rocky/rocky_skill.webp",cool_down:Cw},Pw=xw,Lw=10,Iw={name:"",description:" 20%  15% ",resource_url:"/assets/copper/iron_wall/wesley/wesley_skill.webp",cool_down:Lw},Tw=Iw,Ew=20,Aw={name:"",description:" 100 ",resource_url:"/assets/copper/arcanist/spark/spark_skill.webp",cool_down:Ew},Gw=Aw,Rw=10,Ow={name:"",description:"",resource_url:"/assets/copper/arcanist/bubble/bubble_skill.webp",cool_down:Rw},Dw=Ow,Nw=5,jw={name:"",description:" 200% ",resource_url:"/assets/copper/arcanist/turner/turner_skill.webp",cool_down:Nw},Hw=jw,Fw=10,Uw={name:"",description:"",resource_url:"/assets/copper/mechanic/gyro/gyro_skill.webp",cool_down:Fw},Bw=Uw,zw=10,Vw={name:"",description:"",resource_url:"/assets/copper/mechanic/tricky/tricky_skill.webp",cool_down:zw},qw=Vw,Ww=5,Kw={name:"",description:"",resource_url:"/assets/copper/mechanic/pendulum/pendulum_skill.webp",cool_down:Ww},Jw=Kw,Xw=3,Yw={name:"",description:" 200%",resource_url:"/assets/copper/mechanic/yoyo/yoyo_skill.webp",cool_down:Xw},Zw=Yw,Qw={type_msg:"upgrade_cost_error",content:""},ev={_0:2,_1:100},tv={_0:1,_1:0},nv={_0:4,_1:0},sv={_0:3,_1:0},ov={_0:0,_1:0},iv={_0:2,_1:0},rv={_0:1,_1:0},av={_0:4,_1:0},cv={_0:3,_1:0},lv={_0:0,_1:0},uv={type_msg:"resource_not_enough",content:""},_v={type_msg:"resource_not_enough",content:""},$v={_0:3,_1:1},dv={_0:4,_1:1},pv={_0:0,_1:1},mv={_0:1,_1:1},fv={_0:3,_1:8},hv={_0:1,_1:2},gv={_0:3,_1:6},bv={_0:1,_1:3},yv={_0:3,_1:10},wv={_0:1,_1:4},vv={_0:0,_1:5},Sv={_0:3,_1:20},kv={_0:1,_1:6},Mv={_0:4,_1:10},Cv={_0:3,_1:8},xv={_0:1,_1:3},Pv={_0:0,_1:3},Lv={_0:3,_1:30},Iv={_0:4,_1:20},Tv={_0:0,_1:10},Ev={_0:2,_1:8},Av={_0:3,_1:15},Gv={_0:1,_1:5},Rv={_0:4,_1:8},Ov={_0:3,_1:25},Dv={_0:4,_1:15},Nv={_0:2,_1:5},jv=[0,2,3,4,6,6,8],Hv={_0:0,_1:1},Fv={_0:1,_1:Hv},Uv={_0:1,_1:1},Bv={_0:3,_1:Uv},zv={_0:3,_1:2},Vv={_0:1,_1:1},qv={_0:0,_1:1},Wv={_0:4,_1:qv},Kv={_0:1,_1:1},Jv={_0:0,_1:Kv},Xv={_0:3,_1:1},Yv={_0:0,_1:2},Zv={_0:1,_1:2},Qv={_0:1,_1:Zv},eS={_0:0,_1:1},tS={_0:3,_1:eS},nS={_0:3,_1:3},sS={_0:1,_1:2},oS={_0:0,_1:1},iS={_0:1,_1:2},rS={_0:4,_1:iS},aS={_0:0,_1:1},cS={_0:0,_1:aS},lS={_0:1,_1:2},uS={_0:4,_1:3},_S={_0:2,_1:1},$S={_0:1,_1:3},dS={_0:1,_1:$S},pS={_0:1,_1:2},mS={_0:4,_1:pS},fS={_0:0,_1:1},hS={_0:3,_1:fS},gS={_0:1,_1:4},bS={_0:4,_1:2},yS={_0:3,_1:8},wS={_0:2,_1:3},vS={_0:1,_1:2},SS={_0:1,_1:vS},kS={_0:0,_1:1},MS={_0:4,_1:kS},CS={_0:1,_1:2},xS={_0:0,_1:6},PS={_0:3,_1:6},LS={_0:2,_1:1},IS={_0:2,_1:4},TS={_0:1,_1:IS},ES={_0:1,_1:3},AS={_0:4,_1:ES},GS={_0:1,_1:2},RS={_0:3,_1:GS},OS={_0:1,_1:6},DS={_0:4,_1:4},NS={_0:3,_1:12},jS={_0:2,_1:3},HS={_0:1,_1:2},FS={_0:1,_1:HS},US={_0:2,_1:3},BS={_0:4,_1:US},zS={_0:1,_1:2},VS={_0:0,_1:zS},qS={_0:1,_1:10},WS={_0:4,_1:10},KS={_0:0,_1:10},JS={_0:2,_1:3},XS={_0:2,_1:4},YS={_0:1,_1:XS},ZS={_0:2,_1:4},QS={_0:4,_1:ZS},ek={_0:1,_1:2},tk={_0:3,_1:ek},nk={_0:1,_1:10},sk={_0:4,_1:10},ok={_0:3,_1:15},ik={_0:2,_1:5},rk={_0:3,_1:5},ak={_0:1,_1:rk},ck={_0:2,_1:3},lk={_0:4,_1:ck},uk={_0:1,_1:2},_k={_0:0,_1:uk},$k={_0:1,_1:10},dk={_0:4,_1:15},pk={_0:3,_1:10},mk={_0:2,_1:5},fk={_0:2,_1:3},hk={_0:1,_1:fk},gk={_0:3,_1:5},bk={_0:4,_1:gk},yk={_0:1,_1:2},wk={_0:3,_1:yk},vk={_0:1,_1:15},Sk={_0:4,_1:15},kk={_0:0,_1:20},Mk={_0:3,_1:20},Ck={_0:2,_1:8},xk={_0:4,_1:6},Pk={_0:1,_1:xk},Lk={_0:4,_1:6},Ik={_0:4,_1:Lk},Tk={_0:2,_1:3},Ek={_0:3,_1:Tk},Ak={_0:2,_1:3},Gk={_0:0,_1:Ak},Rk={_0:1,_1:30},Ok={_0:4,_1:30},Dk={_0:0,_1:30},Nk={_0:3,_1:30},jk={_0:2,_1:10},Hk={_0:5,_1:7},Fk={_0:1,_1:Hk},Uk={_0:5,_1:7},Bk={_0:4,_1:Uk},zk={_0:3,_1:4},Vk={_0:3,_1:zk},qk={_0:3,_1:4},Wk={_0:0,_1:qk},Kk={_0:1,_1:40},Jk={_0:4,_1:40},Xk={_0:0,_1:40},Yk={_0:3,_1:40},Zk={_0:2,_1:15},Qk={name:"",resource_type:3,model_url:"/assets/resource/refined_copper_ingot/refined_copper_ingot.glb"},e5={name:"",resource_type:4,model_url:"/assets/resource/resonant_star_crystal/resonant_star_crystal.glb"},t5={_0:0,_1:0},n5={_0:0,_1:3},s5={_0:0,_1:4},o5={_0:0,_1:5},i5=[n5,s5,o5],r5={_0:0,_1:3},a5={_0:0,_1:4},c5={_0:0,_1:5},l5={_0:-1,_1:0},u5={_0:1,_1:0},_5={_0:0,_1:-1},$5={_0:0,_1:1},d5={_0:-1,_1:0},p5={_0:1,_1:0},m5={_0:0,_1:-1},f5={_0:0,_1:1},h5=void 0,g5={name:Gy,copper_type:0,description:Ry,icon_url:Oy,model_url:Dy,skill:Pw,attack_range:h5},b5=void 0,y5={name:Ny,copper_type:0,description:jy,icon_url:Hy,model_url:Fy,skill:Tw,attack_range:b5},w5={name:"",description:"",resource_url:"/assets/copper/iron_wall/bell/bell_skill.webp",cool_down:void 0},v5=void 0,S5={name:Uy,copper_type:0,description:By,icon_url:zy,model_url:Vy,skill:w5,attack_range:v5},k5={name:"",description:" 1:1 ",resource_url:"/assets/copper/iron_wall/tumble/tumble_skill.webp",cool_down:void 0},M5=void 0,C5={name:qy,copper_type:0,description:Wy,icon_url:Ky,model_url:Jy,skill:k5,attack_range:M5},x5={name:"",description:" 3x3  20%  10% ",resource_url:"/assets/copper/iron_wall/chief/chief_skill.webp",cool_down:void 0},P5=void 0,L5={name:Xy,copper_type:0,description:Yy,icon_url:Zy,model_url:Qy,skill:x5,attack_range:P5},I5=void 0,T5={name:e4,copper_type:1,description:t4,icon_url:n4,model_url:s4,skill:Gw,attack_range:I5},E5={name:"",description:" 20% ",resource_url:"/assets/copper/arcanist/syrup/syrup_skill.webp",cool_down:void 0},A5=void 0,G5={name:o4,copper_type:1,description:i4,icon_url:r4,model_url:a4,skill:E5,attack_range:A5},R5=void 0,O5={name:c4,copper_type:1,description:l4,icon_url:u4,model_url:_4,skill:Dw,attack_range:R5},D5={name:"",description:" 20% ",resource_url:"/assets/copper/arcanist/glimmer/glimmer_skill.webp",cool_down:void 0},N5=void 0,j5={name:$4,copper_type:1,description:d4,icon_url:p4,model_url:m4,skill:D5,attack_range:N5},H5=void 0,F5={name:f4,copper_type:1,description:h4,icon_url:g4,model_url:b4,skill:Hw,attack_range:H5},U5={name:"",description:" 20 ",resource_url:"/assets/copper/resonator/murmur/murmur_skill.webp",cool_down:void 0},B5=void 0,z5={name:y4,copper_type:4,description:w4,icon_url:v4,model_url:S4,skill:U5,attack_range:B5},V5={name:"",description:" 5 ",resource_url:"/assets/copper/resonator/melody/melody_skill.webp",cool_down:void 0},q5=void 0,W5={name:k4,copper_type:4,description:M4,icon_url:C4,model_url:x4,skill:V5,attack_range:q5},K5={name:"",description:" 0 ",resource_url:"/assets/copper/resonator/clawsteak/clawster_skill.webp",cool_down:void 0},J5=void 0,X5={name:P4,copper_type:4,description:L4,icon_url:I4,model_url:T4,skill:K5,attack_range:J5},Y5={name:"",description:" 3*3 ",resource_url:"/assets/copper/resonator/diggs/diggs_skill.webp",cool_down:void 0},Z5=void 0,Q5={name:E4,copper_type:4,description:A4,icon_url:G4,model_url:R4,skill:Y5,attack_range:Z5},eM={name:"",description:" 10 ",resource_url:"/assets/copper/resonator/hive/hive_skill.webp",cool_down:void 0},tM=void 0,nM={name:O4,copper_type:4,description:D4,icon_url:N4,model_url:j4,skill:eM,attack_range:tM},sM=void 0,oM={name:H4,copper_type:3,description:F4,icon_url:U4,model_url:B4,skill:Bw,attack_range:sM},iM=void 0,rM={name:z4,copper_type:3,description:V4,icon_url:q4,model_url:W4,skill:qw,attack_range:iM},aM=void 0,cM={name:K4,copper_type:3,description:J4,icon_url:X4,model_url:Y4,skill:Jw,attack_range:aM},lM=void 0,uM={name:Z4,copper_type:3,description:Q4,icon_url:ew,model_url:tw,skill:Zw,attack_range:lM},_M={name:"",description:"",resource_url:"/assets/copper/mechanic/karin/karin_skill.webp",cool_down:void 0},$M=void 0,dM={name:nw,copper_type:3,description:sw,icon_url:ow,model_url:iw,skill:_M,attack_range:$M},pM=void 0,mM=void 0,fM={name:rw,copper_type:2,description:aw,icon_url:cw,model_url:lw,skill:pM,attack_range:mM},hM=void 0,gM=void 0,bM={name:uw,copper_type:2,description:_w,icon_url:$w,model_url:dw,skill:hM,attack_range:gM},yM=void 0,wM=void 0,vM={name:pw,copper_type:2,description:mw,icon_url:fw,model_url:hw,skill:yM,attack_range:wM},SM=void 0,kM=void 0,MM={name:gw,copper_type:2,description:bw,icon_url:yw,model_url:ww,skill:SM,attack_range:kM},CM=void 0,xM=void 0,or=[g5,y5,S5,C5,L5,T5,G5,O5,j5,F5,z5,W5,X5,Q5,nM,oM,rM,cM,uM,dM,fM,bM,vM,MM,{name:vw,copper_type:2,description:Sw,icon_url:kw,model_url:Mw,skill:CM,attack_range:xM}],PM=Y1(),LM=fx(e=>{const t=or.length;let n=0;for(;;){const o=n;if(o<t){const s=or[o];if(e({_0:s.name,_1:s})===1){n=o+1|0;continue}else return 0}else return 1}}),Pi=Af(),It=jM(DP()),IM=Af(),Qe=mP(),ym=l3(),br=Mr(G1),yr=Mr(R1),wm=[yy,wy,vy,Sy,ky,My,Cy,xy],TM=Mr(O1),vm=xr(Op,52),Ms=Or(8),ir=Or(8),zt=Or(8),En=Or(8),bo=Q3(8),Lt=HM(void 0),Hn=BC([]),Bl=[{name:"",health:Math.fround(400),can_move:!1,can_attack:!1,attack_range:0,description:" ",asset_url:"assets/structure/riveted_barrier/riveted_barrier.webp",model_url:"assets/structure/riveted_barrier/riveted_barrier.glb",attribute:qt(Math.fround(0),0,Math.fround(0),Math.fround(0),Math.fround(0)),cost:kt([fv,hv])},{name:"",health:Math.fround(180),can_move:!1,can_attack:!0,attack_range:3,description:"",asset_url:"assets/structure/gear_arrow_tower/gear_arrow_tower.webp",model_url:"assets/structure/gear_arrow_tower/gear_arrow_tower.glb",attribute:qt(Math.fround(0),0,Math.fround(30),Math.fround(0),Math.fround(0)),cost:kt([gv,bv])},{name:"",health:Math.fround(300),can_move:!1,can_attack:!1,attack_range:0,description:"",asset_url:"assets/structure/heart_source_drill/heart_source_mineral_drill.webp",model_url:"assets/structure/heart_source_drill/heart_source_mineral_drill.glb",attribute:qt(Math.fround(0),0,Math.fround(0),Math.fround(0),Math.fround(0)),cost:kt([yv,wv,vv])},{name:"",health:Math.fround(200),can_move:!1,can_attack:!1,attack_range:0,description:"",asset_url:"assets/structure/charging_coil/charging_coil.webp",model_url:"assets/structure/charging_coil/charging_coil.glb",attribute:qt(Math.fround(0),0,Math.fround(0),Math.fround(0),Math.fround(0)),cost:kt([Sv,kv,Mv])},{name:"",health:Math.fround(200),can_move:!1,can_attack:!0,attack_range:3,description:"",asset_url:"assets/structure/repair_workshop/repair_workshop.webp",model_url:"assets/structure/repair_workshop/repair_workshop.glb",attribute:qt(Math.fround(0),0,Math.fround(25),Math.fround(0),Math.fround(0)),cost:kt([Cv,xv,Pv])},{name:"",health:Math.fround(1200),can_move:!1,can_attack:!0,attack_range:5,description:"",asset_url:"assets/structure/mirror_refractory_tower/mirror_light_refraction_tower.webp",model_url:"assets/structure/mirror_refractory_tower/mirror_light_refraction_tower.glb",attribute:qt(Math.fround(0),0,Math.fround(120),Math.fround(0),Math.fround(0)),cost:kt([Lv,Iv,Tv,Ev])},{name:"",health:Math.fround(500),can_move:!1,can_attack:!0,attack_range:4,description:"",asset_url:"assets/structure/resonance_alarm_bell/resonance_alarm_bell.webp",model_url:"assets/structure/resonance_alarm_bell/resonance_alarm_bell.glb",attribute:qt(Math.fround(0),0,Math.fround(60),Math.fround(0),Math.fround(0)),cost:kt([Av,Gv,Rv])},{name:"",health:Math.fround(800),can_move:!1,can_attack:!0,attack_range:4,description:"",asset_url:"assets/structure/storm_iron_anvil/storm_anvil.webp",model_url:"assets/structure/storm_iron_anvil/storm_anvil.glb",attribute:qt(Math.fround(0),0,Math.fround(100),Math.fround(0),Math.fround(0)),cost:kt([Ov,Dv,Nv])}],Sm=mx(e=>{const t=Bl.length;let n=0;for(;;){const o=n;if(o<t){const s=Bl[o];if(e({_0:s.name,_1:s})===1){n=o+1|0;continue}else return 0}else return 1}}),Ks=zC([]),Ta=[{level:1,health:Math.fround(25),attack:Math.fround(8),defense:Math.fround(3),dodge:Math.fround(0),attack_range:1,speed:2,name:"",enemy_type:"goblin",description:"''",asset_url:"/assets/enemy/goblin/goblin.webp",model_url:"/assets/enemy/goblin/goblin.glb",drop_items:[Fv,Bv],summon_cost:kt([zv,Vv])},{level:1,health:Math.fround(30),attack:Math.fround(7),defense:Math.fround(5),dodge:Math.fround(0),attack_range:1,speed:1,name:"",enemy_type:"cruiser",description:"",asset_url:"/assets/enemy/cruiser/cruiser.webp",model_url:"/assets/enemy/cruiser/cruiser.glb",drop_items:[Wv,Jv],summon_cost:kt([Xv,Yv])},{level:2,health:Math.fround(35),attack:Math.fround(12),defense:Math.fround(5),dodge:Math.fround(10),attack_range:1,speed:4,name:"",enemy_type:"scout",description:"''",asset_url:"/assets/enemy/scout/scout.webp",model_url:"/assets/enemy/scout/scout.glb",drop_items:[Qv,tS],summon_cost:kt([nS,sS,oS])},{level:2,health:Math.fround(40),attack:Math.fround(16),defense:Math.fround(8),dodge:Math.fround(5),attack_range:3,speed:2,name:"",enemy_type:"horn",description:"",asset_url:"/assets/enemy/horn/horn.webp",model_url:"/assets/enemy/horn/horn.glb",drop_items:[rS,cS],summon_cost:kt([lS,uS,_S])},{level:3,health:Math.fround(70),attack:Math.fround(22),defense:Math.fround(15),dodge:Math.fround(0),attack_range:1,speed:1,name:"",enemy_type:"boxer",description:" ",asset_url:"/assets/enemy/boxer/boxer.webp",model_url:"/assets/enemy/boxer/boxer.glb",drop_items:[dS,mS,hS],summon_cost:kt([gS,bS,yS,wS])},{level:3,health:Math.fround(55),attack:Math.fround(30),defense:Math.fround(4),dodge:Math.fround(20),attack_range:1,speed:3,name:"",enemy_type:"assassin",description:"",asset_url:"/assets/enemy/assassin/assassin.webp",model_url:"/assets/enemy/assassin/assassin.glb",drop_items:[SS,MS],summon_cost:kt([CS,xS,PS,LS])},{level:4,health:Math.fround(110),attack:Math.fround(30),defense:Math.fround(20),dodge:Math.fround(0),attack_range:1,speed:2,name:"",enemy_type:"devourer",description:"",asset_url:"/assets/enemy/devourer/devourer.glb",model_url:"/assets/enemy/devourer/devourer.glb",drop_items:[TS,AS,RS],summon_cost:kt([OS,DS,NS,jS])},{level:4,health:Math.fround(50),attack:Math.fround(32),defense:Math.fround(10),dodge:Math.fround(70),attack_range:2,speed:3,name:"",enemy_type:"mirror",description:"",asset_url:"/assets/enemy/mirror/mirror.webp",model_url:"/assets/enemy/mirror/mirror.glb",drop_items:[FS,BS,VS],summon_cost:kt([qS,WS,KS,JS])},{level:5,health:Math.fround(250),attack:Math.fround(45),defense:Math.fround(35),dodge:Math.fround(5),attack_range:2,speed:1,name:"",enemy_type:"guard",description:"",asset_url:"/assets/enemy/guard/guard.webp",model_url:"/assets/enemy/guard/guard.glb",drop_items:[YS,QS,tk],summon_cost:kt([nk,sk,ok,ik])},{level:5,health:Math.fround(100),attack:Math.fround(50),defense:Math.fround(10),dodge:Math.fround(25),attack_range:2,speed:5,name:"",enemy_type:"demon",description:"''''",asset_url:"/assets/enemy/demon/demon.webp",model_url:"/assets/enemy/demon/demon.glb",drop_items:[ak,lk,_k],summon_cost:kt([$k,dk,pk,mk])},{level:5,health:Math.fround(160),attack:Math.fround(55),defense:Math.fround(15),dodge:Math.fround(0),attack_range:2,speed:2,name:"",enemy_type:"variant",description:"''''",asset_url:"/assets/enemy/variant/variant.webp",model_url:"/assets/enemy/variant/variant.glb",drop_items:[hk,bk,wk],summon_cost:kt([vk,Sk,kk,Mk,Ck])},{level:6,health:Math.fround(300),attack:Math.fround(60),defense:Math.fround(20),dodge:Math.fround(30),attack_range:3,speed:3,name:"BOSS",enemy_type:"shatra",description:"''''''",asset_url:"/assets/enemy/shatra/shatra.webp",model_url:"/assets/enemy/shatra/shatra.glb",drop_items:[Pk,Ik,Ek,Gk],summon_cost:kt([Rk,Ok,Dk,Nk,jk])},{level:6,health:Math.fround(500),attack:Math.fround(40),defense:Math.fround(40),dodge:Math.fround(0),attack_range:1,speed:2,name:"BOSS",enemy_type:"glutton",description:"''''",asset_url:"/assets/enemy/glutton/glutton.webp",model_url:"/assets/enemy/glutton/glutton.glb",drop_items:[Fk,Bk,Vk,Wk],summon_cost:kt([Kk,Jk,Xk,Yk,Zk])}],EM=Z3(Ta),zl=px(e=>EM(t=>e({_0:t.name,_1:t}))),wr=Ru(!1),vr=Ru(!1),Sr=Ru(!1);function Js(e){ne()}function AM(e){return ne()}function Ea(e){return ne()}function GM(e){return ne()}function RM(e){return ne()}function OM(e){return ne()}function DM(e){return ne()}function NM(e){return ne()}function jM(e){return{val:e}}function HM(e){return{val:e}}function Ru(e){return{val:e}}function Aa(e){return Ls(e)|-1073741824}function FM(e,t){{const n=lt(e,t(0));let o=1;for(;;){const s=o;if(s<e){S(n,s),n[s]=t(s),o=s+1|0;continue}else break}return n}}function UM(e){return N1(e)}function BM(e,t){{e:{let n;t:{let o;n:{let s;s:if(ft(e.str,2,e.start,e.end))if(fe(e.str,F(e.str,0,e.start,e.end))===48)switch(fe(e.str,F(e.str,1,e.start,e.end))){case 120:{const a=e.str,c=F(e.str,2,e.start,e.end);let l;c===void 0?l=e.end:l=c,s={str:a,start:l,end:e.end};break s}case 88:{const a=e.str,c=F(e.str,2,e.start,e.end);let l;c===void 0?l=e.end:l=c,s={str:a,start:l,end:e.end};break s}case 111:{const a=e.str,c=F(e.str,2,e.start,e.end);let l;c===void 0?l=e.end:l=c,o={str:a,start:l,end:e.end};break n}case 79:{const a=e.str,c=F(e.str,2,e.start,e.end);let l;c===void 0?l=e.end:l=c,o={str:a,start:l,end:e.end};break n}case 98:{const a=e.str,c=F(e.str,2,e.start,e.end);let l;c===void 0?l=e.end:l=c,n={str:a,start:l,end:e.end};break t}case 66:{const a=e.str,c=F(e.str,2,e.start,e.end);let l;c===void 0?l=e.end:l=c,n={str:a,start:l,end:e.end};break t}default:break e}else break e;else break e;return new Fi({_0:16,_1:s,_2:!0})}return new Fi({_0:8,_1:o,_2:!0})}return new Fi({_0:2,_1:n,_2:!0})}return new Fi({_0:10,_1:e,_2:!1})}}function $a(){return new Np(new Ws(gm))}function Yr(){return new uc(new Ws(gm))}function zM(){return new jp(new Ws(xi))}function Oi(){return new uc(new Ws(xi))}function Ga(){return new Lu(new Ws(xi))}function VM(){return new Fp(new Ws(xi))}function _$(){return new Up(new Ws(xi))}function $$(){return new Bp(new Ws(xi))}function qM(e,t){return t?e===10?no(nl,tn):e===16?no(nl,s$):no(nl,Nn(e)):vs(e===10?no(tl,tn):e===16?no(tl,s$):no(tl,Nn(e)),cn)}function km(e,t){if(v3(e,{str:i$,start:0,end:i$.length})){let n,o;e:{t:{const d=Hm(e,0,void 0);if(ft(d.str,1,d.start,d.end))switch(fe(d.str,F(d.str,0,d.start,d.end))){case 43:{const b=d.str,g=F(d.str,1,d.start,d.end);let m;g===void 0?m=d.end:m=g,n={_0:!1,_1:{str:b,start:m,end:d.end}};break}case 45:{const b=d.str,g=F(d.str,1,d.start,d.end);let m;g===void 0?m=d.end:m=g,n={_0:!0,_1:{str:b,start:m,end:d.end}};break}default:{o=d;break t}}else{o=d;break t}break e}n={_0:!1,_1:o}}const s=n._0,i=n._1,r=BM(i);let a;if(r.$tag===1)a=r._0;else return r;const c=a._0,l=a._1,u=a._2,_=qM(c,s);let $;if(ft(l.str,1,l.start,l.end)){const d=fe(l.str,F(l.str,0,l.start,l.end));if(d>=48&&d<=57)$=!0;else if(d>=97&&d<=122)$=!0;else if(d>=65&&d<=90)$=!0;else if(ft(l.str,2,l.start,l.end))if(d===95){const p=fe(l.str,F(l.str,1,l.start,l.end));$=p>=48&&p<=57||p>=97&&p<=122?!0:p>=65&&p<=90}else $=!1;else $=!1}else $=!1;if($){let d,p=l,b=Mt,g=u;for(;;){const m=p,w=b,y=g;let v,k,L;e:if(po(m.str,1,m.start,m.end)){const I=fe(m.str,F(m.str,0,m.start,m.end));if(I===95){const R=Oi();if(R.$tag===1){d=R._0;break}else return R}else{const R=m.str,D=F(m.str,1,m.start,m.end);let x;D===void 0?x=m.end:x=D;const ge={str:R,start:x,end:m.end};v=w,k=ge,L=I;break e}}else if(ft(m.str,1,m.start,m.end)){const I=fe(m.str,F(m.str,0,m.start,m.end));if(I===95)if(y===!1){const R=Oi();if(R.$tag===1){d=R._0;break}else return R}else{const R=m.str,D=F(m.str,1,m.start,m.end);let x;D===void 0?x=m.end:x=D,p={str:R,start:x,end:m.end},g=!1;continue}else{const R=m.str,D=F(m.str,1,m.start,m.end);let x;D===void 0?x=m.end:x=D;const ge={str:R,start:x,end:m.end};v=w,k=ge,L=I;break e}}else{d=w;break}const P=L;let O;if(P>=48&&P<=57)O=P-48|0;else if(P>=97&&P<=122)O=P+-87|0;else if(P>=65&&P<=90)O=P+-55|0;else{const I=zM();if(I.$tag===1)O=I._0;else return I}if(O<c)if(s)if(ql(v,_)){const I=Cr(Jo(v,Nn(c)),Nn(O));if(kr(I,v)){p=k,b=I,g=!0;continue}else{const R=Yr();if(R.$tag===1){d=R._0;break}else return R}}else{const I=Yr();if(I.$tag===1){d=I._0;break}else return I}else if(gc(v,_)){const I=vs(Jo(v,Nn(c)),Nn(O));if(ql(I,v)){p=k,b=I,g=!0;continue}else{const R=Yr();if(R.$tag===1){d=R._0;break}else return R}}else{const I=Yr();if(I.$tag===1){d=I._0;break}else return I}else{const I=Oi();if(I.$tag===1){d=I._0;break}else return I}}return new Pu(d)}else return Oi()}else return Oi()}function WM(e,t){const n=km(e);let o;if(n.$tag===1)o=n._0;else return n;if(gc(o,Nn(-2147483648))||Vm(o,Nn(2147483647))){const s=$a();if(s.$tag===1)s._0;else return s}return new Hp(No(o))}function KM(e){let t;if(ft(e.str,1,e.start,e.end))switch(fe(e.str,F(e.str,0,e.start,e.end))){case 43:{const _=e.str,$=F(e.str,1,e.start,e.end);let d;$===void 0?d=e.end:d=$,t={str:_,start:d,end:e.end};break}case 45:{const _=e.str,$=F(e.str,1,e.start,e.end);let d;$===void 0?d=e.end:d=$,t={str:_,start:d,end:e.end};break}default:t=e}else t=e;let n,o;e:{t:{let u;n:{s:{let _;r:{o:{let $;i:if(ft(t.str,2,t.start,t.end))if(fe(t.str,F(t.str,0,t.start,t.end))===48)switch(fe(t.str,F(t.str,1,t.start,t.end))){case 120:{const b=t.str,g=F(t.str,2,t.start,t.end);let m;g===void 0?m=t.end:m=g,$={str:b,start:m,end:t.end};break i}case 88:{const b=t.str,g=F(t.str,2,t.start,t.end);let m;g===void 0?m=t.end:m=g,$={str:b,start:m,end:t.end};break i}case 111:{const b=t.str,g=F(t.str,2,t.start,t.end);let m;g===void 0?m=t.end:m=g,_={str:b,start:m,end:t.end};break o}case 79:{const b=t.str,g=F(t.str,2,t.start,t.end);let m;g===void 0?m=t.end:m=g,_={str:b,start:m,end:t.end};break o}case 98:{const b=t.str,g=F(t.str,2,t.start,t.end);let m;g===void 0?m=t.end:m=g,u={str:b,start:m,end:t.end};break s}case 66:{const b=t.str,g=F(t.str,2,t.start,t.end);let m;g===void 0?m=t.end:m=g,u={str:b,start:m,end:t.end};break s}default:{o=t;break t}}else{o=t;break t}else{o=t;break t}n={_0:$,_1:!0,_2:!0};break r}n={_0:_,_1:!0,_2:!1}}break n}n={_0:u,_1:!0,_2:!1}}break e}n={_0:o,_1:!1,_2:!1}}const s=n._0,i=n._1,r=n._2;let a=s,c=i,l=!1;for(;;){const u=a,_=c,$=l;let d,p,b;e:{if(po(u.str,0,u.start,u.end))return!0;if(po(u.str,1,u.start,u.end)){const g=fe(u.str,F(u.str,0,u.start,u.end));if(g===95)return!1;{const m=u.str,w=F(u.str,1,u.start,u.end);let y;w===void 0?y=u.end:y=w,d={str:m,start:y,end:u.end},p=g,b=$;break e}}else{const g=fe(u.str,F(u.str,0,u.start,u.end));if(g===95){if(_===!1)return!1;{const m=u.str,w=F(u.str,1,u.start,u.end);let y;w===void 0?y=u.end:y=w,a={str:m,start:y,end:u.end},c=!1,l=!0;continue}}else{const m=u.str,w=F(u.str,1,u.start,u.end);let y;w===void 0?y=u.end:y=w,d={str:m,start:y,end:u.end},p=g,b=$;break e}}}if(p>=48&&p<=57||r&&(p>=97&&p<=102||p>=65&&p<=70)){a=d,c=!0,l=!1;continue}else{if(b)return!1;a=d,c=!1,l=!1;continue}}}function JM(){return{digits:j1(800),digits_num:0,decimal_point:0,negative:!1,truncated:!1}}function Ou(e){for(;;){let t;if(e.digits_num>0){const n=e.digits,o=e.digits_num-1|0;S(n,o),t=n[o]===0}else t=!1;if(t){e.digits_num=e.digits_num-1|0;continue}else break}if(e.digits_num===0){e.decimal_point=0;return}else return}function XM(e){const t=JM();let n=!1,o=!1,s;e:{t:{if(ft(e.str,1,e.start,e.end))switch(fe(e.str,F(e.str,0,e.start,e.end))){case 45:{const c=e.str,l=F(e.str,1,e.start,e.end);let u;l===void 0?u=e.end:u=l;const $={str:c,start:u,end:e.end};t.negative=!0,s=$;break}case 43:{const c=e.str,l=F(e.str,1,e.start,e.end);let u;l===void 0?u=e.end:u=l,s={str:c,start:u,end:e.end};break}default:break t}else break t;break e}s=e}let i,r=s;for(;;){const a=r;if(ft(a.str,1,a.start,a.end)){const c=fe(a.str,F(a.str,0,a.start,a.end));if(c===95){const l=a.str,u=F(a.str,1,a.start,a.end);let _;u===void 0?_=a.end:_=u,r={str:l,start:_,end:a.end};continue}else if(c===46){const l=a.str,u=F(a.str,1,a.start,a.end);let _;u===void 0?_=a.end:_=u;const d={str:l,start:_,end:a.end};if(n){const p=_$();if(p.$tag===1){i=p._0;break}else return p}else{n=!0,t.decimal_point=t.digits_num,r=d;continue}}else if(c>=48&&c<=57){const l=a.str,u=F(a.str,1,a.start,a.end);let _;u===void 0?_=a.end:_=u;const d={str:l,start:_,end:a.end};if(o=!0,c===48&&t.digits_num===0){t.decimal_point=t.decimal_point-1|0,r=d;continue}if(t.digits_num<t.digits.length){const p=t.digits,b=t.digits_num;S(p,b),p[b]=(c-48|0)&255,t.digits_num=t.digits_num+1|0}else c!==48&&(t.truncated=!0);r=d;continue}else{i=a;break}}else{i=a;break}}if(o){n||(t.decimal_point=t.digits_num);let a,c;e:{t:{if(ft(i.str,1,i.start,i.end))switch(fe(i.str,F(i.str,0,i.start,i.end))){case 101:{const $=i.str,d=F(i.str,1,i.start,i.end);let p;d===void 0?p=i.end:p=d,c={str:$,start:p,end:i.end};break t}case 69:{const $=i.str,d=F(i.str,1,i.start,i.end);let p;d===void 0?p=i.end:p=d,c={str:$,start:p,end:i.end};break t}default:a=i}else a=i;break e}let l=1,u;if(ft(c.str,1,c.start,c.end))switch(fe(c.str,F(c.str,0,c.start,c.end))){case 43:{const $=c.str,d=F(c.str,1,c.start,c.end);let p;d===void 0?p=c.end:p=d,u={str:$,start:p,end:c.end};break}case 45:{const $=c.str,d=F(c.str,1,c.start,c.end);let p;d===void 0?p=c.end:p=d;const g={str:$,start:p,end:c.end};l=-1,u=g;break}default:u=c}else u=c;t:{n:{if(ft(u.str,1,u.start,u.end)){const $=fe(u.str,F(u.str,0,u.start,u.end));if($>=48&&$<=57){let d=0,p,b=u;for(;;){const g=b;if(ft(g.str,1,g.start,g.end)){const m=fe(g.str,F(g.str,0,g.start,g.end));if(m===95){const w=g.str,y=F(g.str,1,g.start,g.end);let v;y===void 0?v=g.end:v=y,b={str:w,start:v,end:g.end};continue}else if(m>=48&&m<=57){const w=g.str,y=F(g.str,1,g.start,g.end);let v;y===void 0?v=g.end:v=y;const L={str:w,start:v,end:g.end};d=(Math.imul(d,10)|0)+(m-48|0)|0,b=L;continue}else{p=g;break}}else{p=g;break}}t.decimal_point=t.decimal_point+(Math.imul(l,d)|0)|0,a=p}else break n}else break n;break t}const _=_$();if(_.$tag===1)a=_._0;else return _}}return po(a.str,0,a.start,a.end)?(Ou(t),new zp(t)):$$()}else return $$()}function YM(e){return XM(e)}function ZM(e){let t,n;e:{t:{if(ft(e.str,1,e.start,e.end))switch(fe(e.str,F(e.str,0,e.start,e.end))){case 45:{const r=e.str,a=F(e.str,1,e.start,e.end);let c;a===void 0?c=e.end:c=a,t={_0:!1,_1:{str:r,start:c,end:e.end}};break}case 43:{const r=e.str,a=F(e.str,1,e.start,e.end);let c;a===void 0?c=e.end:c=a,n={str:r,start:c,end:e.end};break t}default:{n=e;break t}}else{n=e;break t}break e}t={_0:!0,_1:n}}const o=t._0,s=t._1;e:{let i;t:{n:if(po(s.str,3,s.start,s.end))switch(fe(s.str,F(s.str,0,s.start,s.end))){case 110:switch(fe(s.str,F(s.str,1,s.start,s.end))){case 97:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 110:break n;case 78:break n;default:break e}case 65:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 110:break n;case 78:break n;default:break e}default:break e}case 78:switch(fe(s.str,F(s.str,1,s.start,s.end))){case 97:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 110:break n;case 78:break n;default:break e}case 65:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 110:break n;case 78:break n;default:break e}default:break e}case 105:switch(fe(s.str,F(s.str,1,s.start,s.end))){case 110:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 102:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}case 70:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}default:break e}case 78:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 102:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}case 70:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}default:break e}default:break e}case 73:switch(fe(s.str,F(s.str,1,s.start,s.end))){case 110:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 102:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}case 70:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}default:break e}case 78:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 102:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}case 70:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}default:break e}default:break e}default:break e}else if(ft(s.str,3,s.start,s.end))switch(fe(s.str,F(s.str,0,s.start,s.end))){case 105:switch(fe(s.str,F(s.str,1,s.start,s.end))){case 110:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 102:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}case 70:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}default:break e}case 78:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 102:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}case 70:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}default:break e}default:break e}case 73:switch(fe(s.str,F(s.str,1,s.start,s.end))){case 110:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 102:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}case 70:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}default:break e}case 78:switch(fe(s.str,F(s.str,2,s.start,s.end))){case 102:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}case 70:{const l=s.str,u=F(s.str,3,s.start,s.end);let _;u===void 0?_=s.end:_=u,i={str:l,start:_,end:s.end};break t}default:break e}default:break e}default:break e}else break e;return new uo(TM)}t:{n:{if(po(i.str,0,i.start,i.end))break n;if(po(i.str,5,i.start,i.end))switch(fe(i.str,F(i.str,0,i.start,i.end))){case 105:switch(fe(i.str,F(i.str,1,i.start,i.end))){case 110:switch(fe(i.str,F(i.str,2,i.start,i.end))){case 105:switch(fe(i.str,F(i.str,3,i.start,i.end))){case 116:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}case 84:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}default:break t}case 73:switch(fe(i.str,F(i.str,3,i.start,i.end))){case 116:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}case 84:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}default:break t}default:break t}case 78:switch(fe(i.str,F(i.str,2,i.start,i.end))){case 105:switch(fe(i.str,F(i.str,3,i.start,i.end))){case 116:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}case 84:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}default:break t}case 73:switch(fe(i.str,F(i.str,3,i.start,i.end))){case 116:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}case 84:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}default:break t}default:break t}default:break t}case 73:switch(fe(i.str,F(i.str,1,i.start,i.end))){case 110:switch(fe(i.str,F(i.str,2,i.start,i.end))){case 105:switch(fe(i.str,F(i.str,3,i.start,i.end))){case 116:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}case 84:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}default:break t}case 73:switch(fe(i.str,F(i.str,3,i.start,i.end))){case 116:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}case 84:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}default:break t}default:break t}case 78:switch(fe(i.str,F(i.str,2,i.start,i.end))){case 105:switch(fe(i.str,F(i.str,3,i.start,i.end))){case 116:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}case 84:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}default:break t}case 73:switch(fe(i.str,F(i.str,3,i.start,i.end))){case 116:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}case 84:switch(fe(i.str,F(i.str,4,i.start,i.end))){case 121:break n;case 89:break n;default:break t}default:break t}default:break t}default:break t}default:break t}else break t}return o?new uo(yr):new uo(br)}return Ga()}return Ga()}function QM(e,t,n){let o=t,s=0,i=e;for(;;){const r=i;if(ft(r.str,1,r.start,r.end)){const a=fe(r.str,F(r.str,0,r.start,r.end)),c=r.str,l=F(r.str,1,r.start,r.end);let u;l===void 0?u=r.end:u=l;const $={str:c,start:u,end:r.end};if(a>=48&&a<=57)s=s+1|0,o=n(a-48|0,o);else if(a!==95)break;i=$;continue}else break}return{_0:i,_1:o,_2:s}}function e6(e,t,n){let o=t,s=0,i=e;for(;;){const r=i;if(ft(r.str,1,r.start,r.end)){const a=fe(r.str,F(r.str,0,r.start,r.end)),c=r.str,l=F(r.str,1,r.start,r.end);let u;l===void 0?u=r.end:u=l;const $={str:c,start:u,end:r.end};if(a>=48&&a<=57)s=s+1|0,o=n(a-48|0,o);else if(a!==95)break;i=$;continue}else break}return{_0:i,_1:o,_2:s}}function d$(e,t){return QM(e,t,(n,o)=>ro(zn(o,tn),zu(n)))}function t6(e){let t=e,n=!1,o,s;e:{t:{const i=t;if(ft(i.str,1,i.start,i.end)){const r=fe(i.str,F(i.str,0,i.start,i.end));switch(r){case 43:{const a=i.str,c=F(i.str,1,i.start,i.end);let l;c===void 0?l=i.end:l=c,o={str:a,start:l,end:i.end},s=r;break t}case 45:{const a=i.str,c=F(i.str,1,i.start,i.end);let l;c===void 0?l=i.end:l=c,o={str:a,start:l,end:i.end},s=r;break t}}}break e}n=s===45,t=o}e:{const i=t;if(ft(i.str,1,i.start,i.end)){const r=fe(i.str,F(i.str,0,i.start,i.end));if(r>=48&&r<=57){const a=e6(t,c2,(u,_)=>gc(_,H1)?vs(Jo(tn,_),Nn(u)):_),c=a._0,l=a._1;return n?{_0:c,_1:Lf(l)}:{_0:c,_1:l}}else break e}else break e}}function p$(e,t){let n=t,o=0,s=e;for(;;){const i=s;let r;e:if(ft(i.str,1,i.start,i.end)){const a=fe(i.str,F(i.str,0,i.start,i.end));if(a>=48&&a<=57){const c=i.str,l=F(i.str,1,i.start,i.end);let u;l===void 0?u=i.end:u=l;const $={str:c,start:u,end:i.end};if(Wl(n,bm)){o=o+1|0,n=ro(zn(n,tn),zu(a-48|0)),s=$;continue}else{r=i;break e}}else if(a===95){const c=i.str,l=F(i.str,1,i.start,i.end);let u;l===void 0?u=i.end:u=l,s={str:c,start:u,end:i.end};continue}else{r=i;break e}}else{r=i;break e}return{_0:r,_1:n,_2:o}}}function n6(e){let t,n;e:{t:{if(ft(e.str,1,e.start,e.end))switch(fe(e.str,F(e.str,0,e.start,e.end))){case 45:{const w=e.str,y=F(e.str,1,e.start,e.end);let v;y===void 0?v=e.end:v=y,t={_0:{str:w,start:v,end:e.end},_1:!0};break}case 43:{const w=e.str,y=F(e.str,1,e.start,e.end);let v;y===void 0?v=e.end:v=y,n={str:w,start:v,end:e.end};break t}default:{n=e;break t}}else{n=e;break t}break e}t={_0:n,_1:!1}}const o=t._0,s=t._1;if(n3(o))return new Ao(void 0);const i=d$(o,Mt),r=i._0,a=i._1,c=i._2;let l=a,u=r,_=c,$=0,d=Mt;const p=u;if(ft(p.str,1,p.start,p.end)&&fe(p.str,F(p.str,0,p.start,p.end))===46){const w=p.str,y=F(p.str,1,p.start,p.end);let v;y===void 0?v=p.end:v=y,u={str:w,start:v,end:p.end};const P=d$(u,l),O=P._0,I=P._1,R=P._2;u=O,l=I,$=R,d=Lf(Nn($))}if(_=_+$|0,_===0)return new Ao(void 0);let b;e:{t:{const k=u;if(ft(k.str,1,k.start,k.end))switch(fe(k.str,F(k.str,0,k.start,k.end))){case 101:{const P=k.str,O=F(k.str,1,k.start,k.end);let I;O===void 0?I=k.end:I=O,b={str:P,start:I,end:k.end};break t}case 69:{const P=k.str,O=F(k.str,1,k.start,k.end);let I;O===void 0?I=k.end:I=O,b={str:P,start:I,end:k.end};break t}}break e}const m=t6(b);let w;if(m===void 0)return new Ao(void 0);w=m;const y=w._0,v=w._1;u=y,d=vs(d,v)}const g=u;if(po(g.str,0,g.start,g.end)){if(_<=19)return new Ao({exponent:d,mantissa:l,negative:s,many_digits:!1});_=_-19|0;let m=!1,w=e.str,y=e.start,v=e.end;e:for(;;){const L=w,P=y,O=v;let I,R;t:if(ft(L,1,P,O)){const D=fe(L,F(L,0,P,O));switch(D){case 48:{const x=F(L,1,P,O);let z;x===void 0?z=O:z=x,I={str:L,start:z,end:O},R=D;break t}case 46:{const x=F(L,1,P,O);let z;x===void 0?z=O:z=x,I={str:L,start:z,end:O},R=D;break t}default:break e}}else break;_=_-((R-46|0)/2|0)|0,w=I.str,y=I.start,v=I.end}let k=l;if(_>0){m=!0,k=Mt;const L=p$(e,k),P=L._0,O=L._1,I=L._2;k=O;let R;if(h3(k,bm))R=I;else if(ft(P.str,1,P.start,P.end)){const D=P.str,x=F(P.str,1,P.start,P.end);let z;x===void 0?z=P.end:z=x;const re={str:D,start:z,end:P.end},he=p$(re,k),q=he._1,G=he._2;k=q,R=G}else return new Ao(void 0);d=Nn(R),d=vs(d,l2)}return new Ao({exponent:d,mantissa:k,negative:s,many_digits:m})}else return VM()}function m$(e,t,n){const o=t-Kt.bias|0;let s=If(e,Cr(jo(cn,Kt.mantissa_bits),cn));const i=Nn(o&((1<<Kt.exponent_bits)-1|0));return s=D$(s,jo(i,Kt.mantissa_bits)),n&&(s=D$(s,jo(jo(cn,Kt.mantissa_bits),Kt.exponent_bits))),s}function s6(e,t){if(t<0||t>=e.digits_num)return!1;let n;const o=e.digits;if(S(o,t),o[t]===5?n=(t+1|0)===e.digits_num:n=!1,n){if(e.truncated)return!0;let i;if(t>0){const r=e.digits,a=t-1|0;S(r,a),i=(r[a]%2|0)!==0}else i=!1;return i}const s=e.digits;return S(s,t),s[t]>=5}function o6(e){if(e.decimal_point>20)return Ap;let t=Mt,n=0;for(;n<e.decimal_point&&n<e.digits_num;){const o=Jo(t,tn),s=e.digits,i=n;S(s,i),t=vs(o,ja(s[i])),n=n+1|0;continue}for(;n<e.decimal_point;){t=Jo(t,tn),n=n+1|0;continue}return s6(e,e.decimal_point)&&(t=vs(t,cn)),t}function i6(e,t){S(Xr,t);const n=Xr[t]._0;S(Xr,t);const o=Xr[t]._1;let s=!1;const i=o.length;let r=0;for(;;){const a=r;if(a<i){if(a>=e.digits_num){s=!0;break}const c=o.charCodeAt(a)-48|0,l=e.digits;if(S(l,a),l[a]!==c){const u=e.digits;S(u,a),s=u[a]<c;break}r=a+1|0;continue}else break}return s?n-1|0:n}function f$(e,t){const n=i6(e,t);let o=e.digits_num,s=e.digits_num+n|0,i=Mt;for(o=o-1|0;o>=0;){const r=e.digits,a=o;S(r,a);const c=ja(r[a]);i=vs(i,jo(c,t));const l=no(i,tn),u=No(Cr(i,Jo(l,tn)));if(s=s-1|0,s<e.digits.length){const _=e.digits,$=s;S(_,$),_[$]=u&255}else u!==0&&(e.truncated=!0);i=l,o=o-1|0;continue}for(;Vm(i,Mt);){const r=no(i,tn),a=No(Cr(i,Jo(tn,r)));if(s=s-1|0,s<e.digits.length){const c=e.digits,l=s;S(c,l),c[l]=a&255}else a!==0&&(e.truncated=!0);i=r;continue}e.digits_num=e.digits_num+n|0,e.digits_num>e.digits.length&&(e.digits_num=e.digits.length),e.decimal_point=e.decimal_point+n|0,Ou(e)}function h$(e,t){let n=0,o=0,s=Mt;for(;ao(ns(s,t),Mt);){if(n>=e.digits_num){for(;ao(ns(s,t),Mt);){s=zn(s,tn),n=n+1|0;continue}break}const r=e.digits,a=n;S(r,a);const c=r[a];s=ro(zn(s,tn),ja(c)),n=n+1|0;continue}e.decimal_point=e.decimal_point-(n-1|0)|0;const i=eu(xr(cn,t),cn);for(;n<e.digits_num;){const r=ns(s,t),a=e.digits,c=o;S(a,c),a[c]=O$(r),o=o+1|0,s=Uo(s,i);const l=e.digits,u=n;S(l,u);const _=l[u];s=ro(zn(s,tn),ja(_)),n=n+1|0;continue}for(;Ra(s,Mt);){const r=ns(s,t);if(o<e.digits.length){const a=e.digits,c=o;S(a,c),a[c]=O$(r),o=o+1|0}else Ra(r,Mt)&&(e.truncated=!0);s=Uo(s,i),s=zn(s,tn);continue}e.digits_num=o,Ou(e)}function Zr(e,t){if(e.digits_num===0)return;let n=t;if(n>0){for(;n>59;){f$(e,59),n=n-59|0;continue}f$(e,n)}if(n<0){for(;n<-59;){h$(e,59),n=n+59|0;continue}h$(e,-n|0);return}else return}function r6(e){let t=0,n=Mt;if(e.digits_num===0||e.decimal_point<-330){n=Mt,t=Kt.bias;const s=m$(n,t,e.negative);return new uo(Mr(s))}if(e.decimal_point>310){const s=$a();if(s.$tag===1)s._0;else return s}for(;e.decimal_point>0;){let s=0;e.decimal_point>=Jr.length?s=60:s=Ns(Jr,e.decimal_point),Zr(e,-s|0),t=t+s|0;continue}for(;;){let s;if(e.decimal_point<0)s=!0;else{let i;if(e.decimal_point===0){const r=e.digits;S(r,0),i=r[0]<5}else i=!1;s=i}if(s){let i=0;(-e.decimal_point|0)>=Jr.length?i=60:i=Ns(Jr,-e.decimal_point|0),Zr(e,i),t=t-i|0;continue}else break}if(t=t-1|0,t<(Kt.bias+1|0)){const s=(Kt.bias+1|0)-t|0;Zr(e,-s|0),t=t+s|0}if((t-Kt.bias|0)>=((1<<Kt.exponent_bits)-1|0)){const s=$a();if(s.$tag===1)s._0;else return s}if(Zr(e,Kt.mantissa_bits+1|0),n=o6(e),N$(n,jo(Op,Kt.mantissa_bits))&&(n=Jx(n,1),t=t+1|0,(t-Kt.bias|0)>=((1<<Kt.exponent_bits)-1|0))){const s=$a();if(s.$tag===1)s._0;else return s}N$(If(n,jo(cn,Kt.mantissa_bits)),Mt)&&(t=Kt.bias);const o=m$(n,t,e.negative);return new uo(Mr(o))}function a6(e,t){if(ao(e,Mt)||ao(t,Mt))return by;if(ao(e,cn))return t;if(ao(t,cn))return e;if(H$(t)===0||H$(e)===0)return;const n=Zx(a2,t);if(!Ra(e,n))return zn(e,t)}function il(e){const t=e&31;return S(a$,t),a$[t]}function c6(e){return kr(gy,e.exponent)&&kr(e.exponent,hy)&&g3(e.mantissa,vm)&&!e.many_digits}function l6(e){if(c6(e)){let t;if(kr(e.exponent,ol)){const n=Na(e.mantissa);t=gc(e.exponent,Mt)?n/il(-No(e.exponent)|0):n*il(No(e.exponent))}else{const n=Cr(e.exponent,ol),o=e.mantissa,s=No(n);S(r$,s);const i=a6(o,r$[s]);let r;if(i===void 0||(r=i,Ra(r,vm)))return ua;t=Na(r)*il(No(ol))}return e.negative&&(t=-t),new Iu(t)}else return ua}function u6(e){if((e.end-e.start|0)>0)if(KM(e)){const t=n6(e);let n;if(t.$tag===1)n=t._0;else return t;if(n===void 0)return ZM(e);{const i=l6(n);if(i.$tag===1){const a=i._0;return new uo(a)}else{const r=YM(e);let a;if(r.$tag===1)a=r._0;else return r;return r6(a)}}}else return Ga();else return Ga()}function Qr(e,t){if(t>=0&&t<(e.end-e.start|0)){const n=e.bytes,o=e.start+t|0;return S(n,o),n[o]}else return NM(`index out of bounds: the len is from 0 to ${Mn(e.end-e.start|0)} but the index is ${Mn(t)}`)}function _6(e,t,n){const o=e.length;let s;if(n===void 0)s=o;else{const a=n;s=a<0?o+a|0:a}const i=t<0?o+t|0:t;return i>=0&&i<=s&&s<=o?{bytes:e,start:i,end:s}:DM()}function $6(e){const t=Qr(e,0),n=Qr(e,1),o=(t>>>0)+(n<<8>>>0)|0,s=Qr(e,2),i=(o>>>0)+(s<<16>>>0)|0,r=Qr(e,3);return(i>>>0)+(r<<24>>>0)|0}function d6(e,t){return{elem_info:0|1<<e,data:[t]}}function Du(e,t){if(e.elem_info&1<<t){const o=e.data,s=e.elem_info,i=_c(s&((1<<t>>>0)-1|0));return S(o,i),o[i]}else return}function p6(e,t,n,o){return{elem_info:0|1<<e|1<<n,data:e<n?[t,o]:[o,t]}}function m6(e,t,n){const o=e.data,s=o.length,i=s+1|0,r=e.elem_info,a=_c(r&((1<<t>>>0)-1|0)),c=lt(i,n);return Ha(o,c,a,0,0),Ha(o,c,s-a|0,a,a+1|0),{elem_info:e.elem_info|1<<t,data:c}}function f6(e,t){const n=e.data,o=n.length,s=e.elem_info,i=_c(s&((1<<t>>>0)-1|0)),r=lt(o-1|0,n[0]);return Ha(n,r,i,0,0),Ha(n,r,(o-i|0)-1|0,i+1|0,i),{elem_info:e.elem_info^1<<t,data:r}}function Mm(e,t,n){const o=UM(e.data),s=e.elem_info,i=_c(s&((1<<t>>>0)-1|0));return S(o,i),o[i]=n,{elem_info:e.elem_info,data:o}}function h6(e,t,n){let o=e,s=n;e:for(;;){const i=o,r=s;switch(i.$tag){case 1:{const a=i,c=a._0,l=a._1,u=a._2;return t===c?l:W6(u,t)}case 0:{const a=i,c=a._0,l=a._1,u=a._2;return r===u&&t===c?l:void 0}default:{const c=i._0,u=r&31,_=Du(c,u);if(_!==void 0){o=_,s=r>>>5|0;continue e}return}}}}function g6(e,t){const n=e;if(n!==void 0)return h6(n,t,Aa(t))}function Cm(e,t,n,o,s,i){const a=n&31,l=i&31;if(a===l){let u;if(n>>>0<=127){const $={_0:e,_1:t};u=new _o(o,s,new hr($,yi))}else{const d=n>>>5|0;u=Cm(e,t,d,o,s,i>>>5|0)}return new Mi(d6(a,u))}else{let u,_;e:if(n>>>0<=127){const d=new _o(e,t,yi),p=new _o(o,s,yi);u=d,_=p;break e}else{const d=n,p=new qo(e,t,d>>>5|0),b=i,g=new qo(o,s,b>>>5|0);u=p,_=g;break e}return new Mi(p6(a,u,l,_))}}function xm(e,t,n,o){switch(e.$tag){case 1:{const s=e,i=s._0,r=s._1,a=s._2;if(t===i)return new _o(t,n,a);{const c=Nm(a,_=>_._0===t);let l;c===void 0?l=a:l=jm(a,c);const u={_0:i,_1:r};return new _o(t,n,new hr(u,l))}}case 0:{const s=e,i=s._0,r=s._1,a=s._2;return o===a&&t===i?new qo(i,n,a):Cm(i,r,a,t,n,o)}default:{const i=e._0,a=o&31,c=Du(i,a);if(c===void 0){const l=o,u=new qo(t,n,l>>>5|0);return new Mi(m6(i,a,u))}else{const $=xm(c,t,n,o>>>5|0);return new Mi(Mm(i,a,$))}}}}function da(e,t,n){const o=e;return o===void 0?new qo(t,n,Aa(t)):xm(o,t,n,Aa(t))}function Pm(e,t,n){switch(e.$tag){case 1:{const o=e,s=o._0,i=o._1,r=o._2;if(s===t){if(r.$tag===0)return;{const a=r,c=a._0,l=c._0,u=c._1,_=a._1;return new _o(l,u,_)}}else{const a=Nm(r,c=>c._0===t);if(a===void 0)return e;{const l=a;return new _o(s,i,jm(r,l))}}}case 0:{const o=e,s=o._0,i=o._2;return n===i&&t===s?void 0:e}default:{const s=e._0,r=n&31,a=Du(s,r);if(a===void 0)return e;{const _=Pm(a,t,n>>>5|0);let $,d;e:{t:{if(s.data.length===1){if(_===void 0)return;d=_;break t}else if(_===void 0)$=f6(s,r);else{d=_;break t}break e}$=Mm(s,r,d)}e:{const p=$.data;if(p.length===1){const b=p[0];if(b.$tag===0){const g=b,m=g._0,w=g._1,y=g._2,v=$.elem_info,k=F1(v),L=y;return new qo(m,w,L<<5|k)}else break e}else break e}return new Mi($)}}}}function b6(e,t){const n=e;if(n!==void 0)return Pm(n,t,Aa(t))}function Lm(e){switch(e.$tag){case 1:{const t=e,n=t._0,o=t._1,s=t._2;return jx(R$({_0:n,_1:o}),q6(s))}case 0:{const t=e,n=t._0,o=t._1;return R$({_0:n,_1:o})}default:{const o=e._0.data;return s=>{const i=o.length;let r=0;for(;;){const a=r;if(a<i){const c=o[a];if(Lm(c)(s)===1){r=a+1|0;continue}else return 0}else return 1}}}}}function y6(e){const t=e;return t===void 0?Nx():Lm(t)}function w6(e){const t=y6(e);return n=>t(o=>n(o._1))}function ea(e,t){if(e!==void 0)return t(e)}function v6(e,t){return Math.pow(e,t)}function mc(e,t){let n=1,o=0,s=0;for(;;){const i=s;if(i<t){const r=e.str,a=e.start+i|0;r.charCodeAt(a)===10?(n=n+1|0,o=0):o=o+1|0,s=i+1|0;continue}else break}return{line:n,column:o}}function S6(e,t){const n=e.offset+t|0,o=hc(e.input,n),s=65533;return new $c(new Gr(mc(e.input,n),o===-1?s:o))}function Yn(e,t){const n=e.offset+t|0,o=hc(e.input,n),s=65533;return new dc(new Gr(mc(e.input,n),o===-1?s:o))}function Nu(e,t){const n=e.offset+t|0,o=hc(e.input,n),s=65533;return new Rr(new Gr(mc(e.input,n),o===-1?s:o))}function fc(e,t){const n=e.offset+t|0,o=hc(e.input,n),s=65533;return new go(new Gr(mc(e.input,n),o===-1?s:o))}function k6(e,t){return new Vp(new je({_0:e,_1:t}))}function M6(e,t){return new Wp(new je({_0:e,_1:t}))}function C6(e,t){return new Kp(new je({_0:e,_1:t}))}function x6(e,t){return new Jp(new je({_0:e,_1:t}))}function P6(e,t){return new Xp(new je({_0:e,_1:t}))}function Im(e,t){const n=e;let o=0,s=n.length;for(;;){const i=o,r=s;if(i<r){const a=(i+r|0)/2|0,c=C3(n,a),l=c._0,u=c._1;if(t<l){s=a;continue}else if(t>u){o=a+1|0;continue}else return!0}else return!1}}function Wt(e){if(e.offset<e.end_offset){const t=e.input,n=e.offset,o=t.str,s=t.start+n|0,i=o.charCodeAt(s);if(e.offset=e.offset+1|0,i>=55296&&i<=56319&&e.offset<e.end_offset){const r=e.input,a=e.offset,c=r.str,l=r.start+a|0,u=c.charCodeAt(l);if(u>=56320&&u<=57343)return e.offset=e.offset+1|0,((i<<10)+u|0)-56613888|0}return i}else return-1}function Li(e){e:for(;;)t:{n:{const t=Wt(e);if(t===-1)break;{const o=t;switch(o){case 9:break n;case 32:break n;case 10:break n;case 13:break n;default:{if(o>127&&Im(wm,o))break t;e.offset=e.offset-1|0;break e}}}}break t}}function L6(e,t){return{offset:0,input:e,end_offset:e.end-e.start|0,remaining_available_depth:t}}function $s(e,t){if(e.offset<e.end_offset){const n=e.input,o=e.offset,s=n.str,i=n.start+o|0,r=s.charCodeAt(i);return e.offset=e.offset+1|0,t!==r?Yn(e,-1):new Tu(void 0)}else return new dc(Tn)}function yo(e,t,n){const o=Hm(e.input,t,n);if(!rl(o,{str:c$,start:0,end:c$.length})&&!rl(o,{str:l$,start:0,end:l$.length})&&!rl(o,{str:u$,start:0,end:u$.length})){let s,i;e:{t:{const r=km(o);let a;if(r.$tag===1)a=r._0;else{i=r._0;break t}s=new Pu(a);break e}s=new uc(i)}e:if(s.$tag===1){const a=s._0;if(kr(a,U1)&&ql(a,B1))return{_0:Yx(a),_1:void 0};break e}else break e;e:if(ft(o.str,1,o.start,o.end)){if(fe(o.str,F(o.str,0,o.start,o.end))===45)return{_0:br,_1:o};break e}else break e;return{_0:yr,_1:o}}else{let s,i;e:{t:{const r=u6(o);let a;if(r.$tag===1)a=r._0;else{i=r._0;break t}s=new uo(a);break e}s=new Lu(i)}if(s.$tag===1)return{_0:s._0,_1:void 0};e:if(ft(o.str,1,o.start,o.end)){if(fe(o.str,F(o.str,0,o.start,o.end))===45)return{_0:br,_1:o};break e}else break e;return{_0:yr,_1:o}}}function Tm(e,t){for(;;)e:{const n=Wt(e);if(n===-1)return yo(e,t,e.offset);{const s=n;if(s>=48&&s<=57)break e;return e.offset=e.offset-1|0,yo(e,t,e.offset)}}}function I6(e,t){const n=Wt(e);if(n===-1)return new Rr(Tn);{const s=n;return s>=48&&s<=57?new Dn(Tm(e,t)):(e.offset=e.offset-1|0,Nu(e,0))}}function ju(e,t){e:{const s=Wt(e);if(s===-1)return new Rr(Tn);{const r=s;switch(r){case 43:break e;case 45:break e;default:return r>=48&&r<=57?new Dn(Tm(e,t)):(e.offset=e.offset-1|0,Nu(e,0))}}}const n=I6(e,t);let o;if(n.$tag===1)o=n._0;else return n;return new Dn(o)}function T6(e,t){for(;;)e:{t:{const s=Wt(e);if(s===-1)return new Dn(yo(e,t,e.offset));{const r=s;switch(r){case 101:break t;case 69:break t;default:{if(r>=48&&r<=57)break e;return e.offset=e.offset-1|0,new Dn(yo(e,t,e.offset))}}}}const n=ju(e,t);let o;if(n.$tag===1)o=n._0;else return n;return new Dn(o)}}function Em(e,t){const n=Wt(e);if(n===-1)return new Rr(Tn);{const s=n;return s>=48&&s<=57?T6(e,t):Nu(e,-1)}}function g$(e,t){for(;;)e:{t:{const s=Wt(e);if(s===-1)return new Dn(yo(e,t,e.offset));{const r=s;switch(r){case 46:{const a=Em(e,t);let c;if(a.$tag===1)c=a._0;else return a;return new Dn(c)}case 101:break t;case 69:break t;default:{if(r>=48&&r<=57)break e;return e.offset=e.offset-1|0,new Dn(yo(e,t,e.offset))}}}}const n=ju(e,t);let o;if(n.$tag===1)o=n._0;else return n;return new Dn(o)}}function E6(e,t){let n=0,o=0;for(;;){const s=o;if(s<t){const i=Wt(e);if(i===-1)return new Zp(Tn);{const a=i;if(a>=65){const c=((a&-33)-65|0)+10|0;if(c>15){const l=Yn(e,-1);if(l.$tag===1)l._0;else return l}n=n<<4|c}else if(a>=48){const c=a-48|0;if(c>9){const l=Yn(e,-1);if(l.$tag===1)l._0;else return l}n=n<<4|c}else{const c=Yn(e,-1);if(c.$tag===1)c._0;else return c}}o=s+1|0;continue}else break}return new Qp(n)}function b$(e,t){const n=e._2,o=e._1,s=e._0;if(s.val>0&&t>s.val){const r=o.input.str,c=o.input.start;Dr(n,r,c+s.val|0,t-s.val|0);return}else return}function Hu(e){const t=Zo(),n={val:e.offset},o={_0:n,_1:e,_2:t};e:for(;;)t:{n:{s:{const i=Wt(e);if(i===-1)return new jl(Tn);{const a=i;switch(a){case 34:{b$(o,e.offset-1|0);break e}case 10:break s;case 13:break s;case 92:{b$(o,e.offset-1|0);const c=Wt(e);if(c===-1)return new jl(Tn);switch(c){case 98:{ut(t,8);break}case 102:{ut(t,12);break}case 110:{ut(t,10);break}case 114:{ut(t,13);break}case 116:{ut(t,9);break}case 34:{ut(t,34);break}case 92:{ut(t,92);break}case 47:{ut(t,47);break}case 117:{const _=E6(e,4);let $;if(_.$tag===1)$=_._0;else return _;ut(t,$);break}default:{const _=Yn(e,-1);if(_.$tag===1)_._0;else return _}}n.val=e.offset;break}default:if(a<32){const c=Yn(e,-1);if(c.$tag===1)c._0;else return c}else break t}}break n}const s=Yn(e,-1);if(s.$tag===1)s._0;else return s}break t}return new em(t.val)}function y$(e,t){e:{const n=Wt(e);if(n===-1)return new Dn(yo(e,t,e.offset));{const s=n;switch(s){case 46:return Em(e,t);case 101:break e;case 69:break e;default:{if(s>=48&&s<=57){e.offset=e.offset-1|0;const i=Yn(e,0);if(i.$tag===1)i._0;else return i}return e.offset=e.offset-1|0,new Dn(yo(e,t,e.offset))}}}}return ju(e,t)}function Vl(e,t){for(;;)e:{t:{n:{const n=Wt(e);if(n===-1)return new go(Tn);{const s=n;if(s===9)break n;if(s===32)break n;if(s===10)break n;if(s===13)break n;if(s===123)return new Ft(W1);if(s===91)return new Ft(K1);if(s===93){if(t)return new Ft(nm);{const i=Yn(e,-1);if(i.$tag===1)i._0;else return i}}else if(s===110){const i=$s(e,117);if(i.$tag===1)i._0;else return i;const r=$s(e,108);if(r.$tag===1)r._0;else return r;const a=$s(e,108);if(a.$tag===1)a._0;else return a;return new Ft(z1)}else if(s===116){const i=$s(e,114);if(i.$tag===1)i._0;else return i;const r=$s(e,117);if(r.$tag===1)r._0;else return r;const a=$s(e,101);if(a.$tag===1)a._0;else return a;return new Ft(V1)}else if(s===102){const i=$s(e,97);if(i.$tag===1)i._0;else return i;const r=$s(e,108);if(r.$tag===1)r._0;else return r;const a=$s(e,115);if(a.$tag===1)a._0;else return a;const c=$s(e,101);if(c.$tag===1)c._0;else return c;return new Ft(q1)}else if(s===45){const i=Wt(e);if(i===-1)return new go(Tn);{const a=i;if(a===48){const c=y$(e,e.offset-2|0);let l;if(c.$tag===1)l=c._0;else return c;const u=l._0,_=l._1;return new Ft(new Bi(u,ea(_,$=>na($))))}else{if(a>=49&&a<=57){const l=g$(e,e.offset-2|0);let u;if(l.$tag===1)u=l._0;else return l;const _=u._0,$=u._1;return new Ft(new Bi(_,ea($,d=>na(d))))}const c=Yn(e,-1);if(c.$tag===1)c._0;else return c}}}else if(s===48){const i=y$(e,e.offset-1|0);let r;if(i.$tag===1)r=i._0;else return i;const a=r._0,c=r._1;return new Ft(new Bi(a,ea(c,l=>na(l))))}else if(s>=49&&s<=57){const i=g$(e,e.offset-1|0);let r;if(i.$tag===1)r=i._0;else return i;const a=r._0,c=r._1;return new Ft(new Bi(a,ea(c,l=>na(l))))}else if(s===34){const i=Hu(e);let r;if(i.$tag===1)r=i._0;else return i;return new Ft(new pc(r))}else{if(s>127&&Im(wm,s))break e;const r=-(s<=65535?1:2)|0,a=Yn(e,r);if(a.$tag===1)a._0;else return a}}break t}break e}break e}}function A6(e){Li(e);const t=Wt(e);if(t===-1)return new go(Tn);switch(t){case 93:return new Ft(nm);case 44:return new Ft(sm);default:return fc(e,-1)}}function G6(e){Li(e);const t=Wt(e);if(t===-1)return new go(Tn);switch(t){case 125:return new Ft(tm);case 44:return new Ft(sm);default:return fc(e,-1)}}function R6(e){Li(e);const t=Wt(e);return t===-1?new dc(Tn):t===58?new Tu(void 0):Yn(e,-1)}function O6(e){Li(e);const t=Wt(e);if(t===-1)return new go(Tn);switch(t){case 125:return new Ft(tm);case 34:{const s=Hu(e);let i;if(s.$tag===1)i=s._0;else return s;return new Ft(new pc(i))}default:return fc(e,-1)}}function D6(e){Li(e);const t=Wt(e);if(t===-1)return new go(Tn);if(t===34){const s=Hu(e);let i;if(s.$tag===1)i=s._0;else return s;return new Ft(new pc(i))}else return fc(e,-1)}function Am(e){const t=Vl(e,!1);let n;if(t.$tag===1)n=t._0;else return t;return Gm(e,n)}function Gm(e,t){e:switch(t.$tag){case 0:return new bs(Ay);case 1:return new bs(Gp);case 2:return new bs(Rp);case 3:{const n=t,o=n._0,s=n._1;return new bs(new Ar(o,s))}case 4:{const o=t._0;return new bs(new Ae(o))}case 5:return j6(e);case 7:return N6(e);case 8:break e;case 6:break e;default:break e}return new bs(Ea())}function N6(e){if(e.remaining_available_depth<=0)return new $c(Dp);e.remaining_available_depth=e.remaining_available_depth-1|0;const t=[];let n;const o=Vl(e,!0);let s;if(o.$tag===1)s=o._0;else return o;let i=s;e:for(;;){const r=i;if(r.$tag===8){e.remaining_available_depth=e.remaining_available_depth+1|0,n=new In(t);break}else{const a=Gm(e,r);let c;if(a.$tag===1)c=a._0;else return a;Gx(t,c);const l=A6(e);let u;if(l.$tag===1)u=l._0;else return l;switch(u.$tag){case 9:{const _=Vl(e,!1);if(_.$tag===1)i=_._0;else return _;continue e}case 8:{e.remaining_available_depth=e.remaining_available_depth+1|0,n=new In(t);break e}default:{n=Ea();break e}}}}return new bs(n)}function j6(e){if(e.remaining_available_depth<=0)return new $c(Dp);e.remaining_available_depth=e.remaining_available_depth-1|0;const t=Jm(8);let n;const o=O6(e);let s;if(o.$tag===1)s=o._0;else return o;let i=s;e:for(;;){const r=i;switch(r.$tag){case 6:{e.remaining_available_depth=e.remaining_available_depth+1|0,n=new ke(t);break e}case 4:{const c=r._0,l=R6(e);if(l.$tag===1)l._0;else return l;const u=Am(e);let _;if(u.$tag===1)_=u._0;else return u;le(t,c,_);const $=G6(e);let d;if($.$tag===1)d=$._0;else return $;switch(d.$tag){case 9:{const p=D6(e);if(p.$tag===1)i=p._0;else return p;continue e}case 6:{e.remaining_available_depth=e.remaining_available_depth+1|0,n=new ke(t);break e}default:{n=Ea();break e}}}default:{n=Ea();break e}}}return new bs(n)}function Rm(e,t){const n=L6(e,t),o=Am(n);let s;if(o.$tag===1)s=o._0;else return o;return Li(n),n.offset>=n.end_offset?new bs(s):S6(n,0)}function w$(e,t){const n=Zo(e.length),o=Z6(e);for(;;){const s=hx(o);if(s===-1)break;{const r=s;switch(r){case 34:{dt(n,'\\"');break}case 92:{dt(n,"\\\\");break}case 47:{ut(n,r);break}case 10:{dt(n,"\\n");break}case 13:{dt(n,"\\r");break}case 8:{dt(n,"\\b");break}case 9:{dt(n,"\\t");break}default:{const a=r;a===12?dt(n,"\\f"):a<32?(dt(n,"\\u00"),dt(n,Y3(a&255))):ut(n,r)}}continue}}return n.val}function oi(e,t){return""}function Ye(e,t,n,o){const s=Zo(),i=[];let r=e;for(;;){const a=r;if(a===void 0){if(i.length===0)break;{const c=i[i.length-1|0];if(c.$tag===0){const l=c,u=l._0,_=l._1;if(_<u.length){const $=S3(u,_);l._1=_+1|0,_>0&&(ut(s,44),dt(s,oi())),r=$;continue}else{F$(i),dt(s,oi()),ut(s,93),r=void 0;continue}}else{const l=c,u=l._0,_=l._1,$=wf(u);if($===void 0){F$(i),dt(s,oi()),ut(s,125),r=void 0;continue}else{const p=$,b=p._0;let m=p._1;_||(ut(s,44),dt(s,oi())),ut(s,34),dt(s,w$(b)),ut(s,34),ut(s,58),l._1=!1,r=m;continue}}}}else{const l=a;switch(l.$tag){case 6:{const _=l._0;_.size===0?dt(s,"{}"):(ut(s,123),dt(s,oi()),G$(i,new im(bf(_),!0)));break}case 5:{const _=l._0;_.length===0?dt(s,"[]"):(ut(s,91),dt(s,oi()),G$(i,new om(_,0)));break}case 4:{const _=l._0;ut(s,34),dt(s,w$(_)),ut(s,34);break}case 3:{const u=l,_=u._0,$=u._1;$===void 0?X3(s,_):dt(s,$);break}case 1:{dt(s,"true");break}case 2:{dt(s,"false");break}default:dt(s,"null")}r=void 0;continue}}return s.val}function Di(e){if(e.$tag===3){const n=e._0;return new Iu(n)}else return ua}function pa(e){if(e.$tag===4)return e._0}function Om(e){if(e.$tag===5){const n=e._0;return new am(n)}else return J1}function Dm(e){if(e.$tag===6)return e._0}function H6(e,t){return hP(e,t)}function F6(e,t){return nu(e,t)}function U6(e,t){let n;return n=rm,H6(e,n)}function B6(e,t){let n;return n=rm,F6(e,n)}function z6(e,t){switch(e.$tag){case 1:return new Nl(!0);case 2:return new Nl(!1);default:return x6(t,"Bool::from_json: expected boolean")}}function io(e,t){e:if(e.$tag===3){const o=e._0;if(o!==yr)if(o!==br){if(o>2147483647||o<-2147483648){const s=M6(t,"Int::from_json: overflow");if(s.$tag===1)s._0;else return s}return new qp(ui(o))}else break e;else break e}else break e;return k6(t,"Int::from_json: expected number")}function ta(e,t){e:switch(e.$tag){case 4:switch(e._0){case"NaN":return new Ui(Py);case"Infinity":return new Ui(Ly);case"-Infinity":return new Ui(Iy);default:break e}case 3:{const o=e._0;if(o!==yr&&o!==br)return new Ui(Math.fround(o));break e}default:break e}return C6(t,"Float::from_json: expected number")}function ws(e,t){if(e.$tag===4){const o=e._0;return new Yp(o)}else return P6(t,"String::from_json: expected string")}function V6(e){return Math.round(e)}function q6(e){return n=>{let o=e;for(;;){const s=o;if(s.$tag===0)return 1;{const i=s,r=i._0,a=i._1;if(n(r)===0)return 0;o=a;continue}}}}function W6(e,t){let n=e;for(;;){const o=n;if(o.$tag===0)return;{const s=o,i=s._0,r=i._0,a=i._1,c=s._1;if(r===t)return a;n=c;continue}}}function Nm(e,t){let n=e,o=0;for(;;){const s=n,i=o;if(s.$tag===0)return;{const r=s,a=r._0,c=r._1;if(t(a))return i;n=c,o=i+1|0;continue}}}function jm(e,t){if(e.$tag===0)return yi;if(t<0)return e;if(t===0)return e._1;{const n=e,o=n._0,s=n._1,i=new hr(o,yi);let r=i,a=s,c=t-1|0;for(;;){const l=r,u=a,_=c;if(u.$tag===0)break;if(l.$tag===1){const $=l,d=u,p=d._0,b=d._1;if(_===0){$._1=b;break}else{$._1=new hr(p,yi),r=$._1,a=b,c=_-1|0;continue}}else{ne();break}}return i}}function K6(e,t){t.method_0(t.self,String(e))}function Hm(e,t,n){let o;return n===void 0?o=e.end-e.start|0:o=n,t>=0&&t<=o&&o<=(e.end-e.start|0)?{str:e.str,start:e.start+t|0,end:e.start+o|0}:GM()}function J6(e,t,n,o){let s=0,i=o;for(;(i-1|0)>=n&&s<t;){const r=i-1|0,a=e.charCodeAt(r);56320<=a&&a<=57343?i=i-2|0:i=i-1|0,s=s+1|0;continue}return s<t||i<n?void 0:i}function X6(e,t,n,o){if(n>=0&&n<=o){let s=n,i=0;for(;s<o&&i<t;){const r=s,a=e.charCodeAt(r);55296<=a&&a<=56319?s=s+2|0:s=s+1|0,i=i+1|0;continue}return i<t||s>=o?void 0:s}else return RM()}function F(e,t,n,o){let s;return o===void 0?s=e.length:s=o,t>=0?X6(e,t,n,s):J6(e,-t|0,n,s)}function po(e,t,n,o){let s;o===void 0?s=e.length:s=o;let i=n,r=0;for(;;){const a=i,c=r;if(a<s&&c<t){const l=e.charCodeAt(a);if(55296<=l&&l<=56319&&(a+1|0)<s){const u=a+1|0,_=e.charCodeAt(u);if(56320<=_&&_<=57343){i=a+2|0,r=c+1|0;continue}else Js()}i=a+1|0,r=c+1|0;continue}else return c===t&&a===s}}function ft(e,t,n,o){let s;o===void 0?s=e.length:s=o;let i=n,r=0;for(;;){const a=i,c=r;if(a<s&&c<t){const l=e.charCodeAt(a);if(55296<=l&&l<=56319&&(a+1|0)<s){const u=a+1|0,_=e.charCodeAt(u);if(56320<=_&&_<=57343){i=a+2|0,r=c+1|0;continue}else Js()}i=a+1|0,r=c+1|0;continue}else return c>=t}}function na(e){return e.str.substring(e.start,e.end)}function Fm(e,t){return(((Math.imul(e-55296|0,1024)|0)+t|0)-56320|0)+65536|0}function Y6(e,t){const n=e.end-e.start|0;if(n===(t.end-t.start|0)){if(e.str===t.str&&e.start===t.start)return!0;let o=0;for(;;){const s=o;if(s<n){const i=e.str,r=e.start+s|0,a=i.charCodeAt(r),c=t.str,l=t.start+s|0;if(a!==c.charCodeAt(l))return!1;o=s+1|0;continue}else break}return!0}else return!1}function Z6(e){const t=e.length,n={val:0};return()=>{if(n.val<t){const s=n.val,i=e.charCodeAt(s);if(55296<=i&&i<=56319&&(n.val+1|0)<t){const r=n.val+1|0,a=e.charCodeAt(r);if(56320<=a&&a<=57343){const c=Fm(i,a);return n.val=n.val+2|0,c}}return n.val=n.val+1|0,i}else return-1}}function Q6(e,t){const n=e.end-e.start|0,o=t.end-t.start|0;if(o>0)if(n>=o){const s=lt(256,o),i=o-1|0;let r=0;for(;;){const c=r;if(c<i){const l=t.str,u=t.start+c|0,_=l.charCodeAt(u)&255;S(s,_),s[_]=(o-1|0)-c|0,r=c+1|0;continue}else break}let a=0;for(;;){const c=a;if(c<=(n-o|0)){const l=o-1|0;let u=0;for(;;){const b=u;if(b<=l){const g=c+b|0,m=e.str,w=e.start+g|0,y=m.charCodeAt(w),v=t.str,k=t.start+b|0;if(y!==v.charCodeAt(k))break;u=b+1|0;continue}else return c}const _=(c+o|0)-1|0,$=e.str,d=e.start+_|0,p=$.charCodeAt(d)&255;S(s,p),a=c+s[p]|0;continue}else break}return}else return;else return Ty}function e3(e,t){const n=e.end-e.start|0,o=t.end-t.start|0;if(o>0)if(n>=o){const i=t.str,r=t.start+0|0,a=i.charCodeAt(r),c=n-o|0;let l=0;for(;l<=c;){for(;;){let u;if(l<=c){const _=l,$=e.str,d=e.start+_|0;u=$.charCodeAt(d)!==a}else u=!1;if(u){l=l+1|0;continue}else break}if(l<=c){let u=1;for(;;){const _=u;if(_<o){const $=l+_|0,d=e.str,p=e.start+$|0,b=d.charCodeAt(p),g=t.str,m=t.start+_|0;if(b!==g.charCodeAt(m))break;u=_+1|0;continue}else return l}l=l+1|0}continue}return}else return;else return Ey}function t3(e,t){return(t.end-t.start|0)<=4?e3(e,t):Q6(e,t)}function rl(e,t){return t3(e,t)!==void 0}function n3(e){return(e.end-e.start|0)===0}function hc(e,t){if(t>=0&&t<(e.end-e.start|0)){const n=e.str,o=e.start+t|0,s=n.charCodeAt(o);if(55296<=s&&s<=56319)if((t+1|0)<(e.end-e.start|0)){const i=t+1|0,r=e.str,a=e.start+i|0,c=r.charCodeAt(a);return 56320<=c&&c<=57343?Fm(s,c):-1}else return-1;else return 56320<=s&&s<=57343?-1:s}else return-1}function s3(e,t,n){S(t,0),t[0]=1634760805,S(t,1),t[1]=1634760805,S(t,2),t[2]=1634760805,S(t,3),t[3]=1634760805,S(t,4),t[4]=857760878,S(t,5),t[5]=857760878,S(t,6),t[6]=857760878,S(t,7),t[7]=857760878,S(t,8),t[8]=2036477234,S(t,9),t[9]=2036477234,S(t,10),t[10]=2036477234,S(t,11),t[11]=2036477234,S(t,12),t[12]=1797285236,S(t,13),t[13]=1797285236,S(t,14),t[14]=1797285236,S(t,15),t[15]=1797285236,S(e,0),S(t,16),t[16]=e[0],S(e,0),S(t,17),t[17]=e[0],S(e,0),S(t,18),t[18]=e[0],S(e,0),S(t,19),t[19]=e[0],S(e,1),S(t,20),t[20]=e[1],S(e,1),S(t,21),t[21]=e[1],S(e,1),S(t,22),t[22]=e[1],S(e,1),S(t,23),t[23]=e[1],S(e,2),S(t,24),t[24]=e[2],S(e,2),S(t,25),t[25]=e[2],S(e,2),S(t,26),t[26]=e[2],S(e,2),S(t,27),t[27]=e[2],S(e,3),S(t,28),t[28]=e[3],S(e,3),S(t,29),t[29]=e[3],S(e,3),S(t,30),t[30]=e[3],S(e,3),S(t,31),t[31]=e[3],S(e,4),S(t,32),t[32]=e[4],S(e,4),S(t,33),t[33]=e[4],S(e,4),S(t,34),t[34]=e[4],S(e,4),S(t,35),t[35]=e[4],S(e,5),S(t,36),t[36]=e[5],S(e,5),S(t,37),t[37]=e[5],S(e,5),S(t,38),t[38]=e[5],S(e,5),S(t,39),t[39]=e[5],S(e,6),S(t,40),t[40]=e[6],S(e,6),S(t,41),t[41]=e[6],S(e,6),S(t,42),t[42]=e[6],S(e,6),S(t,43),t[43]=e[6],S(e,7),S(t,44),t[44]=e[7],S(e,7),S(t,45),t[45]=e[7],S(e,7),S(t,46),t[46]=e[7],S(e,7),S(t,47),t[47]=e[7],S(t,48),t[48]=n,S(t,49),t[49]=(n>>>0)+1|0,S(t,50),t[50]=(n>>>0)+2|0,S(t,51),t[51]=(n>>>0)+3|0,S(t,52),t[52]=0,S(t,53),t[53]=0,S(t,54),t[54]=0,S(t,55),t[55]=0,S(t,56),t[56]=0,S(t,57),t[57]=0,S(t,58),t[58]=0,S(t,59),t[59]=0,S(t,60),t[60]=0,S(t,61),t[61]=0,S(t,62),t[62]=0,S(t,63),t[63]=0}function Ys(e){const t=e._0,n=e._1,o=e._2,s=e._3,i=(t>>>0)+(n>>>0)|0,r=s^i,a=r<<16|(r>>>16|0),c=(o>>>0)+(a>>>0)|0,l=n^c,u=l<<12|(l>>>20|0),_=(i>>>0)+(u>>>0)|0,$=a^_,d=$<<8|($>>>24|0),p=(c>>>0)+(d>>>0)|0,b=u^p,g=b<<7|(b>>>25|0);return{_0:_,_1:g,_2:p,_3:d}}function Um(e,t,n){s3(e,t,n);let o=0;for(;;){const s=o;if(s<4){S(t,s);let i=t[s];const r=4+s|0;S(t,r);let a=t[r];const c=8+s|0;S(t,c);let l=t[c];const u=12+s|0;S(t,u);let _=t[u];const $=16+s|0;S(t,$);let d=t[$];const p=20+s|0;S(t,p);let b=t[p];const g=24+s|0;S(t,g);let m=t[g];const w=28+s|0;S(t,w);let y=t[w];const v=32+s|0;S(t,v);let k=t[v];const L=36+s|0;S(t,L);let P=t[L];const O=40+s|0;S(t,O);let I=t[O];const R=44+s|0;S(t,R);let D=t[R];const x=48+s|0;S(t,x);let z=t[x];const ge=52+s|0;S(t,ge);let re=t[ge];const he=56+s|0;S(t,he);let q=t[he];const G=60+s|0;S(t,G);let Y=t[G],U=0;for(;;){const K=U;if(K<4){const X=Ys({_0:i,_1:d,_2:k,_3:z});i=X._0,d=X._1,k=X._2,z=X._3;const _e=Ys({_0:a,_1:b,_2:P,_3:re});a=_e._0,b=_e._1,P=_e._2,re=_e._3;const ie=Ys({_0:l,_1:m,_2:I,_3:q});l=ie._0,m=ie._1,I=ie._2,q=ie._3;const Z=Ys({_0:_,_1:y,_2:D,_3:Y});_=Z._0,y=Z._1,D=Z._2,Y=Z._3;const se=Ys({_0:i,_1:b,_2:I,_3:Y});i=se._0,b=se._1,I=se._2,Y=se._3;const ve=Ys({_0:a,_1:m,_2:D,_3:z});a=ve._0,m=ve._1,D=ve._2,z=ve._3;const de=Ys({_0:l,_1:y,_2:k,_3:re});l=de._0,y=de._1,k=de._2,re=de._3;const Se=Ys({_0:_,_1:d,_2:P,_3:q});_=Se._0,d=Se._1,P=Se._2,q=Se._3,U=K+1|0;continue}else break}S(t,s),t[s]=i;const j=4+s|0;S(t,j),t[j]=a;const J=8+s|0;S(t,J),t[J]=l;const W=12+s|0;S(t,W),t[W]=_;const we=16+s|0;S(t,we),S(t,we),t[we]=(t[we]>>>0)+(d>>>0)|0;const De=20+s|0;S(t,De),S(t,De),t[De]=(t[De]>>>0)+(b>>>0)|0;const Ke=24+s|0;S(t,Ke),S(t,Ke),t[Ke]=(t[Ke]>>>0)+(m>>>0)|0;const Fe=28+s|0;S(t,Fe),S(t,Fe),t[Fe]=(t[Fe]>>>0)+(y>>>0)|0;const it=32+s|0;S(t,it),S(t,it),t[it]=(t[it]>>>0)+(k>>>0)|0;const ht=36+s|0;S(t,ht),S(t,ht),t[ht]=(t[ht]>>>0)+(P>>>0)|0;const $t=40+s|0;S(t,$t),S(t,$t),t[$t]=(t[$t]>>>0)+(I>>>0)|0;const Ot=44+s|0;S(t,Ot),S(t,Ot),t[Ot]=(t[Ot]>>>0)+(D>>>0)|0;const C=48+s|0;S(t,C),t[C]=z;const T=52+s|0;S(t,T),t[T]=re;const A=56+s|0;S(t,A),t[A]=q;const te=60+s|0;S(t,te),t[te]=Y,o=s+1|0;continue}else return}}function o3(e){const t=FM(8,s=>$6(_6(e,Math.imul(s,4)|0,(Math.imul(s,4)|0)+4|0))),n=lt(64,0);return Um(t,n,0),{buffer:n,seed:t,i:0,n:32,counter:0}}function i3(e){const t=e.i;if(t>>>0>=e.n>>>0)return;e.i=(t>>>0)+1|0;const n=t&31,o=e.buffer,s=Math.imul(n,2)|0;S(o,s);const i=Ql(o[s]),r=e.buffer,a=(Math.imul(n,2)|0)+1|0;S(r,a);const c=Ql(r[a]);return eP(xr(c,32),i)}function r3(e){e.counter=(e.counter>>>0)+4|0,e.counter===16&&(rP(e.buffer,e.seed,8,56,0),e.counter=0),Um(e.seed,e.buffer,e.counter),e.i=0,e.n=e.counter===12?28:32}function a3(e){for(;;){const t=i3(e);if(t!==void 0)return t;r3(e)}}function c3(e){return{self:o3(e),method_0:a3}}function l3(e){return c3(X1)}function v$(e,t){const n=Uo(e,sl),o=ns(e,32),s=Uo(t,sl),i=ns(t,32),r=zn(n,s),a=ro(zn(o,s),ns(r,32)),c=ro(zn(n,i),Uo(a,sl));return{hi:ro(ro(zn(o,i),ns(a,32)),ns(c,32)),lo:zn(e,t)}}function u3(e,t){if(ao(t,Mt)){const s=e;return s.method_0(s.self)}else if(ao(Uo(t,eu(t,cn)),Mt)){const s=e;return Uo(s.method_0(s.self),eu(t,cn))}const n=e;let o=v$(n.method_0(n.self),t);if(Wl(o.lo,t)){const s=Qx(tP(t),t);for(;Wl(o.lo,s);){const i=e;o=v$(i.method_0(i.self),t);continue}}return o.hi}function _3(e,t){if(t===0){const n=e;return j$(n.method_0(n.self))}return j$(u3(e,Ql(t)))}function $3(e,t){if(t===0){const n=e;return Wm(ns(n.method_0(n.self),33))}else return _3(e,t)}function d3(e){const t=e;return Na(ns(xr(t.method_0(t.self),11),11))/Na(xr(cn,53))}function Or(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function p3(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function S$(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function m3(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,S$(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,S$(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function Bm(e,t,n){e.size>=e.grow_at&&f3(e);let o,s=0,i=n&e.capacity_mask;for(;;){const _=s,$=i,d=e.entries;S(d,$);const p=d[$];if(p===void 0){o={_0:$,_1:_};break}else{const g=p;let m;if(g.hash===n){const w=g.key;m=w._0===t._0&&w._1===t._1}else m=!1;if(m)return;if(_>g.psl){m3(e,$,g),o={_0:$,_1:_};break}s=_+1|0,i=$+1&e.capacity_mask;continue}}const r=o._0,a=o._1,u={prev:e.tail,next:void 0,psl:a,hash:n,key:t};p3(e,r,u)}function f3(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.hash;Bm(e,l,u),s=c;continue}}}function is(e,t){Bm(e,t,Qo(t))}function zm(e){const t=e.end-e.start|0;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=Or(n),i=e.end-e.start|0;let r=0;for(;;){const a=r;if(a<i){const c=e.buf[e.start+a|0];is(s,c),r=a+1|0;continue}else break}return s}function ps(e,t){const n=Qo(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return!1;{const u=c;let _;if(u.hash===n){const $=u.key;_=$._0===t._0&&$._1===t._1}else _=!1;if(_)return!0;if(i>u.psl)return!1;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function nn(e){$x(e.entries,void 0,0),e.size=0,e.head=void 0,e.tail=-1}function sn(e){const t={val:e.head};return()=>{const o=t.val;if(o!==void 0){const i=o,r=i.key,a=i.next;return t.val=a,r}}}function ql(e,t){return F3(e,t)}function h3(e,t){return U3(e,t)}function kr(e,t){return j3(e,t)}function g3(e,t){return H3(e,t)}function gc(e,t){return R3(e,t)}function Wl(e,t){return O3(e,t)}function b3(e,t,n,o,s){if(e===n&&t<o){let i=0;for(;;){const r=i;if(r<s){const a=t+r|0,c=o+r|0;S(n,c),S(e,a),e[a]=n[c],i=r+1|0;continue}else return}}else{let i=s-1|0;for(;;){const r=i;if(r>=0){const a=t+r|0,c=o+r|0;S(n,c),S(e,a),e[a]=n[c],i=r-1|0;continue}else return}}}function y3(e,t,n,o,s){if(e===n&&t<o){let i=0;for(;;){const r=i;if(r<s){const a=t+r|0,c=o+r|0;S(n,c),S(e,a),e[a]=n[c],i=r+1|0;continue}else return}}else{let i=s-1|0;for(;;){const r=i;if(r>=0){const a=t+r|0,c=o+r|0;S(n,c),S(e,a),e[a]=n[c],i=r-1|0;continue}else return}}}function Zo(e){return{val:""}}function ut(e,t){const n=e;n.val=`${n.val}${String.fromCodePoint(t)}`}function Vm(e,t){return D3(e,t)}function Ra(e,t){return N3(e,t)}function w3(e,t){return(((Math.imul(e-55296|0,1024)|0)+t|0)-56320|0)+65536|0}function fe(e,t){const n=e.charCodeAt(t);if(55296<=n&&n<=56319){const o=t+1|0,s=e.charCodeAt(o);return w3(n,s)}else return n}function v3(e,t){return!Y6(e,t)}function S3(e,t){const n=e.length;return t>=0&&t<n?(S(e,t),e[t]):ne()}function bt(e,t){const n=e.length;return t>=0&&t<n?(S(e,t),e[t]):ne()}function yt(e,t){const n=e.length;return t>=0&&t<n?(S(e,t),e[t]):ne()}function Ns(e,t){const n=e.length;return t>=0&&t<n?(S(e,t),e[t]):ne()}function k3(e,t){const n=e.length;return t<n?(S(e,t),e[t]):ne()}function M3(e,t){const n=e.length;return t>=0&&t<n?(S(e,t),e[t]):ne()}function C3(e,t){const n=e.length;return t>=0&&t<n?(S(e,t),e[t]):ne()}function x3(e,t){const n=e.length;return t>=0&&t<n?(S(e,t),e[t]):ne()}function P3(e,t){const n=e.length;return t<n?(S(e,t),e[t]):ne()}function Zs(e,t){const n=e.length;return t>=0&&t<n?(S(e,t),e[t]):ne()}function dt(e,t){const n=e;n.val=`${n.val}${t}`}function bn(e){const t=e._0,n=e._1,o=[Re(t),Re(n)];return new In(o)}function L3(e){const t=e._0,n=e._1,o=[Cc(t),bn(n)];return new In(o)}function I3(e){const t=e._0,n=e._1,o=[Cc(t),Re(n)];return new In(o)}function T3(e,t){oP(t,e)}function E3(e,t){_P(t,e)}function A3(e,t){G3(t,e)}function Kl(e,t){iP(t,e)}function G3(e,t){const n=e._0,o=e._1;Kl(t,n),Kl(t,o)}function R3(e,t){return kc(e,t)<0}function O3(e,t){return Mc(e,t)<0}function D3(e,t){return kc(e,t)>0}function N3(e,t){return Mc(e,t)>0}function j3(e,t){return kc(e,t)<=0}function H3(e,t){return Mc(e,t)<=0}function F3(e,t){return kc(e,t)>=0}function U3(e,t){return Mc(e,t)>=0}function B3(e){let t=e.acc;return t=t^(t>>>15|0),t=Math.imul(t,-2048144777)|0,t=t^(t>>>13|0),t=Math.imul(t,-1028477379)|0,t=t^(t>>>16|0),t}function bc(e){return B3(e)}function z3(e){return{acc:(e>>>0)+374761393|0}}function yc(e){let t;return t=PM,z3(t)}function ls(e){const t=yc();return T3(t,e),bc(t)}function qm(e){const t=yc();return E3(t,e),bc(t)}function Qo(e){const t=yc();return A3(t,e),bc(t)}function Ls(e){const t=yc();return Kl(t,e),bc(t)}function V3(e){const t=Zo();return qP(e,{self:t,method_0:dt,method_1:Dr,method_2:ut}),t.val}function q3(e){const t=Zo();return uP(e,{self:t,method_0:dt,method_1:Dr,method_2:ut}),t.val}function wc(e){const t=Zo(),n={self:t,method_0:dt,method_1:Dr,method_2:ut};return e?n.method_0(n.self,"true"):n.method_0(n.self,"false"),t.val}function W3(e){return{hi:e>>31&-1,lo:e|0}}function Nn(e){return W3(e)}function No(e){return e.lo}function K3(e,t){return Z1(e,t)}function Mn(e){return K3(e,10)}function Wm(e){return e.lo}function J3(e,t,n){const o=e.length;let s;return n===void 0?s=o:s=n,t>=0&&t<=s&&s<=o?e.substring(t,s):ne()}function Dr(e,t,n,o){const s=e;s.val=`${s.val}${J3(t,n,n+o|0)}`}function X3(e,t){K6(t,{self:e,method_0:dt,method_1:Dr,method_2:ut})}function k$(e){return e<10?(e+48|0)&255:(((e+97|0)&255)-10|0)&255}function Y3(e){const t=Zo();return ut(t,k$((e/16|0)&255)),ut(t,k$((e%16|0)&255)),t.val}function Z3(e){return n=>{const o=e.length;let s=0;for(;;){const i=s;if(i<o){const r=e[i];if(n(r)!==1)return 0;s=i+1|0;continue}else return 1}}}function Km(e){return e.$tag===0?ne():e._0}function Ni(e){return e.$tag===0?ne():e._0}function xt(e){return e>=0?e<=1?1:e>1073741824?1073741824:(2147483647>>(Math.clz32(e-1|0)-1|0))+1|0:ne()}function Jm(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function Q3(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function eC(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function tC(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function nC(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function sC(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function oC(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function iC(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function rC(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function aC(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function cC(e){const t=xt(e),n=t-1|0,o=(Math.imul(t,13)|0)/16|0;return{entries:lt(t,void 0),size:0,capacity:t,capacity_mask:n,grow_at:o,head:void 0,tail:-1}}function lC(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function uC(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function _C(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function $C(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function dC(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function pC(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function mC(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function fC(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function hC(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function gC(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function bC(e,t,n){const o=e.tail;if(o===-1)e.head=n;else{const i=e.entries;S(i,o);const r=i[o];let a;r===void 0?a=ne():a=r,a.next=n}e.tail=t;const s=e.entries;S(s,t),s[t]=n,e.size=e.size+1|0}function M$(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function C$(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function Jl(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function Xl(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function Yl(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function x$(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function P$(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function L$(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function I$(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function T$(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function E$(e,t,n){const o=e.entries;S(o,n),o[n]=t;const s=t.next;if(s===void 0){e.tail=n;return}else{const r=s;r.prev=n;return}}function yC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,M$(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,M$(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function wC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,C$(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,C$(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function vC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,Yl(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,Yl(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function SC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,Jl(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,Jl(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function kC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,Xl(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,Xl(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function MC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,x$(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,x$(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function CC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,P$(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,P$(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function xC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,L$(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,L$(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function PC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,I$(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,I$(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function LC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,T$(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,T$(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function IC(e,t,n){let o=n.psl+1|0,s=t+1&e.capacity_mask,i=n;for(;;){const r=o,a=s,c=i,l=e.entries;S(l,a);const u=l[a];if(u===void 0){c.psl=r,E$(e,c,a);break}else{const $=u;if(r>$.psl){c.psl=r,E$(e,c,a),o=$.psl+1|0,s=a+1&e.capacity_mask,i=$;continue}else{o=r+1|0,s=a+1&e.capacity_mask;continue}}}}function Xm(e,t,n,o){e.size>=e.grow_at&&TC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;if(m.hash===o&&m.key===t){m.value=n;return}if($>m.psl){yC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};lC(e,a,_)}function Ym(e,t,n,o){e.size>=e.grow_at&&EC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;if(m.hash===o&&Rf(m.key,t)){m.value=n;return}if($>m.psl){wC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};uC(e,a,_)}function Zm(e,t,n,o){e.size>=e.grow_at&&AC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;if(m.hash===o&&m.key===t){m.value=n;return}if($>m.psl){vC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};_C(e,a,_)}function Qm(e,t,n,o){e.size>=e.grow_at&&GC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;if(m.hash===o&&m.key===t){m.value=n;return}if($>m.psl){SC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};$C(e,a,_)}function ef(e,t,n,o){e.size>=e.grow_at&&RC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;if(m.hash===o&&m.key===t){m.value=n;return}if($>m.psl){kC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};dC(e,a,_)}function tf(e,t,n,o){e.size>=e.grow_at&&OC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;if(m.hash===o&&m.key===t){m.value=n;return}if($>m.psl){MC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};pC(e,a,_)}function nf(e,t,n,o){e.size>=e.grow_at&&DC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;if(m.hash===o&&m.key===t){m.value=n;return}if($>m.psl){CC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};mC(e,a,_)}function sf(e,t,n,o){e.size>=e.grow_at&&NC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;let w;if(m.hash===o){const y=m.key;w=y._0===t._0&&y._1===t._1}else w=!1;if(w){m.value=n;return}if($>m.psl){xC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};fC(e,a,_)}function of(e,t,n,o){e.size>=e.grow_at&&jC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;let w;if(m.hash===o){const y=m.key;w=y._0===t._0&&y._1===t._1}else w=!1;if(w){m.value=n;return}if($>m.psl){PC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};hC(e,a,_)}function rf(e,t,n,o){e.size>=e.grow_at&&HC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;if(m.hash===o&&m.key===t){m.value=n;return}if($>m.psl){LC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};gC(e,a,_)}function af(e,t,n,o){e.size>=e.grow_at&&FC(e);let s,i=0,r=o&e.capacity_mask;for(;;){const $=i,d=r,p=e.entries;S(p,d);const b=p[d];if(b===void 0){s={_0:d,_1:$};break}else{const m=b;let w;if(m.hash===o){const y=m.key;w=y._0===t._0&&y._1===t._1}else w=!1;if(w){m.value=n;return}if($>m.psl){IC(e,d,m),s={_0:d,_1:$};break}i=$+1|0,r=d+1&e.capacity_mask;continue}}const a=s._0,c=s._1,_={prev:e.tail,next:void 0,psl:c,hash:o,key:t,value:n};bC(e,a,_)}function TC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;Xm(e,l,u,_),s=c;continue}}}function EC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;Ym(e,l,u,_),s=c;continue}}}function AC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;Zm(e,l,u,_),s=c;continue}}}function GC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;Qm(e,l,u,_),s=c;continue}}}function RC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;ef(e,l,u,_),s=c;continue}}}function OC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;tf(e,l,u,_),s=c;continue}}}function DC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;nf(e,l,u,_),s=c;continue}}}function NC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;sf(e,l,u,_),s=c;continue}}}function jC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;of(e,l,u,_),s=c;continue}}}function HC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;rf(e,l,u,_),s=c;continue}}}function FC(e){const t=e.head,n=e.capacity<<1;e.entries=lt(n,void 0),e.capacity=n,e.capacity_mask=n-1|0;const o=e.capacity;e.grow_at=(Math.imul(o,13)|0)/16|0,e.size=0,e.head=void 0,e.tail=-1;let s=t;for(;;){const i=s;if(i===void 0)return;{const a=i,c=a.next,l=a.key,u=a.value,_=a.hash;af(e,l,u,_),s=c;continue}}}function le(e,t,n){Xm(e,t,n,ls(t))}function Fu(e,t,n){Ym(e,t,n,qm(t))}function UC(e,t,n){Zm(e,t,n,Ls(t))}function cf(e,t,n){Qm(e,t,n,Ls(t))}function lf(e,t,n){ef(e,t,n,Ls(t))}function uf(e,t,n){tf(e,t,n,ls(t))}function _f(e,t,n){nf(e,t,n,ls(t))}function Oa(e,t,n){sf(e,t,n,Qo(t))}function Zl(e,t,n){of(e,t,n,Qo(t))}function $f(e,t,n){rf(e,t,n,ls(t))}function df(e,t,n){af(e,t,n,Qo(t))}function Me(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=Jm(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];le(s,c._0,c._1),r=a+1|0;continue}else break}return s}function BC(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=eC(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];cf(s,c._0,c._1),r=a+1|0;continue}else break}return s}function zC(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=tC(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];lf(s,c._0,c._1),r=a+1|0;continue}else break}return s}function pf(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=nC(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];Fu(s,c._0,c._1),r=a+1|0;continue}else break}return s}function VC(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=sC(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];uf(s,c._0,c._1),r=a+1|0;continue}else break}return s}function qC(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=oC(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];_f(s,c._0,c._1),r=a+1|0;continue}else break}return s}function mf(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=iC(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];Oa(s,c._0,c._1),r=a+1|0;continue}else break}return s}function WC(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=rC(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];Zl(s,c._0,c._1),r=a+1|0;continue}else break}return s}function KC(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=aC(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];$f(s,c._0,c._1),r=a+1|0;continue}else break}return s}function JC(e){const t=e.length;let n=xt(t);t>((Math.imul(n,13)|0)/16|0)&&(n=Math.imul(n,2)|0);const s=cC(n),i=e.length;let r=0;for(;;){const a=r;if(a<i){const c=e[a];df(s,c._0,c._1),r=a+1|0;continue}else break}return s}function ae(e,t){const n=ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return;{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i>u.psl)return;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function ff(e,t){const n=qm(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return;{const u=c;if(u.hash===n&&Rf(u.key,t))return u.value;if(i>u.psl)return;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function Nr(e,t){const n=Ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return;{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i>u.psl)return;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function XC(e,t){const n=ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return;{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i>u.psl)return;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function YC(e,t){const n=ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return;{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i>u.psl)return;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function ZC(e,t){const n=Ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return;{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i>u.psl)return;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function QC(e,t){const n=Ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return;{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i>u.psl)return;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function ex(e,t){const n=Qo(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return;{const u=c;let _;if(u.hash===n){const $=u.key;_=$._0===t._0&&$._1===t._1}else _=!1;if(_)return u.value;if(i>u.psl)return;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function hf(e,t){const n=Qo(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)return-1;{const u=c;let _;if(u.hash===n){const $=u.key;_=$._0===t._0&&$._1===t._1}else _=!1;if(_)return u.value;if(i>u.psl)return-1;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function Da(e,t){const n=ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)ne();else{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i<=u.psl){o=i+1|0,s=r+1&e.capacity_mask;continue}else ne()}}}function A$(e,t){const n=ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)ne();else{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i<=u.psl){o=i+1|0,s=r+1&e.capacity_mask;continue}else ne()}}}function tx(e,t){const n=ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)ne();else{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i<=u.psl){o=i+1|0,s=r+1&e.capacity_mask;continue}else ne()}}}function nx(e,t){const n=ls(t);let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)ne();else{const u=c;if(u.hash===n&&u.key===t)return u.value;if(i<=u.psl){o=i+1|0,s=r+1&e.capacity_mask;continue}else ne()}}}function sx(e,t){const n=t.prev;if(n===-1)e.head=t.next;else{const s=e.entries;S(s,n);const i=s[n];let r;i===void 0?r=ne():r=i;const a=r;a.next=t.next}const o=t.next;if(o===void 0){e.tail=t.prev;return}else{const i=o;i.prev=t.prev;return}}function ox(e,t){const n=t.prev;if(n===-1)e.head=t.next;else{const s=e.entries;S(s,n);const i=s[n];let r;i===void 0?r=ne():r=i;const a=r;a.next=t.next}const o=t.next;if(o===void 0){e.tail=t.prev;return}else{const i=o;i.prev=t.prev;return}}function ix(e,t){const n=t.prev;if(n===-1)e.head=t.next;else{const s=e.entries;S(s,n);const i=s[n];let r;i===void 0?r=ne():r=i;const a=r;a.next=t.next}const o=t.next;if(o===void 0){e.tail=t.prev;return}else{const i=o;i.prev=t.prev;return}}function rx(e,t){let n=t;for(;;){const o=n,s=o+1&e.capacity_mask;e:{const r=e.entries;S(r,s);const a=r[s];if(a===void 0)break e;{const l=a;if(l.psl===0)break e;l.psl=l.psl-1|0,Jl(e,l,o),n=s;continue}}const i=e.entries;S(i,o),i[o]=void 0;return}}function ax(e,t){let n=t;for(;;){const o=n,s=o+1&e.capacity_mask;e:{const r=e.entries;S(r,s);const a=r[s];if(a===void 0)break e;{const l=a;if(l.psl===0)break e;l.psl=l.psl-1|0,Xl(e,l,o),n=s;continue}}const i=e.entries;S(i,o),i[o]=void 0;return}}function cx(e,t){let n=t;for(;;){const o=n,s=o+1&e.capacity_mask;e:{const r=e.entries;S(r,s);const a=r[s];if(a===void 0)break e;{const l=a;if(l.psl===0)break e;l.psl=l.psl-1|0,Yl(e,l,o),n=s;continue}}const i=e.entries;S(i,o),i[o]=void 0;return}}function lx(e,t,n){let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)break;{const u=c;if(u.hash===n&&u.key===t){sx(e,u),rx(e,r),e.size=e.size-1|0;break}if(i>u.psl)break;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function ux(e,t,n){let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)break;{const u=c;if(u.hash===n&&u.key===t){ox(e,u),ax(e,r),e.size=e.size-1|0;break}if(i>u.psl)break;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function _x(e,t,n){let o=0,s=n&e.capacity_mask;for(;;){const i=o,r=s,a=e.entries;S(a,r);const c=a[r];if(c===void 0)break;{const u=c;if(u.hash===n&&u.key===t){ix(e,u),cx(e,r),e.size=e.size-1|0;break}if(i>u.psl)break;o=i+1|0,s=r+1&e.capacity_mask;continue}}}function vc(e,t){lx(e,t,Ls(t))}function Sc(e,t){ux(e,t,Ls(t))}function gf(e,t){_x(e,t,Ls(t))}function $x(e,t,n,o){const s=e.length;if(s>0)if(n<s){let i;i=s-n|0,e.fill(t,n,n+i);return}else{ne();return}else return}function bf(e){const t={val:e.head};return()=>{const o=t.val;if(o!==void 0){const i=o,r=i.key,a=i.value,c=i.next;return t.val=c,{_0:r,_1:a}}}}function dx(e){const t={val:e.head};return()=>{const o=t.val;if(o!==void 0){const i=o,r=i.key,a=i.value,c=i.next;return t.val=c,{_0:r,_1:a}}}}function yf(e){return n=>{let o=e.head;for(;;){const s=o;if(s===void 0)return 1;{const r=s,a=r.value,c=r.next;if(n(a)===1){o=c;continue}else return 0}}}}function Uu(e){return n=>{let o=e.head;for(;;){const s=o;if(s===void 0)return 1;{const r=s,a=r.value,c=r.next;if(n(a)===1){o=c;continue}else return 0}}}}function Bu(e){return n=>{let o=e.head;for(;;){const s=o;if(s===void 0)return 1;{const r=s,a=r.value,c=r.next;if(n(a)===1){o=c;continue}else return 0}}}}function px(e){const t=VC([]);return e(n=>(uf(t,n._0,n._1),1)),t}function mx(e){const t=qC([]);return e(n=>(_f(t,n._0,n._1),1)),t}function fx(e){const t=KC([]);return e(n=>($f(t,n._0,n._1),1)),t}function wf(e){return e()}function on(e){return e()}function hx(e){return e()}function gx(e){return e()}function xn(e){return e?Gp:Rp}function Re(e){const t=e+0,n=void 0;return new Ar(t,n)}function bx(e){return{hi:0,lo:e}}function zu(e){return bx(e)}function Ql(e){return zu(e)}function Na(e){return Q1(e)}function Mr(e){return e2(e)}function Pn(e){const t=e,n=void 0;return new Ar(t,n)}function yx(e){const t=new Array(e.length),n=e.length;let o=0;for(;;){const s=o;if(s<n){const i=e[s];t[s]=Pc(i),o=s+1|0;continue}else break}return new In(t)}function wx(e){const t=new Array(e.length),n=e.length;let o=0;for(;;){const s=o;if(s<n){const i=e[s];t[s]=tu(i),o=s+1|0;continue}else break}return new In(t)}function vx(e){const t=new Array(e.length),n=e.length;let o=0;for(;;){const s=o;if(s<n){const i=e[s];t[s]=i,o=s+1|0;continue}else break}return new In(t)}function Sx(e){const t=new Array(e.length),n=e.length;let o=0;for(;;){const s=o;if(s<n){const i=e[s];t[s]=Vf(i),o=s+1|0;continue}else break}return new In(t)}function kx(e){const t=new Array(e.length),n=e.length;let o=0;for(;;){const s=o;if(s<n){const i=e[s];t[s]=L3(i),o=s+1|0;continue}else break}return new In(t)}function Mx(e){const t=new Array(e.length),n=e.length;let o=0;for(;;){const s=o;if(s<n){const i=e[s];t[s]=I3(i),o=s+1|0;continue}else break}return new In(t)}function Cx(e){if(e.length===0){const i=[];return new In(i)}const n=new Array(e.length),o=e.length;let s=0;for(;;){const i=s;if(i<o){const r=e[i];n[i]=qf(r),s=i+1|0;continue}else break}return new In(n)}function G$(e,t){gn(e,t)}function xx(e,t){gn(e,t)}function Px(e,t){gn(e,t)}function Sn(e,t){gn(e,t)}function Lx(e,t){gn(e,t)}function Ix(e,t){gn(e,t)}function wo(e,t){gn(e,t)}function Tx(e,t){gn(e,t)}function Ex(e,t){gn(e,t)}function Ax(e,t){gn(e,t)}function Gx(e,t){gn(e,t)}function Rx(e,t){gn(e,t)}function al(e,t){gn(e,t)}function Ox(e,t){gn(e,t)}function Dx(e,t){gn(e,t)}function Nx(){return e=>1}function R$(e){return t=>t(e)}function jx(e,t){return n=>e(n)===1&&t(n)===1?1:0}function Hx(e){const t=[];return e(n=>(xx(t,n),1)),t}function Fx(e){const t=[];return e(n=>(Dx(t,n),1)),t}function O$(e){return Wm(e)&255}function ja(e){return Nn(e)}function Ux(e){return e.lo===0?{hi:~e.hi+1|0,lo:0}:{hi:~e.hi,lo:~e.lo+1|0}}function vf(e,t,n){const o=e.hi,s=e.lo,i=s+n|0,r=i>>31,a=s>>31,c=n>>31,l=(a&c|~r&(a^c))&1;return{hi:(o+t|0)+l|0,lo:i}}function Sf(e,t){return vf(e,t.hi,t.lo)}function kf(e,t){return t.lo===0?{hi:e.hi-t.hi|0,lo:e.lo}:vf(e,~t.hi,~t.lo+1|0)}function Mf(e,t){const n=e.hi,o=e.lo,s=t.hi,i=t.lo,r=n,a=o,c=s,l=i,u=r>>>16|0,_=r&65535,$=a>>>16|0,d=a&65535,p=c>>>16|0,b=c&65535,g=l>>>16|0,m=l&65535,w=Math.imul(d,m)|0,y=w>>>16|0,v=w&65535,k=(y>>>0)+((Math.imul($,m)|0)>>>0)|0,L=k>>>16|0,O=((k&65535)>>>0)+((Math.imul(d,g)|0)>>>0)|0,I=(L>>>0)+((O>>>16|0)>>>0)|0,R=O&65535,D=(I>>>0)+((Math.imul(_,m)|0)>>>0)|0,x=D>>>16|0,ge=((D&65535)>>>0)+((Math.imul($,g)|0)>>>0)|0,re=(x>>>0)+((ge>>>16|0)>>>0)|0,q=((ge&65535)>>>0)+((Math.imul(d,b)|0)>>>0)|0,G=(re>>>0)+((q>>>16|0)>>>0)|0,Y=q&65535;return{hi:(((((((((G>>>0)+((Math.imul(u,m)|0)>>>0)|0)>>>0)+((Math.imul(_,g)|0)>>>0)|0)>>>0)+((Math.imul($,b)|0)>>>0)|0)>>>0)+((Math.imul(d,p)|0)>>>0)|0)&65535)<<16|Y,lo:R<<16|v}}function Bx(e,t){if(t.hi===0&&t.lo===0)return ne();{const n=Eu(),o=e.hi,s=e.lo,i=t.hi,r=t.lo,a=n.div_s,c=a(s,o,r,i),l=n.get_high;return{hi:l(),lo:c}}}function zx(e,t){if(t.hi===0&&t.lo===0)return ne();{const n=Eu(),o=e.hi,s=e.lo,i=t.hi,r=t.lo,a=n.div_u,c=a(s,o,r,i),l=n.get_high;return{hi:l(),lo:c}}}function Vx(e,t){if(t.hi===0&&t.lo===0)return ne();{const n=Eu(),o=e.hi,s=e.lo,i=t.hi,r=t.lo,a=n.rem_u,c=a(s,o,r,i),l=n.get_high;return{hi:l(),lo:c}}}function qx(e){return{hi:~e.hi,lo:~e.lo}}function Cf(e,t){return{hi:e.hi&t.hi,lo:e.lo&t.lo}}function xf(e,t){return{hi:e.hi|t.hi,lo:e.lo|t.lo}}function Pf(e,t){const n=t&63;if(n===0)return e;if(n<32){const o=e.hi,s=e.lo,i=o,r=s,a=i<<n|(r>>>(32-n|0)|0),c=r<<n;return{hi:a,lo:c}}else return{hi:e.lo<<(n-32|0),lo:0}}function Wx(e,t){const n=t&63;return n===0?e:n<32?{hi:e.hi>>>n|0,lo:e.lo>>>n|e.hi<<(32-n|0)}:{hi:0,lo:e.hi>>>(n-32|0)|0}}function Kx(e,t){const n=t&63;return n===0?e:n<32?{hi:e.hi>>n,lo:e.lo>>>n|e.hi<<(32-n|0)}:{hi:e.hi>>31,lo:e.hi>>(n-32|0)}}function Lf(e){return Ux(e)}function vs(e,t){return Sf(e,t)}function Cr(e,t){return kf(e,t)}function Jo(e,t){return Mf(e,t)}function no(e,t){return Bx(e,t)}function If(e,t){return Cf(e,t)}function D$(e,t){return xf(e,t)}function Jx(e,t){return Kx(e,t)}function jo(e,t){return Pf(e,t)}function N$(e,t){const n=e,o=t;return n.hi===o.hi&&n.lo===o.lo}function kc(e,t){return t2(e,t)}function Xx(e){return s2(e)}function Yx(e){return Xx(e)}function ro(e,t){return Sf(e,t)}function eu(e,t){return kf(e,t)}function zn(e,t){return Mf(e,t)}function Zx(e,t){return zx(e,t)}function Qx(e,t){return Vx(e,t)}function j$(e){return e.lo}function Mc(e,t){return n2(e,t)}function ao(e,t){const n=e,o=t;return n.hi===o.hi&&n.lo===o.lo}function Uo(e,t){return Cf(e,t)}function eP(e,t){return xf(e,t)}function tP(e){return qx(e)}function xr(e,t){return Pf(e,t)}function ns(e,t){return Wx(e,t)}function H$(e){const t=e;return t.hi!==0?Math.clz32(t.hi):32+Math.clz32(t.lo)|0}function nP(e,t){const n=(e.acc>>>0)+((Math.imul(t,-1028477379)|0)>>>0)|0,o=17;e.acc=Math.imul(n<<o|(n>>>(32-o|0)|0),668265263)|0}function Tf(e,t){e.acc=(e.acc>>>0)+4|0,nP(e,t)}function li(e,t){Tf(e,t)}function sP(e,t){const n=t.length;let o=0;for(;;){const s=o;if(s<n){Tf(e,t.charCodeAt(s)),o=s+1|0;continue}else return}}function oP(e,t){sP(t,e)}function iP(e,t){li(t,e)}function Ha(e,t,n,o,s){if(s>=0&&o>=0&&(s+n|0)<=t.length&&(o+n|0)<=e.length){b3(t,s,e,o,n);return}else{Js(`bounds check failed: dst_offset = ${Mn(s)}, src_offset = ${Mn(o)}, len = ${Mn(n)}, dst.length = ${Mn(t.length)}, self.length = ${Mn(e.length)}`);return}}function rP(e,t,n,o,s){if((s+n|0)<=t.length&&(o+n|0)<=e.length){y3(t,s,e,o,n);return}else{Js(`bounds check failed: dst_offset = ${Mn(s)}, src_offset = ${Mn(o)}, len = ${Mn(n)}, dst.length = ${Mn(t.length)}, self.length = ${Mn(e.length)}`);return}}function ui(e){return e!==e?0:e>=2147483647?2147483647:e<=-2147483648?-2147483648:e|0}function Ef(e){console.log(e)}function aP(e){return o2(e)}function F$(e){if(e.length!==0)return aP(e)}function cP(e,t){if(t>=0&&t<e.length){S(e,t);const n=e[t];return i2(e,t,1),n}else return OM(`index out of bounds: the len is from 0 to ${Mn(e.length)} but the index is ${Mn(t)}`)}function lP(e,t){const n=e.length;return t<n?e[t]:void 0}function Af(){return{now:0}}function ei(e){return e.now=e.now+1|0,e.now}function Gf(e){const t=Me([]);return le(t,"cost",Mx(e.cost)),new ke(t)}function uP(e,t){switch(e){case 0:{t.method_0(t.self,"HeartCrystalDust");return}case 1:{t.method_0(t.self,"RecallGear");return}case 2:{t.method_0(t.self,"SpiritalSpark");return}case 3:{t.method_0(t.self,"RefinedCopper");return}default:{t.method_0(t.self,"ResonantCrystal");return}}}function Rf(e,t){switch(e){case 0:return t===0;case 1:return t===1;case 2:return t===2;case 3:return t===3;default:return t===4}}function _P(e,t){switch(e){case 0:{li(t,0);return}case 1:{li(t,1);return}case 2:{li(t,2);return}case 3:{li(t,3);return}default:{li(t,4);return}}}function Cc(e){switch(e){case 0:{const t="HeartCrystalDust";return new Ae(t)}case 1:{const t="RecallGear";return new Ae(t)}case 2:{const t="SpiritalSpark";return new Ae(t)}case 3:{const t="RefinedCopper";return new Ae(t)}default:{const t="ResonantCrystal";return new Ae(t)}}}function kt(e){return{cost:e}}function xc(e){const t=Me([]);return le(t,"health",Pn(e.health)),le(t,"speed",Re(e.speed)),le(t,"attack",Pn(e.attack)),le(t,"defense",Pn(e.defense)),le(t,"dodge",Pn(e.dodge)),new ke(t)}function Of(e,t){let n,o=Kr,s=Kr,i=Kr,r=Kr;if(e.$tag===6){const w=e._0,y=ae(w,"health");if(y!==void 0){const I=y,R="health",D=ta(I,new et(t,R));let x;if(D.$tag===1)x=D._0;else return D;o=new zi(x)}const v=ae(w,"speed");if(v!==void 0){const I=v,R="speed",D=io(I,new et(t,R));let x;if(D.$tag===1)x=D._0;else return D;n=x}const k=ae(w,"attack");if(k!==void 0){const I=k,R="attack",D=ta(I,new et(t,R));let x;if(D.$tag===1)x=D._0;else return D;r=new zi(x)}const L=ae(w,"defense");if(L!==void 0){const I=L,R="defense",D=ta(I,new et(t,R));let x;if(D.$tag===1)x=D._0;else return D;i=new zi(x)}const P=ae(w,"dodge");if(P!==void 0){const I=P,R="dodge",D=ta(I,new et(t,R));let x;if(D.$tag===1)x=D._0;else return D;s=new zi(x)}}else return new Go(new je({_0:t,_1:"Expected object to deserialize Attribute"}));const a=n;let c;if(a===void 0)return new Go(new je({_0:t,_1:"Missing field speed"}));c=a;const l=o;let u;if(l.$tag===1)u=l._0;else return new Go(new je({_0:t,_1:"Missing field health"}));const _=s;let $;if(_.$tag===1)$=_._0;else return new Go(new je({_0:t,_1:"Missing field dodge"}));const d=i;let p;if(d.$tag===1)p=d._0;else return new Go(new je({_0:t,_1:"Missing field defense"}));const b=r;let g;if(b.$tag===1)g=b._0;else return new Go(new je({_0:t,_1:"Missing field attack"}));return new cm({health:u,speed:c,attack:g,defense:p,dodge:$})}function qt(e,t,n,o,s){return{health:e,speed:t,attack:n,defense:o,dodge:s}}function tu(e){const t=Me([]);return le(t,"equipment_base",$P(e.equipment_base)),le(t,"id",Re(e.id)),new ke(t)}function nu(e,t){let n,o;if(e.$tag===6){const l=e._0,u=ae(l,"equipment_base");if(u!==void 0){const d=u,p="equipment_base",b=dP(d,new et(t,p));let g;if(b.$tag===1)g=b._0;else return b;o=g}const _=ae(l,"id");if(_!==void 0){const d=_,p="id",b=io(d,new et(t,p));let g;if(b.$tag===1)g=b._0;else return b;n=g}}else return new _a(new je({_0:t,_1:"Expected object to deserialize Equipment"}));const s=n;let i;if(s===void 0)return new _a(new je({_0:t,_1:"Missing field id"}));i=s;const r=o;let a;return r===void 0?new _a(new je({_0:t,_1:"Missing field equipment_base"})):(a=r,new lm({equipment_base:a,id:i}))}function $P(e){const t=Me([]),n=e.name;le(t,"name",new Ae(n));const o=e.description;le(t,"description",new Ae(o));const s=e.resource_url;return le(t,"resource_url",new Ae(s)),le(t,"attribute",xc(e.attribute)),new ke(t)}function dP(e,t){let n,o,s,i;if(e.$tag===6){const b=e._0,g=ae(b,"name");if(g!==void 0){const k=g,L="name",P=ws(k,new et(t,L));let O;if(P.$tag===1)O=P._0;else return P;o=O}const m=ae(b,"description");if(m!==void 0){const k=m,L="description",P=ws(k,new et(t,L));let O;if(P.$tag===1)O=P._0;else return P;s=O}const w=ae(b,"resource_url");if(w!==void 0){const k=w,L="resource_url",P=ws(k,new et(t,L));let O;if(P.$tag===1)O=P._0;else return P;n=O}const y=ae(b,"attribute");if(y!==void 0){const k=y,L="attribute",P=Of(k,new et(t,L));let O;if(P.$tag===1)O=P._0;else return P;i=O}}else return new ai(new je({_0:t,_1:"Expected object to deserialize EquipmentBase"}));const r=n;let a;if(r===void 0)return new ai(new je({_0:t,_1:"Missing field resource_url"}));a=r;const c=o;let l;if(c===void 0)return new ai(new je({_0:t,_1:"Missing field name"}));l=c;const u=s;let _;if(u===void 0)return new ai(new je({_0:t,_1:"Missing field description"}));_=u;const $=i;let d;return $===void 0?new ai(new je({_0:t,_1:"Missing field attribute"})):(d=$,new um({name:l,description:_,resource_url:a,attribute:d}))}function pP(e){const t=Me([]);le(t,"id",Re(e.id));const n=e.type_msg;le(t,"type_msg",new Ae(n));const o=e.content;return le(t,"content",new Ae(o)),new ke(t)}function mP(){return{history:[],callback:e=>{}}}function fP(e,t){e.callback=t}function tt(e,t){const n={id:ei(IM),type_msg:t.type_msg,content:t.content};Px(e.history,n);const o=e.callback;o(Ye(pP(n)))}function Pc(e){const t=Me([]);return le(t,"id",Re(e.id)),le(t,"level",Re(e.level)),le(t,"suffix",Re(e.suffix)),le(t,"live_left",Re(e.live_left)),le(t,"attribute",xc(e.attribute)),le(t,"copper_type",Df(e.copper_type)),le(t,"equipment_slot",gP(e.equipment_slot)),le(t,"copper_info",yP(e.copper_info)),new ke(t)}function hP(e,t){let n,o,s,i,r,a,c,l;if(e.$tag===6){const D=e._0,x=ae(D,"id");if(x!==void 0){const j=x,J="id",W=io(j,new et(t,J));let we;if(W.$tag===1)we=W._0;else return W;i=we}const z=ae(D,"level");if(z!==void 0){const j=z,J="level",W=io(j,new et(t,J));let we;if(W.$tag===1)we=W._0;else return W;s=we}const ge=ae(D,"suffix");if(ge!==void 0){const j=ge,J="suffix",W=io(j,new et(t,J));let we;if(W.$tag===1)we=W._0;else return W;n=we}const re=ae(D,"live_left");if(re!==void 0){const j=re,J="live_left",W=io(j,new et(t,J));let we;if(W.$tag===1)we=W._0;else return W;o=we}const he=ae(D,"attribute");if(he!==void 0){const j=he,J="attribute",W=Of(j,new et(t,J));let we;if(W.$tag===1)we=W._0;else return W;l=we}const q=ae(D,"copper_type");if(q!==void 0){const j=q,J="copper_type",W=Nf(j,new et(t,J));let we;if(W.$tag===1)we=W._0;else return W;a=we}const G=ae(D,"equipment_slot");if(G!==void 0){const j=G,J="equipment_slot",W=bP(j,new et(t,J));let we;if(W.$tag===1)we=W._0;else return W;r=we}const Y=ae(D,"copper_info");if(Y!==void 0){const j=Y,J="copper_info",W=wP(j,new et(t,J));let we;if(W.$tag===1)we=W._0;else return W;c=we}}else return new ds(new je({_0:t,_1:"Expected object to deserialize Copper"}));const u=n;let _;if(u===void 0)return new ds(new je({_0:t,_1:"Missing field suffix"}));_=u;const $=o;let d;if($===void 0)return new ds(new je({_0:t,_1:"Missing field live_left"}));d=$;const p=s;let b;if(p===void 0)return new ds(new je({_0:t,_1:"Missing field level"}));b=p;const g=i;let m;if(g===void 0)return new ds(new je({_0:t,_1:"Missing field id"}));m=g;const w=r;let y;if(w===void 0)return new ds(new je({_0:t,_1:"Missing field equipment_slot"}));y=w;const v=a;let k;if(v===void 0)return new ds(new je({_0:t,_1:"Missing field copper_type"}));k=v;const L=c;let P;if(L===void 0)return new ds(new je({_0:t,_1:"Missing field copper_info"}));P=L;const O=l;let I;return O===void 0?new ds(new je({_0:t,_1:"Missing field attribute"})):(I=O,new _m({id:m,level:b,suffix:_,live_left:d,attribute:I,copper_type:k,equipment_slot:y,copper_info:P}))}function Df(e){switch(e){case 0:{const t="IronWall";return new Ae(t)}case 1:{const t="Arcanist";return new Ae(t)}case 2:{const t="CraftsMan";return new Ae(t)}case 3:{const t="Mechanic";return new Ae(t)}default:{const t="Resonator";return new Ae(t)}}}function Nf(e,t){let n;switch(e.$tag){case 4:{n=e._0;break}case 5:{const s=e._0,i=lP(s,0);if(i===void 0)return new Vi(new je({_0:t,_1:"Missing tag in array[0] when derserializing CopperType"}));{const a=i;if(a.$tag===4)n=a._0;else return new Vi(new je({_0:t,_1:"Expected string tag at array[0] when derserializing CopperType"}))}break}default:return new Vi(new je({_0:t,_1:"Expected string or array for tag in enum when derserializing CopperType"}))}switch(n){case"IronWall":return new ci(0);case"Arcanist":return new ci(1);case"CraftsMan":return new ci(2);case"Mechanic":return new ci(3);case"Resonator":return new ci(4);default:return new Vi(new je({_0:t,_1:`Unknown enum constructor ${n} when deserializing CopperType`}))}}function gP(e){const t=Me([]),n=e.slot1;n===void 0||le(t,"slot1",tu(n));const o=e.slot2;return o===void 0||le(t,"slot2",tu(o)),le(t,"is_slot2_locked",xn(e.is_slot2_locked)),new ke(t)}function bP(e,t){let n=o$,o=o$,s=-1;if(e.$tag===6){const $=e._0,d=ae($,"slot1");if(d!==void 0){const m=d,w="slot1",y=nu(m,new et(t,w));let v;if(y.$tag===1)v=y._0;else return y;o=new Hl(v)}const p=ae($,"slot2");if(p!==void 0){const m=p,w="slot2",y=nu(m,new et(t,w));let v;if(y.$tag===1)v=y._0;else return y;n=new Hl(v)}const b=ae($,"is_slot2_locked");if(b!==void 0){const m=b,w="is_slot2_locked",y=z6(m,new et(t,w));let v;if(y.$tag===1)v=y._0;else return y;s=v}}else return new Fl(new je({_0:t,_1:"Expected object to deserialize EquipmentSlot"}));const i=n;let r;i.$tag===1?r=i._0:r=void 0;const a=o;let c;a.$tag===1?c=a._0:c=void 0;const l=s;let u;return l===-1?new Fl(new je({_0:t,_1:"Missing field is_slot2_locked"})):(u=l,new $m({slot1:c,slot2:r,is_slot2_locked:u}))}function yP(e){const t=Me([]),n=e.name;le(t,"name",new Ae(n)),le(t,"copper_type",Df(e.copper_type));const o=e.description;le(t,"description",new Ae(o));const s=e.icon_url;le(t,"icon_url",new Ae(s));const i=e.model_url;le(t,"model_url",new Ae(i));const r=e.skill;r===void 0||le(t,"skill",vP(r));const a=e.attack_range;return a===void 0||le(t,"attack_range",Re(a)),new ke(t)}function wP(e,t){let n=r2,o,s,i,r,a,c=pm;if(e.$tag===6){const O=e._0,I=ae(O,"name");if(I!==void 0){const q=I,G="name",Y=ws(q,new et(t,G));let U;if(Y.$tag===1)U=Y._0;else return Y;o=U}const R=ae(O,"copper_type");if(R!==void 0){const q=R,G="copper_type",Y=Nf(q,new et(t,G));let U;if(Y.$tag===1)U=Y._0;else return Y;a=U}const D=ae(O,"description");if(D!==void 0){const q=D,G="description",Y=ws(q,new et(t,G));let U;if(Y.$tag===1)U=Y._0;else return Y;r=U}const x=ae(O,"icon_url");if(x!==void 0){const q=x,G="icon_url",Y=ws(q,new et(t,G));let U;if(Y.$tag===1)U=Y._0;else return Y;i=U}const z=ae(O,"model_url");if(z!==void 0){const q=z,G="model_url",Y=ws(q,new et(t,G));let U;if(Y.$tag===1)U=Y._0;else return Y;s=U}const ge=ae(O,"skill");if(ge!==void 0){const q=ge,G="skill",Y=SP(q,new et(t,G));let U;if(Y.$tag===1)U=Y._0;else return Y;n=new dm(U)}const re=ae(O,"attack_range");if(re!==void 0){const q=re,G="attack_range",Y=io(q,new et(t,G));let U;if(Y.$tag===1)U=Y._0;else return Y;c=new Au(U)}}else return new Ro(new je({_0:t,_1:"Expected object to deserialize CopperInfo"}));const l=n;let u;l.$tag===1?u=l._0:u=void 0;const _=o;let $;if(_===void 0)return new Ro(new je({_0:t,_1:"Missing field name"}));$=_;const d=s;let p;if(d===void 0)return new Ro(new je({_0:t,_1:"Missing field model_url"}));p=d;const b=i;let g;if(b===void 0)return new Ro(new je({_0:t,_1:"Missing field icon_url"}));g=b;const m=r;let w;if(m===void 0)return new Ro(new je({_0:t,_1:"Missing field description"}));w=m;const y=a;let v;if(y===void 0)return new Ro(new je({_0:t,_1:"Missing field copper_type"}));v=y;const k=c;let L;return k.$tag===1?L=k._0:L=void 0,new mm({name:$,copper_type:v,description:w,icon_url:g,model_url:p,skill:u,attack_range:L})}function vP(e){const t=Me([]),n=e.name;le(t,"name",new Ae(n));const o=e.description;le(t,"description",new Ae(o));const s=e.resource_url;le(t,"resource_url",new Ae(s));const i=e.cool_down;return i===void 0||le(t,"cool_down",Re(i)),new ke(t)}function SP(e,t){let n,o,s,i=pm;if(e.$tag===6){const b=e._0,g=ae(b,"name");if(g!==void 0){const k=g,L="name",P=ws(k,new et(t,L));let O;if(P.$tag===1)O=P._0;else return P;o=O}const m=ae(b,"description");if(m!==void 0){const k=m,L="description",P=ws(k,new et(t,L));let O;if(P.$tag===1)O=P._0;else return P;s=O}const w=ae(b,"resource_url");if(w!==void 0){const k=w,L="resource_url",P=ws(k,new et(t,L));let O;if(P.$tag===1)O=P._0;else return P;n=O}const y=ae(b,"cool_down");if(y!==void 0){const k=y,L="cool_down",P=io(k,new et(t,L));let O;if(P.$tag===1)O=P._0;else return P;i=new Au(O)}}else return new qi(new je({_0:t,_1:"Expected object to deserialize Skill"}));const r=n;let a;if(r===void 0)return new qi(new je({_0:t,_1:"Missing field resource_url"}));a=r;const c=o;let l;if(c===void 0)return new qi(new je({_0:t,_1:"Missing field name"}));l=c;const u=s;let _;if(u===void 0)return new qi(new je({_0:t,_1:"Missing field description"}));_=u;const $=i;let d;return $.$tag===1?d=$._0:d=void 0,new fm({name:l,description:_,resource_url:a,cool_down:d})}function Rt(e,t,n){return V6(Math.fround(e*Math.fround(v6(n,(t-1|0)+0))))}function Vu(e){switch(e){case 0:return qt(Math.fround(150),2,Math.fround(15),Math.fround(20),Math.fround(10));case 1:return qt(Math.fround(50),3,Math.fround(20),Math.fround(5),Math.fround(10));case 4:return qt(Math.fround(100),3,Math.fround(10),Math.fround(10),Math.fround(10));case 3:return qt(Math.fround(80),3,Math.fround(5),Math.fround(8),Math.fround(10));default:return qt(Math.fround(80),4,Math.fround(0),Math.fround(8),Math.fround(10))}}function U$(e){const t=e.level+1|0,n=Vu(e.copper_type),o=e.attribute.speed;switch(e.copper_type){case 0:return qt(Rt(n.health,t,Math.fround(1.35)),o,Rt(n.attack,t,Math.fround(1.28)),Rt(n.defense,t,Math.fround(1.37)),Rt(n.dodge,t,Math.fround(1.19)));case 1:return qt(Rt(n.health,t,Math.fround(1.22)),o,Rt(n.attack,t,Math.fround(1.4)),Rt(n.defense,t,Math.fround(1.27)),Rt(n.dodge,t,Math.fround(1.19)));case 4:return qt(Rt(n.health,t,Math.fround(1.38)),o,Rt(n.attack,t,Math.fround(1.16)),Rt(n.defense,t,Math.fround(1.27)),Rt(n.dodge,t,Math.fround(1.19)));case 3:return qt(Rt(n.health,t,Math.fround(1.3)),o,Rt(n.attack,t,Math.fround(1.2)),Rt(n.defense,t,Math.fround(1.27)),Rt(n.dodge,t,Math.fround(1.19)));default:return qt(Rt(n.health,t,Math.fround(1.3)),o,Rt(n.attack,t,Math.fround(1.27)),Rt(n.defense,t,Math.fround(1.16)),Rt(n.dodge,t,Math.fround(1.19)))}}function kP(e){return{slot1:e.slot1,slot2:e.slot2,is_slot2_locked:!1}}function MP(e){return e.level===4?{...e,attribute:U$(e),level:e.level+1|0,equipment_slot:kP(e.equipment_slot)}:{...e,attribute:U$(e),level:e.level+1|0}}function CP(e){let t;switch(e){case 1:{t=5;break}case 2:{t=10;break}case 3:{t=20;break}case 4:{t=30;break}default:tt(Qe,Qw),t=0}return kt([{_0:2,_1:t}])}function jf(){return{slot1:void 0,slot2:void 0,is_slot2_locked:!0}}function cl(e){const t=nx(LM,e),n=ei(Pi);return{id:n,level:1,suffix:n,live_left:5,attribute:Vu(t.copper_type),copper_type:t.copper_type,equipment_slot:jf(),copper_info:t}}function co(e,t){return e+$3(ym,(t-e|0)+1|0)|0}function Pr(e){const t=d3(ym);return Ef(`12121:${String(t)}`),t<=e}function xP(){return pf([ev,tv,nv,sv,ov])}function PP(){return pf([iv,rv,av,cv,lv])}function Gn(e,t){const n=ff(e,t);return n===void 0?ne():n}function Hf(e,t,n){const o=ff(e,t);let s;if(o===void 0?s=ne():s=o,s<n){tt(Qe,uv);return}else{Fu(e,t,s-n|0);return}}function Lc(e,t){const n=t.cost,o=n.length;let s=0;for(;;){const i=s;if(i<o){const r=n[i],a=r._0,c=r._1;if(Gn(e,a)<c)return!1;s=i+1|0;continue}else break}return!0}function Ic(e,t){const n=t.cost,o=n.length;let s=0;for(;;){const i=s;if(i<o){const r=n[i],a=r._0,c=r._1;Hf(e,a,c),s=i+1|0;continue}else return}}function so(e,t,n){Fu(e,t,Gn(e,t)+n|0)}function LP(){return{resources:xP(),equipments:[]}}function IP(e,t){return{resources:e,equipments:t}}function qu(e,t){const n=t.length;let o=0;for(;;){const s=o;if(s<n){const i=t[s],r=i.item_type;if(r.$tag===0){const c=r._0;so(e.resources,c,i.count)}else{const c=r._0;Lx(e.equipments,c)}o=s+1|0;continue}else return}}function TP(e,t){return{item_type:e,count:t}}function EP(){const e=cl(""),t=cl(""),n=cl("");return{coppers:da(da(da(void 0,e.id,e),t.id,t),n.id,n)}}function AP(){return{coppers:void 0}}function Wu(e,t){return{coppers:da(e.coppers,t.id,t)}}function ma(e,t){const n=g6(e.coppers,t);return n===void 0?ne():n}function Ff(e){return Hx(w6(e.coppers))}function GP(e,t){return{coppers:b6(e.coppers,t)}}function RP(){const e=ei(Pi),t=co(0,or.length-1|0);S(or,t);const n=or[t],o=Vu(n.copper_type);return{id:e,level:1,suffix:e,live_left:5,attribute:o,copper_type:n.copper_type,equipment_slot:jf(),copper_info:n}}function OP(e){if(Gn(e,2)>=10)return Hf(e,2,10),RP();tt(Qe,_v)}function DP(){const e=LP();return{warehouse:EP(),bag:e}}function NP(e,t){return{warehouse:e,bag:t}}function jP(e){const t=e.bag.resources,n=Me([{_0:"SpiritalSpark",_1:Re(Gn(t,2))},{_0:"RecallGear",_1:Re(Gn(t,1))},{_0:"ResonantCrystal",_1:Re(Gn(t,4))},{_0:"RefinedCopper",_1:Re(Gn(t,3))},{_0:"HeartCrystalDust",_1:Re(Gn(t,0))}]);return Ye(new ke(n))}function HP(e){const t=e.warehouse,n=Me([{_0:"coppers",_1:yx(Ff(t))}]);return Ye(new ke(n))}function FP(e){const t=OP(e.bag.resources);let n;if(t===void 0){const o="error",s={_0:"type",_1:new Ae(o)},i="",r=Me([s,{_0:"content",_1:new Ae(i)}]);n=new ke(r)}else{const s=t;e.warehouse=Wu(e.warehouse,s);const i="success",r=Me([{_0:"type",_1:new Ae(i)},{_0:"copper",_1:Pc(s)}]);n=new ke(r)}return Ye(n)}function UP(e,t){const n=e.warehouse,o=ma(n,t),s=CP(o.level);let i;if(Lc(e.bag.resources,s)){const r=MP(o);Ic(e.bag.resources,s),e.warehouse=GP(e.warehouse,t),e.warehouse=Wu(e.warehouse,r);const a="success",c=Me([{_0:"type",_1:new Ae(a)}]);i=new ke(c)}else{const r="error",a={_0:"type",_1:new Ae(r)},c="",l=Me([a,{_0:"content",_1:new Ae(c)}]);i=new ke(l)}return Ye(i)}function BP(e){const t=kt([$v,dv,pv,mv]);let n;if(Lc(e.bag.resources,t)){Ic(e.bag.resources,t),so(e.bag.resources,2,1);const o="success",s=Me([{_0:"type",_1:new Ae(o)}]);n=new ke(s)}else{const o="error",s={_0:"type",_1:new Ae(o)},i="",r=Me([s,{_0:"content",_1:new Ae(i)}]);n=new ke(r)}return Ye(n)}function Uf(e){const t=Me([]);return le(t,"id",Re(e.id)),le(t,"original_id",Re(e.original_id)),le(t,"copper",Pc(e.copper)),le(t,"can_move",xn(e.can_move)),le(t,"can_attack",xn(e.can_attack)),le(t,"can_summon",xn(e.can_summon)),le(t,"can_build",xn(e.can_build)),le(t,"position",bn(e.position)),le(t,"now_health",Pn(e.now_health)),le(t,"attribute",xc(e.attribute)),new ke(t)}function Bf(e){const t=Me([]);return le(t,"id",Re(e.id)),le(t,"owned",xn(e.owned)),le(t,"can_move",xn(e.can_move)),le(t,"can_attack",xn(e.can_attack)),le(t,"position",bn(e.position)),le(t,"now_health",Pn(e.now_health)),le(t,"enemy_base",Vf(e.enemy_base)),new ke(t)}function zP(e){const t=Me([]),n=e.name;le(t,"name",new Ae(n)),le(t,"resource_type",Cc(e.resource_type));const o=e.model_url;return le(t,"model_url",new Ae(o)),new ke(t)}function zf(e){const t=Me([]);le(t,"id",Re(e.id)),le(t,"owned",xn(e.owned)),le(t,"position",bn(e.position)),le(t,"can_attack",xn(e.can_attack));const n=e.resource_type;return n===void 0||le(t,"resource_type",Cc(n)),le(t,"now_health",Pn(e.now_health)),le(t,"structure_base",qf(e.structure_base)),new ke(t)}function Vf(e){const t=Me([]);le(t,"level",Re(e.level)),le(t,"health",Pn(e.health)),le(t,"attack",Pn(e.attack)),le(t,"defense",Pn(e.defense)),le(t,"dodge",Pn(e.dodge)),le(t,"attack_range",Re(e.attack_range)),le(t,"speed",Re(e.speed));const n=e.name;le(t,"name",new Ae(n));const o=e.enemy_type;le(t,"enemy_type",new Ae(o));const s=e.description;le(t,"description",new Ae(s));const i=e.asset_url;le(t,"asset_url",new Ae(i));const r=e.model_url;return le(t,"model_url",new Ae(r)),le(t,"drop_items",kx(e.drop_items)),le(t,"summon_cost",Gf(e.summon_cost)),new ke(t)}function VP(e){const t=Me([]);return le(t,"id",Re(e.id)),le(t,"material_base",zP(e.material_base)),new ke(t)}function qf(e){const t=Me([]),n=e.name;le(t,"name",new Ae(n)),le(t,"health",Pn(e.health)),le(t,"can_move",xn(e.can_move)),le(t,"can_attack",xn(e.can_attack)),le(t,"attack_range",Re(e.attack_range));const o=e.description;le(t,"description",new Ae(o));const s=e.asset_url;le(t,"asset_url",new Ae(s));const i=e.model_url;return le(t,"model_url",new Ae(i)),le(t,"attribute",xc(e.attribute)),le(t,"cost",Gf(e.cost)),new ke(t)}function qP(e,t){switch(e){case 0:{t.method_0(t.self,"PositiveX");return}case 1:{t.method_0(t.self,"NegativeX");return}case 2:{t.method_0(t.self,"PositiveY");return}default:{t.method_0(t.self,"NegativeY");return}}}function Wf(e,t,n,o){const s=ei(Pi),i=e.can_attack,r=e.health,a={id:s,owned:t,position:o,can_attack:i,resource_type:n,now_health:r,structure_base:e};return lf(Ks,a.id,a),a}function Ku(e){const t=QC(Ks,e);return t===void 0?ne():t}function Ju(e){const t=Me([{_0:"id",_1:Re(e)}]);tt(Qe,{type_msg:"clear_state",content:Ye(new ke(t))})}function Xu(e,t){const n={_0:"id",_1:Re(e)},o=wc(t),s=Me([n,{_0:"can_attack",_1:new Ae(o)}]);tt(Qe,{type_msg:"display_can_attack",content:Ye(new ke(s))})}function rr(e){if(Ju(e.id),e.structure_base.can_attack){Xu(e.id,!0);return}else return}function Ii(e){const t=[];let o=-e|0;for(;;){const s=o;if(s<=e){let r=-e|0;for(;;){const a=r;if(a<=e){const c=(s<0?-s|0:s)+(a<0?-a|0:a)|0;c<=e&&c!==0&&wo(t,{_0:s,_1:a}),r=a+1|0;continue}else break}o=s+1|0;continue}else break}return t}function Kf(e,t){const n=t._0,o=t._1,s=e.index_position,i=s._0,r=s._1;return n>=i&&n<(i+9|0)&&o>=r&&o<(r+9|0)}function ti(e,t){const n=e.rooms,o=n.length;let s=0;for(;;){const i=s;if(i<o){const r=n[i];if(Kf(r,t))return r;s=i+1|0;continue}else break}}function Us(e,t){const n=e.rooms,o=n.length;let s=0;for(;;){const i=s;if(i<o){const r=n[i];if(Kf(r,t)){const a=t._0-r.index_position._0|0,c=t._1-r.index_position._1|0;return{_0:r,_1:{_0:a,_1:c}}}s=i+1|0;continue}else break}}function Yu(e,t){const n=ti(e,t);if(n===void 0)return ne();{const s=n,i=Us(e,t);if(i===void 0)return ne();{const c=i._1;return{_0:s,_1:c}}}}function vo(e,t){const n=Yu(e,t),o=n._0,s=n._1;return bt(yt(o.blocks,s._0),s._1).occupant}function Bo(e,t){const n=ti(e,t);if(n!==void 0){const s=n,i=Us(e,t);if(i===void 0)ne();else{const c=i._1,l=bt(yt(s.blocks,c._0),c._1).occupant;let u;return l.$tag===4?u=!0:u=!1,!u}}return!1}function WP(e,t){const n=e.structure_base.attack_range,o=Ii(n),s=[],i=o.length;let r=0;for(;;){const a=r;if(a<i){const c=o[a],l={_0:e.position._0+c._0|0,_1:e.position._1+c._1|0};if(Bo(t,l)){const u=vo(t,l);if(e.owned)switch(u.$tag){case 1:{const $=u._0;e.structure_base.name===""&&Sn(s,new Ci($));break}case 0:{const $=u._0;$.owned===!1&&Sn(s,new Wo($));break}case 3:{const $=u._0;$.owned===!1&&Sn(s,new Ko($));break}}else switch(u.$tag){case 1:{const $=u._0;Sn(s,new Ci($));break}case 0:{const $=u._0;$.owned===!0&&Sn(s,new Wo($));break}case 3:{const $=u._0;$.owned===!0&&Sn(s,new Ko($));break}}}r=a+1|0;continue}else break}return s}function Tc(e,t){return e.now_health=Math.fround(e.now_health-t),Math.fround(e.now_health<=Math.fround(0))}function KP(e,t,n){const o=Me([{_0:"id",_1:Re(t)},{_0:"position",_1:bn(n)},{_0:"copper",_1:Uf(e)}]);tt(Qe,{type_msg:"set_copper",content:Ye(new ke(o))})}function Zu(e,t,n){const o=Me([{_0:"id",_1:Re(t)},{_0:"position",_1:bn(n)},{_0:"enemy",_1:Bf(e)}]);tt(Qe,{type_msg:"set_enemy",content:Ye(new ke(o))})}function Jf(e,t,n){const o=Me([{_0:"id",_1:Re(t)},{_0:"position",_1:bn(n)},{_0:"structure",_1:zf(e)}]);tt(Qe,{type_msg:"set_structure",content:Ye(new ke(o))})}function JP(e,t,n){const o=Me([{_0:"id",_1:Re(t)},{_0:"position",_1:bn(n)},{_0:"material",_1:VP(e)}]);tt(Qe,{type_msg:"set_material",content:Ye(new ke(o))})}function rs(e){const t=Me([{_0:"id",_1:Re(e)}]);tt(Qe,{type_msg:"remove_unit",content:Ye(new ke(t))})}function zo(e,t){const n={_0:"id",_1:Re(e)},o=V3(t),s=Me([n,{_0:"direction",_1:new Ae(o)}]);tt(Qe,{type_msg:"change_direction",content:Ye(new ke(s))})}function Fa(e,t){const n=Me([{_0:"id",_1:Re(e)},{_0:"to",_1:bn(t)}]);tt(Qe,{type_msg:"move_to",content:Ye(new ke(n))})}function Xf(e,t){const n={_0:"id",_1:Re(e)},o=wc(t),s=Me([n,{_0:"can_move",_1:new Ae(o)}]);tt(Qe,{type_msg:"display_can_move",content:Ye(new ke(s))})}function XP(e,t){const n={_0:"id",_1:Re(e)},o=wc(t),s=Me([n,{_0:"can_summon",_1:new Ae(o)}]);tt(Qe,{type_msg:"display_can_summon",content:Ye(new ke(s))})}function YP(e,t){const n={_0:"id",_1:Re(e)},o=wc(t),s=Me([n,{_0:"can_build",_1:new Ae(o)}]);tt(Qe,{type_msg:"display_can_build",content:Ye(new ke(s))})}function Xo(e){const t=Me([{_0:"id",_1:Re(e)}]);tt(Qe,{type_msg:"animate_move",content:Ye(new ke(t))})}function ZP(){const e=Me([]);tt(Qe,{type_msg:"animate_reset",content:Ye(new ke(e))})}function QP(e,t){const n=Me([{_0:"room_position",_1:bn(e)},{_0:"size",_1:Re(t)}]);tt(Qe,{type_msg:"put_room_blocks",content:Ye(new ke(n))})}function Ua(e){const t=Me([{_0:"position",_1:bn(e)}]);tt(Qe,{type_msg:"set_move_block",content:Ye(new ke(t))})}function oo(e){const t=Me([{_0:"position",_1:bn(e)}]);tt(Qe,{type_msg:"set_attack_block",content:Ye(new ke(t))})}function Ba(e){const t=Me([{_0:"position",_1:bn(e)}]);tt(Qe,{type_msg:"set_can_summon_blocks",content:Ye(new ke(t))})}function rn(e){const t=Me([{_0:"position",_1:bn(e)}]);tt(Qe,{type_msg:"clear_block",content:Ye(new ke(t))})}function Qu(e){const t=Me([{_0:"id",_1:Re(e)}]);tt(Qe,{type_msg:"attack_complete",content:Ye(new ke(t))})}function jn(e,t,n){const o=Me([{_0:"id",_1:Re(e)},{_0:"now_health",_1:Pn(t)},{_0:"max_health",_1:Pn(n)}]);tt(Qe,{type_msg:"update_health",content:Ye(new ke(o))})}function Yf(){const e=Me([]);tt(Qe,{type_msg:"game_over",content:Ye(new ke(e))})}function Zf(){const e=Me([]);tt(Qe,{type_msg:"success",content:Ye(new ke(e))})}function Qf(e){const t=[],n=Ta.length;let o=0;for(;;){const i=o;if(i<n){const r=Ta[i];r.level<=e&&Rx(t,r),o=i+1|0;continue}else break}const s=t;return x3(s,co(0,s.length-1|0))}function ll(e){let t=co(0,8),n=co(0,8);for(;ps(e,{_0:t,_1:n});){t=co(0,8),n=co(0,8);continue}return{_0:t,_1:n}}function ar(e,t,n){const o=!n,s=!n,i=ei(Pi),r=e.health,a={id:i,owned:n,can_move:o,can_attack:s,position:t,now_health:r,enemy_base:e};return cf(Hn,a.id,a),a}function eL(){return{occupant:gr}}function B$(e){return{id:ei(Pi),material_base:e}}function eh(e,t,n){let o=e;const s=[];let i=0;for(;;){const r=i;if(r<9){const a=[];let c=0;for(;;){const l=c;if(l<9){Tx(a,eL()),c=l+1|0;continue}else break}Ex(s,a),i=r+1|0;continue}else break}if(o===6&&wr.val===!1)bt(yt(s,3),4).occupant=new $o(ar(A$(zl,"BOSS"),{_0:t._0+3|0,_1:t._1+4|0},!1)),bt(yt(s,5),4).occupant=new $o(ar(A$(zl,"BOSS"),{_0:t._0+5|0,_1:t._1+4|0},!1)),wr.val=!0;else{o===6&&(o=5),bt(yt(s,4),4).occupant=new Gu(Wf(tx(Sm,""),!1,void 0,{_0:t._0+4|0,_1:t._1+4|0}));const r=Ns(jv,o);let a=0;for(;;){const c=a;if(c<r){const l=Qf(o),u=ll(n);is(n,u);const _={_0:t._0+u._0|0,_1:t._1+u._1|0};bt(yt(s,u._0),u._1).occupant=new $o(ar(l,_,!1)),a=c+1|0;continue}else break}if(Pr(.4)){const c=ll(n);is(n,c),bt(yt(s,c._0),c._1).occupant=new Ul(B$(Qk))}if(Pr(.4)){const c=ll(n);is(n,c),bt(yt(s,c._0),c._1).occupant=new Ul(B$(e5))}}return{level:o,index_position:t,blocks:s}}function tL(e){const t=e.blocks,n=t.length;let o=0;for(;;){const s=o;if(s<n){const i=t[s],r=i.length;let a=0;for(;;){const c=a;if(c<r){if(i[c].occupant.$tag===4)return!1;a=c+1|0;continue}else break}o=s+1|0;continue}else break}return!0}function nL(e){const t=[];let n=0;for(;;){const o=n;if(o<9){let s=0;for(;;){const i=s;if(i<9){bt(yt(e.blocks,o),i).occupant.$tag===4&&wo(t,{_0:o,_1:i}),s=i+1|0;continue}else break}n=o+1|0;continue}else break}return t}function sL(e,t){const n=t._0,o=t._1,s=e.index_position,i=s._0,r=s._1,a=n-i|0,c=o-r|0;return a<0?c<0?{_0:5,_1:{_0:i-9|0,_1:r}}:c>=9?{_0:4,_1:{_0:i-9|0,_1:r+9|0}}:{_0:0,_1:{_0:i-9|0,_1:r}}:a>=9?c<0?{_0:7,_1:{_0:i+9|0,_1:r}}:c>=9?{_0:6,_1:{_0:i+9|0,_1:r+9|0}}:{_0:1,_1:{_0:i+9|0,_1:r}}:c<0?{_0:3,_1:{_0:i,_1:r-9|0}}:{_0:2,_1:{_0:i,_1:r+9|0}}}function oL(e){const t=JC([]),n=e.rooms,o=n.length;let s=0;for(;;){const i=s;if(i<o){const r=n[i],a=r.index_position,c=a._0,l=a._1;let u=0;for(;;){const _=u;if(_<9){let $=0;for(;;){const d=$;if(d<9){const p={_0:c+_|0,_1:l+d|0};df(t,p,bt(yt(r.blocks,_),d)),$=d+1|0;continue}else break}u=_+1|0;continue}else break}s=i+1|0;continue}else break}return t}function iL(e){const t=oL(e),n=mf([]),o={map:n},s=dx(t);for(;;){const i=gx(s);if(i===void 0)break;{const a=i,c=a._0;a._1.occupant.$tag===4?Oa(n,c,!0):Oa(n,c,!1);continue}}return o}function rL(e,t){const n=hf(e.map,t);return n===-1?!1:n}function aL(e,t,n){const o=Ii(t),s=[],i=o.length;let r=0;for(;;){const a=r;if(a<i){const c=o[a],l={_0:n._0+c._0|0,_1:n._1+c._1|0};rL(e,l)&&wo(s,l),r=a+1|0;continue}else break}return s}function sa(e,t){const n=e._0>t._0?e._0-t._0|0:t._0-e._0|0,o=e._1>t._1?e._1-t._1|0:t._1-e._1|0;return n+o|0}function cL(e,t,n,o,s){if(t._0===n._0&&t._1===n._1)return t;const i=[{position:t,g_cost:0,h_cost:sa(t,n),f_cost:sa(t,n)}],r=mf([]),a=WC([]);for(;i.length>0;){let c=0,l=Zs(i,0);const u=i.length;let _=1;for(;;){const w=_;if(w<u){Zs(i,w).f_cost<l.f_cost&&(l=Zs(i,w),c=w),_=w+1|0;continue}else break}cP(i,c),Oa(r,l.position,!0);const $=sa(l.position,n);let d;const p=l.position;if(p._0===n._0&&p._1===n._1?d=!0:d=$<=s,d){let w=l.position,y=l.position;for(;;){const v=ex(a,w);if(v===void 0)break;{const L=v;y=w,w=L;const P=w;if(P._0===t._0&&P._1===t._1)break;continue}}return y}const b=aL(e,o,l.position),g=b.length;let m=0;for(;;){const w=m;if(w<g){e:{const y=b[w];if(hf(r,y)!==-1)break e;const k=l.g_cost+1|0;let L=!1,P=0;const O=i.length;let I=0;for(;;){const R=I;if(R<O){const D=Zs(i,R).position;if(D._0===y._0&&D._1===y._1){L=!0,P=R;break}I=R+1|0;continue}else break}if(L)k<Zs(i,P).g_cost&&(Zs(i,P).g_cost=k,Zs(i,P).f_cost=k+Zs(i,P).h_cost|0,Zl(a,y,l.position));else{const R=sa(y,n),D=k+R|0;Ox(i,{position:y,g_cost:k,h_cost:R,f_cost:D}),Zl(a,y,l.position)}break e}m=w+1|0;continue}else break}continue}}function th(e,t){Ax(e.rooms,t)}function lL(e){const t=eh(1,t5,e),n={rooms:[]};return th(n,t),n}function uL(e,t){const n=ti(e,t);if(n===void 0)return ne();{const s=n,i=Us(e,t);if(i===void 0)return ne();{const c=i._1;return bt(yt(s.blocks,c._0),c._1)}}}function e_(e,t){const n=ti(e,t);if(n!==void 0){const s=n,i=Us(e,t);if(i===void 0)ne();else{const c=i._1,l=bt(yt(s.blocks,c._0),c._1).occupant;let u;return l.$tag===4?u=!0:u=!1,!u}}return!0}function ul(e,t){if(ti(e,t)!==void 0)return 0;let o=999999;const s=e.rooms,i=s.length;let r=0;for(;;){const a=r;if(a<i){const l=s[a].index_position,u=l._0,_=l._1,$=t._0,d=t._1,p=$<u?u-$|0:$>=(u+9|0)?($-(u+9|0)|0)+1|0:0,b=d<_?_-d|0:d>=(_+9|0)?(d-(_+9|0)|0)+1|0:0,g=p>b?p:b;g<o&&(o=g),r=a+1|0;continue}else break}return o}function Kn(e,t){const n=Yu(e,t),o=n._0,s=n._1;bt(yt(o.blocks,s._0),s._1).occupant=gr}function t_(e,t,n){const o=Yu(e,t),s=o._0,i=o._1;bt(yt(s.blocks,i._0),i._1).occupant=n}function nh(e){const t=e.index_position,n=t._0,o=t._1;QP(e.index_position,9);let s=0;for(;;){const i=s;if(i<9){let r=0;for(;;){const a=r;if(a<9){const c={_0:n+i|0,_1:o+a|0},l=bt(yt(e.blocks,i),a).occupant;switch(l.$tag){case 4:break;case 0:{const _=l._0;Zu(_,_.id,c),jn(_.id,_.now_health,_.enemy_base.health);break}case 1:{const _=l._0;KP(_,_.id,c),jn(_.id,_.now_health,_.copper.attribute.health);break}case 3:{const _=l._0;Jf(_,_.id,c);break}default:{const _=l._0;JP(_,_.id,c)}}r=a+1|0;continue}else break}s=i+1|0;continue}else return}}function _L(e){return((e/4|0)+1|0)>=6?6:(e/4|0)+1|0}function $L(){return{map:lL(zm({buf:i5,start:0,end:3}))}}function Qn(e,t){if(t===0&&(ps(En,e)?Ua(e):ps(ir,e)?oo(e):ps(Ms,e)&&Ba(e)),t===1&&(ps(zt,e)||ps(ir,e)?oo(e):ps(Ms,e)&&Ba(e)),t===2)if(ps(zt,e)){oo(e);return}else if(ps(ir,e)){oo(e);return}else if(ps(En,e)){Ua(e);return}else return;else return}function dL(e){const t=Ku(e),n=Me([{_0:"structure",_1:zf(t)}]);tt(Qe,{type_msg:"handle_on_click_structure",content:Ye(new ke(n))})}function Is(){const e=sn(zt);for(;;){const t=on(e);if(t===void 0)break;{const o=t;rn(o),Qn(o,0);continue}}nn(zt)}function Ts(){const e=sn(En);for(;;){const t=on(e);if(t===void 0)break;{const o=t;rn(o),Qn(o,1);continue}}nn(En)}function Es(){const e=sn(Ms);for(;;){const t=on(e);if(t===void 0)break;{const o=t;rn(o),Qn(o,2);continue}}nn(Ms)}function Ec(e){switch(e.$tag){case 0:return e._0.position;case 1:return e._0.position;default:return e._0.position}}function pL(e,t){Ts(),Is(),Es();const n=Ku(t),o=WP(n,e),s=o.length;let i=0;for(;;){const r=i;if(r<s){const a=o[r],c=Ec(a);oo(c),is(zt,c),i=r+1|0;continue}else return}}function mL(){const e=sn(zt);for(;;){const t=on(e);if(t===void 0)break;{const o=t;rn(o),Qn(o,0);continue}}nn(zt)}function sh(e,t){if(Pr(e.attribute.dodge/100))return!1;const n=e.attribute.defense,o=Math.fround(t/Math.fround(t+Math.fround(Math.fround(1)*n))),s=Math.fround(t*o);return e.now_health=Math.fround(e.now_health-s),Math.fround(e.now_health<=Math.fround(0))}function oh(e,t){if(e.now_health=Math.fround(e.now_health+t),Math.fround(e.now_health>e.attribute.health)){e.now_health=e.attribute.health;return}else return}function Ac(e,t){if(Pr(e.enemy_base.dodge/100))return!1;const n=e.enemy_base.defense,o=Math.fround(t/Math.fround(t+Math.fround(Math.fround(1)*n))),s=Math.fround(t*o);return e.now_health=Math.fround(e.now_health-s),Math.fround(e.now_health<=Math.fround(0))}function n_(e){const t=[],n=e.enemy_base.drop_items,o=n.length;let s=0;for(;;){const i=s;if(i<o){const r=n[i],a=co(r._1._0,r._1._1);Ix(t,TP(new hm(r._0),a)),s=i+1|0;continue}else break}return t}function fL(e,t,n){Xo(e);const o=Ku(e),s=vo(n,t);switch(s.$tag){case 0:{const c=s._0;Ac(c,o.structure_base.attribute.attack)?(qu(It.val.bag,n_(c)),vc(Hn,c.id),rs(c.id),Kn(n,c.position)):jn(c.id,c.now_health,c.enemy_base.health),o.can_attack=!1,rr(o);break}case 1:{const c=s._0;o.owned?oh(c,o.structure_base.attribute.attack):(sh(c,o.structure_base.attribute.attack)&&(gf(bo,c.id),rs(c.id),Kn(n,c.position)),bo.size===0&&Yf()),jn(c.id,c.now_health,c.copper.attribute.health),o.can_attack=!1,rr(o);break}case 3:{const c=s._0;Tc(c,o.structure_base.attribute.attack)?(Sc(Ks,c.id),rs(c.id),Kn(n,c.position)):jn(c.id,c.now_health,c.structure_base.health),o.can_attack=!1,rr(o);break}case 4:break;default:Js()}const i=sn(zt);for(;;){const a=on(i);if(a===void 0)break;{const l=a;rn(l),Qn(l,0);continue}}nn(zt);let r;if(s.$tag===4?r=!0:r=!1,!r){Qu(e);return}}function _l(e,t,n){const o=e.copper_type;let s;switch(o){case 2:{s=!1;break}case 4:{s=!1;break}default:s=!0}const i=ei(Pi),r=e.copper_type;let a;r===4?a=!0:a=!1;const c=e.copper_type;let l;c===2?l=!0:l=!1;const u=e.attribute.health,_=e.attribute,$={id:i,original_id:t,copper:e,can_move:!0,can_attack:s,can_summon:a,can_build:l,position:n,now_health:u,attribute:_};return UC(bo,$.id,$),$}function Ss(e){Ju(e.id),Xf(e.id,e.can_move),Xu(e.id,e.can_attack),XP(e.id,e.can_summon),YP(e.id,e.can_build)}function hL(e){const t=It.val.warehouse,n=_l(ma(t,Ns(e,0)),Ns(e,0),r5),o=_l(ma(t,Ns(e,1)),Ns(e,1),a5),s=_l(ma(t,Ns(e,2)),Ns(e,2),c5);Lt.val=$L();const i=Lt.val;let r;i===void 0?r=ne():r=i;const a=r.map,c=k3(a.rooms,0);bt(yt(c.blocks,0),3).occupant=new wi(n),bt(yt(c.blocks,0),4).occupant=new wi(o),bt(yt(c.blocks,0),5).occupant=new wi(s),nh(c),zo(n.id,2),zo(o.id,2),zo(s.id,2),Ss(n),Ss(o),Ss(s)}function za(e){e:switch(e){case 0:return 1;case 1:return 0;case 2:return 2;case 3:return 3;case 4:break e;case 5:break e;case 6:break e;default:break e}return AM()}function Va(e,t){const n=t._0-e._0|0,o=t._1-e._1|0;return n!==0?n>0?2:3:o>0?0:1}function gL(){return Fx(yf(bo))}function bL(e){const t=[],n=e.position,o=n._0,s=n._1,i=gL(),r=i.length;let a=0;for(;;){const p=a;if(p<r){const b=i[p];al(t,{_0:b.position,_1:new Ci(b)}),a=p+1|0;continue}else break}Uu(Hn)(p=>(p.id!==e.id&&p.owned&&al(t,{_0:p.position,_1:new Wo(p)}),1)),Bu(Ks)(p=>(p.owned===!0&&al(t,{_0:p.position,_1:new Ko(p)}),1));let u=1e9,_;const $=t.length;let d=0;for(;;){const p=d;if(p<$){const b=t[p],g=b._0,m=g._0,w=g._1,y=b._1,v=m-o|0,k=v<0?-v|0:v,L=w-s|0,P=k+(L<0?-L|0:L)|0;P<u&&(u=P,_=y),d=p+1|0;continue}else break}return _}function s_(e,t){const n=e.enemy_base.attack_range,o=Ii(n),s=[],i=o.length;let r=0;for(;;){const a=r;if(a<i){const c=o[a],l={_0:e.position._0+c._0|0,_1:e.position._1+c._1|0};if(Bo(t,l)){const u=vo(t,l);if(e.owned)switch(u.$tag){case 0:{const $=u._0;$.owned===!1&&Sn(s,new Wo($));break}case 3:{const $=u._0;$.owned===!1&&Sn(s,new Ko($));break}}else switch(u.$tag){case 1:{const $=u._0;Sn(s,new Ci($));break}case 0:{const $=u._0;$.owned===!0&&Sn(s,new Wo($));break}case 3:{const $=u._0;$.owned===!0&&Sn(s,new Ko($));break}}}r=a+1|0;continue}else break}return s}function yL(e,t){const n=s_(t,e);if(n.length>0){const o=P3(n,0);switch(Xo(t.id),o.$tag){case 0:{const i=o._0;Ac(i,t.enemy_base.attack)?(vc(Hn,i.id),rs(i.id),Kn(e,i.position)):jn(i.id,i.now_health,i.enemy_base.health);break}case 1:{const i=o._0;if(sh(i,t.enemy_base.attack)){const a=i.copper;a.live_left=a.live_left-1|0,gf(bo,i.id),rs(i.id),Kn(e,i.position),bo.size===0&&Yf()}else jn(i.id,i.now_health,i.copper.attribute.health);break}default:{const i=o._0;Tc(i,t.enemy_base.attack)?(Sc(Ks,i.id),rs(i.id),Kn(e,i.position)):jn(i.id,i.now_health,i.structure_base.health)}}}else{const o=bL(t);if(o!==void 0){const r=Ec(o),a=iL(e),c=cL(a,t.position,r,t.enemy_base.speed,t.enemy_base.attack_range);if(c!==void 0){const u=c;Xo(t.id);const _=t.position;Kn(e,t.position),t.position=u,t_(e,t.position,new $o(t)),zo(t.id,za(Va(_,u))),Fa(t.id,u)}}}return 1}function wL(){const e=Lt.val;let t;e===void 0?t=ne():t=e;const n=t.map;Uu(Hn)(s=>s.owned===!1?yL(n,s):1)}function vL(){const e=sn(zt);for(;;){const s=on(e);if(s===void 0)break;rn(s)}nn(zt);const t=sn(En);for(;;){const s=on(t);if(s===void 0)break;rn(s)}nn(En);const n=sn(ir);for(;;){const s=on(n);if(s===void 0)break;rn(s)}nn(ir);const o=sn(Ms);for(;;){const s=on(o);if(s===void 0)break;rn(s)}nn(Ms)}function Lr(e){if(Ju(e.id),e.can_move&&Xf(e.id,!0),e.can_attack){Xu(e.id,!0);return}else return}function SL(){yf(bo)(o=>{o.can_move=!0;const s=o.copper.copper_type;let i;switch(s){case 2:{i=!1;break}case 4:{i=!1;break}default:i=!0}o.can_attack=i;const r=o.copper.copper_type;let a;r===4?a=!0:a=!1,o.can_summon=a;const c=o.copper.copper_type;let l;return c===2?l=!0:l=!1,o.can_build=l,Ss(o),1}),Uu(Hn)(o=>(o.owned&&(o.can_move=!0,o.can_attack=!0,Lr(o)),1)),Bu(Ks)(o=>(o.owned&&(o.structure_base.can_attack&&(o.can_attack=!0),rr(o)),1))}function kL(){Bu(Ks)(t=>{if(t.structure_base.name===""){const n=t.resource_type;if(n!==void 0){const s=n;so(It.val.bag.resources,s,2);const i={_0:"position",_1:bn(t.position)},r=q3(s),a={_0:"resource_type",_1:new Ae(r)},c=2,l=void 0,u=Me([i,a,{_0:"amount",_1:new Ar(c,l)}]);tt(Qe,{type_msg:"drill_resource_generate",content:Ye(new ke(u))})}}return 1})}function ML(){if(Pr(.2)){const e=Lt.val;let t;e===void 0?t=ne():t=e;const o=t.map.rooms,s=o.length;let i=0;for(;;){const r=i;if(r<s){e:{const a=o[r];if(tL(a))break e;const c=bt(yt(a.blocks,4),4).occupant;if(c.$tag===3&&c._0.structure_base.name===""){const _=a.level,$=Qf(_),d=nL(a),p=M3(d,co(0,d.length-1|0)),b={_0:a.index_position._0+p._0|0,_1:a.index_position._1+p._1|0},g=ar($,b,!1);bt(yt(a.blocks,p._0),p._1).occupant=new $o(g),Zu(g,g.id,b)}break e}i=r+1|0;continue}else return}}else return}function CL(){vL(),SL(),wL(),ZP(),ML(),kL()}function xL(){Lt.val=void 0,wr.val=!1,vr.val=!1,Sr.val=!1}function PL(e){Ts(),Is(),Es();const t=Nr(Hn,e);let n;t===void 0?n=ne():n=t;const o=Lt.val;let s;o===void 0?s=ne():s=o;const i=s.map,a=s_(n,i).length!==0,c=Me([{_0:"enemy",_1:Bf(n)},{_0:"has_attack_targets",_1:xn(a)}]);tt(Qe,{type_msg:"handle_on_click_enemy",content:Ye(new ke(c))})}function LL(e,t){Ts(),Is(),Es();const n=Nr(Hn,t);let o;n===void 0?o=ne():o=n;const s=s_(o,e),i=s.length;let r=0;for(;;){const a=r;if(a<i){const c=s[a],l=Ec(c);oo(l),is(zt,l),r=a+1|0;continue}else return}}function IL(){const e=sn(zt);for(;;){const t=on(e);if(t===void 0)break;{const o=t;rn(o),Qn(o,0);continue}}nn(zt)}function TL(e,t,n){Xo(e);const o=Nr(Hn,e);let s;o===void 0?s=ne():s=o;const i=vo(n,t);switch(i.$tag){case 0:{const l=i._0;Ac(l,s.enemy_base.attack)?(qu(It.val.bag,n_(l)),vc(Hn,l.id),rs(l.id),Kn(n,l.position),wr.val===!0&&(l.enemy_base.name==="BOSS"?vr.val=!0:l.enemy_base.name==="BOSS"&&(Sr.val=!0),vr.val===!0&&Sr.val===!0&&Zf())):jn(l.id,l.now_health,l.enemy_base.health),s.can_attack=!1,Lr(s);break}case 3:{const l=i._0;Tc(l,s.enemy_base.attack)?(Sc(Ks,l.id),rs(l.id),Kn(n,l.position)):jn(l.id,l.now_health,l.structure_base.health),s.can_attack=!1,Lr(s);break}case 4:break;default:Js()}const r=sn(zt);for(;;){const c=on(r);if(c===void 0)break;{const u=c;rn(u),Qn(u,0);continue}}nn(zt);let a;if(i.$tag===4?a=!0:a=!1,!a){Qu(e);return}}function EL(e,t){const n=Ii(e.enemy_base.speed),o=[],s=n.length;let i=0;for(;;){const r=i;if(r<s){const a=n[r],c={_0:e.position._0+a._0|0,_1:e.position._1+a._1|0};e_(t,c)||wo(o,c),i=r+1|0;continue}else break}return o}function AL(e,t){Ts(),Is(),Es();const n=Nr(Hn,t);let o;n===void 0?o=ne():o=n;const s=EL(o,e),i=s.length;let r=0;for(;;){const a=r;if(a<i){const c=s[a];Ua(c),is(En,c),r=a+1|0;continue}else return}}function GL(){const e=sn(En);for(;;){const t=on(e);if(t===void 0)break;{const o=t;rn(o),Qn(o,1);continue}}nn(En)}function RL(e,t,n){Xo(e);const o=Nr(Hn,e);let s;if(o===void 0?s=ne():s=o,ti(n,t)===void 0)Js();else{const a=s.position,c=Us(n,a);let l;c===void 0?l=ne():l=c;const u=l._0,_=l._1,$=Us(n,t);let d;$===void 0?d=ne():d=$;const p=d._0,b=d._1;bt(yt(u.blocks,_._0),_._1).occupant=gr,bt(yt(p.blocks,b._0),b._1).occupant=new $o(s),s.position=t,zo(e,za(Va(a,t))),Fa(e,t)}s.can_move=!1,Lr(s);const r=sn(En);for(;;){const a=on(r);if(a===void 0)break;{const l=a;rn(l),Qn(l,1);continue}}nn(En)}function Cs(e){const t=ZC(bo,e);return t===void 0?ne():t}function OL(e){const t=e.copper.copper_info.attack_range;if(t===void 0)switch(e.copper.copper_type){case 0:return 1;case 1:return 3;case 3:return 1;case 4:return 0;default:return 0}else return t}function ih(e,t){const n=OL(e),o=Ii(n),s=[],i=o.length;let r=0;for(;;){const a=r;if(a<i){const c=o[a],l={_0:e.position._0+c._0|0,_1:e.position._1+c._1|0};if(Bo(t,l)){const u=vo(t,l);switch(u.$tag){case 1:{const $=u._0;$.copper.copper_type===3&&Sn(s,new Ci($));break}case 3:{const $=u._0;$.owned===!1&&Sn(s,new Ko($));break}case 0:{const $=u._0;$.owned===!1&&Sn(s,new Wo($));break}}}r=a+1|0;continue}else break}return s}function DL(e){Ts(),Is(),Es();const t=Cs(e),n=Lt.val;let o;n===void 0?o=ne():o=n;const s=o.map,r=ih(t,s).length!==0,a=Me([{_0:"copper",_1:Uf(Cs(e))},{_0:"has_attack_targets",_1:xn(r)}]);tt(Qe,{type_msg:"handle_on_click_copper",content:Ye(new ke(a))}),Ss(t)}function NL(e,t){Ts(),Is(),Es();const n=Cs(t),o=ih(n,e),s=o.length;let i=0;for(;;){const r=i;if(r<s){const a=o[r],c=Ec(a);oo(c),is(zt,c),i=r+1|0;continue}else return}}function jL(e,t,n){Xo(e);const o=Cs(e),s=vo(n,t);switch(s.$tag){case 0:{const c=s._0;if(Ac(c,o.attribute.attack)){qu(It.val.bag,n_(c)),vc(Hn,c.id),rs(c.id),Kn(n,c.position);const u=Lt.val;let _;u===void 0?_=ne():_=u;const $=_.map,d=vo($,c.position);let p;switch(d.$tag){case 4:{p="Empty";break}case 0:{p="Enemy";break}default:p="Other"}Ef(`deeeebug${p}`),wr.val===!0&&(c.enemy_base.name==="BOSS"?vr.val=!0:c.enemy_base.name==="BOSS"&&(Sr.val=!0),vr.val===!0&&Sr.val===!0&&Zf())}else jn(c.id,c.now_health,c.enemy_base.health);o.can_attack=!1,Ss(o);break}case 1:{const c=s._0;oh(c,o.attribute.attack),jn(c.id,c.now_health,c.copper.attribute.health),o.can_attack=!1,Ss(o);break}case 3:{const c=s._0;Tc(c,o.attribute.attack)?(Sc(Ks,c.id),rs(c.id),Kn(n,c.position)):jn(c.id,c.now_health,c.structure_base.health),o.can_attack=!1,Ss(o);break}case 4:break;default:Js()}const i=sn(zt);for(;;){const a=on(i);if(a===void 0)break;{const l=a;rn(l),Qn(l,0);continue}}nn(zt);let r;if(s.$tag===4?r=!0:r=!1,!r){Qu(e);return}}function HL(e,t){const n=Ii(e.attribute.speed),o=[],s=n.length;let i=0;for(;;){const r=i;if(r<s){e:{const a=n[r],c={_0:e.position._0+a._0|0,_1:e.position._1+a._1|0};if(ul(t,c)>1||Bo(t,c))break e;const u=a._0,_=a._1;if(u!==0&&_!==0){const $={_0:e.position._0+u|0,_1:e.position._1},d={_0:e.position._0,_1:e.position._1+_|0},p=ul(t,$),b=ul(t,d),g=p<=1&&!Bo(t,$),m=b<=1&&!Bo(t,d);if(!g&&!m)break e}wo(o,c);break e}i=r+1|0;continue}else break}return o}function FL(e,t){Ts(),Is(),Es();const n=Cs(t),o=HL(n,e),s=o.length;let i=0;for(;;){const r=i;if(r<s){const a=o[r];Ua(a),is(En,a),i=r+1|0;continue}else return}}function UL(e,t,n){Xo(e);const o=Cs(e);if(ti(n,t)===void 0){const r=o.position,a=Us(n,r);let c;a===void 0?c=ne():c=a;const l=c._0,u=c._1,$=sL(l,t)._1,d=t._0-$._0|0,p=t._1-$._1|0,b=_L(n.rooms.length+1|0),m=eh(b,$,zm({buf:[{_0:d,_1:p}],start:0,end:1}));th(n,m),bt(yt(l.blocks,u._0),u._1).occupant=gr,bt(yt(m.blocks,d),p).occupant=new wi(o),nh(m),zo(e,za(Va(r,t))),o.position=t,Fa(e,t)}else{const r=o.position,a=Us(n,r);let c;a===void 0?c=ne():c=a;const l=c._0,u=c._1,_=Us(n,t);let $;_===void 0?$=ne():$=_;const d=$._0,p=$._1;bt(yt(l.blocks,u._0),u._1).occupant=gr,bt(yt(d.blocks,p._0),p._1).occupant=new wi(o),o.position=t,zo(e,za(Va(r,t))),Fa(e,t)}o.can_move=!1,Ss(o);const i=sn(En);for(;;){const r=on(i);if(r===void 0)break;{const c=r;rn(c),Qn(c,1);continue}}nn(En)}function BL(e,t){const n=[],o=[l5,u5,_5,$5],s=o.length;let i=0;for(;;){const r=i;if(r<s){const a=o[r],c={_0:e.position._0+a._0|0,_1:e.position._1+a._1|0};e_(t,c)||wo(n,c),i=r+1|0;continue}else break}return n}function zL(e){Ts(),Is(),Es();const t=Cs(e),n=Lt.val;let o;n===void 0?o=ne():o=n;const s=o.map,i=BL(t,s),r=i.length;let a=0;for(;;){const c=a;if(c<r){const l=i[c];Ba(l),is(Ms,l),a=c+1|0;continue}else return}}function VL(e,t,n,o){const s=XC(zl,o);let i;s===void 0?i=ne():i=s;const r=i.summon_cost,a=Cs(e);if(Lc(It.val.bag.resources,r)){Ic(It.val.bag.resources,r);const c=ar(i,t,!0);t_(n,t,new $o(c)),Zu(c,c.id,t),Lr(c),a.can_summon=!1,Ss(a);return}else{const c="",l=Me([{_0:"message",_1:new Ae(c)}]);tt(Qe,{type_msg:"resource_not_enough",content:Ye(new ke(l))});return}}function qL(){const e=Me([{_0:"contents",_1:Sx(Ta)}]);tt(Qe,{type_msg:"get_summon_menu",content:Ye(new ke(e))})}function WL(){const e=Me([{_0:"contents",_1:Cx(Bl)}]);tt(Qe,{type_msg:"get_structure_menu",content:Ye(new ke(e))})}function KL(e,t,n){const o=[],s=[d5,p5,m5,f5],i=s.length;let r=0;for(;;){const a=r;if(a<i){const c=s[a],l={_0:e.position._0+c._0|0,_1:e.position._1+c._1|0};n?Bo(t,l)&&uL(t,l).occupant.$tag===2&&wo(o,l):e_(t,l)||wo(o,l),r=a+1|0;continue}else break}return o}function JL(e,t){Ts(),Is(),Es();const n=Cs(e),o=Lt.val;let s;o===void 0?s=ne():s=o;const i=s.map,r=KL(n,i,t===""),a=r.length;let c=0;for(;;){const l=c;if(l<a){const u=r[l];Ba(u),is(Ms,u),c=l+1|0;continue}else return}}function su(){const e=sn(Ms);for(;;){const t=on(e);if(t===void 0)break;{const o=t;rn(o),Qn(o,2);continue}}nn(Ms)}function XL(e,t,n,o){const s=YC(Sm,o);let i;s===void 0?i=ne():i=s;const r=i.cost,a=Cs(e);if(Lc(It.val.bag.resources,r)){Ic(It.val.bag.resources,r);let c;if(o===""){const u=vo(n,t);if(u.$tag===2){const $=u._0;Kn(n,t),rs($.id),c=$.material_base.resource_type}else c=ne()}else c=void 0;const l=Wf(i,!0,c,t);t_(n,t,new Gu(l)),Jf(l,l.id,t),a.can_build=!1,rr(l),su();return}else{const c="",l=Me([{_0:"message",_1:new Ae(c)}]);tt(Qe,{type_msg:"resource_not_enough",content:Ye(new ke(l))}),su();return}}function st(e){e:{const t=pa(e);let n;t===void 0?n=ne():n=t;const o=WM({str:n,start:0,end:n.length});if(o.$tag===1)return o._0;o._0;break e}return ne()}function YL(e){let t;e:{t:{const n=Rm({str:e,start:0,end:e.length},1024);if(n.$tag===1)t=n._0;else{n._0;break t}break e}t=ne()}e:if(t.$tag===6){const o=t._0,s=ae(o,"type");if(s===void 0)break e;{const r=s;if(r.$tag===4)switch(r._0){case"on_click_copper":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;DL(st(p));return}else break e}}case"on_attack_start":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=Lt.val;let w;m===void 0?w=ne():w=m,NL(w.map,st(g));return}}else break e}}case"on_attack_end":{Is();return}case"on_attack_apply":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=ae(d,"position");if(m===void 0)break e;{const y=m;if(y.$tag===6){const k=y._0,L=ae(k,"x");if(L===void 0)break e;{const O=L,I=ae(k,"y");if(I===void 0)break e;{const D=I,x=st(g),z={_0:st(O),_1:st(D)},ge=Lt.val;let re;ge===void 0?re=ne():re=ge,jL(x,z,re.map);return}}}else break e}}}else break e}}case"on_move_start":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=Lt.val;let w;m===void 0?w=ne():w=m,FL(w.map,st(g));return}}else break e}}case"on_move_end":{Ts();return}case"on_move_apply":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=ae(d,"position");if(m===void 0)break e;{const y=m;if(y.$tag===6){const k=y._0,L=ae(k,"x");if(L===void 0)break e;{const O=L,I=ae(k,"y");if(I===void 0)break e;{const D=I,x=st(g),z={_0:st(O),_1:st(D)},ge=Lt.val;let re;ge===void 0?re=ne():re=ge,UL(x,z,re.map);return}}}else break e}}}else break e}}case"on_game_start":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"ids");if(p===void 0)break e;{const m=Km(Om(p)),w=new Array(m.length),y=m.length;let v=0;for(;;){const k=v;if(k<y){const L=m[k];w[k]=st(L),v=k+1|0;continue}else break}hL(w);return}}else break e}}case"on_game_round_pass":{CL();return}case"on_click_enemy":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;PL(st(p));return}else break e}}case"on_enemy_attack_start":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=Lt.val;let w;m===void 0?w=ne():w=m,LL(w.map,st(g));return}}else break e}}case"on_enemy_attack_end":{IL();return}case"on_enemy_attack_apply":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=ae(d,"position");if(m===void 0)break e;{const y=m;if(y.$tag===6){const k=y._0,L=ae(k,"x");if(L===void 0)break e;{const O=L,I=ae(k,"y");if(I===void 0)break e;{const D=I,x=st(g),z={_0:st(O),_1:st(D)},ge=Lt.val;let re;ge===void 0?re=ne():re=ge,TL(x,z,re.map);return}}}else break e}}}else break e}}case"on_enemy_move_start":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=Lt.val;let w;m===void 0?w=ne():w=m,AL(w.map,st(g));return}}else break e}}case"on_enemy_move_end":{GL();return}case"on_enemy_move_apply":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=ae(d,"position");if(m===void 0)break e;{const y=m;if(y.$tag===6){const k=y._0,L=ae(k,"x");if(L===void 0)break e;{const O=L,I=ae(k,"y");if(I===void 0)break e;{const D=I,x=st(g),z={_0:st(O),_1:st(D)},ge=Lt.val;let re;ge===void 0?re=ne():re=ge,RL(x,z,re.map);return}}}else break e}}}else break e}}case"on_get_summon_menu":{qL();return}case"on_summon_start":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;zL(st(p));return}else break e}}case"on_summon_apply":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=ae(d,"position");if(m===void 0)break e;{const y=m;if(y.$tag===6){const k=y._0,L=ae(k,"x");if(L===void 0)break e;{const O=L,I=ae(k,"y");if(I===void 0)break e;{const D=I,x=ae(d,"name");if(x===void 0)break e;{const ge=x,re=st(g),he={_0:st(O),_1:st(D)},q=Lt.val;let G;q===void 0?G=ne():G=q;const Y=G.map,U=pa(ge);let j;U===void 0?j=ne():j=U,VL(re,he,Y,j);return}}}}else break e}}}else break e}}case"on_summon_end":{Es();return}case"on_click_structure":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;dL(st(p));return}else break e}}case"on_get_structure_menu":{WL();return}case"on_structure_build_start":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=ae(d,"name");if(m===void 0)break e;{const y=m,v=st(g),k=pa(y);let L;k===void 0?L=ne():L=k,JL(v,L);return}}}else break e}}case"on_structure_build_apply":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=ae(d,"position");if(m===void 0)break e;{const y=m;if(y.$tag===6){const k=y._0,L=ae(k,"x");if(L===void 0)break e;{const O=L,I=ae(k,"y");if(I===void 0)break e;{const D=I,x=ae(d,"name");if(x===void 0)break e;{const ge=x,re=st(g),he={_0:st(O),_1:st(D)},q=Lt.val;let G;q===void 0?G=ne():G=q;const Y=G.map,U=pa(ge);let j;U===void 0?j=ne():j=U,XL(re,he,Y,j);return}}}}else break e}}}else break e}}case"on_structure_build_end":{su();return}case"on_structure_attack_start":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=Lt.val;let w;m===void 0?w=ne():w=m,pL(w.map,st(g));return}}else break e}}case"on_structure_attack_end":{mL();return}case"on_structure_attack_apply":{const l=ae(o,"content");if(l===void 0)break e;{const _=l;if(_.$tag===6){const d=_._0,p=ae(d,"id");if(p===void 0)break e;{const g=p,m=ae(d,"position");if(m===void 0)break e;{const y=m;if(y.$tag===6){const k=y._0,L=ae(k,"x");if(L===void 0)break e;{const O=L,I=ae(k,"y");if(I===void 0)break e;{const D=I,x=st(g),z={_0:st(O),_1:st(D)},ge=Lt.val;let re;ge===void 0?re=ne():re=ge,fL(x,z,re.map);return}}}else break e}}}else break e}}case"on_game_over":{xL();return}default:break e}else break e}}else break e;Js()}function ZL(e){const t=Ff(e),n=new Array(t.length),o=t.length;let s=0;for(;;){const i=s;if(i<o){const r=t[i];n[i]=Pc(r),s=i+1|0;continue}else break}return vx(n)}function QL(){const e={_0:"warehouse",_1:ZL(It.val.warehouse)},t=Me([{_0:"SpiritalSpark",_1:Re(Gn(It.val.bag.resources,2))},{_0:"RecallGear",_1:Re(Gn(It.val.bag.resources,1))},{_0:"ResonantCrystal",_1:Re(Gn(It.val.bag.resources,4))},{_0:"RefinedCopper",_1:Re(Gn(It.val.bag.resources,3))},{_0:"HeartCrystalDust",_1:Re(Gn(It.val.bag.resources,0))}]),n=Me([{_0:"resources",_1:new ke(t)},{_0:"equipments",_1:wx(It.val.bag.equipments)}]),o=Me([e,{_0:"bag",_1:new ke(n)}]);return Ye(new ke(o))}function e7(e){let t=AP();if(e.$tag===5){const o=e._0,s=o.length;let i=0;for(;;){const r=i;if(r<s){const a=o[r];let c;e:{t:{const l=U6(a);if(l.$tag===1)c=l._0;else{l._0;break t}break e}c=ne()}t=Wu(t,c),i=r+1|0;continue}else break}return t}else return ne()}function t7(e){const t=Dm(e);let n;t===void 0?n=ne():n=t;const o=PP(),s=bf(n);for(;;){const i=wf(s);if(i===void 0)break;{const a=i,c=a._0,l=a._1;switch(c){case"SpiritalSpark":{so(o,2,ui(Ni(Di(l))));break}case"RecallGear":{so(o,1,ui(Ni(Di(l))));break}case"ResonantCrystal":{so(o,4,ui(Ni(Di(l))));break}case"RefinedCopper":{so(o,3,ui(Ni(Di(l))));break}case"HeartCrystalDust":{so(o,0,ui(Ni(Di(l))));break}}continue}}return o}function n7(e){if(e.$tag===6){const n=e._0,o=t7(Da(n,"resources")),s=Km(Om(Da(n,"equipments"))),i=new Array(s.length),r=s.length;let a=0;for(;;){const l=a;if(l<r){const u=s[l];let _;e:{t:{const $=B6(u);if($.$tag===1)_=$._0;else{$._0;break t}break e}_=ne()}i[l]=_,a=l+1|0;continue}else break}return IP(o,i)}else return ne()}function s7(e){let t;e:{t:{const i=Rm({str:e,start:0,end:e.length},1024);let r;if(i.$tag===1)r=i._0;else{i._0;break t}const a=Dm(r);a===void 0?t=ne():t=a;break e}t=ne()}const n=e7(Da(t,"warehouse")),o=n7(Da(t,"bag")),s=NP(n,o);It.val=s}function o7(){return jP(It.val)}function i7(){return BP(It.val)}function r7(){return HP(It.val)}function a7(){return FP(It.val)}function c7(e){return UP(It.val,e)}function l7(e){fP(Qe,e)}function u7(e){s7(e)}function _7(){return QL()}function $7(e){YL(e)}p1();function d7(){return JSON.parse(a7())}function Gc(){return JSON.parse(o7())}function p7(){return JSON.parse(i7())}function fa(){return JSON.parse(r7())}function m7(e){return JSON.parse(c7(e))}function rh(e){l7(t=>{const n=JSON.parse(t);e(n),He.enqueue(n)})}function f7(e){u7(e)}function h7(){return JSON.parse(_7())}function Ue(e){$7(e)}const g7={class:"draw-screen"},b7={class:"draw-screen__body"},y7={class:"draw-card"},w7={class:"card-face card-back"},v7=["src"],S7={class:"card-face card-front"},k7=["src"],M7={key:1,class:"card-icon"},C7=["src"],x7={class:"draw-cost"},P7=["src"],L7=["disabled","title"],I7={key:0,class:"toast"},T7={__name:"DrawScreen",emits:["draw"],setup(e,{emit:t}){const n=t,o=oe(!1),s=oe(!0),i=oe(!1),r=oe(""),a=oe(""),c=oe(""),l=oe({left:0,top:0,width:0,height:0}),u=oe(!1),_=oe(!1),$=oe(!1),d=oe("");function p(w){d.value=w||"",$.value=!0,setTimeout(()=>{$.value=!1},1800)}async function b(){try{const y=Gc(),v=Number((y==null?void 0:y.SpiritalSpark)??0);s.value=v>=10}catch{s.value=!1}}function g(){i.value=!1,u.value=!1,_.value=!1}function m(){if(o.value)return;if(b(),!s.value){p("");return}o.value=!0,f("[DrawScreen] runDrawSequence start");const w=document.querySelector(".draw-card");if(w){w.classList.add("is-shaking"),setTimeout(()=>w.classList.remove("is-shaking"),500);const y=w.getBoundingClientRect();l.value={left:Math.round(y.left),top:Math.round(y.top),width:Math.round(y.width),height:Math.round(y.height)}}setTimeout(async()=>{i.value=!0,u.value=!1,_.value=!0;try{const y=d7();if(y&&y.type==="success"&&y.copper&&y.copper.copper_info){const v=y.copper.copper_info;r.value=v.name||"",a.value="",c.value=Q(v.icon_url||""),f("[DrawScreen] tempImage resolved:",c.value),await _r(),setTimeout(()=>{_.value=!1,setTimeout(()=>{u.value=!0},350)},450),n("draw",{name:v.name,image:v.icon_url||""}),b()}else y&&y.type==="error"&&(i.value=!1,u.value=!1,_.value=!1,p(y.content||""),n("draw",{error:!0}),b())}catch{i.value=!1,u.value=!1,_.value=!1,p(""),n("draw",{error:!0}),b()}finally{setTimeout(()=>{o.value=!1},800)}},600)}return(w,y)=>(V(),ee("div",g7,[h("div",b7,[h("div",y7,[i.value?(V(),ee("div",{key:0,class:"draw-temp",onClick:g},[y[3]||(y[3]=h("div",{class:"dim-backdrop"},null,-1)),h("div",{class:"temp-stack",style:Bn({left:l.value.left+"px",top:l.value.top+"px",width:l.value.width+"px",height:l.value.height+"px"}),onClick:y[2]||(y[2]=Fs(()=>{},["stop"]))},[h("div",{class:wt(["card",{flipped:_.value}]),onClick:y[0]||(y[0]=Fs(v=>_.value=!_.value,["stop"]))},[h("div",w7,[h("img",{src:ye(Q)("frontend_resource/gacha.webp"),alt:"back"},null,8,v7)]),h("div",S7,[c.value?(V(),ee("img",{key:0,src:c.value,alt:"copper",class:"card-front-img"},null,8,k7)):(V(),ee("div",M7,ce(a.value||""),1))])],2),h("div",{class:wt(["card-name-below",{show:u.value}]),onClick:y[1]||(y[1]=Fs(()=>{},["stop"]))},ce(r.value),3)],4)])):Ie("",!0),h("img",{class:"draw-card__img",src:ye(Q)("frontend_resource/gacha.webp"),alt:"card"},null,8,C7)]),h("div",x7,[h("img",{class:"draw-cost__icon",src:ye(Q)("resource/spiritual_spark.webp"),alt:"cost"},null,8,P7),y[4]||(y[4]=h("span",{class:"draw-cost__times"},"X 10",-1))]),h("button",{class:"draw-action",disabled:o.value||!s.value,title:s.value?"":"",onClick:m},"  ",8,L7),$.value?(V(),ee("div",I7,ce(d.value),1)):Ie("",!0)])]))}},E7=Vt(T7,[["__scopeId","data-v-b6bb0732"]]);function z$(e,t){if(t===Xh)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===gl||t===od){let n=e.getIndex();if(n===null){const r=[],a=e.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)r.push(c);e.setIndex(r),n=e.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e}const o=n.count-2,s=[];if(t===gl)for(let r=1;r<=o;r++)s.push(n.getX(0)),s.push(n.getX(r)),s.push(n.getX(r+1));else for(let r=0;r<o;r++)r%2===0?(s.push(n.getX(r)),s.push(n.getX(r+1)),s.push(n.getX(r+2))):(s.push(n.getX(r+2)),s.push(n.getX(r+1)),s.push(n.getX(r)));s.length/3!==o&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const i=e.clone();return i.setIndex(s),i.clearGroups(),i}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}class Rc extends id{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new D7(n)}),this.register(function(n){return new N7(n)}),this.register(function(n){return new W7(n)}),this.register(function(n){return new K7(n)}),this.register(function(n){return new J7(n)}),this.register(function(n){return new H7(n)}),this.register(function(n){return new F7(n)}),this.register(function(n){return new U7(n)}),this.register(function(n){return new B7(n)}),this.register(function(n){return new O7(n)}),this.register(function(n){return new z7(n)}),this.register(function(n){return new j7(n)}),this.register(function(n){return new q7(n)}),this.register(function(n){return new V7(n)}),this.register(function(n){return new G7(n)}),this.register(function(n){return new X7(n)}),this.register(function(n){return new Y7(n)})}load(t,n,o,s){const i=this;let r;if(this.resourcePath!=="")r=this.resourcePath;else if(this.path!==""){const l=Wi.extractUrlBase(t);r=Wi.resolveURL(l,this.path)}else r=Wi.extractUrlBase(t);this.manager.itemStart(t);const a=function(l){s?s(l):console.error(l),i.manager.itemError(t),i.manager.itemEnd(t)},c=new ha(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(t,function(l){try{i.parse(l,r,function(u){n(u),i.manager.itemEnd(t)},a)}catch(u){a(u)}},o,a)}setDRACOLoader(t){return this.dracoLoader=t,this}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return this.pluginCallbacks.indexOf(t)===-1&&this.pluginCallbacks.push(t),this}unregister(t){return this.pluginCallbacks.indexOf(t)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,n,o,s){let i;const r={},a={},c=new TextDecoder;if(typeof t=="string")i=JSON.parse(t);else if(t instanceof ArrayBuffer)if(c.decode(new Uint8Array(t,0,4))===ah){try{r[Ze.KHR_BINARY_GLTF]=new Z7(t)}catch(_){s&&s(_);return}i=JSON.parse(r[Ze.KHR_BINARY_GLTF].content)}else i=JSON.parse(c.decode(t));else i=t;if(i.asset===void 0||i.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new _I(i,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const _=this.pluginCallbacks[u](l);_.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[_.name]=_,r[_.name]=!0}if(i.extensionsUsed)for(let u=0;u<i.extensionsUsed.length;++u){const _=i.extensionsUsed[u],$=i.extensionsRequired||[];switch(_){case Ze.KHR_MATERIALS_UNLIT:r[_]=new R7;break;case Ze.KHR_DRACO_MESH_COMPRESSION:r[_]=new Q7(i,this.dracoLoader);break;case Ze.KHR_TEXTURE_TRANSFORM:r[_]=new eI;break;case Ze.KHR_MESH_QUANTIZATION:r[_]=new tI;break;default:$.indexOf(_)>=0&&a[_]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+_+'".')}}l.setExtensions(r),l.setPlugins(a),l.parse(o,s)}parseAsync(t,n){const o=this;return new Promise(function(s,i){o.parse(t,n,s,i)})}}function A7(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const Ze={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class G7{constructor(t){this.parser=t,this.name=Ze.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,n=this.parser.json.nodes||[];for(let o=0,s=n.length;o<s;o++){const i=n[o];i.extensions&&i.extensions[this.name]&&i.extensions[this.name].light!==void 0&&t._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(t){const n=this.parser,o="light:"+t;let s=n.cache.get(o);if(s)return s;const i=n.json,c=((i.extensions&&i.extensions[this.name]||{}).lights||[])[t];let l;const u=new as(16777215);c.color!==void 0&&u.setRGB(c.color[0],c.color[1],c.color[2],ks);const _=c.range!==void 0?c.range:0;switch(c.type){case"directional":l=new ys(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new _i(u),l.distance=_;break;case"spot":l=new Yh(u),l.distance=_,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),fs(l,c),c.intensity!==void 0&&(l.intensity=c.intensity),l.name=n.createUniqueName(c.name||"light_"+t),s=Promise.resolve(l),n.cache.add(o,s),s}getDependency(t,n){if(t==="light")return this._loadLight(n)}createNodeAttachment(t){const n=this,o=this.parser,i=o.json.nodes[t],a=(i.extensions&&i.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return o._getNodeRef(n.cache,a,c)})}}class R7{constructor(){this.name=Ze.KHR_MATERIALS_UNLIT}getMaterialType(){return Bt}extendParams(t,n,o){const s=[];t.color=new as(1,1,1),t.opacity=1;const i=n.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const r=i.baseColorFactor;t.color.setRGB(r[0],r[1],r[2],ks),t.opacity=r[3]}i.baseColorTexture!==void 0&&s.push(o.assignTexture(t,"map",i.baseColorTexture,en))}return Promise.all(s)}}class O7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(t,n){const s=this.parser.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name].emissiveStrength;return i!==void 0&&(n.emissiveIntensity=i),Promise.resolve()}}class D7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const o=this.parser,s=o.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];if(r.clearcoatFactor!==void 0&&(n.clearcoat=r.clearcoatFactor),r.clearcoatTexture!==void 0&&i.push(o.assignTexture(n,"clearcoatMap",r.clearcoatTexture)),r.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=r.clearcoatRoughnessFactor),r.clearcoatRoughnessTexture!==void 0&&i.push(o.assignTexture(n,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),r.clearcoatNormalTexture!==void 0&&(i.push(o.assignTexture(n,"clearcoatNormalMap",r.clearcoatNormalTexture)),r.clearcoatNormalTexture.scale!==void 0)){const a=r.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new _n(a,a)}return Promise.all(i)}}class N7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_DISPERSION}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const s=this.parser.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name];return n.dispersion=i.dispersion!==void 0?i.dispersion:0,Promise.resolve()}}class j7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_IRIDESCENCE}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const o=this.parser,s=o.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];return r.iridescenceFactor!==void 0&&(n.iridescence=r.iridescenceFactor),r.iridescenceTexture!==void 0&&i.push(o.assignTexture(n,"iridescenceMap",r.iridescenceTexture)),r.iridescenceIor!==void 0&&(n.iridescenceIOR=r.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),r.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),r.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),r.iridescenceThicknessTexture!==void 0&&i.push(o.assignTexture(n,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(i)}}class H7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_SHEEN}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const o=this.parser,s=o.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[];n.sheenColor=new as(0,0,0),n.sheenRoughness=0,n.sheen=1;const r=s.extensions[this.name];if(r.sheenColorFactor!==void 0){const a=r.sheenColorFactor;n.sheenColor.setRGB(a[0],a[1],a[2],ks)}return r.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=r.sheenRoughnessFactor),r.sheenColorTexture!==void 0&&i.push(o.assignTexture(n,"sheenColorMap",r.sheenColorTexture,en)),r.sheenRoughnessTexture!==void 0&&i.push(o.assignTexture(n,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(i)}}class F7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const o=this.parser,s=o.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];return r.transmissionFactor!==void 0&&(n.transmission=r.transmissionFactor),r.transmissionTexture!==void 0&&i.push(o.assignTexture(n,"transmissionMap",r.transmissionTexture)),Promise.all(i)}}class U7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_VOLUME}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const o=this.parser,s=o.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];n.thickness=r.thicknessFactor!==void 0?r.thicknessFactor:0,r.thicknessTexture!==void 0&&i.push(o.assignTexture(n,"thicknessMap",r.thicknessTexture)),n.attenuationDistance=r.attenuationDistance||1/0;const a=r.attenuationColor||[1,1,1];return n.attenuationColor=new as().setRGB(a[0],a[1],a[2],ks),Promise.all(i)}}class B7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_IOR}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const s=this.parser.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name];return n.ior=i.ior!==void 0?i.ior:1.5,Promise.resolve()}}class z7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_SPECULAR}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const o=this.parser,s=o.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];n.specularIntensity=r.specularFactor!==void 0?r.specularFactor:1,r.specularTexture!==void 0&&i.push(o.assignTexture(n,"specularIntensityMap",r.specularTexture));const a=r.specularColorFactor||[1,1,1];return n.specularColor=new as().setRGB(a[0],a[1],a[2],ks),r.specularColorTexture!==void 0&&i.push(o.assignTexture(n,"specularColorMap",r.specularColorTexture,en)),Promise.all(i)}}class V7{constructor(t){this.parser=t,this.name=Ze.EXT_MATERIALS_BUMP}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const o=this.parser,s=o.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];return n.bumpScale=r.bumpFactor!==void 0?r.bumpFactor:1,r.bumpTexture!==void 0&&i.push(o.assignTexture(n,"bumpMap",r.bumpTexture)),Promise.all(i)}}class q7{constructor(t){this.parser=t,this.name=Ze.KHR_MATERIALS_ANISOTROPY}getMaterialType(t){const o=this.parser.json.materials[t];return!o.extensions||!o.extensions[this.name]?null:xs}extendMaterialParams(t,n){const o=this.parser,s=o.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=[],r=s.extensions[this.name];return r.anisotropyStrength!==void 0&&(n.anisotropy=r.anisotropyStrength),r.anisotropyRotation!==void 0&&(n.anisotropyRotation=r.anisotropyRotation),r.anisotropyTexture!==void 0&&i.push(o.assignTexture(n,"anisotropyMap",r.anisotropyTexture)),Promise.all(i)}}class W7{constructor(t){this.parser=t,this.name=Ze.KHR_TEXTURE_BASISU}loadTexture(t){const n=this.parser,o=n.json,s=o.textures[t];if(!s.extensions||!s.extensions[this.name])return null;const i=s.extensions[this.name],r=n.options.ktx2Loader;if(!r){if(o.extensionsRequired&&o.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(t,i.source,r)}}class K7{constructor(t){this.parser=t,this.name=Ze.EXT_TEXTURE_WEBP}loadTexture(t){const n=this.name,o=this.parser,s=o.json,i=s.textures[t];if(!i.extensions||!i.extensions[n])return null;const r=i.extensions[n],a=s.images[r.source];let c=o.textureLoader;if(a.uri){const l=o.options.manager.getHandler(a.uri);l!==null&&(c=l)}return o.loadTextureImage(t,r.source,c)}}class J7{constructor(t){this.parser=t,this.name=Ze.EXT_TEXTURE_AVIF}loadTexture(t){const n=this.name,o=this.parser,s=o.json,i=s.textures[t];if(!i.extensions||!i.extensions[n])return null;const r=i.extensions[n],a=s.images[r.source];let c=o.textureLoader;if(a.uri){const l=o.options.manager.getHandler(a.uri);l!==null&&(c=l)}return o.loadTextureImage(t,r.source,c)}}class X7{constructor(t){this.name=Ze.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const n=this.parser.json,o=n.bufferViews[t];if(o.extensions&&o.extensions[this.name]){const s=o.extensions[this.name],i=this.parser.getDependency("buffer",s.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then(function(a){const c=s.byteOffset||0,l=s.byteLength||0,u=s.count,_=s.byteStride,$=new Uint8Array(a,c,l);return r.decodeGltfBufferAsync?r.decodeGltfBufferAsync(u,_,$,s.mode,s.filter).then(function(d){return d.buffer}):r.ready.then(function(){const d=new ArrayBuffer(u*_);return r.decodeGltfBuffer(new Uint8Array(d),u,_,$,s.mode,s.filter),d})})}else return null}}class Y7{constructor(t){this.name=Ze.EXT_MESH_GPU_INSTANCING,this.parser=t}createNodeMesh(t){const n=this.parser.json,o=n.nodes[t];if(!o.extensions||!o.extensions[this.name]||o.mesh===void 0)return null;const s=n.meshes[o.mesh];for(const l of s.primitives)if(l.mode!==Un.TRIANGLES&&l.mode!==Un.TRIANGLE_STRIP&&l.mode!==Un.TRIANGLE_FAN&&l.mode!==void 0)return null;const r=o.extensions[this.name].attributes,a=[],c={};for(const l in r)a.push(this.parser.getDependency("accessor",r[l]).then(u=>(c[l]=u,c[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(t)),Promise.all(a).then(l=>{const u=l.pop(),_=u.isGroup?u.children:[u],$=l[0].count,d=[];for(const p of _){const b=new Ho,g=new Be,m=new Si,w=new Be(1,1,1),y=new rd(p.geometry,p.material,$);for(let v=0;v<$;v++)c.TRANSLATION&&g.fromBufferAttribute(c.TRANSLATION,v),c.ROTATION&&m.fromBufferAttribute(c.ROTATION,v),c.SCALE&&w.fromBufferAttribute(c.SCALE,v),y.setMatrixAt(v,b.compose(g,m,w));for(const v in c)if(v==="_COLOR_0"){const k=c[v];y.instanceColor=new Zh(k.array,k.itemSize,k.normalized)}else v!=="TRANSLATION"&&v!=="ROTATION"&&v!=="SCALE"&&p.geometry.setAttribute(v,c[v]);ad.prototype.copy.call(y,p),this.parser.assignFinalMaterial(y),d.push(y)}return u.isGroup?(u.clear(),u.add(...d),u):d[0]}))}}const ah="glTF",ji=12,V$={JSON:1313821514,BIN:5130562};class Z7{constructor(t){this.name=Ze.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(t,0,ji),o=new TextDecoder;if(this.header={magic:o.decode(new Uint8Array(t.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==ah)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-ji,i=new DataView(t,ji);let r=0;for(;r<s;){const a=i.getUint32(r,!0);r+=4;const c=i.getUint32(r,!0);if(r+=4,c===V$.JSON){const l=new Uint8Array(t,ji+r,a);this.content=o.decode(l)}else if(c===V$.BIN){const l=ji+r;this.body=t.slice(l,l+a)}r+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Q7{constructor(t,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ze.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(t,n){const o=this.json,s=this.dracoLoader,i=t.extensions[this.name].bufferView,r=t.extensions[this.name].attributes,a={},c={},l={};for(const u in r){const _=ou[u]||u.toLowerCase();a[_]=r[u]}for(const u in t.attributes){const _=ou[u]||u.toLowerCase();if(r[u]!==void 0){const $=o.accessors[t.attributes[u]],d=vi[$.componentType];l[_]=d.name,c[_]=$.normalized===!0}}return n.getDependency("bufferView",i).then(function(u){return new Promise(function(_,$){s.decodeDracoFile(u,function(d){for(const p in d.attributes){const b=d.attributes[p],g=c[p];g!==void 0&&(b.normalized=g)}_(d)},a,l,ks,$)})})}}class eI{constructor(){this.name=Ze.KHR_TEXTURE_TRANSFORM}extendTexture(t,n){return(n.texCoord===void 0||n.texCoord===t.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(t=t.clone(),n.texCoord!==void 0&&(t.channel=n.texCoord),n.offset!==void 0&&t.offset.fromArray(n.offset),n.rotation!==void 0&&(t.rotation=n.rotation),n.scale!==void 0&&t.repeat.fromArray(n.scale),t.needsUpdate=!0),t}}class tI{constructor(){this.name=Ze.KHR_MESH_QUANTIZATION}}class ch extends w0{constructor(t,n,o,s){super(t,n,o,s)}copySampleValue_(t){const n=this.resultBuffer,o=this.sampleValues,s=this.valueSize,i=t*s*3+s;for(let r=0;r!==s;r++)n[r]=o[i+r];return n}interpolate_(t,n,o,s){const i=this.resultBuffer,r=this.sampleValues,a=this.valueSize,c=a*2,l=a*3,u=s-n,_=(o-n)/u,$=_*_,d=$*_,p=t*l,b=p-l,g=-2*d+3*$,m=d-$,w=1-g,y=m-$+_;for(let v=0;v!==a;v++){const k=r[b+v+a],L=r[b+v+c]*u,P=r[p+v+a],O=r[p+v]*u;i[v]=w*k+y*L+g*P+m*O}return i}}const nI=new Si;class sI extends ch{interpolate_(t,n,o,s){const i=super.interpolate_(t,n,o,s);return nI.fromArray(i).normalize().toArray(i),i}}const Un={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},vi={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},q$={9728:ld,9729:bl,9984:s0,9985:n0,9986:t0,9987:cd},W$={33071:i0,33648:o0,10497:Bs},$l={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ou={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Qs={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},oI={CUBICSPLINE:void 0,LINEAR:$d,STEP:g0},dl={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function iI(e){return e.DefaultMaterial===void 0&&(e.DefaultMaterial=new Ut({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:y0})),e.DefaultMaterial}function To(e,t,n){for(const o in n.extensions)e[o]===void 0&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[o]=n.extensions[o])}function fs(e,t){t.extras!==void 0&&(typeof t.extras=="object"?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function rI(e,t,n){let o=!1,s=!1,i=!1;for(let l=0,u=t.length;l<u;l++){const _=t[l];if(_.POSITION!==void 0&&(o=!0),_.NORMAL!==void 0&&(s=!0),_.COLOR_0!==void 0&&(i=!0),o&&s&&i)break}if(!o&&!s&&!i)return Promise.resolve(e);const r=[],a=[],c=[];for(let l=0,u=t.length;l<u;l++){const _=t[l];if(o){const $=_.POSITION!==void 0?n.getDependency("accessor",_.POSITION):e.attributes.position;r.push($)}if(s){const $=_.NORMAL!==void 0?n.getDependency("accessor",_.NORMAL):e.attributes.normal;a.push($)}if(i){const $=_.COLOR_0!==void 0?n.getDependency("accessor",_.COLOR_0):e.attributes.color;c.push($)}}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(c)]).then(function(l){const u=l[0],_=l[1],$=l[2];return o&&(e.morphAttributes.position=u),s&&(e.morphAttributes.normal=_),i&&(e.morphAttributes.color=$),e.morphTargetsRelative=!0,e})}function aI(e,t){if(e.updateMorphTargets(),t.weights!==void 0)for(let n=0,o=t.weights.length;n<o;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let o=0,s=n.length;o<s;o++)e.morphTargetDictionary[n[o]]=o}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function cI(e){let t;const n=e.extensions&&e.extensions[Ze.KHR_DRACO_MESH_COMPRESSION];if(n?t="draco:"+n.bufferView+":"+n.indices+":"+pl(n.attributes):t=e.indices+":"+pl(e.attributes)+":"+e.mode,e.targets!==void 0)for(let o=0,s=e.targets.length;o<s;o++)t+=":"+pl(e.targets[o]);return t}function pl(e){let t="";const n=Object.keys(e).sort();for(let o=0,s=n.length;o<s;o++)t+=n[o]+":"+e[n[o]]+";";return t}function iu(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function lI(e){return e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0?"image/jpeg":e.search(/\.webp($|\?)/i)>0||e.search(/^data\:image\/webp/)===0?"image/webp":e.search(/\.ktx2($|\?)/i)>0||e.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const uI=new Ho;class _I{constructor(t={},n={}){this.json=t,this.extensions={},this.plugins={},this.options=n,this.cache=new A7,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let o=!1,s=-1,i=!1,r=-1;if(typeof navigator<"u"){const a=navigator.userAgent;o=/^((?!chrome|android).)*safari/i.test(a)===!0;const c=a.match(/Version\/(\d+)/);s=o&&c?parseInt(c[1],10):-1,i=a.indexOf("Firefox")>-1,r=i?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||o&&s<17||i&&r<98?this.textureLoader=new ki(this.options.manager):this.textureLoader=new Qh(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new ha(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,n){const o=this,s=this.json,i=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(r){return r._markDefs&&r._markDefs()}),Promise.all(this._invokeAll(function(r){return r.beforeRoot&&r.beforeRoot()})).then(function(){return Promise.all([o.getDependencies("scene"),o.getDependencies("animation"),o.getDependencies("camera")])}).then(function(r){const a={scene:r[0][s.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:s.asset,parser:o,userData:{}};return To(i,a,s),fs(a,s),Promise.all(o._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){for(const c of a.scenes)c.updateMatrixWorld();t(a)})}).catch(n)}_markDefs(){const t=this.json.nodes||[],n=this.json.skins||[],o=this.json.meshes||[];for(let s=0,i=n.length;s<i;s++){const r=n[s].joints;for(let a=0,c=r.length;a<c;a++)t[r[a]].isBone=!0}for(let s=0,i=t.length;s<i;s++){const r=t[s];r.mesh!==void 0&&(this._addNodeRef(this.meshCache,r.mesh),r.skin!==void 0&&(o[r.mesh].isSkinnedMesh=!0)),r.camera!==void 0&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(t,n){n!==void 0&&(t.refs[n]===void 0&&(t.refs[n]=t.uses[n]=0),t.refs[n]++)}_getNodeRef(t,n,o){if(t.refs[n]<=1)return o;const s=o.clone(),i=(r,a)=>{const c=this.associations.get(r);c!=null&&this.associations.set(a,c);for(const[l,u]of r.children.entries())i(u,a.children[l])};return i(o,s),s.name+="_instance_"+t.uses[n]++,s}_invokeOne(t){const n=Object.values(this.plugins);n.push(this);for(let o=0;o<n.length;o++){const s=t(n[o]);if(s)return s}return null}_invokeAll(t){const n=Object.values(this.plugins);n.unshift(this);const o=[];for(let s=0;s<n.length;s++){const i=t(n[s]);i&&o.push(i)}return o}getDependency(t,n){const o=t+":"+n;let s=this.cache.get(o);if(!s){switch(t){case"scene":s=this.loadScene(n);break;case"node":s=this._invokeOne(function(i){return i.loadNode&&i.loadNode(n)});break;case"mesh":s=this._invokeOne(function(i){return i.loadMesh&&i.loadMesh(n)});break;case"accessor":s=this.loadAccessor(n);break;case"bufferView":s=this._invokeOne(function(i){return i.loadBufferView&&i.loadBufferView(n)});break;case"buffer":s=this.loadBuffer(n);break;case"material":s=this._invokeOne(function(i){return i.loadMaterial&&i.loadMaterial(n)});break;case"texture":s=this._invokeOne(function(i){return i.loadTexture&&i.loadTexture(n)});break;case"skin":s=this.loadSkin(n);break;case"animation":s=this._invokeOne(function(i){return i.loadAnimation&&i.loadAnimation(n)});break;case"camera":s=this.loadCamera(n);break;default:if(s=this._invokeOne(function(i){return i!=this&&i.getDependency&&i.getDependency(t,n)}),!s)throw new Error("Unknown type: "+t);break}this.cache.add(o,s)}return s}getDependencies(t){let n=this.cache.get(t);if(!n){const o=this,s=this.json[t+(t==="mesh"?"es":"s")]||[];n=Promise.all(s.map(function(i,r){return o.getDependency(t,r)})),this.cache.add(t,n)}return n}loadBuffer(t){const n=this.json.buffers[t],o=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&t===0)return Promise.resolve(this.extensions[Ze.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(i,r){o.load(Wi.resolveURL(n.uri,s.path),i,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(t){const n=this.json.bufferViews[t];return this.getDependency("buffer",n.buffer).then(function(o){const s=n.byteLength||0,i=n.byteOffset||0;return o.slice(i,i+s)})}loadAccessor(t){const n=this,o=this.json,s=this.json.accessors[t];if(s.bufferView===void 0&&s.sparse===void 0){const r=$l[s.type],a=vi[s.componentType],c=s.normalized===!0,l=new a(s.count*r);return Promise.resolve(new Ki(l,r,c))}const i=[];return s.bufferView!==void 0?i.push(this.getDependency("bufferView",s.bufferView)):i.push(null),s.sparse!==void 0&&(i.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(i).then(function(r){const a=r[0],c=$l[s.type],l=vi[s.componentType],u=l.BYTES_PER_ELEMENT,_=u*c,$=s.byteOffset||0,d=s.bufferView!==void 0?o.bufferViews[s.bufferView].byteStride:void 0,p=s.normalized===!0;let b,g;if(d&&d!==_){const m=Math.floor($/d),w="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+m+":"+s.count;let y=n.cache.get(w);y||(b=new l(a,m*d,s.count*d/u),y=new e0(b,d/u),n.cache.add(w,y)),g=new b0(y,c,$%d/u,p)}else a===null?b=new l(s.count*c):b=new l(a,$,s.count*c),g=new Ki(b,c,p);if(s.sparse!==void 0){const m=$l.SCALAR,w=vi[s.sparse.indices.componentType],y=s.sparse.indices.byteOffset||0,v=s.sparse.values.byteOffset||0,k=new w(r[1],y,s.sparse.count*m),L=new l(r[2],v,s.sparse.count*c);a!==null&&(g=new Ki(g.array.slice(),g.itemSize,g.normalized)),g.normalized=!1;for(let P=0,O=k.length;P<O;P++){const I=k[P];if(g.setX(I,L[P*c]),c>=2&&g.setY(I,L[P*c+1]),c>=3&&g.setZ(I,L[P*c+2]),c>=4&&g.setW(I,L[P*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}g.normalized=p}return g})}loadTexture(t){const n=this.json,o=this.options,i=n.textures[t].source,r=n.images[i];let a=this.textureLoader;if(r.uri){const c=o.manager.getHandler(r.uri);c!==null&&(a=c)}return this.loadTextureImage(t,i,a)}loadTextureImage(t,n,o){const s=this,i=this.json,r=i.textures[t],a=i.images[n],c=(a.uri||a.bufferView)+":"+r.sampler;if(this.textureCache[c])return this.textureCache[c];const l=this.loadImageSource(n,o).then(function(u){u.flipY=!1,u.name=r.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const $=(i.samplers||{})[r.sampler]||{};return u.magFilter=q$[$.magFilter]||bl,u.minFilter=q$[$.minFilter]||cd,u.wrapS=W$[$.wrapS]||Bs,u.wrapT=W$[$.wrapT]||Bs,u.generateMipmaps=!u.isCompressedTexture&&u.minFilter!==ld&&u.minFilter!==bl,s.associations.set(u,{textures:t}),u}).catch(function(){return null});return this.textureCache[c]=l,l}loadImageSource(t,n){const o=this,s=this.json,i=this.options;if(this.sourceCache[t]!==void 0)return this.sourceCache[t].then(_=>_.clone());const r=s.images[t],a=self.URL||self.webkitURL;let c=r.uri||"",l=!1;if(r.bufferView!==void 0)c=o.getDependency("bufferView",r.bufferView).then(function(_){l=!0;const $=new Blob([_],{type:r.mimeType});return c=a.createObjectURL($),c});else if(r.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const u=Promise.resolve(c).then(function(_){return new Promise(function($,d){let p=$;n.isImageBitmapLoader===!0&&(p=function(b){const g=new u_(b);g.needsUpdate=!0,$(g)}),n.load(Wi.resolveURL(_,i.path),p,void 0,d)})}).then(function(_){return l===!0&&a.revokeObjectURL(c),fs(_,r),_.userData.mimeType=r.mimeType||lI(r.uri),_}).catch(function(_){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),_});return this.sourceCache[t]=u,u}assignTexture(t,n,o,s){const i=this;return this.getDependency("texture",o.index).then(function(r){if(!r)return null;if(o.texCoord!==void 0&&o.texCoord>0&&(r=r.clone(),r.channel=o.texCoord),i.extensions[Ze.KHR_TEXTURE_TRANSFORM]){const a=o.extensions!==void 0?o.extensions[Ze.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const c=i.associations.get(r);r=i.extensions[Ze.KHR_TEXTURE_TRANSFORM].extendTexture(r,a),i.associations.set(r,c)}}return s!==void 0&&(r.colorSpace=s),t[n]=r,r})}assignFinalMaterial(t){const n=t.geometry;let o=t.material;const s=n.attributes.tangent===void 0,i=n.attributes.color!==void 0,r=n.attributes.normal===void 0;if(t.isPoints){const a="PointsMaterial:"+o.uuid;let c=this.cache.get(a);c||(c=new r0,Fc.prototype.copy.call(c,o),c.color.copy(o.color),c.map=o.map,c.sizeAttenuation=!1,this.cache.add(a,c)),o=c}else if(t.isLine){const a="LineBasicMaterial:"+o.uuid;let c=this.cache.get(a);c||(c=new a0,Fc.prototype.copy.call(c,o),c.color.copy(o.color),c.map=o.map,this.cache.add(a,c)),o=c}if(s||i||r){let a="ClonedMaterial:"+o.uuid+":";s&&(a+="derivative-tangents:"),i&&(a+="vertex-colors:"),r&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=o.clone(),i&&(c.vertexColors=!0),r&&(c.flatShading=!0),s&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(o))),o=c}t.material=o}getMaterialType(){return Ut}loadMaterial(t){const n=this,o=this.json,s=this.extensions,i=o.materials[t];let r;const a={},c=i.extensions||{},l=[];if(c[Ze.KHR_MATERIALS_UNLIT]){const _=s[Ze.KHR_MATERIALS_UNLIT];r=_.getMaterialType(),l.push(_.extendParams(a,i,n))}else{const _=i.pbrMetallicRoughness||{};if(a.color=new as(1,1,1),a.opacity=1,Array.isArray(_.baseColorFactor)){const $=_.baseColorFactor;a.color.setRGB($[0],$[1],$[2],ks),a.opacity=$[3]}_.baseColorTexture!==void 0&&l.push(n.assignTexture(a,"map",_.baseColorTexture,en)),a.metalness=_.metallicFactor!==void 0?_.metallicFactor:1,a.roughness=_.roughnessFactor!==void 0?_.roughnessFactor:1,_.metallicRoughnessTexture!==void 0&&(l.push(n.assignTexture(a,"metalnessMap",_.metallicRoughnessTexture)),l.push(n.assignTexture(a,"roughnessMap",_.metallicRoughnessTexture))),r=this._invokeOne(function($){return $.getMaterialType&&$.getMaterialType(t)}),l.push(Promise.all(this._invokeAll(function($){return $.extendMaterialParams&&$.extendMaterialParams(t,a)})))}i.doubleSided===!0&&(a.side=Cn);const u=i.alphaMode||dl.OPAQUE;if(u===dl.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===dl.MASK&&(a.alphaTest=i.alphaCutoff!==void 0?i.alphaCutoff:.5)),i.normalTexture!==void 0&&r!==Bt&&(l.push(n.assignTexture(a,"normalMap",i.normalTexture)),a.normalScale=new _n(1,1),i.normalTexture.scale!==void 0)){const _=i.normalTexture.scale;a.normalScale.set(_,_)}if(i.occlusionTexture!==void 0&&r!==Bt&&(l.push(n.assignTexture(a,"aoMap",i.occlusionTexture)),i.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=i.occlusionTexture.strength)),i.emissiveFactor!==void 0&&r!==Bt){const _=i.emissiveFactor;a.emissive=new as().setRGB(_[0],_[1],_[2],ks)}return i.emissiveTexture!==void 0&&r!==Bt&&l.push(n.assignTexture(a,"emissiveMap",i.emissiveTexture,en)),Promise.all(l).then(function(){const _=new r(a);return i.name&&(_.name=i.name),fs(_,i),n.associations.set(_,{materials:t}),i.extensions&&To(s,_,i),_})}createUniqueName(t){const n=c0.sanitizeNodeName(t||"");return n in this.nodeNamesUsed?n+"_"+ ++this.nodeNamesUsed[n]:(this.nodeNamesUsed[n]=0,n)}loadGeometries(t){const n=this,o=this.extensions,s=this.primitiveCache;function i(a){return o[Ze.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,n).then(function(c){return K$(c,a,n)})}const r=[];for(let a=0,c=t.length;a<c;a++){const l=t[a],u=cI(l),_=s[u];if(_)r.push(_.promise);else{let $;l.extensions&&l.extensions[Ze.KHR_DRACO_MESH_COMPRESSION]?$=i(l):$=K$(new ud,l,n),s[u]={primitive:l,promise:$},r.push($)}}return Promise.all(r)}loadMesh(t){const n=this,o=this.json,s=this.extensions,i=o.meshes[t],r=i.primitives,a=[];for(let c=0,l=r.length;c<l;c++){const u=r[c].material===void 0?iI(this.cache):this.getDependency("material",r[c].material);a.push(u)}return a.push(n.loadGeometries(r)),Promise.all(a).then(function(c){const l=c.slice(0,c.length-1),u=c[c.length-1],_=[];for(let d=0,p=u.length;d<p;d++){const b=u[d],g=r[d];let m;const w=l[d];if(g.mode===Un.TRIANGLES||g.mode===Un.TRIANGLE_STRIP||g.mode===Un.TRIANGLE_FAN||g.mode===void 0)m=i.isSkinnedMesh===!0?new l0(b,w):new St(b,w),m.isSkinnedMesh===!0&&m.normalizeSkinWeights(),g.mode===Un.TRIANGLE_STRIP?m.geometry=z$(m.geometry,od):g.mode===Un.TRIANGLE_FAN&&(m.geometry=z$(m.geometry,gl));else if(g.mode===Un.LINES)m=new u0(b,w);else if(g.mode===Un.LINE_STRIP)m=new _0(b,w);else if(g.mode===Un.LINE_LOOP)m=new $0(b,w);else if(g.mode===Un.POINTS)m=new d0(b,w);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(m.geometry.morphAttributes).length>0&&aI(m,i),m.name=n.createUniqueName(i.name||"mesh_"+t),fs(m,i),g.extensions&&To(s,m,g),n.assignFinalMaterial(m),_.push(m)}for(let d=0,p=_.length;d<p;d++)n.associations.set(_[d],{meshes:t,primitives:d});if(_.length===1)return i.extensions&&To(s,_[0],i),_[0];const $=new ts;i.extensions&&To(s,$,i),n.associations.set($,{meshes:t});for(let d=0,p=_.length;d<p;d++)$.add(_[d]);return $})}loadCamera(t){let n;const o=this.json.cameras[t],s=o[o.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return o.type==="perspective"?n=new Ir(_d.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):o.type==="orthographic"&&(n=new p0(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),o.name&&(n.name=this.createUniqueName(o.name)),fs(n,o),Promise.resolve(n)}loadSkin(t){const n=this.json.skins[t],o=[];for(let s=0,i=n.joints.length;s<i;s++)o.push(this._loadNodeShallow(n.joints[s]));return n.inverseBindMatrices!==void 0?o.push(this.getDependency("accessor",n.inverseBindMatrices)):o.push(null),Promise.all(o).then(function(s){const i=s.pop(),r=s,a=[],c=[];for(let l=0,u=r.length;l<u;l++){const _=r[l];if(_){a.push(_);const $=new Ho;i!==null&&$.fromArray(i.array,l*16),c.push($)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[l])}return new m0(a,c)})}loadAnimation(t){const n=this.json,o=this,s=n.animations[t],i=s.name?s.name:"animation_"+t,r=[],a=[],c=[],l=[],u=[];for(let _=0,$=s.channels.length;_<$;_++){const d=s.channels[_],p=s.samplers[d.sampler],b=d.target,g=b.node,m=s.parameters!==void 0?s.parameters[p.input]:p.input,w=s.parameters!==void 0?s.parameters[p.output]:p.output;b.node!==void 0&&(r.push(this.getDependency("node",g)),a.push(this.getDependency("accessor",m)),c.push(this.getDependency("accessor",w)),l.push(p),u.push(b))}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(c),Promise.all(l),Promise.all(u)]).then(function(_){const $=_[0],d=_[1],p=_[2],b=_[3],g=_[4],m=[];for(let y=0,v=$.length;y<v;y++){const k=$[y],L=d[y],P=p[y],O=b[y],I=g[y];if(k===void 0)continue;k.updateMatrix&&k.updateMatrix();const R=o._createAnimationTracks(k,L,P,O,I);if(R)for(let D=0;D<R.length;D++)m.push(R[D])}const w=new f0(i,void 0,m);return fs(w,s),w})}createNodeMesh(t){const n=this.json,o=this,s=n.nodes[t];return s.mesh===void 0?null:o.getDependency("mesh",s.mesh).then(function(i){const r=o._getNodeRef(o.meshCache,s.mesh,i);return s.weights!==void 0&&r.traverse(function(a){if(a.isMesh)for(let c=0,l=s.weights.length;c<l;c++)a.morphTargetInfluences[c]=s.weights[c]}),r})}loadNode(t){const n=this.json,o=this,s=n.nodes[t],i=o._loadNodeShallow(t),r=[],a=s.children||[];for(let l=0,u=a.length;l<u;l++)r.push(o.getDependency("node",a[l]));const c=s.skin===void 0?Promise.resolve(null):o.getDependency("skin",s.skin);return Promise.all([i,Promise.all(r),c]).then(function(l){const u=l[0],_=l[1],$=l[2];$!==null&&u.traverse(function(d){d.isSkinnedMesh&&d.bind($,uI)});for(let d=0,p=_.length;d<p;d++)u.add(_[d]);return u})}_loadNodeShallow(t){const n=this.json,o=this.extensions,s=this;if(this.nodeCache[t]!==void 0)return this.nodeCache[t];const i=n.nodes[t],r=i.name?s.createUniqueName(i.name):"",a=[],c=s._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(t)});return c&&a.push(c),i.camera!==void 0&&a.push(s.getDependency("camera",i.camera).then(function(l){return s._getNodeRef(s.cameraCache,i.camera,l)})),s._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(t)}).forEach(function(l){a.push(l)}),this.nodeCache[t]=Promise.all(a).then(function(l){let u;if(i.isBone===!0?u=new h0:l.length>1?u=new ts:l.length===1?u=l[0]:u=new ad,u!==l[0])for(let _=0,$=l.length;_<$;_++)u.add(l[_]);if(i.name&&(u.userData.name=i.name,u.name=r),fs(u,i),i.extensions&&To(o,u,i),i.matrix!==void 0){const _=new Ho;_.fromArray(i.matrix),u.applyMatrix4(_)}else i.translation!==void 0&&u.position.fromArray(i.translation),i.rotation!==void 0&&u.quaternion.fromArray(i.rotation),i.scale!==void 0&&u.scale.fromArray(i.scale);if(!s.associations.has(u))s.associations.set(u,{});else if(i.mesh!==void 0&&s.meshCache.refs[i.mesh]>1){const _=s.associations.get(u);s.associations.set(u,{..._})}return s.associations.get(u).nodes=t,u}),this.nodeCache[t]}loadScene(t){const n=this.extensions,o=this.json.scenes[t],s=this,i=new ts;o.name&&(i.name=s.createUniqueName(o.name)),fs(i,o),o.extensions&&To(n,i,o);const r=o.nodes||[],a=[];for(let c=0,l=r.length;c<l;c++)a.push(s.getDependency("node",r[c]));return Promise.all(a).then(function(c){for(let u=0,_=c.length;u<_;u++)i.add(c[u]);const l=u=>{const _=new Map;for(const[$,d]of s.associations)($ instanceof Fc||$ instanceof u_)&&_.set($,d);return u.traverse($=>{const d=s.associations.get($);d!=null&&_.set($,d)}),_};return s.associations=l(i),i})}_createAnimationTracks(t,n,o,s,i){const r=[],a=t.name?t.name:t.uuid,c=[];Qs[i.path]===Qs.weights?t.traverse(function($){$.morphTargetInfluences&&c.push($.name?$.name:$.uuid)}):c.push(a);let l;switch(Qs[i.path]){case Qs.weights:l=$_;break;case Qs.rotation:l=d_;break;case Qs.translation:case Qs.scale:l=__;break;default:switch(o.itemSize){case 1:l=$_;break;case 2:case 3:default:l=__;break}break}const u=s.interpolation!==void 0?oI[s.interpolation]:$d,_=this._getArrayFromAccessor(o);for(let $=0,d=c.length;$<d;$++){const p=new l(c[$]+"."+Qs[i.path],n.array,_,u);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),r.push(p)}return r}_getArrayFromAccessor(t){let n=t.array;if(t.normalized){const o=iu(n.constructor),s=new Float32Array(n.length);for(let i=0,r=n.length;i<r;i++)s[i]=n[i]*o;n=s}return n}_createCubicSplineTrackInterpolant(t){t.createInterpolant=function(o){const s=this instanceof d_?sI:ch;return new s(this.times,this.values,this.getValueSize()/3,o)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function $I(e,t,n){const o=t.attributes,s=new dn;if(o.POSITION!==void 0){const a=n.json.accessors[o.POSITION],c=a.min,l=a.max;if(c!==void 0&&l!==void 0){if(s.set(new Be(c[0],c[1],c[2]),new Be(l[0],l[1],l[2])),a.normalized){const u=iu(vi[a.componentType]);s.min.multiplyScalar(u),s.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const i=t.targets;if(i!==void 0){const a=new Be,c=new Be;for(let l=0,u=i.length;l<u;l++){const _=i[l];if(_.POSITION!==void 0){const $=n.json.accessors[_.POSITION],d=$.min,p=$.max;if(d!==void 0&&p!==void 0){if(c.setX(Math.max(Math.abs(d[0]),Math.abs(p[0]))),c.setY(Math.max(Math.abs(d[1]),Math.abs(p[1]))),c.setZ(Math.max(Math.abs(d[2]),Math.abs(p[2]))),$.normalized){const b=iu(vi[$.componentType]);c.multiplyScalar(b)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(a)}e.boundingBox=s;const r=new v0;s.getCenter(r.center),r.radius=s.min.distanceTo(s.max)/2,e.boundingSphere=r}function K$(e,t,n){const o=t.attributes,s=[];function i(r,a){return n.getDependency("accessor",r).then(function(c){e.setAttribute(a,c)})}for(const r in o){const a=ou[r]||r.toLowerCase();a in e.attributes||s.push(i(o[r],a))}if(t.indices!==void 0&&!e.index){const r=n.getDependency("accessor",t.indices).then(function(a){e.setIndex(a)});s.push(r)}return yl.workingColorSpace!==ks&&"COLOR_0"in o&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${yl.workingColorSpace}" not supported.`),fs(e,t),$I(e,t,n),Promise.all(s).then(function(){return t.targets!==void 0?rI(e,t.targets,n):e})}const ml=new WeakMap;class Oc extends id{constructor(t){super(t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(t){return this.decoderPath=t,this}setDecoderConfig(t){return this.decoderConfig=t,this}setWorkerLimit(t){return this.workerLimit=t,this}load(t,n,o,s){const i=new ha(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(t,r=>{this.parse(r,n,s)},o,s)}parse(t,n,o=()=>{}){this.decodeDracoFile(t,n,null,null,en,o).catch(o)}decodeDracoFile(t,n,o,s,i=ks,r=()=>{}){const a={attributeIDs:o||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!o,vertexColorSpace:i};return this.decodeGeometry(t,a).then(n).catch(r)}decodeGeometry(t,n){const o=JSON.stringify(n);if(ml.has(t)){const c=ml.get(t);if(c.key===o)return c.promise;if(t.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const i=this.workerNextTaskID++,r=t.byteLength,a=this._getWorker(i,r).then(c=>(s=c,new Promise((l,u)=>{s._callbacks[i]={resolve:l,reject:u},s.postMessage({type:"decode",id:i,taskConfig:n,buffer:t},[t])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{s&&i&&this._releaseTask(s,i)}),ml.set(t,{key:o,promise:a}),a}_createGeometry(t){const n=new ud;t.index&&n.setIndex(new Ki(t.index.array,1));for(let o=0;o<t.attributes.length;o++){const s=t.attributes[o],i=s.name,r=s.array,a=s.itemSize,c=new Ki(r,a);i==="color"&&(this._assignVertexColorSpace(c,s.vertexColorSpace),c.normalized=!(r instanceof Float32Array)),n.setAttribute(i,c)}return n}_assignVertexColorSpace(t,n){if(n!==en)return;const o=new as;for(let s=0,i=t.count;s<i;s++)o.fromBufferAttribute(t,s),yl.colorSpaceToWorking(o,en),t.setXYZ(s,o.r,o.g,o.b)}_loadLibrary(t,n){const o=new ha(this.manager);return o.setPath(this.decoderPath),o.setResponseType(n),o.setWithCredentials(this.withCredentials),new Promise((s,i)=>{o.load(t,s,void 0,i)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const t=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return t?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(o=>{const s=o[0];t||(this.decoderConfig.wasmBinary=o[1]);const i=dI.toString(),r=["/* draco decoder */",s,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([r]))}),this.decoderPending}_getWorker(t,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(i){const r=i.data;switch(r.type){case"decode":s._callbacks[r.id].resolve(r);break;case"error":s._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,i){return s._taskLoad>i._taskLoad?-1:1});const o=this.workerPool[this.workerPool.length-1];return o._taskCosts[t]=n,o._taskLoad+=n,o})}_releaseTask(t,n){t._taskLoad-=t._taskCosts[n],delete t._callbacks[n],delete t._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(t=>t._taskLoad))}dispose(){for(let t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function dI(){let e,t;onmessage=function(r){const a=r.data;switch(a.type){case"init":e=a.decoderConfig,t=new Promise(function(u){e.onModuleLoaded=function(_){u({draco:_})},DracoDecoderModule(e)});break;case"decode":const c=a.buffer,l=a.taskConfig;t.then(u=>{const _=u.draco,$=new _.Decoder;try{const d=n(_,$,new Int8Array(c),l),p=d.attributes.map(b=>b.array.buffer);d.index&&p.push(d.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:d},p)}catch(d){console.error(d),self.postMessage({type:"error",id:a.id,error:d.message})}finally{_.destroy($)}});break}};function n(r,a,c,l){const u=l.attributeIDs,_=l.attributeTypes;let $,d;const p=a.GetEncodedGeometryType(c);if(p===r.TRIANGULAR_MESH)$=new r.Mesh,d=a.DecodeArrayToMesh(c,c.byteLength,$);else if(p===r.POINT_CLOUD)$=new r.PointCloud,d=a.DecodeArrayToPointCloud(c,c.byteLength,$);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!d.ok()||$.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+d.error_msg());const b={index:null,attributes:[]};for(const g in u){const m=self[_[g]];let w,y;if(l.useUniqueIDs)y=u[g],w=a.GetAttributeByUniqueId($,y);else{if(y=a.GetAttributeId($,r[u[g]]),y===-1)continue;w=a.GetAttribute($,y)}const v=s(r,a,$,g,m,w);g==="color"&&(v.vertexColorSpace=l.vertexColorSpace),b.attributes.push(v)}return p===r.TRIANGULAR_MESH&&(b.index=o(r,a,$)),r.destroy($),b}function o(r,a,c){const u=c.num_faces()*3,_=u*4,$=r._malloc(_);a.GetTrianglesUInt32Array(c,_,$);const d=new Uint32Array(r.HEAPF32.buffer,$,u).slice();return r._free($),{array:d,itemSize:1}}function s(r,a,c,l,u,_){const $=_.num_components(),p=c.num_points()*$,b=p*u.BYTES_PER_ELEMENT,g=i(r,u),m=r._malloc(b);a.GetAttributeDataArrayForAllPoints(c,_,g,b,m);const w=new u(r.HEAPF32.buffer,m,p).slice();return r._free(m),{name:l,array:w,itemSize:$}}function i(r,a){switch(a){case Float32Array:return r.DT_FLOAT32;case Int8Array:return r.DT_INT8;case Int16Array:return r.DT_INT16;case Int32Array:return r.DT_INT32;case Uint8Array:return r.DT_UINT8;case Uint16Array:return r.DT_UINT16;case Uint32Array:return r.DT_UINT32}}}class pI{constructor(){this.gltfCache=new Map,this.modelPool=new Map,this.instancedMeshes=new Map,this.gltfLoader=null,this.dracoLoader=null,this.maxCacheSize=50,this.maxInstancesPerModel=1e3,this.preloadStatus=new Map,this.preloadQueue=[],this.initLoaders()}initLoaders(){this.gltfLoader||(this.gltfLoader=new Rc,this.gltfLoader.setCrossOrigin("anonymous"),this.dracoLoader=new Oc,this.dracoLoader.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),this.dracoLoader.setCrossOrigin("anonymous"),this.gltfLoader.setDRACOLoader(this.dracoLoader),f("[ModelCache] GLTFDraco"))}async loadModel(t,n=!0){if(n&&this.modelPool.has(t)){const i=this.modelPool.get(t);return f(`[ModelCache] : ${t}`),i.clone(!0)}let o;if(this.gltfCache.has(t))f(`[ModelCache] GLTF: ${t}`),o=this.gltfCache.get(t);else try{const r=await(await Tp(t)).arrayBuffer();f(`[ModelCache] GLTF: ${t}`),o=await new Promise((a,c)=>{this.gltfLoader.parse(r,"",l=>a(l),l=>c(l))}),this.cacheGLTF(t,o)}catch(i){throw f(`[ModelCache] : ${t}`,i),i}const s=o.scene.clone(!0);return n&&this.addToModelPool(t,s),s}async createInstancedMesh(t,n=100){if(this.instancedMeshes.has(t))return f(`[ModelCache] : ${t}`),this.instancedMeshes.get(t);const o=await this.loadModel(t,!0),s=[];if(o.traverse(c=>{c.isMesh&&s.push(c)}),s.length===0)throw new Error(`[ModelCache] : ${t}`);const i=s[0],r=new rd(i.geometry,i.material,n),a=new Ho;for(let c=0;c<n;c++)a.setPosition(0,-1e3,0),r.setMatrixAt(c,a);return r.instanceMatrix.needsUpdate=!0,this.instancedMeshes.set(t,r),f(`[ModelCache] : ${t}, : ${n}`),r}updateInstancedMeshInstance(t,n,o,s,i){const r=this.instancedMeshes.get(t);if(!r){f(`[ModelCache] : ${t}`);return}if(n>=r.count){f(`[ModelCache] : ${n}/${r.count}`);return}const a=new Ho;a.compose(o,new Si().setFromEuler(s),i),r.setMatrixAt(n,a),r.instanceMatrix.needsUpdate=!0}hideInstancedMeshInstance(t,n){const o=this.instancedMeshes.get(t);if(!o)return;const s=new Ho;s.setPosition(0,-1e3,0),o.setMatrixAt(n,s),o.instanceMatrix.needsUpdate=!0}cacheGLTF(t,n){if(this.gltfCache.size>=this.maxCacheSize){const o=this.gltfCache.keys().next().value;this.gltfCache.delete(o),f(`[ModelCache] GLTF: ${o}`)}this.gltfCache.set(t,n),f(`[ModelCache] GLTF: ${t}`)}addToModelPool(t,n){if(this.modelPool.size>=this.maxCacheSize){const o=this.modelPool.keys().next().value,s=this.modelPool.get(o);this.disposeModel(s),this.modelPool.delete(o),f(`[ModelCache] : ${o}`)}this.modelPool.set(t,n),f(`[ModelCache] : ${t}`)}async preloadModels(t,n=null){f(`[ModelCache]  ${t.length} `);const o=t.length;let s=0;const i=t.filter(a=>{const c=this.preloadStatus.get(a);return!c||c==="failed"});f(`[ModelCache]  ${i.length} `);const r=3;for(let a=0;a<i.length;a+=r){const l=i.slice(a,a+r).map(async u=>{try{this.preloadStatus.set(u,"loading"),await this.loadModel(u,!0),this.preloadStatus.set(u,"loaded"),s++,n&&n(s,o,Math.round(s/o*100)),f(`[ModelCache] : ${u} (${s}/${o})`)}catch(_){f(`[ModelCache] : ${u}`,_),this.preloadStatus.set(u,"failed"),s++,n&&n(s,o,Math.round(s/o*100))}});await Promise.all(l),a+r<i.length&&await new Promise(u=>setTimeout(u,100))}f(`[ModelCache] : ${s}/${o} `)}isPreloaded(t){return this.preloadStatus.get(t)==="loaded"}getPreloadStatus(){const t={total:this.preloadStatus.size,loaded:0,loading:0,failed:0};for(const n of this.preloadStatus.values())t[n]++;return t}disposeModel(t){t&&t.traverse(n=>{n.isMesh&&(n.geometry&&n.geometry.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(o=>{o.map&&o.map.dispose(),o.dispose&&o.dispose()}):(n.material.map&&n.material.map.dispose(),n.material.dispose&&n.material.dispose())))})}clearCache(){f("[ModelCache] ..."),this.modelPool.forEach(t=>{this.disposeModel(t)}),this.modelPool.clear(),this.instancedMeshes.forEach(t=>{this.disposeModel(t)}),this.instancedMeshes.clear(),this.gltfCache.clear(),this.preloadStatus.clear(),f("[ModelCache] ")}getCacheStatus(){return{gltfCacheSize:this.gltfCache.size,modelPoolSize:this.modelPool.size,instancedMeshesSize:this.instancedMeshes.size,preloadStatus:this.getPreloadStatus(),maxCacheSize:this.maxCacheSize,maxInstancesPerModel:this.maxInstancesPerModel,gltfLoaderInitialized:!!this.gltfLoader,dracoLoaderInitialized:!!this.dracoLoader}}updateConfig(t){t.maxCacheSize!==void 0&&(this.maxCacheSize=Math.max(10,t.maxCacheSize)),t.maxInstancesPerModel!==void 0&&(this.maxInstancesPerModel=Math.max(10,t.maxInstancesPerModel)),f("[ModelCache] :",this.getCacheStatus())}}const Rn=new pI,mI={class:"model-wrapper"},fI={key:0,class:"model-loading"},hI={__name:"PuppetModelView",props:{puppet:{type:Object,default:null}},setup(e){const t=e,n=oe(null),o=oe(!1);let s=null,i=null,r=null,a=0,c=null,l=null,u=new k0,_=null,$=null,d=0,p=!1;window.__GLTF_MEMORY_CACHE__||(window.__GLTF_MEMORY_CACHE__=new Map,f("[PuppetModelView] Initialized global GLTF memory cache"));function b(){if(p)return;const y=n.value;if(!y){f("[PuppetModelView] Container not ready for Three.js initialization");return}f("[PuppetModelView] Initializing Three.js..."),i=new qa,r=new Ir(45,1,.1,1e3),r.position.set(0,1,3),s=new Wa({antialias:!0,alpha:!0}),s.setPixelRatio(window.devicePixelRatio||1),s.outputColorSpace=en,$=new Oc,$.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),$.setCrossOrigin("anonymous"),f("[PuppetModelView] Draco loader initialized:",!!$),y.innerHTML="",y.appendChild(s.domElement);const v=new Ka(16777215,1.2),k=new ys(16777215,1.5);k.position.set(3,5,2);const L=new ys(16777215,.8);L.position.set(-2,3,4);const P=new _i(16777215,1,10);P.position.set(0,2,3),i.add(v,k,L,P);const O=()=>{if(!y||!s)return;let R=y.clientWidth,D=y.clientHeight;if(!R||!D){const x=y.getBoundingClientRect();if(R=x.width||200,D=x.height||200,!x.width||!x.height){requestAnimationFrame(O);return}}s.setSize(R,D,!0),r.aspect=R/Math.max(1,D),r.updateProjectionMatrix()};O(),_=new ResizeObserver(O),_.observe(y),requestAnimationFrame(()=>{O(),requestAnimationFrame(()=>{O(),requestAnimationFrame(O)})});const I=()=>{if(!s||!i||!r)return;a=requestAnimationFrame(I);const R=u.getDelta();l&&l.update(R),c&&(c.rotation.y+=R*.6),s.render(i,r)};I(),p=!0,f("[PuppetModelView] Three.js initialized successfully, container size:",y.clientWidth,"x",y.clientHeight)}function g(){l&&(l.stopAllAction(),l=null),c&&(i.remove(c),c.traverse(y=>{y.isMesh&&(y.geometry&&y.geometry.dispose(),Array.isArray(y.material)?y.material.forEach(v=>{v.map&&v.map.dispose(),v&&v.dispose&&v.dispose()}):y.material&&(y.material.map&&y.material.map.dispose(),y.material.dispose&&y.material.dispose()))}),c=null)}function m(y){const v=new dn().setFromObject(y),k=new Be,L=new Be;v.getSize(k),v.getCenter(L),y.position.sub(L),y.position.add(new Be(0,0,0)),y.scale.multiplyScalar(.8);const O=s==null?void 0:s.domElement,I=O?O.clientWidth||O.width:200,R=O?O.clientHeight||O.height:200,D=Math.max(1e-6,I/Math.max(1,R)),x=r.fov*(Math.PI/180),z=2*Math.atan(Math.tan(x/2)*D),ge=1.05,re=k.y/2/Math.tan(x/2),he=k.x/2/Math.tan(z/2),q=ge*Math.max(re,he,.1);r.position.set(0,0,q),r.lookAt(0,0,0)}async function w(y){var L;if(!y)return;f("[PuppetModelView] Loading puppet:",y.name),o.value=!0,b(),g();const v=++d;f("[PuppetModelView] ");let k=y.modelUrl||"";if(f("[PuppetModelView] Original modelUrl:",k),f("[PuppetModelView] Puppet image:",y.image),f("[PuppetModelView] Puppet name:",y.name),f("[PuppetModelView] Puppet data:",y),!k||k.trim()===""){f("[PuppetModelView] No model URL found");return}f("[PuppetModelView] Final Model URL:",k);try{f("[PuppetModelView] Starting to load:",k),f("[PuppetModelView] Cache status:",Rn.getCacheStatus());const P=await Rn.loadModel(k);if(f("[PuppetModelView] Model loaded from cache manager:",P),v!==d){f("[PuppetModelView] Ignoring outdated load result for:",y.name),gltf&&gltf.scene&&gltf.scene.traverse(O=>{O.isMesh&&(O.geometry&&O.geometry.dispose(),Array.isArray(O.material)?O.material.forEach(I=>{I.map&&I.map.dispose(),I.dispose&&I.dispose()}):O.material&&(O.material.map&&O.material.map.dispose(),O.material.dispose&&O.material.dispose()))});return}if(f("[PuppetModelView] Applying model for:",y.name),!i){f("[PuppetModelView] Scene not ready, initializing..."),b();let O=0;for(;!i&&O<40;)await new Promise(I=>setTimeout(I,50)),O++;if(!i){f("[PuppetModelView] Scene initialization timeout");return}}if(c=P,!c){f("[PuppetModelView] No model instance received");return}i.add(c),m(c),f("[PuppetModelView] Model loaded successfully:",y.name,"Scene children:",i.children.length),o.value=!1}catch(P){if(f("[PuppetModelView] Load failed:",P),f("[PuppetModelView] Failed URL:",k),f("[PuppetModelView] Puppet data:",y),typeof(P==null?void 0:P.message)=="string"&&P.message.includes("DRACOLoader")){f("[PuppetModelView] Retrying without Draco decoder...");try{const O=new Rc;O.setCrossOrigin("anonymous");const I=await O.loadAsync(k);if(v===d&&(c=I.scene||((L=I.scenes)==null?void 0:L[0]),c)){i.add(c),I.animations&&I.animations.length&&(l=new S0(c),l.clipAction(I.animations[0]).play()),m(c),f("[PuppetModelView] Model loaded successfully without Draco:",y.name);return}}catch(O){f("[PuppetModelView] Fallback load also failed:",O)}}if(v===d){const O=new hs(1,1,1),I=new Ut({color:8947967});c=new St(O,I),i.add(c),m(c)}o.value=!1}}return Ln(()=>t.puppet,async y=>{await _r(),w(y)},{immediate:!1}),hn(()=>{f("[PuppetModelView] Component mounted"),_r(()=>{n.value&&(b(),t.puppet&&setTimeout(()=>{w(t.puppet)},0))})}),Ps(()=>{if(f("[PuppetModelView] Cleaning up..."),cancelAnimationFrame(a),g(),_&&n.value)try{_.unobserve(n.value)}catch{}const y=i,v=s;s=null,i=null,r=null,p=!1,d=0;const k=()=>{if(f("[PuppetModelView] Starting deferred cleanup..."),y&&y.traverse(L=>{if(L.isMesh)try{if(L.geometry&&L.geometry.dispose(),Array.isArray(L.material))L.material.forEach(P=>{try{P.map&&P.map.dispose(),P.dispose&&P.dispose()}catch{}});else if(L.material)try{L.material.map&&L.material.map.dispose(),L.material.dispose&&L.material.dispose()}catch{}}catch{}}),v)try{v.dispose(),v.forceContextLoss&&v.forceContextLoss()}catch{}f("[PuppetModelView] Deferred cleanup completed")};typeof window<"u"&&window.requestIdleCallback?window.requestIdleCallback(k,{timeout:1e3}):setTimeout(k,100),f("[PuppetModelView] Quick cleanup completed, heavy cleanup deferred")}),(y,v)=>(V(),ee("div",mI,[h("div",{ref_key:"mountEl",ref:n,class:"model-canvas"},null,512),o.value?(V(),ee("div",fI,[...v[0]||(v[0]=[h("div",{class:"loading-spinner"},null,-1)])])):Ie("",!0)]))}},gI=Vt(hI,[["__scopeId","data-v-0e860b93"]]),bI={class:"warehouse"},yI={class:"warehouse__resources"},wI={class:"resource-icon"},vI=["src","alt"],SI={class:"resource-value"},kI={class:"resource-tooltip"},MI={key:0,class:"warehouse__main"},CI={class:"warehouse__sidebar"},xI={class:"puppet-list"},PI=["onClick","onMouseenter"],LI={class:"puppet-card__quantity"},II={class:"puppet-card__image"},TI=["src","alt"],EI={class:"puppet-card__info"},AI={class:"puppet-card__name"},GI={class:"puppet-card__level"},RI={class:"puppet-detail__header"},OI={class:"puppet-detail__name"},DI={class:"puppet-detail__content"},NI={class:"puppet-detail__row"},jI={class:"puppet-detail__model"},HI={class:"puppet-detail__description"},FI={class:"puppet-detail__row"},UI={class:"puppet-detail__stats"},BI={class:"stats-section"},zI={class:"stat-item"},VI={class:"stat-value"},qI={class:"stat-item"},WI={class:"stat-value"},KI={class:"stat-item"},JI={class:"stat-value"},XI={class:"stat-item"},YI={class:"stat-value"},ZI={class:"stat-item"},QI={class:"stat-value"},eT={class:"stat-item"},tT={class:"stat-value"},nT={class:"stat-item"},sT={class:"stat-value"},oT={class:"equipment-section"},iT={class:"equipment-slots"},rT=["src","alt"],aT=["src"],cT=["src"],lT={key:3,class:"equipment-icon"},uT={key:0,class:"skill-section"},_T={class:"skill-info"},$T={class:"skill-text"},dT={class:"skill-name"},pT={class:"skill-cooldown"},mT={class:"skill-effect"},fT={class:"skill-icon"},hT=["src","alt"],gT={key:1},bT={class:"puppet-detail__upgrade"},yT={class:"upgrade-cost"},wT=["src"],vT={class:"cost-amount"},ST=["disabled"],kT=["src"],MT={class:"warehouse__placeholder",key:"placeholder"},CT=["src"],xT={__name:"Warehouse",props:{musicOn:{type:Boolean,default:!0}},setup(e,{expose:t}){Zn(q=>({fdb82c0e:ge,v4f1f7bb6:z,v4f1e1e99:R,v4f1e92f8:D,v4f1f0757:x}));const n=e,o=["SpiritalSpark","RecallGear","ResonantCrystal","RefinedCopper","HeartCrystalDust"];function s(q){return o.map(G=>({icon:Wn[G].icon,name:Wn[G].name,value:Number((q==null?void 0:q[G])??0)}))}const i={IronWall:"",Arcanist:"",CraftsMan:"",Mechanic:"",Resonator:""};function r(q){const G=Number(q??1);return G===1?5:G===2?10:G===3?20:G===4?30:0}function a(q){return(q||[]).map((G,Y)=>{var te,K,X,_e,ie,Z;const U=(G==null?void 0:G.copper_info)||{},j=(U==null?void 0:U.skill)||{},J=(G==null?void 0:G.equipment_slot)||{},W=(J==null?void 0:J.slot1)||null,we=(J==null?void 0:J.slot2)||null,De=(G==null?void 0:G.attribute)||{},Ke=((te=W==null?void 0:W.equipment_base)==null?void 0:te.attribute)||{},Fe=((K=we==null?void 0:we.equipment_base)==null?void 0:K.attribute)||{},it=Number(Ke.attack||0)+Number(Fe.attack||0),ht=Number(Ke.defense||0)+Number(Fe.defense||0),$t=Number(Ke.dodge||0)+Number(Fe.dodge||0),Ot=G==null?void 0:G.copper_type,C=(G==null?void 0:G.level)??1,T=(U==null?void 0:U.model_url)||"",A=T?Q(T):"";return{id:Number((G==null?void 0:G.id)??Y+1),name:(U==null?void 0:U.name)??"",level:C,suffix:(G==null?void 0:G.suffix)??0,image:Q((U==null?void 0:U.icon_url)||""),modelUrl:A,quantity:1,description:(U==null?void 0:U.description)||"",stats:{level:`${C}/5`,health:Number(De.health||0),live_left:Number((G==null?void 0:G.live_left)??0),attack:{base:Number(De.attack||0),bonus:it},defense:{base:Number(De.defense||0),bonus:ht},dodge:{base:Number(De.dodge||0),bonus:$t},class:i[Ot]||""},equipment:[W?{name:((X=W.equipment_base)==null?void 0:X.name)||"",icon:Q(((_e=W.equipment_base)==null?void 0:_e.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1},J!=null&&J.is_slot2_locked?{name:"",icon:"",equipped:!1,locked:!0}:we?{name:((ie=we.equipment_base)==null?void 0:ie.name)||"",icon:Q(((Z=we.equipment_base)==null?void 0:Z.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1}],skill:{name:(j==null?void 0:j.name)||"",cooldown:(j==null?void 0:j.cool_down)!=null?`${j.cool_down}`:"",effect:(j==null?void 0:j.description)||"",icon:Q((j==null?void 0:j.resource_url)||"")},upgradeCost:r(C)}})}function c(q,G,Y=[]){if(!q||typeof q!="object")return null;if(Object.prototype.hasOwnProperty.call(q,G))return[...Y,G];if(Array.isArray(q)){for(let U=0;U<q.length;U++){const j=c(q[U],G,[...Y,U]);if(j)return j}return null}for(const U of Object.keys(q)){const j=c(q[U],G,[...Y,U]);if(j)return j}return null}function l(q,G){return G.reduce((Y,U)=>Y!=null?Y[U]:void 0,q)}const u=oe([]);async function _(){try{const q=Gc();q&&(u.value=s(q))}catch(q){console.error("[Warehouse] :",q),u.value=s({})}}hn(()=>{_(),lc(vn.UPDATE_RESOURCES,_)});function $(q){let G=q;if(typeof q=="string")try{G=JSON.parse(q)}catch{}G&&G.type_msg&&(G.type_msg==="upgrade_cost_error"?alert(G.content||""):f("[GlobalInfo]",G))}hn(()=>{try{rh($)}catch{}n.musicOn&&re.value&&setTimeout(()=>{if(re.value.readyState>=2)re.value.play().then(()=>{f("[Warehouse] ")}).catch(G=>{f("[Warehouse] :",G)});else{const G=()=>{re.value.play().then(()=>{f("[Warehouse] ")}).catch(Y=>{f("[Warehouse] :",Y)}),re.value.removeEventListener("canplay",G)};re.value.addEventListener("canplay",G,{once:!0})}},200)}),Ln(()=>n.musicOn,q=>{if(re.value)if(q)if(re.value.readyState>=2)re.value.play().catch(G=>{f("[Warehouse] :",G)});else{const G=()=>{re.value.play().catch(Y=>{f("[Warehouse] :",Y)}),re.value.removeEventListener("canplay",G)};re.value.addEventListener("canplay",G)}else re.value.pause()}),Ps(()=>{re.value&&re.value.pause(),Cu(vn.UPDATE_RESOURCES,_)});const d=oe([]);hn(async()=>{try{const q=fa();let G=q&&Array.isArray(q.coppers)?q.coppers:[];if(!Array.isArray(G)){const Y=c(q,"coppers");if(f("[Warehouse] copper key path:",Y),Y){const U=l(q,Y);f("[Warehouse] copper found by path:",U),Array.isArray(U)&&(G=U)}!Array.isArray(G)&&q&&q.entries&&f("[Warehouse] copper entries sample:",q.entries)}Array.isArray(G)||f("[Warehouse] copper list not array"),d.value=a(G),Array.isArray(d.value)&&d.value.length>0&&(p.value=d.value[0]),!p.value&&Array.isArray(d.value)&&d.value.length>0&&(p.value=d.value[0])}catch{d.value=[]}});const p=oe(null),b=oe([]),g=oe(null),m=oe(null),w=oe(null);function y(q,G){q&&(b.value[G]=q)}async function v(q,G){p.value=q,await _r();const Y=b.value[G];if(Y&&typeof Y.scrollIntoView=="function"&&Y.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}),g.value=G,m.value)try{m.value.scrollTo({top:0,behavior:"smooth"})}catch{m.value.scrollTop=0}setTimeout(()=>{g.value===G&&(g.value=null)},320)}const k=oe(!1);function L(){k.value=!0}function P(){return k.value?(k.value=!1,!0):!1}t({handleBack:P});async function O(q){try{await _();const G=fa(),Y=Array.isArray(G==null?void 0:G.coppers)?G.coppers:[];d.value=a(Y)}catch{}}async function I(){if(!p.value)return;if(Number(p.value.level||0)>=5){alert("");return}const q=p.value.id,G=m7(q);if(!G||G.type!=="success"){alert(G&&G.content?G.content:"");return}try{await _();const Y=fa(),U=Array.isArray(Y==null?void 0:Y.coppers)?Y.coppers:[];d.value=a(U);const j=d.value.find(J=>J.id===q);j&&(p.value=j)}catch{}}const R=`url('${Q("@assets/ui/panel2.png")}')`,D=`url('${Q("@assets/ui/panel3.png")}')`,x=`url('${Q("@assets/ui/panel4.png")}')`,z=`url('${Q("@assets/ui/panel5.png")}')`,ge=`url('${Q("@assets/frontend_resource/Gemini_Generated_Image_e03q5oe03q5oe03q.png")}')`,re=oe(null),he=Q("assets/warehouse.mp3");return(q,G)=>(V(),ee("div",bI,[h("div",yI,[(V(!0),ee(mt,null,Xn(u.value,Y=>(V(),ee("div",{class:"resource-item",key:Y.name},[h("div",wI,[h("img",{src:Y.icon,alt:Y.name},null,8,vI)]),h("div",SI,ce(Y.value),1),h("div",kI,ce(Y.name),1)]))),128))]),k.value?Ie("",!0):(V(),ee("div",MI,[h("div",CI,[G[2]||(G[2]=h("div",{class:"warehouse__title"},"",-1)),h("div",xI,[(V(!0),ee(mt,null,Xn(d.value,(Y,U)=>{var j;return V(),ee("div",{class:wt(["puppet-card",{"puppet-card--selected":((j=p.value)==null?void 0:j.id)===Y.id,"puppet-card--pulse":g.value===U,"puppet-card--hover":w.value===U}]),key:Y.id,ref_for:!0,ref:J=>y(J,U),onClick:J=>v(Y,U),onMouseenter:J=>w.value=U,onMouseleave:G[0]||(G[0]=J=>w.value=null)},[h("div",LI,ce(Y.level),1),h("div",II,[h("img",{src:Y.image,alt:Y.name},null,8,TI)]),h("div",EI,[h("div",AI,ce(Y.name)+ce(Y.suffix),1),h("div",GI,ce(Y.level)+"",1)])],42,PI)}),128)),h("div",{class:"puppet-card puppet-card--add",onClick:L},[...G[1]||(G[1]=[h("div",{class:"puppet-card__add-icon"},"+",-1),h("div",{class:"puppet-card__add-text"},"",-1)])])])]),h("div",{class:"warehouse__detail",ref_key:"detailWrap",ref:m},[Ct(Eb,{name:"fade-slide",mode:"out-in"},{default:Vd(()=>{var Y,U,j,J;return[p.value?(V(),ee("div",{class:"puppet-detail",key:((Y=p.value)==null?void 0:Y.id)||"none"},[h("div",RI,[h("h2",OI,ce(p.value.name),1)]),h("div",DI,[h("div",NI,[h("div",jI,[Ct(gI,{puppet:p.value},null,8,["puppet"])]),h("div",HI,ce(p.value.description),1)]),h("div",FI,[h("div",UI,[h("div",BI,[h("div",zI,[G[3]||(G[3]=h("span",{class:"stat-label"},":",-1)),h("span",VI,ce(p.value.stats.health),1)]),h("div",qI,[G[4]||(G[4]=h("span",{class:"stat-label"},":",-1)),h("span",WI,ce(p.value.stats.level),1)]),h("div",KI,[G[5]||(G[5]=h("span",{class:"stat-label"},":",-1)),h("span",JI,ce(p.value.stats.live_left),1)]),h("div",XI,[G[6]||(G[6]=h("span",{class:"stat-label"},":",-1)),h("span",YI,ce(p.value.stats.attack.base),1)]),h("div",ZI,[G[7]||(G[7]=h("span",{class:"stat-label"},":",-1)),h("span",QI,ce(p.value.stats.defense.base),1)]),h("div",eT,[G[8]||(G[8]=h("span",{class:"stat-label"},":",-1)),h("span",tT,ce(p.value.stats.dodge.base)+"% ",1)]),h("div",nT,[G[9]||(G[9]=h("span",{class:"stat-label"},":",-1)),h("span",sT,ce(p.value.stats.class),1)])])]),h("div",oT,[G[10]||(G[10]=h("h4",{class:"section-title"},"",-1)),h("div",iT,[(V(!0),ee(mt,null,Xn(p.value.equipment,(W,we)=>(V(),ee("div",{key:we,class:wt(["equipment-slot",{"equipment-slot--empty":!W.equipped&&!W.locked,"equipment-slot--locked":W.locked}])},[W.equipped&&W.icon&&(W.icon.startsWith("/")||W.icon.startsWith("http"))?(V(),ee("img",{key:0,src:W.icon,alt:W.name,class:"equipment-icon"},null,8,rT)):W.locked?(V(),ee("img",{key:1,src:ye(Q)("@assets/ui/lock.png"),alt:"",class:"equipment-icon"},null,8,aT)):W.icon===""?(V(),ee("img",{key:2,src:ye(Q)("@assets/ui/jia.png"),alt:"",class:"equipment-icon"},null,8,cT)):(V(),ee("span",lT,ce(W.icon),1))],2))),128))])])]),((j=(U=p.value)==null?void 0:U.stats)==null?void 0:j.class)!==""?(V(),ee("div",uT,[G[11]||(G[11]=h("h4",{class:"section-title"},"",-1)),h("div",_T,[h("div",$T,[h("div",dT,ce(p.value.skill.name),1),h("div",pT," : "+ce(p.value.skill.cooldown),1),h("div",mT,ce(p.value.skill.effect),1)]),h("div",fT,[p.value.skill.icon&&(p.value.skill.icon.startsWith("/")||p.value.skill.icon.startsWith("http"))?(V(),ee("img",{key:0,src:p.value.skill.icon,alt:p.value.skill.name,class:"skill-icon-img"},null,8,hT)):(V(),ee("span",gT,ce(p.value.skill.icon),1))])])])):Ie("",!0)]),h("div",bT,[h("div",yT,[p.value.level<5?(V(),ee("img",{key:0,src:ye(Wn).SpiritalSpark.icon,alt:"",class:"cost-icon-img"},null,8,wT)):Ie("",!0),h("span",vT,ce(p.value.level>=5?"":"X "+p.value.upgradeCost),1)]),h("button",{class:"upgrade-btn",onClick:I,disabled:((J=p.value)==null?void 0:J.level)>=5},[h("img",{src:ye(Q)("@assets/ui/upgrade.png"),class:"upgrade-icon",alt:""},null,8,kT)],8,ST)])])):(V(),ee("div",MT,[...G[12]||(G[12]=[h("p",null,"",-1)])]))]}),_:1})],512)])),k.value?(V(),kn(E7,{key:1,onDraw:O})):Ie("",!0),h("audio",{ref_key:"audioRef",ref:re,src:ye(he),loop:"",preload:"auto"},null,8,CT)]))}},PT=Vt(xT,[["__scopeId","data-v-6aa3978d"]]),LT={class:"panel",style:{left:"24px",right:"auto"}},IT=["title"],TT={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ET={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},AT={class:"sr-only"},GT={__name:"TopLeftPanel",props:{musicOn:{type:Boolean,default:!0}},emits:["back","open-settings","toggle-music"],setup(e,{emit:t}){return(n,o)=>(V(),ee("div",LT,[h("button",{class:"btn",onClick:o[0]||(o[0]=s=>n.$emit("back")),title:""},[...o[3]||(o[3]=[h("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[h("path",{d:"M15 18L9 12L15 6",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),h("span",{class:"sr-only"},"",-1)])]),h("button",{class:"btn",onClick:o[1]||(o[1]=s=>n.$emit("toggle-music")),title:e.musicOn?"":""},[e.musicOn?(V(),ee("svg",TT,[...o[4]||(o[4]=[h("path",{d:"M9 18V5L21 3V16",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),h("circle",{cx:"6",cy:"18",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),h("circle",{cx:"18",cy:"16",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1)])])):(V(),ee("svg",ET,[...o[5]||(o[5]=[h("path",{d:"M9 18V5L21 3V16",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),h("circle",{cx:"6",cy:"18",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),h("circle",{cx:"18",cy:"16",r:"3",stroke:"#ffffff","stroke-width":"2"},null,-1),h("line",{x1:"2",y1:"2",x2:"22",y2:"22",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round"},null,-1)])])),h("span",AT,ce(e.musicOn?"":""),1)],8,IT),h("button",{class:"btn",onClick:o[2]||(o[2]=s=>n.$emit("open-settings")),title:""},[...o[6]||(o[6]=[h("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[h("path",{d:"M12 15.5C13.933 15.5 15.5 13.933 15.5 12C15.5 10.067 13.933 8.5 12 8.5C10.067 8.5 8.5 10.067 8.5 12C8.5 13.933 10.067 15.5 12 15.5Z",stroke:"#ffffff","stroke-width":"2"}),h("path",{d:"M19.4 15A7.964 7.964 0 0 0 20 12C20 11.49 19.95 10.99 19.86 10.5L22 8.5L20 5.5L17.34 6.07C16.78 5.58 16.14 5.18 15.44 4.9L15 2H9L8.56 4.9C7.86 5.18 7.22 5.58 6.66 6.07L4 5.5L2 8.5L4.14 10.5C4.05 10.99 4 11.49 4 12C4 12.51 4.05 13.01 4.14 13.5L2 15.5L4 18.5L6.66 17.93C7.22 18.42 7.86 18.82 8.56 19.1L9 22H15L15.44 19.1C16.14 18.82 16.78 18.42 17.34 17.93L20 18.5L22 15.5L19.86 13.5C19.95 13.01 20 12.51 20 12",stroke:"#ffffff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),h("span",{class:"sr-only"},"",-1)])])]))}},J$=Vt(GT,[["__scopeId","data-v-8380a348"]]),RT=["automatic_loading_gun","charging_coil","heart_source_mineral_drill","mirro_light_refraction_tower","repair_workshop","resonance_alarm_bell","rivet_barrier","steam_mining_car","storm_anvil"];function OT(){const e=[],t=[{type:"arcanist",name:"bubble"},{type:"craftsman",name:"coil"},{type:"iron_wall",name:"bell"},{type:"mechanic",name:"gyro"},{type:"resonator",name:"clawster"}];for(const o of t){const s=rc(o.type,o.name);e.push(s)}const n=["goblin","guard","demon"];for(const o of n){const s=ac(o);e.push(s)}return f(`[ModelPreloadConfig]  ${e.length} URL`),e}function DT(){const e=[],t=[{type:"arcanist",name:"glimmer"},{type:"arcanist",name:"spark"},{type:"craftsman",name:"artifex"},{type:"craftsman",name:"wrench"},{type:"iron_wall",name:"chief"},{type:"iron_wall",name:"rocky"},{type:"mechanic",name:"karin"},{type:"mechanic",name:"tricky"},{type:"resonator",name:"diggs"},{type:"resonator",name:"hive"}];for(const o of t){const s=rc(o.type,o.name);e.push(s)}const n=["assassin","boxer","cruiser","devourer","glutton"];for(const o of n){const s=ac(o);e.push(s)}return f(`[ModelPreloadConfig]  ${e.length} URL`),e}function NT(){const e=[],t=[{type:"arcanist",name:"syrup"},{type:"arcanist",name:"turner"},{type:"craftsman",name:"drillbit"},{type:"craftsman",name:"quickhand"},{type:"iron_wall",name:"tumble"},{type:"iron_wall",name:"wesley"},{type:"mechanic",name:"pendulum"},{type:"mechanic",name:"yoyo"},{type:"resonator",name:"melody"},{type:"resonator",name:"murmur"}];for(const o of t){const s=rc(o.type,o.name);e.push(s)}const n=["horn","mirror","scout","shatra","variant"];for(const o of n){const s=ac(o);e.push(s)}for(const o of RT){const s=Ep(o);e.push(s)}return f(`[ModelPreloadConfig]  ${e.length} URL`),e}function jT(e=["high","medium"]){const t=[];for(const o of e)switch(o){case"high":t.push(...OT());break;case"medium":t.push(...DT());break;case"low":t.push(...NT());break}const n=[...new Set(t)];return f(`[ModelPreloadConfig]  ${e.join(", ")}  ${n.length} URL`),n}class HT{constructor(){this.isPreloading=!1,this.preloadProgress=0,this.preloadCallbacks=[]}async startPreload(t=["high","medium"],n=null){if(this.isPreloading){f("[ModelPreloadManager] ");return}this.isPreloading=!0,this.preloadProgress=0;try{const o=jT(t);f(`[ModelPreloadManager]  ${o.length}  (: ${t.join(", ")})`),n&&this.preloadCallbacks.push(n),await Rn.preloadModels(o,(s,i,r)=>{this.preloadProgress=r,this.notifyProgress(s,i,r)}),f("[ModelPreloadManager] ")}catch(o){f("[ModelPreloadManager] :",o)}finally{this.isPreloading=!1,this.preloadCallbacks=[]}}notifyProgress(t,n,o){this.preloadCallbacks.forEach(s=>{try{s(t,n,o)}catch(i){f("[ModelPreloadManager] :",i)}})}getStatus(){return{isPreloading:this.isPreloading,progress:this.preloadProgress,cacheStatus:Rn.getCacheStatus()}}isModelPreloaded(t){return Rn.isPreloaded(t)}async preloadModel(t){try{await Rn.loadModel(t,!0),f(`[ModelPreloadManager] : ${t}`)}catch(n){f(`[ModelPreloadManager] : ${t}`,n)}}async preloadModels(t){const n=t.map(o=>this.preloadModel(o));await Promise.all(n),f(`[ModelPreloadManager] : ${t.length} `)}}const X$=new HT,lh="mgpic_game_settings",Y$={controlMode:"touchpad",mouseSensitivity:.002};function Dc(){try{const e=localStorage.getItem(lh);if(e){const t=JSON.parse(e);return{...Y$,...t}}}catch(e){console.error("[GameSettings] :",e)}return{...Y$}}function FT(e){try{return localStorage.setItem(lh,JSON.stringify(e)),!0}catch(t){return console.error("[GameSettings] :",t),!1}}function Z$(e){return Dc()[e]}function uh(e,t){const n=Dc();return n[e]=t,FT(n)}const UT={class:"startmenu"},BT={key:0,class:"download-banner"},zT={key:1,class:"settings-local"},VT={class:"settings-local__card"},qT={class:"settings-local__content"},WT={class:"settings-local__row"},KT={class:"setting-options"},JT={__name:"StartMenu",props:{visible:{type:Boolean,default:!0}},emits:["started"],setup(e,{emit:t}){Zn(x=>({c38888f0:g}));const n=e,o=oe(null);let s=null,i=null,r=null,a=null,c=null,l=1.2;const u=oe(!1),_=oe(!1),$=oe(!1),d=oe("touchpad"),p=oe(!1),b=oe(Q("ui/Gemini_Generated_Image_gtrehogtrehogtre (1).png")),g=`url('${Q("@assets/ui/panel4.png")}')`,m=t;Ln(()=>n.visible,x=>{x&&s&&c?k():x||v()});function w(){if(a=requestAnimationFrame(w),c){const x=Date.now()*.001;c.position.y=Math.sin(x*.8)*.1,c.rotation.y=Math.sin(x*.6)*.1;const z=l+Math.sin(x*1.2)*.04;c.scale.setScalar(z)}r&&r.render(s,i)}function y(){!r||!i||(i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight))}function v(){a&&(cancelAnimationFrame(a),a=null),r&&r.setAnimationLoop(null)}function k(){a||w()}function L(){try{v()}catch{}try{window.removeEventListener("resize",y)}catch{}try{s&&(s.traverse(x=>{if(x.isMesh){x.geometry&&x.geometry.dispose&&x.geometry.dispose();const z=x.material;Array.isArray(z)?z.forEach(ge=>ge&&ge.dispose&&ge.dispose()):z&&z.dispose&&z.dispose()}}),s.clear())}catch{}try{if(r){r.clear(!0,!0,!0),r.dispose();const x=r.getContext&&r.getContext(),z=x&&x.getExtension&&x.getExtension("WEBGL_lose_context");z&&z.loseContext&&z.loseContext()}}catch{}s=null,i=null,r=null,c=null}async function P(x=null){try{window.getAssetUrl=Q,window.precacheAllResources=Dl,window.getCacheStatus=r1}catch{}if(!s||!r){f("[StartMenu] Scene or renderer not initialized in onMounted");return}if(x&&x(0,100,20),!s.children.some(re=>re.isLight)){const re=new Ka(4210752,.4);s.add(re);const he=new ys(16777215,12.5);he.position.set(-5,-2,1),s.add(he)}x&&x(0,100,50);const ge=Q("logo.glb");try{x&&x(0,100,60),f("[StartMenu] Logo...");const re=await Rn.loadModel(ge,!0);x&&x(0,100,80),re.position.set(0,0,0),s.add(re);const q=new dn().setFromObject(re).getCenter(new Be);re.position.set(-q.x,-q.y,-q.z-.3);try{re.scale.setScalar(l)}catch{}c=re,x&&x(0,100,80),f("[StartMenu] Logo ...");try{await X$.startPreload(["high","medium"],(G,Y,U)=>{const j=80+U*.15;x&&x(0,100,Math.round(j)),f(`[StartMenu] : ${G}/${Y} (${U}%)`)}),f("[StartMenu] ")}catch(G){f("[StartMenu] :",G)}x&&x(0,100,100),u.value=!0,f("[StartMenu] "),_.value=!0}catch(re){f("[StartMenu] 3D",re);const he=new hs(1,1,1),q=new Bt({color:16096779}),G=new St(he,q);s.add(G),c=G,f("[StartMenu] ...");try{await X$.startPreload(["high","medium"],(Y,U,j)=>{const J=80+j*.15;x&&x(0,100,Math.round(J)),f(`[StartMenu] : ${Y}/${U} (${j}%)`)}),f("[StartMenu] ")}catch(Y){f("[StartMenu] :",Y)}x&&x(0,100,100),u.value=!0,f("[StartMenu] "),_.value=!0}window.__START_MENU_PAUSE__=()=>v(),window.__START_MENU_RESUME__=()=>k()}function O(){m("started"),v()}function I(){const x=Dc();d.value=x.controlMode,$.value=!0}function R(){$.value=!1}function D(x){d.value=x,uh("controlMode",x),window.updateControlMode&&window.updateControlMode(x),f(`[StartMenu] : ${x}`)}return hn(()=>{var x;_.value=!1,u.value=!1,p.value=typeof window<"u"&&(window.navigator.userAgent.toLowerCase().includes("electron")||((x=window.process)==null?void 0:x.type)==="renderer"||!!(window.require&&window.process&&window.process.versions&&window.process.versions.electron)),f("[StartMenu] ..."),f("[StartMenu] Electron :",p.value),!s&&o.value?(s=new qa,s.background=null,i=new Ir(50,window.innerWidth/window.innerHeight,.1,1e3),i.position.set(-3.655,.2,-.006),i.rotation.set(-1.618275,-1.538307,-1.6183,"XYZ"),r=new Wa({antialias:!0,alpha:!0,canvas:o.value}),r.setSize(window.innerWidth,window.innerHeight),r.setPixelRatio(window.devicePixelRatio),r.setClearColor(0,0),window.addEventListener("resize",y),w(),f("[StartMenu] ")):s&&!c?f("[StartMenu] "):c&&(f("[StartMenu] Logo"),_.value=!0,u.value=!0),window.__INIT_THREE_SCENE__=async z=>{if(s&&c){f("[StartMenu] Logo"),_.value=!0,u.value=!0;return}f("[StartMenu] 3D..."),await P(z)}}),Ps(()=>{L()}),(x,z)=>(V(),ee("div",UT,[p.value?Ie("",!0):(V(),ee("div",BT,[...z[2]||(z[2]=[h("span",{class:"download-banner__text"},"  ",-1),h("a",{href:"https://github.com/MGPIC-2025/Cross/releases",target:"_blank",rel:"noopener noreferrer",class:"download-banner__link"},"  ",-1)])])),h("div",{class:"startmenu__bg",style:Bn({backgroundImage:`url('${b.value}')`})},null,4),h("canvas",{ref_key:"canvasRef",ref:o,class:"startmenu__canvas"},null,512),qd(h("div",{class:wt(["startmenu-ui",{"fade-in":_.value}])},[h("button",{id:"start-btn",class:"startmenu-btn","aria-label":"",onClick:O},"  "),h("button",{id:"settings-btn",class:"startmenu-btn","aria-label":"",onClick:I},"  ")],2),[[Lp,_.value]]),$.value?(V(),ee("div",zT,[h("div",VT,[h("div",{class:"settings-local__header"},[z[3]||(z[3]=h("div",{class:"settings-local__title"},"",-1)),h("button",{class:"settings-local__close",onClick:R,"aria-label":""},"  ")]),h("div",qT,[h("div",WT,[z[6]||(z[6]=h("div",{class:"setting-label"},"",-1)),h("div",KT,[h("button",{class:wt(["option-btn",{active:d.value==="touchpad"}]),onClick:z[0]||(z[0]=ge=>D("touchpad"))},[...z[4]||(z[4]=[h("span",{class:"option-title"},"",-1),h("span",{class:"option-desc"},"",-1)])],2),h("button",{class:wt(["option-btn",{active:d.value==="mouse"}]),onClick:z[1]||(z[1]=ge=>D("mouse"))},[...z[5]||(z[5]=[h("span",{class:"option-title"},"",-1),h("span",{class:"option-desc"},"",-1)])],2)])])])])])):Ie("",!0)]))}},XT=Vt(JT,[["__scopeId","data-v-b236fd15"]]),Q$={type:"change"},o_={type:"start"},_h={type:"end"},oa=new C0,ed=new dd,YT=Math.cos(70*_d.DEG2RAD),Ht=new Be,yn=2*Math.PI,_t={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},fl=1e-6;class ZT extends M0{constructor(t,n=null){super(t,n),this.state=_t.NONE,this.target=new Be,this.cursor=new Be,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:di.ROTATE,MIDDLE:di.DOLLY,RIGHT:di.PAN},this.touches={ONE:$i.ROTATE,TWO:$i.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new Be,this._lastQuaternion=new Si,this._lastTargetPosition=new Be,this._quat=new Si().setFromUnitVectors(t.up,new Be(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new p_,this._sphericalDelta=new p_,this._scale=1,this._panOffset=new Be,this._rotateStart=new _n,this._rotateEnd=new _n,this._rotateDelta=new _n,this._panStart=new _n,this._panEnd=new _n,this._panDelta=new _n,this._dollyStart=new _n,this._dollyEnd=new _n,this._dollyDelta=new _n,this._dollyDirection=new Be,this._mouse=new _n,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=e8.bind(this),this._onPointerDown=QT.bind(this),this._onPointerUp=t8.bind(this),this._onContextMenu=c8.bind(this),this._onMouseWheel=o8.bind(this),this._onKeyDown=i8.bind(this),this._onTouchStart=r8.bind(this),this._onTouchMove=a8.bind(this),this._onMouseDown=n8.bind(this),this._onMouseMove=s8.bind(this),this._interceptControlDown=l8.bind(this),this._interceptControlUp=u8.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Q$),this.update(),this.state=_t.NONE}update(t=null){const n=this.object.position;Ht.copy(n).sub(this.target),Ht.applyQuaternion(this._quat),this._spherical.setFromVector3(Ht),this.autoRotate&&this.state===_t.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let o=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(o)&&isFinite(s)&&(o<-Math.PI?o+=yn:o>Math.PI&&(o-=yn),s<-Math.PI?s+=yn:s>Math.PI&&(s-=yn),o<=s?this._spherical.theta=Math.max(o,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(o+s)/2?Math.max(o,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let i=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const r=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),i=r!=this._spherical.radius}if(Ht.setFromSpherical(this._spherical),Ht.applyQuaternion(this._quatInverse),n.copy(this.target).add(Ht),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let r=null;if(this.object.isPerspectiveCamera){const a=Ht.length();r=this._clampDistance(a*this._scale);const c=a-r;this.object.position.addScaledVector(this._dollyDirection,c),this.object.updateMatrixWorld(),i=!!c}else if(this.object.isOrthographicCamera){const a=new Be(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),i=c!==this.object.zoom;const l=new Be(this._mouse.x,this._mouse.y,0);l.unproject(this.object),this.object.position.sub(l).add(a),this.object.updateMatrixWorld(),r=Ht.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;r!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(r).add(this.object.position):(oa.origin.copy(this.object.position),oa.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(oa.direction))<YT?this.object.lookAt(this.target):(ed.setFromNormalAndCoplanarPoint(this.object.up,this.target),oa.intersectPlane(ed,this.target))))}else if(this.object.isOrthographicCamera){const r=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),r!==this.object.zoom&&(this.object.updateProjectionMatrix(),i=!0)}return this._scale=1,this._performCursorZoom=!1,i||this._lastPosition.distanceToSquared(this.object.position)>fl||8*(1-this._lastQuaternion.dot(this.object.quaternion))>fl||this._lastTargetPosition.distanceToSquared(this.target)>fl?(this.dispatchEvent(Q$),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?yn/60*this.autoRotateSpeed*t:yn/60/60*this.autoRotateSpeed}_getZoomScale(t){const n=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*n)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,n){Ht.setFromMatrixColumn(n,0),Ht.multiplyScalar(-t),this._panOffset.add(Ht)}_panUp(t,n){this.screenSpacePanning===!0?Ht.setFromMatrixColumn(n,1):(Ht.setFromMatrixColumn(n,0),Ht.crossVectors(this.object.up,Ht)),Ht.multiplyScalar(t),this._panOffset.add(Ht)}_pan(t,n){const o=this.domElement;if(this.object.isPerspectiveCamera){const s=this.object.position;Ht.copy(s).sub(this.target);let i=Ht.length();i*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*i/o.clientHeight,this.object.matrix),this._panUp(2*n*i/o.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/o.clientWidth,this.object.matrix),this._panUp(n*(this.object.top-this.object.bottom)/this.object.zoom/o.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,n){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const o=this.domElement.getBoundingClientRect(),s=t-o.left,i=n-o.top,r=o.width,a=o.height;this._mouse.x=s/r*2-1,this._mouse.y=-(i/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(yn*this._rotateDelta.x/n.clientHeight),this._rotateUp(yn*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let n=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(yn*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),n=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-yn*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),n=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(yn*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),n=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-yn*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const n=this._getSecondPointerPosition(t),o=.5*(t.pageX+n.x),s=.5*(t.pageY+n.y);this._rotateStart.set(o,s)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const n=this._getSecondPointerPosition(t),o=.5*(t.pageX+n.x),s=.5*(t.pageY+n.y);this._panStart.set(o,s)}}_handleTouchStartDolly(t){const n=this._getSecondPointerPosition(t),o=t.pageX-n.x,s=t.pageY-n.y,i=Math.sqrt(o*o+s*s);this._dollyStart.set(0,i)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const o=this._getSecondPointerPosition(t),s=.5*(t.pageX+o.x),i=.5*(t.pageY+o.y);this._rotateEnd.set(s,i)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const n=this.domElement;this._rotateLeft(yn*this._rotateDelta.x/n.clientHeight),this._rotateUp(yn*this._rotateDelta.y/n.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const n=this._getSecondPointerPosition(t),o=.5*(t.pageX+n.x),s=.5*(t.pageY+n.y);this._panEnd.set(o,s)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const n=this._getSecondPointerPosition(t),o=t.pageX-n.x,s=t.pageY-n.y,i=Math.sqrt(o*o+s*s);this._dollyEnd.set(0,i),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const r=(t.pageX+n.x)*.5,a=(t.pageY+n.y)*.5;this._updateZoomParameters(r,a)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==t.pointerId){this._pointers.splice(n,1);return}}_isTrackingPointer(t){for(let n=0;n<this._pointers.length;n++)if(this._pointers[n]==t.pointerId)return!0;return!1}_trackPointer(t){let n=this._pointerPositions[t.pointerId];n===void 0&&(n=new _n,this._pointerPositions[t.pointerId]=n),n.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const n=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[n]}_customWheelEvent(t){const n=t.deltaMode,o={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(n){case 1:o.deltaY*=16;break;case 2:o.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(o.deltaY*=10),o}}function QT(e){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(e)&&(this._addPointer(e),e.pointerType==="touch"?this._onTouchStart(e):this._onMouseDown(e)))}function e8(e){this.enabled!==!1&&(e.pointerType==="touch"?this._onTouchMove(e):this._onMouseMove(e))}function t8(e){switch(this._removePointer(e),this._pointers.length){case 0:this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(_h),this.state=_t.NONE;break;case 1:const t=this._pointers[0],n=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:n.x,pageY:n.y});break}}function n8(e){let t;switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case di.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(e),this.state=_t.DOLLY;break;case di.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(e),this.state=_t.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(e),this.state=_t.ROTATE}break;case di.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(e),this.state=_t.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(e),this.state=_t.PAN}break;default:this.state=_t.NONE}this.state!==_t.NONE&&this.dispatchEvent(o_)}function s8(e){switch(this.state){case _t.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(e);break;case _t.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(e);break;case _t.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(e);break}}function o8(e){this.enabled===!1||this.enableZoom===!1||this.state!==_t.NONE||(e.preventDefault(),this.dispatchEvent(o_),this._handleMouseWheel(this._customWheelEvent(e)),this.dispatchEvent(_h))}function i8(e){this.enabled!==!1&&this._handleKeyDown(e)}function r8(e){switch(this._trackPointer(e),this._pointers.length){case 1:switch(this.touches.ONE){case $i.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(e),this.state=_t.TOUCH_ROTATE;break;case $i.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(e),this.state=_t.TOUCH_PAN;break;default:this.state=_t.NONE}break;case 2:switch(this.touches.TWO){case $i.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(e),this.state=_t.TOUCH_DOLLY_PAN;break;case $i.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(e),this.state=_t.TOUCH_DOLLY_ROTATE;break;default:this.state=_t.NONE}break;default:this.state=_t.NONE}this.state!==_t.NONE&&this.dispatchEvent(o_)}function a8(e){switch(this._trackPointer(e),this.state){case _t.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(e),this.update();break;case _t.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(e),this.update();break;case _t.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(e),this.update();break;case _t.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(e),this.update();break;default:this.state=_t.NONE}}function c8(e){this.enabled!==!1&&e.preventDefault()}function l8(e){e.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function u8(e){e.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const _8={class:"startgame-modal"},$8={class:"card"},d8={class:"card__header"},p8=["src"],m8={class:"card__body"},f8={class:"card__content"},h8={key:0,class:"loading"},g8={key:1,class:"error"},b8={key:2,class:"list"},y8=["onClick"],w8={class:"item__img"},v8=["src","alt"],S8={class:"item__meta"},k8={class:"item__name"},M8={class:"item__level"},C8={class:"preview"},x8={class:"preview__info"},P8={key:0,class:"preview__empty"},L8={key:1,class:"preview__names"},I8={class:"preview__name-number"},T8={class:"preview__name-text"},E8={class:"card__footer"},A8=["disabled"],G8=["src"],R8={__name:"StartGame",props:{musicOn:{type:Boolean,default:!0},paused:{type:Boolean,default:!1}},emits:["confirm","close"],setup(e,{emit:t}){Zn(j=>({v5a78398b:z,v5a792249:re,v5a7bdc83:Y,v1702c6a6:U,v5a7a7f66:he,v5a7b6824:G,v5a78adea:ge,v5a7af3c5:q}));const n=t,o=e,s=oe(!0),i=oe(""),r=oe([]),a=oe(new Set),c=oe(null),l=oe(null),u=Q("@assets/frontend_resource/startgame.mp3");let _,$,d,p,b;const g=new Map,m=Xe(()=>a.value.size===3),w=Xe(()=>r.value.filter(j=>a.value.has(j.id)));function y(){if(!c.value)return;_=new qa,_.background=new as(1710618),$=new Ir(45,c.value.clientWidth/c.value.clientHeight,.1,100),$.position.set(0,3,8),d=new Wa({antialias:!0}),d.setSize(c.value.clientWidth,c.value.clientHeight),d.setPixelRatio(window.devicePixelRatio),c.value.appendChild(d.domElement),p=new ZT($,d.domElement),p.enableDamping=!0,p.dampingFactor=.05,p.target.set(0,1,0);const j=new Ka(16777215,.5);_.add(j);const J=new ys(16777215,1);J.position.set(0,5,10),_.add(J);const W=new ys(11193599,.4);W.position.set(-5,3,5),_.add(W);const we=new ys(16764074,.4);we.position.set(5,3,5),_.add(we);const De=new ys(16777215,.3);De.position.set(0,5,-5),_.add(De);const Ke=new cr(20,20),Fe=new Ut({color:2763306,side:Cn}),it=new St(Ke,Fe);it.rotation.x=-Math.PI/2,it.position.y=0,_.add(it),b=new Rc;const ht=new Oc;ht.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),b.setDRACOLoader(ht),v(),window.addEventListener("resize",k)}function v(){requestAnimationFrame(v),p&&p.update(),d&&_&&$&&d.render(_,$)}function k(){!c.value||!$||!d||($.aspect=c.value.clientWidth/c.value.clientHeight,$.updateProjectionMatrix(),d.setSize(c.value.clientWidth,c.value.clientHeight))}function L(j){const J=a.value;if(J.has(j))J.delete(j);else{if(J.size>=3)return;J.add(j)}a.value=new Set(J)}async function P(j,J){if(!_||!b)return;let W=j.modelUrl;f(`[StartGame] model_url: ${j.name}, URL: ${W}`);try{const we=await Rn.loadModel(W,!0);f(`[StartGame] : ${j.name}`);const Ke=new dn().setFromObject(we).getSize(new Be),Fe=new ts;Fe.add(we);const it=2.5,ht=-(w.value.length-1)*it/2;Fe.position.set(ht+J*it,0,0),Fe.scale.set(1,1,1),Fe.rotation.y=-Math.PI/2;const $t=new dn().setFromObject(Fe);Fe.position.y=-$t.min.y,_.add(Fe),g.set(j.id,Fe),f(`[StartGame] : ${j.name}`)}catch(we){f(`[StartGame] : ${j.name}`,we),O(j,J)}}function O(j,J){if(!_)return;const W=new hs(.8,.8,.8),we=new Ut({color:4491519}),De=new St(W,we),Ke=2.5,Fe=-(w.value.length-1)*Ke/2;De.position.set(Fe+J*Ke,.8,0),De.rotation.y=-Math.PI/2,_.add(De),g.set(j.id,De)}function I(){_&&(g.forEach(j=>{_.remove(j),j.geometry&&j.geometry.dispose(),j.material&&(Array.isArray(j.material)?j.material.forEach(J=>J.dispose()):j.material.dispose())}),g.clear(),w.value.forEach((j,J)=>{P(j,J)}))}async function R(){s.value=!0,i.value="";try{const j=fa(),J=Array.isArray(j==null?void 0:j.coppers)?j.coppers:[];r.value=(J||[]).map((W,we)=>{var Ke,Fe,it,ht,$t,Ot;const De=(Ke=W==null?void 0:W.copper_info)==null?void 0:Ke.model_url;return f(`[StartGame] Copper ${((Fe=W==null?void 0:W.copper_info)==null?void 0:Fe.name)||we+1}: model_url=${De}`),{id:Number((W==null?void 0:W.id)??we+1),name:((it=W==null?void 0:W.copper_info)==null?void 0:it.name)||`#${we+1}`,icon:Q(((ht=W==null?void 0:W.copper_info)==null?void 0:ht.icon_url)||""),level:Number((W==null?void 0:W.level)??1),copperType:(W==null?void 0:W.copper_type)||"Arcanist",modelName:((Ot=($t=W==null?void 0:W.copper_info)==null?void 0:$t.name)==null?void 0:Ot.toLowerCase())||"",modelUrl:De?Q(De):""}})}catch(j){f("[StartGame] ",j),i.value=""}finally{s.value=!1}}async function D(){if(a.value.size!==3)return;const j=Array.from(a.value).map(J=>String(J));window.__ACTUAL_COPPER_IDS__=j,f("[StartGame] ID:",j),n("confirm",{ids:j})}function x(){n("close")}Ln(w,()=>{I()},{deep:!0}),hn(()=>{R(),setTimeout(()=>{y()},100),o.musicOn&&!o.paused&&l.value&&setTimeout(()=>{if(l.value.readyState>=2)l.value.play().then(()=>{f("[StartGame] ")}).catch(J=>{f("[StartGame] :",J)});else{const J=()=>{l.value.play().then(()=>{f("[StartGame] ")}).catch(W=>{f("[StartGame] :",W)}),l.value.removeEventListener("canplay",J)};l.value.addEventListener("canplay",J,{once:!0})}},200)}),Ln(()=>o.musicOn,j=>{if(l.value)if(j&&!o.paused)if(l.value.readyState>=2)l.value.play().catch(J=>{f("[StartGame] :",J)});else{const J=()=>{l.value.play().catch(W=>{f("[StartGame] :",W)}),l.value.removeEventListener("canplay",J)};l.value.addEventListener("canplay",J)}else l.value.pause()}),Ln(()=>o.paused,j=>{if(l.value){if(j)l.value.pause(),f("[StartGame] ");else if(o.musicOn){if(l.value.readyState>=2)l.value.play().catch(J=>{f("[StartGame] :",J)});else{const J=()=>{l.value.play().catch(W=>{f("[StartGame] :",W)}),l.value.removeEventListener("canplay",J)};l.value.addEventListener("canplay",J)}f("[StartGame] ")}}}),Ps(()=>{window.removeEventListener("resize",k),l.value&&l.value.pause(),g.forEach(j=>{_&&_.remove(j)}),g.clear(),d&&d.dispose(),p&&p.dispose()});const z=`url('${Q("@assets/ui/panel1.png")}')`,ge=`url('${Q("@assets/ui/panel2.png")}')`,re=`url('${Q("@assets/ui/panel3.png")}')`,he=`url('${Q("@assets/ui/panel6.png")}')`,q=`url('${Q("@assets/ui/panel7.png")}')`,G=`url('${Q("@assets/ui/panel8.png")}')`,Y=`url('${Q("@assets/ui/panel9.png")}')`,U=`url('${Q("@assets/ui/panel10.png")}')`;return(j,J)=>(V(),ee("div",_8,[h("div",$8,[h("div",d8,[J[0]||(J[0]=h("div",{class:"card__title"},"",-1)),h("button",{class:"card__close",onClick:x,"aria-label":""},[h("img",{src:ye(Q)("@assets/ui/close.png"),alt:""},null,8,p8)])]),h("div",m8,[h("div",f8,[s.value?(V(),ee("div",h8,"...")):i.value?(V(),ee("div",g8,ce(i.value),1)):(V(),ee("div",b8,[(V(!0),ee(mt,null,Xn(r.value,W=>(V(),ee("div",{key:W.id,class:wt(["item",{"item--selected":a.value.has(W.id)}]),onClick:we=>L(W.id)},[h("div",w8,[h("img",{src:W.icon,alt:W.name},null,8,v8)]),h("div",S8,[h("div",k8,ce(W.name),1),h("div",M8,"Lv. "+ce(W.level),1)])],10,y8))),128))])),J[1]||(J[1]=h("div",{class:"hint"},"3",-1))]),h("div",C8,[J[2]||(J[2]=h("div",{class:"preview__title"},"",-1)),h("div",{ref_key:"previewContainer",ref:c,class:"preview__scene"},null,512),h("div",x8,[w.value.length===0?(V(),ee("div",P8,"  ")):(V(),ee("div",L8,[(V(!0),ee(mt,null,Xn(w.value,(W,we)=>(V(),ee("div",{key:W.id,class:"preview__name"},[h("span",I8,ce(we+1),1),h("span",T8,ce(W.name),1)]))),128))]))])])]),h("div",E8,[h("button",{class:"btn btn--primary",disabled:!m.value,onClick:D},"  ",8,A8),h("button",{class:"btn",onClick:x},"")])]),h("audio",{ref_key:"audioRef",ref:l,src:ye(u),loop:"",preload:"auto"},null,8,G8)]))}},O8=Vt(R8,[["__scopeId","data-v-a6884db3"]]),D8={:"spark",:"syrup",:"bubble",:"glimmer",:"turner",:"wrench",:"artifex",:"coil",:"drillbit",:"quickhand",:"rocky",:"wesley",:"bell",:"tumble",:"chief",:"gyro",:"tricky",:"pendulum",:"yoyo",:"karin",:"murmur",:"melody",:"clawster",:"diggs",:"hive"},N8={IronWall:"iron_wall",Arcanist:"arcanist",Mechanic:"mechanic",Resonator:"resonator",CraftsMan:"craftsman"};function j8(e){return D8[e]||e.toLowerCase()}function H8(e){return N8[e]||e.toLowerCase()}const F8={:"rivet_barrier",:"gear_arrow_tower",:"heart_source_mineral_drill",:"steam_mining_car",:"charging_coil",:"repair_workshop",:"mirro_light_refraction_tower",:"resonance_alarm_bell",:"storm_anvil",:"automatic_loading_gun"};function U8(e){return F8[e]||e.toLowerCase().replace(/\s+/g,"_")}function B8(e,t){const n=new Map;function o(l,u,_){if(n.has(l)){const k=n.get(l);k.maxHp=_,s(l,u,_);return}const $=1,d=.1,p=new cr($,d),b=new Bt({color:4456448,side:Cn,depthTest:!1,depthWrite:!1,transparent:!1,toneMapped:!1}),g=new St(p,b),m=new cr($,d),w=new Bt({color:i(u,_),side:Cn,depthTest:!1,depthWrite:!1,transparent:!1,toneMapped:!1}),y=new St(m,w);y.position.z=.001;const v=new ts;v.add(g),v.add(y),v.renderOrder=999,g.renderOrder=999,y.renderOrder=1e3,e.add(v),n.set(l,{bar:y,background:g,container:v,maxHp:_}),s(l,u,_)}function s(l,u,_){const $=n.get(l);if(!$)return;const{bar:d}=$,p=Math.max(0,Math.min(1,u/_));d.scale.x=p,d.position.x=-(1-p)*.5,d.material.color.setHex(i(u,_))}function i(l,u){const _=l/u;return _>.6?65280:_>.3?16776960:16711680}function r(l){const u=n.get(l);if(!u)return;const{bar:_,background:$,container:d}=u;_.geometry.dispose(),_.material.dispose(),$.geometry.dispose(),$.material.dispose(),e.remove(d),n.delete(l)}function a(l){n.forEach((u,_)=>{const $=l.find(d=>d.id===_);if($&&$.object){const{container:d}=u,p=$.object.position.clone();p.y+=1.5,d.position.copy(p),d.lookAt(t.position)}})}function c(){n.forEach((l,u)=>{r(u)}),n.clear()}return{healthBars:n,createOrUpdateHealthBar:o,updateHealthBarValue:s,removeHealthBar:r,updateHealthBarsPosition:a,dispose:c}}const z8={url:Q("@assets/ui/skybox.jpg"),radius:1e3,segments:32,hemisphere:!1},V8={ambient:{color:16777215,intensity:.5},mainDirectional:{color:16777215,intensity:1.2,position:{x:0,y:20,z:5},castShadow:!0},topLight:{color:16777215,intensity:.8,position:{x:0,y:30,z:0}},hemisphere:{skyColor:16777215,groundColor:4473924,intensity:.6,position:{x:0,y:20,z:0}}};function q8(){return{...z8}}const W8={fov:60,near:.1,far:2e3,position:{x:0,y:5,z:10}},K8={antialias:!0},J8={decoderPath:"https://www.gstatic.com/draco/versioned/decoders/1.5.6/"},X8={moveSpeed:.2,rotationSpeed:.003,focusLerpFactor:.08},Y8={enabled:!0,units:[{id:1,name:"1",color:4491519,position:{x:.5,y:.4,z:.5},size:.8},{id:2,name:"2",color:16729156,position:{x:4.5,y:.4,z:4.5},size:.8}]},Z8={enabled:!0,materialType:"standard",basic:{color:4868682,opacity:.8},standard:{color:5921386,roughness:.3,metalness:.7,opacity:.8},texture:{url:null,repeat:{x:1,y:1}},size:.95,height:.05,yOffset:-.02},Q8={enabled:!1,size:100,materialType:"standard",texture:{url:null,repeat:{x:10,y:10},wrapS:"RepeatWrapping",wrapT:"RepeatWrapping"},color:{value:2763306},standard:{color:3815994,roughness:.8,metalness:.1,normalMap:null,normalScale:{x:1,y:1},roughnessMap:null,aoMap:null},position:{x:0,y:0,z:0},rotation:{x:-Math.PI/2,y:0,z:0}};function eE(){return{...V8}}function tE(){return{...W8}}function nE(){return{...K8}}function sE(){return{...J8}}function td(){return{...X8}}function oE(){return{...Y8}}function iE(){return{...Q8}}function $h(){return{...Z8}}function rE(e){const t={move:[],attack:[],summon:[]},n=$h();function o(_={}){var d;const $={...n,..._};if(!$.enabled)return new Bt({transparent:!0,opacity:0});if($.materialType==="texture"&&$.texture.url){const b=new ki().load($.texture.url);return b.colorSpace=en,b.wrapS=Bs,b.wrapT=Bs,b.repeat.set($.texture.repeat.x,$.texture.repeat.y),new Ut({map:b,side:Cn,transparent:!0,opacity:((d=$.standard)==null?void 0:d.opacity)||1})}else return $.materialType==="standard"?new Ut({color:$.standard.color,roughness:$.standard.roughness,metalness:$.standard.metalness,side:Cn,transparent:!0,opacity:$.standard.opacity}):new Bt({color:$.basic.color,side:Cn,transparent:!0,opacity:$.basic.opacity})}const s={move:{color:4521796,opacity:.6},attack:{color:16729156,opacity:.6},summon:{color:16776960,opacity:.6}};function i(_,$="move"){const[d,p]=_,b=s[$]||s.move,g=n.size||.9,m=n.height||.08,w=new cr(g,g),y=new Bt({color:b.color,side:Cn,transparent:!0,opacity:b.opacity}),v=new St(w,y);return v.rotation.x=-Math.PI/2,v.position.set(d,m,p),v.userData={position:_,type:$},e.add(v),t[$].push(v),v}function r(_){const[$,d]=_;let p=!1;return Object.keys(t).forEach(b=>{const g=t[b].findIndex(m=>{const w=m.userData.position;return w[0]===$&&w[1]===d});if(g!==-1){const m=t[b][g];e.remove(m),m.geometry.dispose(),m.material.dispose(),t[b].splice(g,1),p=!0}}),p}function a(_){t[_]&&(t[_].forEach($=>{e.remove($),$.geometry.dispose(),$.material.dispose()}),t[_]=[])}function c(){Object.keys(t).forEach(_=>{a(_)})}function l(_,$){var b;const[d,p]=_;return(b=t[$])==null?void 0:b.some(g=>{const m=g.userData.position;return m[0]===d&&m[1]===p})}function u(){c()}return{indicators:t,createIndicator:i,createCellMaterial:o,clearIndicatorAt:r,clearIndicators:a,clearAllIndicators:c,hasIndicatorAt:l,dispose:u}}function aE(){const e={geometries:[],materials:[],meshes:[],maxSize:10},t={geometries:[],materials:[],meshes:[],maxSize:10};function n(a){let c;if(e.meshes.length>0)c=e.meshes.pop(),c.geometry.dispose(),c.geometry=new ga(.05,.05,a,8),c.material.opacity=.9;else{const l=new ga(.05,.05,a,8),u=new Bt({color:16729156,transparent:!0,opacity:.9,emissive:16729156,emissiveIntensity:.5});c=new St(l,u)}return c}function o(a){e.meshes.length<e.maxSize?e.meshes.push(a):(a.geometry.dispose(),a.material.dispose())}function s(){let a;if(t.meshes.length>0)a=t.meshes.pop(),a.scale.set(1,1,1),a.material.opacity=.8;else{const c=new wl(.2,.4,32),l=new Bt({color:16711680,side:Cn,transparent:!0,opacity:.8,emissive:16711680,emissiveIntensity:.5});a=new St(c,l),a.rotation.x=-Math.PI/2}return a}function i(a){t.meshes.length<t.maxSize?t.meshes.push(a):(a.geometry.dispose(),a.material.dispose())}function r(){e.meshes.forEach(a=>{a.geometry.dispose(),a.material.dispose()}),e.meshes=[],e.geometries=[],e.materials=[],t.meshes.forEach(a=>{a.geometry.dispose(),a.material.dispose()}),t.meshes=[],t.geometries=[],t.materials=[]}return{getAttackRay:n,recycleAttackRay:o,getExplosionRing:s,recycleExplosionRing:i,dispose:r}}function cE(e){const t=aE();function n(i,r){const a=new Be(i[0],.5,i[1]),c=new Be(r[0],.5,r[1]),l=a.distanceTo(c),u=t.getAttackRay(l),_=new Be().addVectors(a,c).multiplyScalar(.5);u.position.copy(_);const $=new Be().subVectors(c,a).normalize(),d=new Si;d.setFromUnitVectors(new Be(0,1,0),$),u.quaternion.copy(d),e.add(u);let p=.9;const b=()=>{p-=.05,u.material.opacity=p,p<=0?(e.remove(u),t.recycleAttackRay(u)):requestAnimationFrame(b)};setTimeout(b,300);const g=t.getExplosionRing();g.position.set(r[0],.1,r[1]),e.add(g);let m=1,w=.8;const y=()=>{m+=.1,w-=.08,g.scale.set(m,m,1),g.material.opacity=w,w<=0?(e.remove(g),t.recycleExplosionRing(g)):requestAnimationFrame(y)};y()}function o(i,r){const a=Object.entries(r).filter(([v,k])=>k>0).map(([v,k])=>{const L=Zt(v);return`+${k} ${L}`});if(a.length===0)return;const c=a.join(`
`),l=document.createElement("canvas"),u=l.getContext("2d");l.width=512,l.height=256,u.fillStyle="rgba(0, 0, 0, 0)",u.fillRect(0,0,l.width,l.height),u.font="bold 48px Arial",u.fillStyle="#ffff00",u.strokeStyle="#000000",u.lineWidth=4,u.textAlign="center",u.textBaseline="middle";const _=c.split(`
`),$=60,d=l.height/2-(_.length-1)*$/2;_.forEach((v,k)=>{const L=d+k*$;u.strokeText(v,l.width/2,L),u.fillText(v,l.width/2,L)});const p=new x0(l),b=new P0({map:p,transparent:!0,opacity:1}),g=new L0(b);g.scale.set(2,1,1),g.position.set(i[0],1.5,i[1]),e.add(g);let m=1.5,w=1;const y=()=>{m+=.02,w-=.01,g.position.y=m,g.material.opacity=w,w<=0?(e.remove(g),g.material.map.dispose(),g.material.dispose()):requestAnimationFrame(y)};y()}function s(){t.dispose()}return{createAttackEffect:n,createResourceGainEffect:o,dispose:s}}const lE={gameScene:Q("@assets/frontend_resource/gamescene.mp3")},uE={move:Q("@assets/frontend_resource/move.mp3"),moveEnemy:Q("@assets/frontend_resource/move_enemy.mp3"),attack:Q("@assets/frontend_resource/attack.mp3"),attackEnemy:Q("@assets/frontend_resource/attack_enemy.mp3"),meHurt:Q("@assets/frontend_resource/me_hurt.mp3"),enemyHurt:Q("@assets/frontend_resource/enemy_hurt.mp3")};function _E(e){return lE[e]||""}function ii(e){return uE[e]||""}let Et=null;function $E(e,t,n={}){const{radius:o=1e3,segments:s=32,hemisphere:i=!1}=n;Et&&(e.remove(Et),Et.geometry&&Et.geometry.dispose(),Et.material&&(Et.material.map&&Et.material.map.dispose(),Et.material.dispose()),Et=null),new ki().load(t,a=>{a.colorSpace=en;const c=i?new vl(o,s,s,0,Math.PI*2,0,Math.PI/2):new vl(o,s,s),l=new Bt({map:a,side:T0,depthWrite:!1});Et=new St(c,l),Et.position.set(0,0,0),e.add(Et),f(`[SceneUtils] ${i?"":""}${o}`)},void 0,a=>{f("[SceneUtils] ",a),e.background=new as(2236962)})}function dE(e,t){if(!t||!t.url){e.background=new as(2236962);return}$E(e,t.url,{radius:t.radius||1e3,segments:t.segments||32,hemisphere:t.hemisphere||!1})}function pE(e,t){const n=new Ka(t.ambient.color,t.ambient.intensity);e.add(n);const o=new ys(t.mainDirectional.color,t.mainDirectional.intensity);o.position.set(t.mainDirectional.position.x,t.mainDirectional.position.y,t.mainDirectional.position.z),o.castShadow=t.mainDirectional.castShadow,e.add(o);const s=new ys(t.topLight.color,t.topLight.intensity);s.position.set(t.topLight.position.x,t.topLight.position.y,t.topLight.position.z),e.add(s);const i=new I0(t.hemisphere.skyColor,t.hemisphere.groundColor,t.hemisphere.intensity);i.position.set(t.hemisphere.position.x,t.hemisphere.position.y,t.hemisphere.position.z),e.add(i)}function mE(e={}){const t={...tE(),...e},n=window.innerWidth/window.innerHeight,o=new Ir(t.fov,n,t.near,t.far);return o.position.set(t.position.x,t.position.y,t.position.z),o}function fE(e,t={}){const n={...nE(),...t},o=t.width||window.innerWidth,s=t.height||window.innerHeight,i=new Wa({antialias:n.antialias});return i.setSize(o,s),i.setPixelRatio(window.devicePixelRatio),e.appendChild(i.domElement),i}function hE(e=null){const t=sE(),n=e||t.decoderPath,o=new Rc,s=new Oc;return s.setDecoderPath(n),o.setDRACOLoader(s),o}function gE(e,t){const n=oE();n.enabled&&(n.units.forEach(o=>{const s=new hs(o.size,o.size,o.size),i=new Ut({color:o.color}),r=new St(s,i);r.position.set(o.position.x,o.position.y,o.position.z),e.add(r),t.push({id:o.id,object:r,name:o.name,type:"test"})}),f("[SceneUtils] :",t.map(o=>`ID=${o.id}`)))}function bE(e,t={}){const n={...iE(),...t};if(!n.enabled)return null;const o=new cr(n.size,n.size);let s;if(n.materialType==="texture"&&n.texture.url){const a=new ki().load(n.texture.url);a.colorSpace=en,a.wrapS=m_[n.texture.wrapS]||Bs,a.wrapT=m_[n.texture.wrapT]||Bs,a.repeat.set(n.texture.repeat.x,n.texture.repeat.y),s=new Ut({map:a,side:Cn})}else if(n.materialType==="color")s=new Bt({color:n.color.value,side:Cn});else{const r={color:n.standard.color,roughness:n.standard.roughness,metalness:n.standard.metalness,side:Cn},a=new ki;if(n.standard.normalMap){const c=a.load(n.standard.normalMap);c.colorSpace=en,r.normalMap=c,r.normalScale=new _n(n.standard.normalScale.x,n.standard.normalScale.y)}if(n.standard.roughnessMap){const c=a.load(n.standard.roughnessMap);c.colorSpace=en,r.roughnessMap=c}if(n.standard.aoMap){const c=a.load(n.standard.aoMap);c.colorSpace=en,r.aoMap=c}s=new Ut(r)}const i=new St(o,s);return i.position.set(n.position.x,n.position.y,n.position.z),i.rotation.set(n.rotation.x,n.rotation.y,n.rotation.z),i.renderOrder=-200,e.add(i),f(`[SceneUtils] ${n.materialType}${n.size}`),i}function yE(e){Et&&e&&(e.remove(Et),Et.geometry&&Et.geometry.dispose(),Et.material&&(Et.material.map&&Et.material.map.dispose(),Et.material.dispose()),Et=null)}const wE={key:0,class:"diamond-name"},vE={class:"diamond-row diamond-row--top"},SE=["title","aria-disabled"],kE={class:"diamond border-orange-red"},ME={class:"diamond-content"},CE={class:"diamond-text"},xE={class:"diamond-value"},PE={class:"diamond-row diamond-row--bottom"},LE={class:"diamond border-orange-red"},IE={class:"diamond-content"},TE={class:"diamond-text"},EE={class:"diamond-value"},AE={class:"diamond border-green"},GE={class:"diamond-content"},RE={class:"diamond-text"},OE={class:"diamond-value"},DE={class:"diamond border-blue"},NE={class:"diamond-content"},jE={class:"diamond-text"},HE={class:"diamond-value"},FE={__name:"DiamondPanel",props:{copperInfo:{type:Object,required:!0},inventoryItems:{type:Array,default:()=>[]},inventoryCapacity:{type:Number,default:5}},emits:["inventory-click"],setup(e,{emit:t}){Zn(m=>({e06679e6:$,bff86908:n,ec019c62:o,v7deac64f:s}));const n=`url('${Q("ui/border-blue.png")}')`,o=`url('${Q("ui/border-green.png")}')`,s=`url('${Q("ui/border-orange-red.png")}')`,i=e,r=t,a=Xe(()=>{var m;return(((m=i.copperInfo)==null?void 0:m.name)||"").trim()}),c=Xe(()=>{var m,w;return((m=i.copperInfo)==null?void 0:m.isOwnedEnemy)===!0||((w=i.copperInfo)==null?void 0:w.isEnemy)===!0}),l=Xe(()=>c.value&&a.value!==""),u=Xe(()=>{var w;const m=(w=i.copperInfo)==null?void 0:w.position;return!Array.isArray(m)||m.length<2?"--":`${m[0]},${m[1]}`}),_=Xe(()=>c.value===!0),$=`url('${Q("@assets/ui/panel4.png")}')`,d=oe({SpiritalSpark:0,RecallGear:0,ResonantCrystal:0,RefinedCopper:0,HeartCrystalDust:0});async function p(){try{const m=Gc();m&&Object.keys(d.value).forEach(w=>{d.value[w]=m[w]||0})}catch(m){console.error("[DiamondPanel] :",m)}}Xe(()=>Object.values(d.value).filter(m=>m>0).length);function b(){_.value||r("inventory-click")}const g=oe(null);return hn(async()=>{if(p(),lc(vn.UPDATE_RESOURCES,p),!g.value)return;function m(y){return new Promise((v,k)=>{const L=new Image;L.onload=()=>v(L),L.onerror=()=>k(),L.src=y})}function w(y,v){g.value&&g.value.style.setProperty(y,String(v))}try{const[y,v,k]=await Promise.all([m(Q("ui/border-blue.png")),m(Q("ui/border-green.png")),m(Q("ui/border-orange-red.png"))]),L=Math.max(3,Math.round(y.naturalHeight/4)),P=Math.max(3,Math.round(v.naturalHeight/4)),O=Math.max(3,Math.round(k.naturalHeight/4));w("--border-blue-slice",L),w("--border-green-slice",P),w("--border-orange-red-slice",O)}catch{w("--border-blue-slice","8"),w("--border-green-slice","8"),w("--border-orange-red-slice","8")}}),(m,w)=>(V(),ee("div",{ref_key:"diamondPanelRef",ref:g,class:"diamond-panel"},[l.value?(V(),ee("div",wE,ce(a.value),1)):Ie("",!0),h("div",vE,[h("div",{class:wt(["diamond","border-blue",{"diamond--disabled":_.value}]),onClick:b,title:_.value?"":"","aria-disabled":_.value?"true":"false"},[...w[0]||(w[0]=[h("div",{class:"diamond-content"},[h("div",{class:"diamond-text"},[h("div",{class:"diamond-label"},"")])],-1)])],10,SE),h("div",kE,[h("div",ME,[h("div",CE,[w[1]||(w[1]=h("div",{class:"diamond-label"},"",-1)),h("div",xE,ce(u.value),1)])])])]),h("div",PE,[h("div",LE,[h("div",IE,[h("div",TE,[w[2]||(w[2]=h("div",{class:"diamond-label"},"",-1)),h("div",EE,ce(e.copperInfo.attack),1)])])]),h("div",AE,[h("div",GE,[h("div",RE,[w[3]||(w[3]=h("div",{class:"diamond-label"},"",-1)),h("div",OE,ce(e.copperInfo.defense),1)])])]),h("div",DE,[h("div",NE,[h("div",jE,[w[4]||(w[4]=h("div",{class:"diamond-label"},"",-1)),h("div",HE,ce(e.copperInfo.speed),1)])])])])],512))}},UE=Vt(FE,[["__scopeId","data-v-fb57740a"]]),BE={class:"minecraft-inventory"},zE={class:"inventory-layout"},VE={class:"inventory-section"},qE={class:"equipment-header-mc"},WE={class:"copper-name"},KE={class:"inventory-grid"},JE={class:"slot-icon"},XE=["src","alt"],YE=["src"],ZE=["src"],QE={key:3,class:"equipment-icon"},eA={class:"slot-tooltip"},tA={class:"tooltip-name"},nA={__name:"InventoryModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},equipment:{type:Array,default:()=>[]}},emits:["close"],setup(e,{emit:t}){const n=e,o=Xe(()=>n.equipment||[]),s=t;function i(){s("close")}return(r,a)=>e.visible?(V(),ee("div",{key:0,class:"inventory-modal",onClick:Fs(i,["self"])},[h("div",BE,[h("div",zE,[h("div",VE,[h("div",qE,[h("h4",null,[h("span",WE,ce(e.copperName),1),a[0]||(a[0]=Vo("  ",-1))])]),h("div",KE,[(V(),ee(mt,null,Xn(2,(c,l)=>{var u,_,$,d,p,b,g,m,w,y;return h("div",{key:l,class:wt(["inv-slot",{"has-item":l<o.value.length&&((u=o.value[l])==null?void 0:u.equipped),"slot-locked":(_=o.value[l])==null?void 0:_.locked}])},[l<o.value.length?(V(),ee(mt,{key:0},[h("div",JE,[($=o.value[l])!=null&&$.equipped&&((d=o.value[l])!=null&&d.icon)&&o.value[l].icon!==""&&(o.value[l].icon.startsWith("/")||o.value[l].icon.startsWith("http")||o.value[l].icon.includes("."))?(V(),ee("img",{key:0,src:o.value[l].icon,alt:((p=o.value[l])==null?void 0:p.name)||"",class:"equipment-icon"},null,8,XE)):(b=o.value[l])!=null&&b.locked?(V(),ee("img",{key:1,src:ye(Q)("@assets/ui/lock.png"),alt:"",class:"equipment-icon"},null,8,YE)):((g=o.value[l])==null?void 0:g.icon)===""?(V(),ee("img",{key:2,src:ye(Q)("@assets/ui/jia.png"),alt:"",class:"equipment-icon"},null,8,ZE)):(V(),ee("span",QE,ce(((m=o.value[l])==null?void 0:m.icon)||""),1))]),h("div",eA,[h("div",tA,ce(((w=o.value[l])==null?void 0:w.name)||((y=o.value[l])!=null&&y.locked?"":"")),1)])],64)):Ie("",!0)],2)}),64))])])])])])):Ie("",!0)}},sA=Vt(nA,[["__scopeId","data-v-10271215"]]),oA={class:"health-bar","aria-label":"Health Bar"},iA={class:"health-bar__border"},rA={class:"health-bar__border-left"},aA=["src"],cA={class:"health-bar__border-right"},lA=["src"],uA={class:"health-bar__text"},_A={__name:"HealthBar",props:{hp:{type:Number,default:0},maxHp:{type:Number,default:100}},setup(e){Zn(c=>({v3bf30af6:s,v3ceb41be:i}));const t=e,n=Q("ui/blood-border-left.png"),o=Q("ui/blood-border-right.png"),s=`url('${Q("ui/blood-border-middle.png")}')`,i=`url('${Q("ui/blood-bar.png")}')`,r=Xe(()=>{if(!t.maxHp||t.maxHp===0)return 0;const l=Math.max(0,Math.min(t.hp,t.maxHp))/t.maxHp*100;return Math.max(0,Math.min(100,l))}),a=Xe(()=>{const c=Math.max(0,Math.min(t.hp,t.maxHp)),l=t.maxHp||100;return`${Math.round(c)}/${Math.round(l)}`});return(c,l)=>(V(),ee("div",oA,[h("div",iA,[h("div",rA,[h("img",{src:ye(n),alt:""},null,8,aA)]),l[0]||(l[0]=h("div",{class:"health-bar__border-middle"},null,-1)),h("div",cA,[h("img",{src:ye(o),alt:""},null,8,lA)]),h("div",{class:"health-bar__fill",style:Bn({width:`calc(${r.value}% + 20px)`})},null,4),h("div",uA,ce(a.value),1)])]))}},$A=Vt(_A,[["__scopeId","data-v-7b5f9ec2"]]),dA={class:"tri-panel"},pA={class:"diamond","aria-label":""},mA=["src"],fA=["src"],hA=["title"],gA=["src"],bA=["src"],yA=["title"],wA=["src"],vA=["src","alt"],SA={__name:"TriPanel",props:{copperType:{type:String,default:""},canMove:{type:Boolean,default:!0},canAttack:{type:Boolean,default:!0},canSummon:{type:Boolean,default:!1}},emits:["move","wait","attack","summon","build"],setup(e,{emit:t}){const n=e,o=t,s=Xe(()=>n.copperType==="CraftsMan"?"build":n.copperType==="Resonator"?"summon":"attack"),i=Xe(()=>s.value==="build"?n.canSummon?"":"":s.value==="summon"?n.canSummon?"":"":n.canAttack?"":""),r=Xe(()=>s.value==="build"||s.value==="summon"?!n.canSummon:!n.canAttack),a=Q("ui/your-image.png"),c=Q("ui/boot.png"),l=Q("ui/mushroom.png"),u=Q("ui/sword.png"),_=Q("@assets/ui/summon.png"),$=Q("@assets/ui/build.png");function d(){n.canMove&&o("move")}function p(){o("wait")}function b(){if(s.value==="build"){if(!n.canSummon)return;o("build")}else if(s.value==="summon"){if(!n.canSummon)return;o("summon")}else{if(!n.canAttack)return;o("attack")}}return(g,m)=>(V(),ee("div",dA,[h("div",pA,[h("div",{class:"hex top",title:"",onClick:p},[h("img",{class:"hex-bg",src:ye(a),alt:""},null,8,mA),h("img",{class:"hex-icon",src:ye(c),alt:""},null,8,fA)]),h("div",{class:wt(["hex left",{"is-locked":e.canMove===!1}]),title:e.canMove?"":"",onClick:d},[h("img",{class:"hex-bg",src:ye(a),alt:""},null,8,gA),h("img",{class:"hex-icon",src:ye(l),alt:""},null,8,bA)],10,hA),h("div",{class:wt(["hex right",{"is-locked":r.value}]),title:i.value,onClick:b},[h("img",{class:"hex-bg",src:ye(a),alt:""},null,8,wA),h("img",{class:"hex-icon",src:s.value==="build"?ye($):s.value==="summon"?ye(_):ye(u),alt:s.value==="build"?"":s.value==="summon"?"":""},null,8,vA)],10,yA)])]))}},kA=Vt(SA,[["__scopeId","data-v-38a09e87"]]),MA={class:"modal-header"},CA=["src"],xA={class:"modal-info"},PA={class:"info-text"},LA={class:"copper-name"},IA={class:"modal-body"},TA={class:"structure-list"},EA=["onClick"],AA={class:"structure-header"},GA={class:"structure-name-row"},RA={class:"structure-name"},OA={class:"structure-type"},DA={class:"structure-stats"},NA={class:"stat"},jA={class:"stat-value"},HA={class:"stat"},FA={class:"stat-value"},UA={class:"stat"},BA={class:"stat-value"},zA={class:"stat"},VA={class:"stat-value"},qA={class:"structure-cost"},WA={class:"cost-value"},KA={class:"structure-desc"},JA={key:0,class:"selected-badge"},XA={class:"modal-footer"},YA=["disabled"],ZA={__name:"BuildModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},structureList:{type:Array,default:()=>[]},position:{type:Array,default:null}},emits:["close","build"],setup(e,{emit:t}){Zn(g=>({b71f15e0:_,v26ebd2fa:p,v26e918c0:d,v26ea017e:$,b71e2d22:b}));const n=e,o=t,s=oe(null),i=Xe(()=>[...n.structureList].sort((g,m)=>{const w=y=>{var k;const v=((k=y.cost)==null?void 0:k.cost)||y.cost;return!Array.isArray(v)||v.length===0?0:Array.isArray(v[0])?v[0][1]:v[0].count};return w(g)-w(m)}));function r(g){s.value=g}function a(){if(!s.value){f("[BuildModal] ");return}f("[BuildModal] :",s.value.name),o("build",s.value.name),c()}function c(){s.value=null,o("close")}function l(g){return{:"",:"",:"",:""}[g]||""}function u(g){if(!g)return"";const m=g.cost||g;return!Array.isArray(m)||m.length===0?"":m.map(w=>{var y;if(Array.isArray(w)){const v=w[0],k=w[1];return`${((y=Wn[v])==null?void 0:y.name)||v} x${k}`}return`${cc(w)} x${w.count}`}).join(", ")}const _=`url('${Q("@assets/ui/panel11.png")}')`,$=`url('${Q("@assets/ui/panel7.png")}')`,d=`url('${Q("@assets/ui/panel8.png")}')`,p=`url('${Q("@assets/ui/panel5.png")}')`,b=`url('${Q("@assets/ui/panel12.png")}')`;return(g,m)=>(V(),kn(Xd,{to:"body"},[e.visible?(V(),ee("div",{key:0,class:"modal-overlay",onClick:Fs(c,["self"])},[h("div",{class:"build-modal",onClick:m[0]||(m[0]=Fs(()=>{},["stop"]))},[h("div",MA,[m[1]||(m[1]=h("h2",{class:"modal-title"}," ",-1)),h("button",{class:"close-btn",onClick:c,title:""},[h("img",{src:ye(Q)("@assets/ui/close.png"),alt:""},null,8,CA)])]),h("div",xA,[h("p",PA,[h("span",LA,ce(e.copperName),1),m[2]||(m[2]=Vo("  ",-1))]),m[3]||(m[3]=h("p",{class:"tip-text"},"   ",-1))]),h("div",IA,[h("div",TA,[(V(!0),ee(mt,null,Xn(i.value,w=>{var y,v,k;return V(),ee("div",{key:w.name,class:wt(["structure-card",{selected:((y=s.value)==null?void 0:y.name)===w.name}]),onClick:L=>r(w)},[h("div",AA,[h("div",GA,[h("span",RA,ce(w.name),1)]),h("span",OA,ce(l(w.name)),1)]),h("div",DA,[h("div",NA,[m[4]||(m[4]=h("span",{class:"stat-label"},"",-1)),h("span",jA,ce(w.health),1)]),h("div",HA,[m[5]||(m[5]=h("span",{class:"stat-label"},"",-1)),h("span",FA,ce(((v=w.attribute)==null?void 0:v.attack)||""),1)]),h("div",UA,[m[6]||(m[6]=h("span",{class:"stat-label"},"",-1)),h("span",BA,ce(w.has_storage?"":""),1)]),h("div",zA,[m[7]||(m[7]=h("span",{class:"stat-label"},"",-1)),h("span",VA,ce(w.attack_range||""),1)])]),h("div",qA,[m[8]||(m[8]=h("span",{class:"cost-label"}," ",-1)),h("span",WA,ce(u(w.cost)),1)]),h("div",KA,ce(w.description),1),((k=s.value)==null?void 0:k.name)===w.name?(V(),ee("div",JA,"  ")):Ie("",!0)],10,EA)}),128))])]),h("div",XA,[h("button",{class:"btn btn-cancel",onClick:c},""),h("button",{class:"btn btn-confirm",disabled:!s.value,onClick:a},"  ",8,YA)])])])):Ie("",!0)]))}},QA=Vt(ZA,[["__scopeId","data-v-96b14c10"]]),eG={key:0,class:"copper-panel-parent"},tG={key:0,class:"minimized-content"},nG=["src"],sG={class:"minimized-info"},oG={class:"minimized-name"},iG={class:"minimized-action"},rG=["src"],aG={class:"panel-content"},cG={key:0,class:"resources"},lG={class:"resources-list"},uG=["onClick"],_G={class:"resource-name"},$G={class:"resource-count"},dG={key:2,class:"enemy-info-tip"},pG={__name:"ActionPanel",props:{copper:{type:Object,default:null},resources:{type:Array,default:()=>[]},hasAttackTargets:{type:Boolean,default:!0},onSelectCopper:{type:Function,default:null}},emits:["close","action","selectCopper"],setup(e,{expose:t,emit:n}){Zn(U=>({v9d0cc038:i.value,v4d912a72:r.value,dc9c48e6:a.value,d8c1fd80:c.value,v64ea23bc:u.value,v065590d6:l.value}));const o=e,s=n,i=Xe(()=>`url('${Q("ui/sword.png")}')`),r=Xe(()=>`url('${Q("ui/red.png")}')`),a=Xe(()=>`url('${Q("ui/boot.png")}')`),c=Xe(()=>`url('${Q("ui/green.png")}')`),l=Xe(()=>`url('${Q("@assets/ui/build.png")}')`),u=Xe(()=>`url('${Q("@assets/ui/summon.png")}')`),_=Q("@assets/ui/close.png"),$=oe("full"),d=oe(null),p=oe(!1),b=oe(!1),g=oe([]),m=Xe(()=>{var j,J,W,we,De,Ke,Fe,it,ht,$t,Ot,C,T,A,te,K,X,_e,ie,Z,se,ve,de,Se,Ce,Ve,Te,Ge,be,at,Pt,Dt,An,As,At;if(!o.copper)return null;const U=((J=(j=o.copper.copper)==null?void 0:j.copper_info)==null?void 0:J.name)||((we=(W=o.copper.enemy)==null?void 0:W.enemy_base)==null?void 0:we.name)||((De=o.copper.enemy_base)==null?void 0:De.name)||o.copper.name||` #${o.copper.id}`;return{id:o.copper.id,name:U,level:((Ke=o.copper.copper)==null?void 0:Ke.level)??((Fe=o.copper.enemy)==null?void 0:Fe.level)??((it=o.copper.enemy_base)==null?void 0:it.level)??1,hp:o.copper.now_health,maxHp:(($t=(ht=o.copper.copper)==null?void 0:ht.attribute)==null?void 0:$t.health)??((C=(Ot=o.copper.enemy)==null?void 0:Ot.enemy_base)==null?void 0:C.health)??((T=o.copper.enemy_base)==null?void 0:T.health)??100,attack:((te=(A=o.copper.copper)==null?void 0:A.attribute)==null?void 0:te.attack)??((X=(K=o.copper.enemy)==null?void 0:K.enemy_base)==null?void 0:X.attack)??((_e=o.copper.enemy_base)==null?void 0:_e.attack)??0,defense:((Z=(ie=o.copper.copper)==null?void 0:ie.attribute)==null?void 0:Z.defense)??((ve=(se=o.copper.enemy)==null?void 0:se.enemy_base)==null?void 0:ve.defense)??((de=o.copper.enemy_base)==null?void 0:de.defense)??0,speed:((Ce=(Se=o.copper.copper)==null?void 0:Se.attribute)==null?void 0:Ce.speed)??((Te=(Ve=o.copper.enemy)==null?void 0:Ve.enemy_base)==null?void 0:Te.speed)??((Ge=o.copper.enemy_base)==null?void 0:Ge.speed)??0,canMove:o.copper.can_move,canAttack:o.copper.can_attack,canSummon:o.copper.can_summon,position:Array.isArray(o.copper.position)&&o.copper.position.length>=2?o.copper.position:Array.isArray((be=o.copper.enemy)==null?void 0:be.position)&&o.copper.enemy.position.length>=2?o.copper.enemy.position:Array.isArray((at=o.copper.enemy_base)==null?void 0:at.position)&&o.copper.enemy_base.position.length>=2?o.copper.enemy_base.position:[0,0],inventoryCapacity:((Pt=o.copper.inventory)==null?void 0:Pt.capacity)||0,copperType:((Dt=o.copper.copper)==null?void 0:Dt.copper_type)||((As=(An=o.copper.enemy)==null?void 0:An.enemy_base)==null?void 0:As.enemy_type)||((At=o.copper.enemy_base)==null?void 0:At.enemy_type)||"",isOwnedEnemy:o.copper.isOwnedEnemy===!0,isEnemy:o.copper.isEnemy===!0}}),w=Xe(()=>{var W,we,De,Ke,Fe;if(!o.copper)return[];const U=((W=o.copper.copper)==null?void 0:W.equipment_slot)||{},j=(U==null?void 0:U.slot1)||null,J=(U==null?void 0:U.slot2)||null;return[j?{name:((we=j.equipment_base)==null?void 0:we.name)||"",icon:Q(((De=j.equipment_base)==null?void 0:De.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1},U!=null&&U.is_slot2_locked?{name:"",icon:"",equipped:!1,locked:!0}:J?{name:((Ke=J.equipment_base)==null?void 0:Ke.name)||"",icon:Q(((Fe=J.equipment_base)==null?void 0:Fe.resource_url)||""),equipped:!0,locked:!1}:{name:"",icon:"",equipped:!1,locked:!1}]});Ln(()=>{var U;return(U=o.copper)==null?void 0:U.id},(U,j)=>{U!==j&&($.value="full",d.value=null,p.value=!1,b.value=!1)});async function y(){if(!m.value.canMove)return;f("[ActionPanel] ");const U=o.copper.isOwnedEnemy===!0,j=U?"on_enemy_move_start":"on_move_start";f(`[ActionPanel] : ${U?"":""}, : ${j}`);const J=JSON.stringify({type:j,content:{id:String(m.value.id)}});Ue(J),$.value="minimized",d.value="moving",s("action",{type:"moveStart",copperId:m.value.id})}async function v(){if(f("[ActionPanel] ",{canAttack:m.value.canAttack,copperId:m.value.id,name:m.value.name}),!m.value.canAttack){f("[ActionPanel] : ");return}f("[ActionPanel] ");const U=o.copper.isOwnedEnemy===!0,j=U?"on_enemy_attack_start":"on_attack_start";f(`[ActionPanel] : ${U?"":""}, : ${j}`);const J=JSON.stringify({type:j,content:{id:String(m.value.id)}});Ue(J),$.value="minimized",d.value="attacking",s("action",{type:"attackStart",copperId:m.value.id})}async function k(){if(f("[ActionPanel] ",{canSummon:m.value.canSummon,copperId:m.value.id,name:m.value.name}),!m.value.canSummon){f("[ActionPanel] : ");return}f("[ActionPanel] ");const U=JSON.stringify({type:"on_summon_start",content:{id:String(m.value.id)}});Ue(U),$.value="minimized",d.value="summoning",s("action",{type:"summonStart",copperId:m.value.id})}async function L(){if(f("[ActionPanel] ",{copperId:m.value.id,name:m.value.name}),!m.value.canSummon){f("[ActionPanel] : /");return}s("action",{type:"buildRequest",copperId:m.value.id})}function P(U){f("[ActionPanel] ",(U==null?void 0:U.length)||0,""),g.value=U||[],b.value=!0}async function O(U){f("[ActionPanel] :",U),b.value=!1;const j=JSON.stringify({type:"on_structure_build_start",content:{id:String(m.value.id),name:U}});Ue(j),$.value="minimized",d.value="building",s("action",{type:"buildStart",copperId:m.value.id,structureName:U})}function I(){f("[ActionPanel] "),p.value=!0}async function R(U){f(`[ActionPanel] : index=${U}`);const j=JSON.stringify({type:"on_copper_pick_up",content:{id:String(m.value.id),index:String(U)}});Ue(j),await z()}async function D(){f("[ActionPanel] ");const U=JSON.stringify({type:"on_copper_craft",content:{id:String(m.value.id)}});Ue(U),await z()}async function x(){await D()}async function z(){const j=o.copper.isOwnedEnemy===!0?"on_click_enemy":"on_click_copper",J=JSON.stringify({type:j,content:{id:String(m.value.id)}});Ue(J)}function ge(){f("[ActionPanel] "),s("action",{type:"wait",copperId:m.value.id})}function re(){$.value="full",d.value=null,p.value=!1,s("close")}function he(){p.value=!1}function q(){$.value="full",d.value=null,s("action",{type:"cancel",copperId:m.value.id})}function G(){q(),re()}async function Y(U){o.onSelectCopper?await o.onSelectCopper(U):s("selectCopper",U)}return t({cancelAction:q,handleSelectCopper:Y,showBuildMenu:P}),(U,j)=>{var J,W,we,De,Ke,Fe,it,ht;return V(),ee(mt,null,[e.copper?(V(),ee("div",eG,[Ct(UE,{"copper-info":m.value,"inventory-items":[],"inventory-capacity":5,onInventoryClick:I},null,8,["copper-info"]),Ct($A,{hp:((J=m.value)==null?void 0:J.hp)||0,"max-hp":((W=m.value)==null?void 0:W.maxHp)||100},null,8,["hp","max-hp"]),$.value==="minimized"||e.resources&&e.resources.length>0&&$.value==="full"?(V(),ee("div",{key:0,class:wt(["copper-panel",{"copper-panel--minimized":$.value==="minimized","copper-panel--min-attack":$.value==="minimized"&&d.value==="attacking","copper-panel--min-move":$.value==="minimized"&&d.value==="moving","copper-panel--min-summon":$.value==="minimized"&&d.value==="summoning","copper-panel--min-build":$.value==="minimized"&&d.value==="building"}]),onClick:j[0]||(j[0]=Fs(()=>{},["stop"]))},[$.value==="minimized"?(V(),ee("div",tG,[h("button",{class:"minimized-close",type:"button",onClick:G,title:""},[h("img",{src:ye(_),alt:""},null,8,nG)]),h("div",sG,[h("span",oG,ce(m.value.name),1),h("span",iG,ce(d.value==="moving"?"...":d.value==="attacking"?"...":d.value==="summoning"?"...":d.value==="building"?"...":""),1)])])):(V(),ee(mt,{key:1},[h("button",{class:"close-btn",onClick:re,title:""},[h("img",{src:ye(_),alt:""},null,8,rG)]),h("div",aG,[e.resources&&e.resources.length>0?(V(),ee("div",cG,[j[3]||(j[3]=h("div",{class:"resources-header"}," ",-1)),h("div",lG,[(V(!0),ee(mt,null,Xn(e.resources,($t,Ot)=>(V(),ee("div",{key:Ot,class:"resource-item",onClick:C=>R(Ot),title:""},[h("span",_G,ce(ye(cc)($t)),1),h("span",$G,"x"+ce($t.count||1),1),j[2]||(j[2]=h("span",{class:"resource-pickup"},"",-1))],8,uG))),128))])])):Ie("",!0)])],64))],2)):Ie("",!0),o.copper.isEnemy?Ie("",!0):(V(),kn(kA,{key:1,"copper-type":(we=m.value)==null?void 0:we.copperType,"can-move":((De=m.value)==null?void 0:De.canMove)!==!1,"can-attack":((Ke=m.value)==null?void 0:Ke.canAttack)!==!1,"can-summon":((Fe=m.value)==null?void 0:Fe.canSummon)!==!1,onMove:y,onWait:ge,onAttack:v,onSummon:k,onBuild:L},null,8,["copper-type","can-move","can-attack","can-summon"])),o.copper.isEnemy?(V(),ee("div",dG,[...j[4]||(j[4]=[h("span",null," ",-1)])])):Ie("",!0)])):Ie("",!0),Ct(sA,{visible:p.value,"copper-name":((it=m.value)==null?void 0:it.name)||"",equipment:w.value,onClose:he,onCraft:x},null,8,["visible","copper-name","equipment"]),Ct(QA,{visible:b.value,"copper-name":((ht=m.value)==null?void 0:ht.name)||"","structure-list":g.value,onClose:j[1]||(j[1]=$t=>b.value=!1),onBuild:O},null,8,["visible","copper-name","structure-list"])],64)}}},mG=Vt(pG,[["__scopeId","data-v-5073d991"]]),fG={class:"panel"},hG={class:"panel-inner"},gG={class:"section section-header"},bG=["aria-label"],yG={class:"section section-body"},wG={class:"current-doll",role:"status","aria-live":"polite"},vG={key:0},SG={class:"section section-choices",role:"group","aria-label":"Character Queue"},kG=["aria-pressed","data-copper-id","title","onClick"],MG=["alt","src","data-default-src","data-selected-src"],CG={class:"actions"},xG=["disabled"],PG=["disabled"],LG={__name:"TurnSystem",props:{currentCopperId:{type:Number,default:null},copperList:{type:Array,default:()=>[]},roundNumber:{type:Number,default:1},isEnemyMoving:{type:Boolean,default:!1}},emits:["nextCopper","endRound","selectCopper"],setup(e,{emit:t}){Zn(w=>({v13e8edbe:a,a5a1de32:l,v6d6dcd30:c,dca1506e:u,v0788e5d0:_,d6662956:$,v5e671a9e:d}));const n=e,o=t,s=oe(null),i=Q("ui/choice.png"),r=Q("ui/choice-active.png"),a=`url('${Q("ui/ribbon-left.png")}')`,c=`url('${Q("ui/ribbon-middle.png")}')`,l=`url('${Q("ui/ribbon-right.png")}')`,u=`url('${Q("ui/panel.png")}')`,_=`url('${Q("ui/round1.png")}')`,$=`url('${Q("ui/currentcupper.png")}')`,d=`url('${Q("ui/btn.png")}')`,p=Xe(()=>{if(!n.currentCopperId)return null;const w=n.copperList.find(y=>y.id===n.currentCopperId);return w?{id:w.id,name:w.name||` #${w.id}`,level:w.level??0,isSummon:w.type==="summon"}:null});function b(){o("nextCopper")}async function g(){const w=JSON.stringify({type:"on_game_round_pass"});Ue(w),o("endRound")}function m(w){o("selectCopper",w)}return hn(async()=>{if(!s.value)return;function w(v){return new Promise((k,L)=>{const P=new Image;P.onload=()=>k(P),P.onerror=O=>{f(":",v,O),L(O)},P.src=v})}function y(v,k){s.value&&(s.value.style.setProperty(v,String(k)),f(` CSS  ${v} = ${k}`))}try{const[v,k,L]=await Promise.all([w(Q("ui/panel.png")),w(Q("ui/btn.png")),w(Q("ui/currentcupper.png"))]),P=Math.max(4,Math.round(v.naturalHeight/4)),O=Math.max(3,Math.round(k.naturalHeight/3)),I=Math.max(3,Math.round(L.naturalHeight/4));f(":",{panelSlice:P,btnSlice:O,currentSlice:I,currentImgSize:`${L.naturalWidth}x${L.naturalHeight}`}),y("--panel-slice",P),y("--btn-slice",O),y("--current-slice",I),setTimeout(()=>{const R=getComputedStyle(s.value);f("CSS :",{"--current-slice":R.getPropertyValue("--current-slice"),"--panel-slice":R.getPropertyValue("--panel-slice"),"--btn-slice":R.getPropertyValue("--btn-slice")})},100)}catch(v){f(":",v),y("--panel-slice","8"),y("--btn-slice","11"),y("--current-slice","8")}}),(w,y)=>(V(),ee("div",{ref_key:"turnSystemRef",ref:s,class:"turn-system"},[y[0]||(y[0]=h("div",{class:"ribbon","aria-hidden":"true"},[h("div",{class:"ribbon-cap left"}),h("div",{class:"ribbon-fill"},"CONTROL"),h("div",{class:"ribbon-cap right"})],-1)),h("div",fG,[h("div",hG,[h("section",gG,[h("div",{class:"round-header",role:"img","aria-label":`Round ${e.roundNumber}`}," Round "+ce(e.roundNumber),9,bG)]),h("section",yG,[h("div",wG,[h("span",null,ce(p.value?`${p.value.name||` #${e.currentCopperId}`}`:""),1),p.value&&!p.value.isSummon?(V(),ee("span",vG," Lv."+ce(p.value.level??0)+" ",1)):Ie("",!0)])]),h("section",SG,[(V(!0),ee(mt,null,Xn(e.copperList,v=>(V(),ee("button",{key:v.id,class:"choice",type:"button","aria-pressed":String(v.id===e.currentCopperId),"data-copper-id":v.id,title:v.name||` #${v.id}`,onClick:k=>m(v.id)},[h("img",{alt:v.name||`Character ${v.id}`,src:v.id===e.currentCopperId?ye(r):ye(i),"data-default-src":ye(i),"data-selected-src":ye(r)},null,8,MG)],8,kG))),128))])])]),h("div",CG,[h("button",{class:"btn btn-primary",onClick:b,disabled:!e.currentCopperId||e.isEnemyMoving},"  ",8,xG),h("button",{class:"btn btn-secondary",onClick:g,disabled:e.isEnemyMoving},"  ",8,PG)])],512))}},IG=Vt(LG,[["__scopeId","data-v-bbcf8c05"]]),TG={class:"modal-info"},EG={class:"info-text"},AG={class:"copper-name"},GG={class:"modal-body"},RG={class:"enemy-list"},OG=["onClick"],DG={class:"enemy-header"},NG={class:"enemy-name-row"},jG={class:"enemy-name"},HG={class:"enemy-level"},FG={class:"enemy-type"},UG={class:"enemy-stats"},BG={class:"stat"},zG={class:"stat-value"},VG={class:"stat"},qG={class:"stat-value"},WG={class:"stat"},KG={class:"stat-value"},JG={class:"stat"},XG={class:"stat-value"},YG={class:"stat"},ZG={class:"stat-value"},QG={class:"enemy-cost"},eR={class:"cost-value"},tR={class:"enemy-desc"},nR={key:0,class:"selected-badge"},sR={class:"modal-footer"},oR=["disabled"],iR={__name:"SummonModal",props:{visible:{type:Boolean,default:!1},copperName:{type:String,default:""},enemyList:{type:Array,default:()=>[]},position:{type:Array,default:null}},emits:["close","summon"],setup(e,{emit:t}){Zn($=>({bad9e2a0:n}));const n=`url('${Q("@assets/ui/panel6.png")}')`,o=e,s=t,i=oe(null),r=Xe(()=>[...o.enemyList].sort(($,d)=>$.level-d.level));function a($){i.value=$}function c(){if(!i.value){f("[SummonModal] ");return}f("[SummonModal] :",i.value.name),s("summon",i.value.name),l()}function l(){i.value=null,s("close")}function u($){return{goblin:"",cruiser:"",scout:"",boxer:"",horn:"",assassin:"",devourer:"",mirror:"",guard:"",demon:"",variant:"",shatra:"BOSS",glutton:"BOSS"}[$]||$}function _($){if(!$)return"";const d=$.cost||$;return!Array.isArray(d)||d.length===0?"":d.map(p=>{var b;if(Array.isArray(p)){const g=p[0],m=p[1];return`${((b=Wn[g])==null?void 0:b.name)||g} x${m}`}return`${cc(p)} x${p.count}`}).join(", ")}return($,d)=>(V(),kn(Xd,{to:"body"},[e.visible?(V(),ee("div",{key:0,class:"modal-overlay",onClick:Fs(l,["self"])},[h("div",{class:"summon-modal",onClick:d[0]||(d[0]=Fs(()=>{},["stop"]))},[h("div",{class:"modal-header"},[d[1]||(d[1]=h("h2",{class:"modal-title"}," ",-1)),h("button",{class:"close-btn",onClick:l,title:""},"")]),h("div",TG,[h("p",EG,[h("span",AG,ce(e.copperName),1),d[2]||(d[2]=Vo("  ",-1))])]),h("div",GG,[h("div",RG,[(V(!0),ee(mt,null,Xn(r.value,p=>{var b,g;return V(),ee("div",{key:p.name,class:wt(["enemy-card",{selected:((b=i.value)==null?void 0:b.name)===p.name}]),onClick:m=>a(p)},[h("div",DG,[h("div",NG,[h("span",jG,ce(p.name),1),h("span",HG,"Lv."+ce(p.level),1)]),h("span",FG,ce(u(p.enemy_type)),1)]),h("div",UG,[h("div",BG,[d[3]||(d[3]=h("span",{class:"stat-label"},"",-1)),h("span",zG,ce(p.health),1)]),h("div",VG,[d[4]||(d[4]=h("span",{class:"stat-label"},"",-1)),h("span",qG,ce(p.attack),1)]),h("div",WG,[d[5]||(d[5]=h("span",{class:"stat-label"},"",-1)),h("span",KG,ce(p.defense),1)]),h("div",JG,[d[6]||(d[6]=h("span",{class:"stat-label"},"",-1)),h("span",XG,ce(p.attack_range),1)]),h("div",YG,[d[7]||(d[7]=h("span",{class:"stat-label"},"",-1)),h("span",ZG,ce(p.move_range),1)])]),h("div",QG,[d[8]||(d[8]=h("span",{class:"cost-label"}," ",-1)),h("span",eR,ce(_(p.summon_cost)),1)]),h("div",tR,ce(p.description),1),((g=i.value)==null?void 0:g.name)===p.name?(V(),ee("div",nR,"   ")):Ie("",!0)],10,OG)}),128))])]),h("div",sR,[h("button",{class:"btn btn-cancel",onClick:l},""),h("button",{class:"btn btn-confirm",disabled:!i.value,onClick:c},"  ",8,oR)])])])):Ie("",!0)]))}},rR=Vt(iR,[["__scopeId","data-v-2e41e79c"]]),aR={key:0,class:"minimized-content"},cR={class:"minimized-info"},lR={class:"minimized-name"},uR={class:"minimized-action"},_R={key:1},$R={class:"structure-panel__header"},dR={class:"structure-panel__title"},pR={class:"structure-panel__body"},mR={class:"structure-panel__health"},fR={class:"structure-panel__health-bar"},hR={class:"structure-panel__health-text"},gR={key:0,class:"structure-panel__storage"},bR={class:"structure-panel__storage-content"},yR={key:0,class:"structure-panel__storage-item"},wR={class:"structure-panel__storage-name"},vR={class:"structure-panel__storage-count"},SR={key:1,class:"structure-panel__storage-empty"},kR={key:1,class:"structure-panel__ground-resources"},MR={class:"structure-panel__ground-list"},CR={class:"structure-panel__resource-name"},xR={class:"structure-panel__resource-count"},PR={key:2,class:"structure-panel__actions"},LR={__name:"StructurePanel",props:{structure:{type:Object,required:!0},resources:{type:Array,default:()=>[]},actionMode:{type:String,default:null}},emits:["close","action","cancel"],setup(e,{emit:t}){Zn(v=>({v31b4b180:p}));const n=e,o=t,s=Xe(()=>{var v;return((v=n.structure.structure_base)==null?void 0:v.name)||""}),i=Xe(()=>n.structure.owned||!1),r=Xe(()=>{var v;return((v=n.structure.structure_base)==null?void 0:v.has_storage)||!1}),a=Xe(()=>n.structure.storage||null),c=Xe(()=>n.structure.can_move||!1),l=Xe(()=>n.structure.can_attack||!1),u=Xe(()=>n.structure.now_health||0),_=Xe(()=>{var v;return((v=n.structure.structure_base)==null?void 0:v.health)||100}),$=Xe(()=>_.value===0?0:Math.max(0,Math.min(100,u.value/_.value*100))),d=Xe(()=>{const v=$.value;return v>60?"#4ade80":v>30?"#facc15":"#ef4444"});Q("@assets/ui/panel.png");const p=`url('${Q("@assets/ui/panel11.png")}')`,b=Xe(()=>n.actionMode!==null),g=Xe(()=>n.actionMode==="move"?"...":n.actionMode==="attack"?"...":n.actionMode==="extract"?"...":n.actionMode==="transfer"?"...":"");function m(v){f(`[StructurePanel] : ${v}`),o("action",{type:v})}function w(){f("[StructurePanel] "),o("cancel")}function y(){o("close")}return(v,k)=>(V(),ee("div",{class:wt(["structure-panel",{"structure-panel--minimized":b.value}])},[b.value?(V(),ee("div",aR,[h("div",cR,[h("span",lR,ce(s.value),1),h("span",uR,ce(g.value),1)]),h("div",{class:"minimized-actions"},[h("button",{class:"mini-btn mini-btn--cancel",onClick:w,title:""},"  ")])])):(V(),ee("div",_R,[h("div",$R,[h("div",dR,[Vo(ce(s.value)+" ",1),h("span",{class:wt(["structure-panel__badge",{"structure-panel__badge--owned":i.value}])},ce(i.value?"":""),3)]),h("button",{class:"structure-panel__close",onClick:y,"aria-label":""},"  ")]),h("div",pR,[h("div",mR,[k[4]||(k[4]=h("div",{class:"structure-panel__health-label"},"",-1)),h("div",fR,[h("div",{class:"structure-panel__health-fill",style:Bn({width:$.value+"%",backgroundColor:d.value})},null,4)]),h("div",hR,ce(Math.ceil(u.value))+" / "+ce(Math.ceil(_.value)),1)]),r.value?(V(),ee("div",gR,[k[5]||(k[5]=h("div",{class:"structure-panel__storage-label"},"",-1)),h("div",bR,[a.value?(V(),ee("div",yR,[h("span",wR,ce(ye(cc)(a.value)),1),h("span",vR,"x"+ce(a.value.count||0),1)])):(V(),ee("div",SR,""))])])):Ie("",!0),e.resources&&e.resources.length>0?(V(),ee("div",kR,[k[6]||(k[6]=h("div",{class:"structure-panel__ground-label"},"",-1)),h("div",MR,[(V(!0),ee(mt,null,Xn(e.resources,(L,P)=>(V(),ee("div",{key:P,class:"structure-panel__ground-item"},[h("span",CR,ce(L.name||""),1),h("span",xR,"x"+ce(L.count||0),1)]))),128))])])):Ie("",!0),i.value?(V(),ee("div",PR,[c.value?(V(),ee("button",{key:0,class:"structure-panel__action-btn structure-panel__action-btn--move",onClick:k[0]||(k[0]=L=>m("move"))},"  ")):Ie("",!0),l.value?(V(),ee("button",{key:1,class:"structure-panel__action-btn structure-panel__action-btn--attack",onClick:k[1]||(k[1]=L=>m("attack"))},"  ")):Ie("",!0),r.value&&a.value?(V(),ee("button",{key:2,class:"structure-panel__action-btn structure-panel__action-btn--transfer",onClick:k[2]||(k[2]=L=>m("transfer"))},"  ")):Ie("",!0),r.value?(V(),ee("button",{key:3,class:"structure-panel__action-btn structure-panel__action-btn--extract",onClick:k[3]||(k[3]=L=>m("extract"))},"  ")):Ie("",!0)])):Ie("",!0)])]))],2))}},IR=Vt(LR,[["__scopeId","data-v-c3c198e2"]]),TR={class:"resource-panel"},ER={class:"resource-list"},AR={class:"resource-layout"},GR={class:"row row-top"},RR=["title"],OR=["src","alt"],DR={class:"resource-count"},NR={class:"resource-tooltip"},jR=["title"],HR=["src","alt"],FR={class:"resource-count"},UR={class:"resource-tooltip"},BR={class:"row row-middle"},zR=["title"],VR=["src","alt"],qR={class:"resource-count"},WR={class:"resource-tooltip"},KR={class:"row row-bottom"},JR=["title"],XR=["src","alt"],YR={class:"resource-count"},ZR={class:"resource-tooltip"},QR=["title"],e9=["src","alt"],t9={class:"resource-count"},n9={class:"resource-tooltip"},s9={class:"crafting-section"},o9={class:"crafting-grid"},i9=["src"],r9={class:"craft-count"},a9={class:"craft-arrow-group"},c9=["src","alt"],l9={class:"craft-result"},u9={class:"recipe-display"},_9=["src"],$9={class:"craft-count"},d9={__name:"ResourcePanel",setup(e,{expose:t}){Zn(_=>({a63b29f0:o}));const o=`url('${Q("@assets/ui/panel5.png")}')`,s=oe({SpiritalSpark:0,RecallGear:0,ResonantCrystal:0,RefinedCopper:0,HeartCrystalDust:0}),i=["HeartCrystalDust","RecallGear","ResonantCrystal","RefinedCopper"],r=oe(!1),a=oe({visible:!1,success:!0,text:""});function c(_,$=!0,d=1500){a.value={visible:!0,success:$,text:_},window.clearTimeout(c._timer),c._timer=window.setTimeout(()=>{a.value.visible=!1},d)}async function l(){if(!r.value){r.value=!0;try{const _=p7();Do(vn.UPDATE_RESOURCES),(_==null?void 0:_.type)==="error"?(console.warn("[ResourcePanel] :",(_==null?void 0:_.content)||_),c("",!1)):(console.log("[ResourcePanel] :",_),c("",!0))}catch(_){console.error("[ResourcePanel] :",_),c("",!1)}finally{r.value=!1}}}async function u(){try{const _=Gc();if(_){const $={},d={};return Object.keys(s.value).forEach(p=>{const b=s.value[p],g=_[p]||0;d[p]=g;const m=g-b;m>0&&($[p]=m)}),s.value=d,Do(vn.RESOURCES_UPDATED,$),$}}catch(_){console.error("[ResourcePanel] :",_)}return{}}return hn(()=>{u(),lc(vn.UPDATE_RESOURCES,u)}),Ps(()=>{Cu(vn.UPDATE_RESOURCES,u)}),t({updateResources:u}),(_,$)=>{var d;return V(),ee("div",TR,[$[0]||($[0]=h("div",{class:"resource-header"},[h("span",{class:"header-text"},"")],-1)),h("div",ER,[h("div",AR,[h("div",GR,[h("div",{class:"resource-slot small",title:ye(Zt)("RecallGear")},[ye(_s)("RecallGear")?(V(),ee("img",{key:0,src:ye(_s)("RecallGear"),alt:ye(Zt)("RecallGear"),class:"resource-icon"},null,8,OR)):Ie("",!0),h("div",DR,ce(s.value.RecallGear||0),1),h("div",NR,ce(ye(Zt)("RecallGear")),1)],8,RR),h("div",{class:"resource-slot small",title:ye(Zt)("HeartCrystalDust")},[ye(_s)("HeartCrystalDust")?(V(),ee("img",{key:0,src:ye(_s)("HeartCrystalDust"),alt:ye(Zt)("HeartCrystalDust"),class:"resource-icon"},null,8,HR)):Ie("",!0),h("div",FR,ce(s.value.HeartCrystalDust||0),1),h("div",UR,ce(ye(Zt)("HeartCrystalDust")),1)],8,jR)]),h("div",BR,[h("div",{class:"resource-slot large",title:ye(Zt)("SpiritalSpark")},[ye(_s)("SpiritalSpark")?(V(),ee("img",{key:0,src:ye(_s)("SpiritalSpark"),alt:ye(Zt)("SpiritalSpark"),class:"resource-icon"},null,8,VR)):Ie("",!0),h("div",qR,ce(s.value.SpiritalSpark||0),1),h("div",WR,ce(ye(Zt)("SpiritalSpark")),1)],8,zR)]),h("div",KR,[h("div",{class:"resource-slot small",title:ye(Zt)("ResonantCrystal")},[ye(_s)("ResonantCrystal")?(V(),ee("img",{key:0,src:ye(_s)("ResonantCrystal"),alt:ye(Zt)("ResonantCrystal"),class:"resource-icon"},null,8,XR)):Ie("",!0),h("div",YR,ce(s.value.ResonantCrystal||0),1),h("div",ZR,ce(ye(Zt)("ResonantCrystal")),1)],8,JR),h("div",{class:"resource-slot small",title:ye(Zt)("RefinedCopper")},[ye(_s)("RefinedCopper")?(V(),ee("img",{key:0,src:ye(_s)("RefinedCopper"),alt:ye(Zt)("RefinedCopper"),class:"resource-icon"},null,8,e9)):Ie("",!0),h("div",t9,ce(s.value.RefinedCopper||0),1),h("div",n9,ce(ye(Zt)("RefinedCopper")),1)],8,QR)])])]),h("div",s9,[h("div",o9,[(V(),ee(mt,null,Xn(i,(p,b)=>{var g;return h("div",{class:"craft-slot",key:b},[(g=ye(Wn)[p])!=null&&g.icon?(V(),ee("img",{key:0,src:ye(Wn)[p].icon,class:"craft-icon"},null,8,i9)):Ie("",!0),h("div",r9,ce(s.value[p]||0),1)])}),64))]),h("div",a9,[h("img",{class:wt(["craft-arrow-img",{disabled:r.value}]),src:ye(Q)("@assets/ui/upgrade.png"),alt:r.value?"":"",onClick:l},null,10,c9),a.value.visible?(V(),ee("div",{key:0,class:wt(["craft-toast",{success:a.value.success,error:!a.value.success}])},ce(a.value.text),3)):Ie("",!0)]),h("div",l9,[h("div",u9,[(d=ye(Wn).SpiritalSpark)!=null&&d.icon?(V(),ee("img",{key:0,src:ye(Wn).SpiritalSpark.icon,class:"recipe-icon"},null,8,_9)):Ie("",!0),h("div",$9,ce(s.value.SpiritalSpark||0),1)])])])])}}},p9=Vt(d9,[["__scopeId","data-v-5ca294fa"]]),m9={class:"game-scene"},f9={key:6,class:"info-panel"},h9={key:7,class:"game-over-overlay"},g9={key:8,class:"game-over-overlay"},b9={key:9,class:"credits-overlay"},y9={key:10,class:"game-over-overlay"},w9={class:"game-over-dialog"},v9={class:"game-over-message"},S9={key:11,class:"game-over-overlay"},k9=["src"],M9=["src"],C9=["src"],x9=["src"],P9=["src"],L9=["src"],I9=["src"],T9={__name:"GameScene",props:{isGameMode:{type:Boolean,default:!1},musicOn:{type:Boolean,default:!0}},emits:["back"],setup(e,{emit:t}){Zn(N=>({v6cc81552:Kh,v6cc889b1:Jh}));const n=e,o=oe(null),s=t,i=oe(null),r=_E("gameScene"),a=oe(null),c=oe(null),l=oe(null),u=oe(null),_=oe(null),$=oe(null),d=ii("move"),p=ii("moveEnemy"),b=ii("attack"),g=ii("attackEnemy"),m=ii("meHurt"),w=ii("enemyHurt");let y,v,k,L,P=[],I={focusPosition:null,focusTarget:null,lerpFactor:td().focusLerpFactor},R=null,D=new _n,x=null,z=null,ge=null;const re=new Map,he={w:!1,a:!1,s:!1,d:!1,shift:!1,space:!1},G=td().moveSpeed,Y=oe(Z$("controlMode")||"touchpad"),U=oe(Z$("mouseSensitivity")||.002);window.updateControlMode=N=>{Y.value=N,f(`[GameScene] : ${N}`)},window.updateMouseSensitivity=N=>{U.value=N};function j(N){const H=N.key.toLowerCase();H==="w"||H==="a"||H==="s"||H==="d"?he[H]=!0:H==="shift"?he.shift=!0:H===" "?(he.space=!0,N.preventDefault()):H==="escape"&&document.pointerLockElement&&document.exitPointerLock()}function J(N){const H=N.key.toLowerCase();H==="w"||H==="a"||H==="s"||H==="d"?he[H]=!1:H==="shift"?he.shift=!1:H===" "&&(he.space=!1)}let W=!1,we=0,De=0,Ke=0,Fe=0,it=!1;function ht(N){N.button===0&&(Y.value==="mouse"&&o.value&&o.value.requestPointerLock(),W=!0,we=N.clientX,De=N.clientY)}function $t(){W=!1}function Ot(N){if(Y.value==="touchpad"){if(!W)return;const H=N.clientX-we,$e=N.clientY-De;Fe-=H*U.value,Ke-=$e*U.value,we=N.clientX,De=N.clientY}else if(Y.value==="mouse"&&it){const H=N.movementX||0,$e=N.movementY||0;Fe-=H*U.value,Ke-=$e*U.value}Ke=Math.max(-Math.PI/2,Math.min(Math.PI/2,Ke)),v.rotation.order="YXZ",v.rotation.y=Fe,v.rotation.x=Ke}function C(){it=document.pointerLockElement===o.value,f(it?"[GameScene] ":"[GameScene] ")}function T(){f("[GameScene] ")}const A=oe(null),te=oe([]),K=oe(null),X=oe(!1),_e=oe([]),ie=oe([]),Z=oe(null),se=oe(null),ve=oe(!1),de=oe(null),Se=oe([]),Ce=oe(null),Ve=oe(1),Te=oe([]),Ge=oe(-1),be=oe(null),at=oe(!1),Pt=oe(new Set),Dt=oe(!1),An=new Map,As=oe(!1),At=oe(!1),ln=oe(!1),ko=oe(!1),ni=oe(!1),Nc=oe(""),ph=Xe(()=>{if(Te.value.length===0||Ge.value<0||Ge.value>=Te.value.length)return null;const N=Te.value[Ge.value];return N?N.id:null});hn(async()=>{var N;if(f("[GameScene] "),mh(),f("[GameScene] "),bh(),f("[GameScene] "),(N=He.sceneContext)!=null&&N.setTestMode&&He.sceneContext.setTestMode("eventloop"),window.__ACTUAL_COPPER_IDS__){const H=window.__ACTUAL_COPPER_IDS__;f("[GameScene] ID:",H);const $e=JSON.stringify({type:"on_game_start",content:{ids:H}});Ue($e),delete window.__ACTUAL_COPPER_IDS__}else f("[GameScene] ID");window.addEventListener("keydown",j),window.addEventListener("keyup",J),window.addEventListener("mousedown",ht),window.addEventListener("mouseup",$t),window.addEventListener("mousemove",Ot),document.addEventListener("pointerlockchange",C),document.addEventListener("pointerlockerror",T),r_(),n.musicOn&&i.value&&setTimeout(()=>{if(i.value.readyState>=2)i.value.play().then(()=>{f("[GameScene] ")}).catch($e=>{f("[GameScene] :",$e)});else{const $e=()=>{i.value.play().then(()=>{f("[GameScene] ")}).catch(me=>{f("[GameScene] :",me)}),i.value.removeEventListener("canplay",$e)};i.value.addEventListener("canplay",$e,{once:!0})}},200)}),Ln(()=>n.musicOn,N=>{if(i.value)if(N)if(i.value.readyState>=2)i.value.play().catch(H=>{f("[GameScene] :",H)});else{const H=()=>{i.value.play().catch($e=>{f("[GameScene] :",$e)}),i.value.removeEventListener("canplay",H)};i.value.addEventListener("canplay",H)}else i.value.pause()}),Ps(()=>{window.removeEventListener("resize",i_),window.removeEventListener("click",a_),window.removeEventListener("keydown",j),window.removeEventListener("keyup",J),window.removeEventListener("mousedown",ht),window.removeEventListener("mouseup",$t),window.removeEventListener("mousemove",Ot),document.removeEventListener("pointerlockchange",C),document.removeEventListener("pointerlockerror",T),document.pointerLockElement&&document.exitPointerLock(),i.value&&i.value.pause(),x&&x.dispose(),z&&z.dispose(),ge&&ge.dispose(),y&&yE(y),k&&k.dispose()});function mh(){y=new qa;const N=q8();dE(y,N),v=mE(),R=new f_,k=fE(o.value),L=null;const H=eE();pE(y,H),bE(y),hE(),n.isGameMode&&window.addEventListener("click",a_),gE(y,P),x=B8(y,v),z=rE(y),ge=cE(y),f("[GameScene] "),f('[GameScene] - /(ID=1,2)""'),f("[GameScene] - EventLoop"),window.addEventListener("resize",i_)}async function fh(N,H,$e,me=1){const Ee=rc(N,H);try{const M=await Rn.loadModel(Ee,!0);f(`[GameScene] : ${H}`);const E=M.clone(!0);E.traverse(Pe=>{Pe.material&&(Array.isArray(Pe.material)?Pe.material=Pe.material.map(Le=>Le.clone()):Pe.material=Pe.material.clone())});const ue=new dn().setFromObject(E).getSize(new Be),pe=new ts;pe.add(E),pe.position.set($e[0],0,$e[1]),pe.scale.set(me,me,me),pe.rotation.y=0;const xe=new dn().setFromObject(pe);return pe.position.y=-xe.min.y,f(`[GameScene] : ${H}, URL: ${Ee}`),pe}catch(M){return f(`[GameScene] : ${H}`,M),null}}async function hh(N,H,$e=1,me="model"){try{const Ee=await Rn.loadModel(N,!0);f(`[GameScene] : ${me}, url=${N}`);const M=Ee.clone(!0);M.traverse(pe=>{pe.material&&(Array.isArray(pe.material)?pe.material=pe.material.map(xe=>xe.clone()):pe.material=pe.material.clone())});const B=new dn().setFromObject(M).getSize(new Be),ue=new ts;return ue.add(M),ue.position.set(H[0],0,H[1]),ue.scale.set($e,$e,$e),ue}catch(Ee){return f(`[GameScene] : ${me}, url=${N}, error=${Ee}`),null}}async function gh(N,H,$e=1){const me=ac(N);try{const Ee=await Rn.loadModel(me,!0);f(`[GameScene] : ${N}`);const M=Ee.clone(!0);M.traverse(Pe=>{Pe.material&&(Array.isArray(Pe.material)?Pe.material=Pe.material.map(Le=>Le.clone()):Pe.material=Pe.material.clone())});const B=new dn().setFromObject(M).getSize(new Be),ue=new ts;ue.add(M),ue.position.set(H[0],0,H[1]),ue.scale.set($e,$e,$e),ue.rotation.y=0;const pe=new dn().setFromObject(ue);ue.position.y=-pe.min.y;const xe=new _i(16729156,2.5,12);return xe.position.set(0,B.y*$e*.8,0),ue.add(xe),f(`[GameScene] : ${N}, URL: ${me}`),ue}catch(Ee){return f(`[GameScene] : ${N}`,Ee),null}}let jr=null;function bh(){const N=new Map,H=new Map,$e=new Map;function me(M,E,B){const ue=P.find(Le=>Le.id===M);if(!ue||!ue.object)return;let pe,xe;E==="move"?(pe=65280,xe=.8):E==="attack"?(pe=16711680,xe=1):E==="summon"?(pe=16776960,xe=1.2):(pe=16777215,xe=1),N.has(M)||N.set(M,{});const Pe=N.get(M);if(Pe[E]&&(y.remove(Pe[E]),Pe[E].geometry.dispose(),Pe[E].material.dispose(),delete Pe[E]),B){const Le=new wl(xe-.1,xe,32),qe=new Bt({color:pe,side:Cn,transparent:!0,opacity:.6}),We=new St(Le,qe);We.rotation.x=-Math.PI/2,We.position.set(ue.object.position.x,.1,ue.object.position.z),y.add(We),Pe[E]=We}}const Ee=M=>{if(P.forEach(E=>{E.object&&(E.object.scale.set(1,1,1),E.object.traverse(B=>{var ue;B.material&&((ue=B.material.emissive)==null||ue.setHex(0),B.material.emissiveIntensity!==void 0&&(B.material.emissiveIntensity=0))}))}),M!==null){const E=P.find(B=>B.id===M);if(E){E.object.scale.set(1.1,1.1,1.1),E.object.traverse(ue=>{ue.material&&ue.material.emissive&&(ue.material.emissive.setHex(16755200),ue.material.emissiveIntensity=.5)});const B=E.type==="summon"?"":E.type==="copper"?"":"";f(`[GameScene] ${B}: ${E.name} (ID=${M})`)}}};jr=(M,E)=>{const B=P.find(Gt=>Gt.id===M);if(!B)return;const ue=new Map;B.object.traverse(Gt=>{Gt.material&&Gt.material.emissive&&(ue.set(Gt,{color:Gt.material.emissive.getHex(),intensity:Gt.material.emissiveIntensity||0}),Gt.material.emissive.setHex(16711680),Gt.material.emissiveIntensity=.8)}),setTimeout(()=>{ue.forEach((Gt,es)=>{es.material&&es.material.emissive&&(es.material.emissive.setHex(Gt.color),es.material.emissiveIntensity=Gt.intensity)})},500);const pe=new Be(B.object.position.x,.5,B.object.position.z),xe=new Be(E[0],.5,E[1]),Pe=new Be().subVectors(xe,pe),Le=Pe.length(),qe=new Be().addVectors(pe,xe).multiplyScalar(.5),We=new ga(.05,.05,Le,8),Ne=new Bt({color:16729156,transparent:!0,opacity:.9,emissive:16729156,emissiveIntensity:.5}),Je=new St(We,Ne);Je.position.copy(qe),Je.quaternion.setFromUnitVectors(new Be(0,1,0),Pe.normalize()),y.add(Je);const nt=new wl(.2,.4,32),ct=new Bt({color:16711680,side:Cn,transparent:!0,opacity:.8,emissive:16711680,emissiveIntensity:.5}),Yt=new St(nt,ct);Yt.rotation.x=-Math.PI/2,Yt.position.copy(xe),y.add(Yt);const Co=performance.now(),Nt=300;function jt(){const es=(performance.now()-Co)/Nt;if(es<1){const Ei=1-es;Ne&&(Ne.opacity=Ei),ct&&(ct.opacity=Ei),Yt.scale.set(1+es*2,1+es*2,1),requestAnimationFrame(jt)}else y.remove(Je),y.remove(Yt),We.dispose(),Ne.dispose(),nt.dispose(),ct.dispose()}jt(),f(`[GameScene] : ID=${M}, =${pe.x.toFixed(1)},${pe.z.toFixed(1)}  [${E[0]},${E[1]}]`)},He.setSceneContext({scene:y,camera:v,controls:L,models:P,gridCellSize:1,focusState:I,focusOnModel:yh,onShowCopperInfo:(M,E,B)=>{var pe,xe,Pe,Le,qe,We,Ne,Je,nt,ct,Yt;f(`[GameScene] onShowCopperInfo : type=${(pe=M.copper)==null?void 0:pe.copper_type}, can_build=${M.can_build}, can_summon=${M.can_summon}`),((xe=M.copper)==null?void 0:xe.copper_type)==="CraftsMan"&&M.id!==void 0&&An.set(M.id,M.can_build===!0);const ue=((Le=(Pe=M.copper)==null?void 0:Pe.copper_info)==null?void 0:Le.name)||M.name||((We=(qe=M.enemy)==null?void 0:qe.enemy_base)==null?void 0:We.name)||((Je=(Ne=M.enemy)==null?void 0:Ne.enemy_base)==null?void 0:Je.enemy_type)||((nt=M.enemy_base)==null?void 0:nt.name)||((ct=M.enemy_base)==null?void 0:ct.enemy_type)||` #${M.id}`;((Yt=M.copper)==null?void 0:Yt.copper_type)==="CraftsMan"?(f(`[GameScene]  can_build=${M.can_build}  can_summon`),A.value={...M,name:ue,can_summon:M.can_build===!0}):A.value={...M,name:ue},te.value=E||[],X.value=B||!1,f(`[GameScene] : ID=${A.value.id}, has_attack_targets=${X.value}, can_summon=${A.value.can_summon}`)},onShowStructureInfo:(M,E)=>{var B;Z.value=M,se.value={structure:M,resources:E},f(`[GameScene] : ID=${M.id}, =${(B=M.structure_base)==null?void 0:B.name}, =${M.now_health}/${M.structure_base.health}`)},highlightSelectedCopper:Ee,createAttackEffect:jr,onMoveStart:(M,E)=>{n.isGameMode&&at.value&&(E==null?void 0:E.type)==="enemy"&&!(E!=null&&E.isOwned)&&(f(`[GameScene]  ${M} `),Pt.value.add(M))},onMoveComplete:M=>{if(!n.isGameMode)return;const E=P.find(xe=>xe.id===M);if((E==null?void 0:E.type)==="structure"){f("[GameScene] "),be.value=null,Dt.value=!1,setTimeout(async()=>{await Ti(M)},300);return}if((E==null?void 0:E.type)==="enemy"&&!(E!=null&&E.isOwned)){at.value&&Pt.value.has(M)?(f(`[GameScene]  ${M} `),Pt.value.delete(M),Pt.value.size===0&&(f("[GameScene] "),at.value=!1)):f(`[GameScene]  ${M} `);return}const ue=Te.value.some(xe=>xe.id===M),pe=(E==null?void 0:E.type)==="summon"||(E==null?void 0:E.isOwned);!ue&&!pe||(Dt.value=!1,f("[GameScene] "),be.value=null,K.value&&K.value.cancelAction(),setTimeout(async()=>{(E==null?void 0:E.type)==="summon"?await Hr(M,!1):await Mo(M),setTimeout(()=>{if(te.value&&te.value.length>0){f("[GameScene] ");return}l_()},100)},300))},onCraftResult:(M,E)=>{f(`[GameScene] : ${M?"":""} - ${E}`),alert(E)},onResourceNotEnough:M=>{f(`[GameScene] : ${M}`),Nc.value=M,ni.value=!0,be.value=null,Ce.value=null,ve.value=!1,de.value=null},onSummonFailed:M=>{f(`[GameScene] : ${M}`),alert(` ${M}`),be.value=null,ve.value=!1,de.value=null},onShowSummonMenu:M=>{f("[GameScene] :",M),Se.value=M||[]},onShowStructureMenu:M=>{var E;f("[GameScene] ",(M==null?void 0:M.length)||0,""),(E=K.value)!=null&&E.showBuildMenu?K.value.showBuildMenu(M||[]):f("[GameScene]  copperActionPanelRef.value.showBuildMenu ")},onRemoveCopper:M=>{const E=Te.value.findIndex(B=>B.id===M);E>-1&&(f(`[GameScene] : ID=${M}`),Te.value.splice(E,1),A.value&&A.value.id===M&&jc(),Te.value.length===0||Ge.value===E?Ge.value=-1:Ge.value>E?Ge.value-=1:Ge.value>=Te.value.length&&(Ge.value=Te.value.length-1))},onShowResourceGain:(M,E)=>{f("[GameScene] :",M,E),ge&&Object.keys(E).length>0&&ge.createResourceGainEffect(M,E)},onGameOver:()=>{f("[GameScene] "),As.value=!0},onGameSuccess:()=>{f("[GameScene] "),At.value=!0},onAttackComplete:M=>{if(!n.isGameMode)return;const E=P.find(ue=>ue.id===M);if((E==null?void 0:E.type)==="structure"){f("[GameScene] "),be.value=null,setTimeout(async()=>{await Ti(M)},300);return}if(!Te.value.some(ue=>ue.id===M)){f("[GameScene] ");return}f("[GameScene] "),be.value=null,K.value&&K.value.cancelAction(),setTimeout(async()=>{(E==null?void 0:E.type)==="summon"?await Hr(M,!1):await Mo(M),setTimeout(()=>{if(te.value&&te.value.length>0){f("[GameScene] ");return}l_()},100)},300)},onSetMoveBlock:M=>{z&&z.createIndicator(M,"move"),f(`[GameScene] : =${M}`)},onSetAttackBlock:M=>{if(be.value==="transferring"){_e.value.push(M);const E=P.find(B=>{if(B.type==="copper"&&B.object){const ue=B.object.position;return Math.abs(ue.x-M[0])<.1&&Math.abs(ue.z-M[1])<.1}return!1});if(E){const B=Te.value.find(pe=>pe.id===E.id);ie.value.find(pe=>pe.id===E.id)||(ie.value.push({id:E.id,name:E.name||(B?B.name:` #${E.id}`)||` #${E.id}`,position:M}),f(`[GameScene] : ${E.name||E.id} (ID=${E.id}), =${ie.value.length}`))}else f(`[GameScene]  ${M} `)}else z&&z.createIndicator(M,"attack"),X.value=!0,f(`[GameScene] : ${M}`)},onSetCanSummonBlock:M=>{z&&z.createIndicator(M,"summon"),f(`[GameScene] : =${M}`)},onClearBlock:M=>{z&&z.clearIndicatorAt(M)},onSetCopper:async(M,E,B)=>{var Ne,Je,nt,ct,Yt,Co;if(f(`[GameScene] : id=${B.id}, pos=${E}`),P.find(Nt=>Nt.id===B.id)){f(`[GameScene] ID=${B.id}`);return}if(((Ne=B.copper)==null?void 0:Ne.copper_type)==="CraftsMan"&&(An.set(B.id,B.can_build===!0),f(`[GameScene]  can_build : id=${B.id}, can_build=${B.can_build}`)),n.isGameMode){const Nt={id:B.id,name:((Je=B.copper.copper_info)==null?void 0:Je.name)||` #${B.id}`,level:Number(((nt=B.copper)==null?void 0:nt.level)??0),turnDone:!1};Te.value.find(jt=>jt.id===B.id)||(Te.value.push(Nt),f(`[GameScene] : ${Nt.name}`))}const pe=B.copper.copper_type||"Arcanist",xe=((ct=B.copper.copper_info)==null?void 0:ct.name)||"default",Pe=(Yt=B.copper.copper_info)==null?void 0:Yt.model_url;let Le=1;switch(pe){case"IronWall":Le=1.2;break;case"Arcanist":Le=1;break;case"Mechanic":Le=1.1;break;case"Resonator":Le=1;break;case"CraftsMan":Le=1;break;default:Le=1}let qe;if(Pe&&Pe.includes("/enemy/")){const Nt=Q(Pe);if(f(`[GameScene] URL: ${Pe} -> ${Nt}`),qe=await hh(Nt,E,Le,xe),qe){const Gt=new dn().setFromObject(qe).getSize(new Be),es=new dn().setFromObject(qe);qe.position.y=-es.min.y;const Ei=new _i(4474111,2.5,12);Ei.position.set(0,Gt.y*Le*.8,0),qe.add(Ei)}}else{const Nt=j8(xe),jt=H8(pe);f(`[GameScene] : =${xe}, =${Nt}, type=${pe}, typeFolder=${jt}`),qe=await fh(jt,Nt,E,Le)}if(!qe){f(`[GameScene] : ${xe}`);const Nt=new hs(.8,.8,.8);let jt=4491519;switch(pe){case"IronWall":jt=8947848;break;case"Arcanist":jt=16729224;break;case"Mechanic":jt=4521864;break;case"Resonator":jt=16755268;break;case"CraftsMan":jt=4474111;break}const Gt=new Ut({color:jt});qe=new St(Nt,Gt),qe.position.set(E[0],.4,E[1])}qe.userData.modelId=B.id,y.add(qe);const We={id:B.id,object:qe,name:((Co=B.copper.copper_info)==null?void 0:Co.name)||`Copper_${B.id}`,type:"copper"};P.push(We),f(`[GameScene] : ${We.name} (ID=${B.id})`)},onSetEnemy:async(M,E,B)=>{var Je,nt,ct,Yt,Co;const ue=B.id,pe=B.owned||!1;if(f(`[GameScene] : id=${ue}, pos=${E}, owned=${pe}`),P.find(Nt=>Nt.id===ue)){f(`[GameScene] ID=${ue}`);return}const Le=(((Je=B.enemy_base)==null?void 0:Je.enemy_type)||"").toLowerCase()||"goblin";let qe=1;switch(Le){case"demon":case"glutton":case"devourer":qe=1.5;break;case"guard":case"horn":qe=1.2;break;default:qe=1}const We={id:ue,object:null,name:((nt=B.enemy_base)==null?void 0:nt.enemy_type)||`Enemy_${ue}`,type:pe?"summon":"enemy",position:E,isOwned:pe,isLoading:!0};P.push(We);let Ne=await gh(Le,E,qe);if(!Ne){f(`[GameScene] : ${Le}`);const Nt=new hs(.8,.8,.8),jt=new Ut({color:pe?4474111:16711680});Ne=new St(Nt,jt),Ne.position.set(E[0],.4,E[1])}if(pe&&Ne){const jt=new dn().setFromObject(Ne).getSize(new Be),Gt=new _i(4474111,2.5,12);Gt.position.set(0,jt.y*qe*.8,0),Ne.add(Gt),f(`[GameScene] : ${Le}`)}Ne.userData.modelId=ue,y.add(Ne),We.object=Ne,We.isLoading=!1,B.now_health!==void 0&&((ct=B.enemy_base)==null?void 0:ct.health)!==void 0&&x&&(x.createOrUpdateHealthBar(ue,B.now_health,B.enemy_base.health),f(`[GameScene] : ${Le} (${B.now_health}/${B.enemy_base.health})`)),pe&&(Te.value.push({id:ue,name:((Yt=B.enemy_base)==null?void 0:Yt.name)||Le,type:"summon",enemy:B}),f(`[GameScene] : ${Le} (ID=${ue})`)),f(`[GameScene] : ${((Co=B.enemy_base)==null?void 0:Co.enemy_type)||ue}, owned=${pe}`)},onSetMaterial:async(M,E,B)=>{var qe,We,Ne;if(f(`[GameScene] : id=${M}, pos=${E}, name=${(qe=B.material_base)==null?void 0:qe.name}`),P.find(Je=>Je.id===M)){f(`[GameScene] ID=${M}`);return}const pe=((We=B.material_base)==null?void 0:We.name)||"",xe=(Ne=B.material_base)==null?void 0:Ne.model_url;if(!xe){f("[GameScene] model_url");const Je=new hs(.5,.5,.5),nt=new Ut({color:16755200,metalness:.3,roughness:.7}),ct=new St(Je,nt);ct.position.set(E[0],.25,E[1]),ct.userData.modelId=M,y.add(ct),P.push({id:M,object:ct,name:pe||`Material_${M}`,type:"material"});return}const Pe=a1(xe);let Le=null;try{const Je=await Rn.loadModel(Pe,!0),nt=new ts;nt.add(Je),nt.position.set(E[0],0,E[1]),nt.scale.set(1,1,1),nt.rotation.y=0;const ct=new dn().setFromObject(nt);nt.position.y=-ct.min.y,Le=nt,f(`[GameScene] : ${pe}, URL: ${Pe}`)}catch(Je){f(`[GameScene] : ${pe}`,Je);const nt=new hs(.5,.5,.5),ct=new Ut({color:16755200,metalness:.3,roughness:.7});Le=new St(nt,ct),Le.position.set(E[0],.25,E[1])}Le.userData.modelId=M,y.add(Le),P.push({id:M,object:Le,name:pe||`Material_${M}`,type:"material"}),f(`[GameScene] : ${pe}`)},onSetStructure:async(M,E,B)=>{var qe,We;if(f(`[GameScene] : id=${M}, pos=${E}`),P.find(Ne=>Ne.id===M)){f(`[GameScene] ID=${M}`);return}const pe=((qe=B.structure_base)==null?void 0:qe.name)||"",xe=U8(pe),Pe=Ep(xe);let Le=null;try{const Ne=await Rn.loadModel(Pe,!0),Je=new ts;Je.add(Ne),Je.position.set(E[0],0,E[1]),Je.scale.set(1,1,1),Je.rotation.y=0;const nt=new dn().setFromObject(Je);Je.position.y=-nt.min.y,Le=Je,f(`[GameScene] : ${pe}, URL: ${Pe}`)}catch(Ne){f(`[GameScene] : ${pe}`,Ne);const Je=new hs(.9,1.2,.9),nt=new Ut({color:6710886,metalness:.5,roughness:.6});Le=new St(Je,nt),Le.position.set(E[0],.6,E[1])}Le.userData.modelId=M,y.add(Le),P.push({id:M,object:Le,name:pe||`Structure_${M}`,type:"structure"}),f(`[GameScene] : ${pe}`),B.now_health!==void 0&&((We=B.structure_base)!=null&&We.health)&&x&&(x.createOrUpdateHealthBar(M,B.now_health,B.structure_base.health),f(`[GameScene] : ${pe} (${B.now_health}/${B.structure_base.health})`))},onPutResourceMarker:M=>{const E=`${M[0]},${M[1]}`;if($e.has(E)){const nt=$e.get(E);y.remove(nt),nt.traverse(ct=>{ct.geometry&&ct.geometry.dispose(),ct.material&&(Array.isArray(ct.material)?ct.material.forEach(Yt=>Yt.dispose()):ct.material.dispose())}),$e.delete(E)}const B=new ts,ue=new ga(.15,.2,.25,8),pe=new Ut({color:16766720,emissive:16755200,emissiveIntensity:.6,metalness:.7,roughness:.3}),xe=new St(ue,pe);xe.position.y=.125,B.add(xe);const Pe=new vl(.08,8,8),Le=new Ut({color:16776960,emissive:16776960,emissiveIntensity:1}),qe=new St(Pe,Le);qe.position.y=.3,B.add(qe);const We=M[0],Ne=M[1];B.position.set(We,.15,Ne);const Je=new _i(16766720,1.5,3);Je.position.set(0,.3,0),B.add(Je),y.add(B),$e.set(E,B)},onClearResourceMarker:M=>{const E=`${M[0]},${M[1]}`;if($e.has(E)){const B=$e.get(E);y.remove(B),B.traverse(ue=>{ue.geometry&&ue.geometry.dispose(),ue.material&&(Array.isArray(ue.material)?ue.material.forEach(pe=>pe.dispose()):ue.material.dispose())}),$e.delete(E)}},onDisplayCanMove:(M,E)=>{f(`[GameScene] : id=${M}, show=${E}`),me(M,"move",E),A.value&&A.value.id===M&&(A.value={...A.value,can_move:E},f(`[GameScene] selectedCopper.can_move=${E}`))},onDisplayCanAttack:(M,E)=>{f(`[GameScene] : id=${M}, show=${E}`),me(M,"attack",E),A.value&&A.value.id===M&&(A.value={...A.value,can_attack:E},f(`[GameScene] selectedCopper.can_attack=${E}`))},onDisplayCanSummon:(M,E)=>{var xe;let B=E,ue=!1,pe=!1;A.value&&A.value.id===M?(ue=((xe=A.value.copper)==null?void 0:xe.copper_type)==="CraftsMan",pe=A.value.can_build===!0):An.has(M)&&(ue=!0,pe=An.get(M)),ue&&(B=pe,f(`[GameScene] : id=${M}, can_build=${B}`)),f(`[GameScene] /: id=${M}, show=${B}`),me(M,"summon",B),A.value&&A.value.id===M&&(A.value={...A.value,can_summon:B},f(`[GameScene] selectedCopper.can_summon=${B}`))},onClearState:M=>{if(f(`[GameScene] : id=${M}`),N.has(M)){const E=N.get(M);E.move&&(y.remove(E.move),E.move.geometry.dispose(),E.move.material.dispose(),delete E.move),E.attack&&(y.remove(E.attack),E.attack.geometry.dispose(),E.attack.material.dispose(),delete E.attack),E.summon&&(y.remove(E.summon),E.summon.geometry.dispose(),E.summon.material.dispose(),delete E.summon),N.delete(M)}},onUpdateHealth:(M,E,B)=>{f(`[GameScene] : id=${M}, hp=${E}/${B}`);const ue=re.get(M);if(ue!==void 0&&E<ue&&E>0){const pe=P.find(xe=>xe.id===M);if(pe){const xe=pe.type==="copper",Pe=xe?_.value:$.value;Pe&&(Pe.currentTime=0,Pe.play().catch(Le=>{f(`[GameScene]  (${xe?"":""}):`,Le)}),f(`[GameScene] : ${xe?"":""} (ID=${M})`))}}re.set(M,E),x&&x.createOrUpdateHealthBar(M,E,B)},onRemoveHealthBar:M=>{f(`[GameScene] : id=${M}`),x&&x.removeHealthBar(M),re.delete(M)},onPutMapBlock:M=>{const E=`${M[0]},${M[1]}`;if(H.has(E)){const We=H.get(E);y.remove(We),We.geometry.dispose(),We.material&&(We.material.map&&We.material.map.dispose(),Array.isArray(We.material)?We.material.forEach(Ne=>{Ne.map&&Ne.map.dispose(),Ne.dispose()}):We.material.dispose())}const B=$h();if(!B.enabled)return;const ue=B.size||.9,pe=.05,xe=new hs(ue,pe,ue);let Pe;if(B.materialType==="texture"&&B.texture.url){const Ne=new ki().load(B.texture.url);Ne.colorSpace=en,Ne.wrapS=Bs,Ne.wrapT=Bs,Ne.repeat.set(B.texture.repeat.x,B.texture.repeat.y);const Je=1;Pe=new Ut({map:Ne,transparent:!1,opacity:Je,depthTest:!0,depthWrite:!0})}else B.materialType==="standard"?Pe=new Ut({color:B.standard.color,roughness:B.standard.roughness,metalness:B.standard.metalness,transparent:!1,opacity:1,depthTest:!0,depthWrite:!0}):Pe=new Bt({color:B.basic.color,transparent:!1,opacity:1,depthTest:!0,depthWrite:!0});const Le=new St(xe,Pe);Le.renderOrder=-100;const qe=B.yOffset||0;Le.position.set(M[0],pe/2+qe,M[1]),y.add(Le),H.set(E,Le)},animateModelMove:(M,E,B)=>{if(!M||!M.object)return;const ue=M.type==="enemy",pe=ue?c.value:a.value;pe&&(pe.currentTime=0,pe.play().catch(Ne=>{f(`[GameScene]  (${ue?"":""}):`,Ne)})),M.isMoving=!0;const xe=M.object.position.clone(),Pe=new Be(E.x,E.y,E.z),Le=500,qe=performance.now();function We(){if(!M||!M.object){B&&B();return}const Ne=performance.now()-qe,Je=Math.min(Ne/Le,1),nt=1-Math.pow(1-Je,2);M.object.position.lerpVectors(xe,Pe,nt),Je<1?requestAnimationFrame(We):(M.object.position.copy(Pe),M.isMoving=!1,B&&B())}We()},setTestMode:M=>{f(`[GameScene] ${M==="backend"?"":"EventLoop"}`),P.forEach(E=>{E.type==="test"?E.object.visible=M==="backend":(E.type==="copper"||E.type==="enemy")&&(E.object.visible=M==="eventloop")}),f(`[GameScene] ${M==="backend"?"":""}${M==="eventloop"?"":""}EventLoop`)}}),f("[GameScene] ")}function yh(N,H,$e){const me=new Be;N.getWorldPosition(me);const Ee=window.cameraFocusDistance||8,M=window.cameraFocusHeight||6,E=0,B=Ee;return{focusPosition:new Be(me.x+E,me.y+M,me.z+B).clone(),focusTarget:me.clone(),lerpFactor:.1}}function i_(){v.aspect=window.innerWidth/window.innerHeight,v.updateProjectionMatrix(),k.setSize(window.innerWidth,window.innerHeight)}function r_(){if(requestAnimationFrame(r_),he.w||he.a||he.s||he.d||he.shift||he.space){const N=new Be;he.w&&(N.z-=1),he.s&&(N.z+=1),he.a&&(N.x-=1),he.d&&(N.x+=1),he.shift&&(N.y-=1),he.space&&(N.y+=1),N.applyQuaternion(v.quaternion),N.y=he.shift?-1:he.space?1:0,v.position.add(N.multiplyScalar(G))}I.focusPosition&&I.focusTarget&&(v.position.lerp(I.focusPosition,I.lerpFactor),v.lookAt(I.focusTarget),Fe=v.rotation.y,Ke=v.rotation.x,v.position.distanceTo(I.focusPosition)<.5&&(f("[GameScene] "),I.focusPosition=null,I.focusTarget=null)),x&&x.updateHealthBarsPosition(P),k.render(y,v)}function a_(N){if(N.target.tagName!=="CANVAS")return;if(D.x=N.clientX/window.innerWidth*2-1,D.y=-(N.clientY/window.innerHeight)*2+1,R.setFromCamera(D,v),be.value==="moving"||be.value==="attacking"||be.value==="summoning"||be.value==="building"||be.value==="transferring"||be.value==="structureMoving"||be.value==="structureAttacking"||be.value==="structureExtract"||be.value==="structureTransfer"){wh(D);return}const H=P.filter(me=>(me.type==="copper"||me.type==="summon"||me.type==="enemy"||me.type==="structure")&&me.object).map(me=>me.object),$e=R.intersectObjects(H,!0);if($e.length>0){let me=$e[0].object;for(;me.parent&&!me.userData.modelId;)me=me.parent;const Ee=me.userData.modelId;if(Ee!==void 0){const M=P.find(ue=>ue.id===Ee),B={copper:"",summon:"",enemy:"",structure:""}[M==null?void 0:M.type]||"";f(`[GameScene] ${B}ID:`,Ee),(M==null?void 0:M.type)==="summon"||(M==null?void 0:M.type)==="enemy"?Hr(Ee,(M==null?void 0:M.type)==="enemy"):(M==null?void 0:M.type)==="structure"?Ti(Ee):Mo(Ee)}}else A.value=null,Z.value=null}async function wh(N){const H=new dd(new Be(0,1,0),0),$e=new f_;if($e.setFromCamera(N,v),be.value==="moving"&&Dt.value){f("[GameScene] ");return}const me=new Be;if($e.ray.intersectPlane(H,me),me){const Ee=Math.round(me.x),M=Math.round(me.z);f(`[GameScene] : (${Ee}, ${M})`);const E={moving:"move",attacking:"attack",summoning:"summon",building:"summon",structureMoving:"move",structureAttacking:"attack",structureExtract:"attack",structureTransfer:"attack"}[be.value];if(!z||!z.hasIndicatorAt([Ee,M],E)){f(`[GameScene]  (${Ee}, ${M}) `);return}be.value==="moving"?await vh(Ee,M):be.value==="attacking"?await Sh(Ee,M):be.value==="summoning"?await kh(Ee,M):be.value==="building"?await Mh(Ee,M):be.value==="structureMoving"?await Gh(Ee,M):be.value==="structureAttacking"?await Rh(Ee,M):be.value==="structureExtract"?await Oh(Ee,M):be.value==="structureTransfer"&&await Dh(Ee,M)}}async function vh(N,H){if(!A.value)return;if(Dt.value){f("[GameScene] ");return}const $e=A.value.isOwnedEnemy===!0,me=$e?"on_enemy_move_apply":"on_move_apply";f(`[GameScene] : (${N}, ${H}), =${$e?"":""}, =${me}`);const Ee=JSON.stringify({type:me,content:{id:String(A.value.id),position:{x:String(N),y:String(H)}}});Dt.value=!0,await Ue(Ee)}async function Sh(N,H){if(!A.value)return;const $e=A.value.isOwnedEnemy===!0,me=$e?"on_enemy_attack_apply":"on_attack_apply";f(`[GameScene] : (${N}, ${H}), =${$e?"":""}, =${me}`);const Ee=A.value.id,M=P.find(B=>B.id===Ee);if(M){const B=M.type==="enemy",ue=B?u.value:l.value;ue&&(ue.currentTime=0,ue.play().catch(pe=>{f(`[GameScene]  (${B?"":""}):`,pe)})),jr&&jr(Ee,[N,H])}const E=JSON.stringify({type:me,content:{id:String(A.value.id),position:{x:String(N),y:String(H)}}});await Ue(E)}async function kh(N,H){if(!A.value)return;f(`[GameScene] : (${N}, ${H})`),de.value=[N,H];const $e=JSON.stringify({type:"on_get_summon_menu"});await Ue($e),await new Promise(me=>setTimeout(me,100)),ve.value=!0}async function Mh(N,H){if(!A.value||!Ce.value)return;f(`[GameScene]  ${Ce.value} : (${N}, ${H})`);const $e=A.value.id,me=JSON.stringify({type:"on_structure_build_apply",content:{id:String($e),position:{x:String(N),y:String(H)},name:Ce.value}});await Ue(me),be.value=null,Ce.value=null,K.value&&K.value.cancelAction(),await new Promise(Ee=>setTimeout(Ee,100)),f("[GameScene] "),await Mo($e)}async function Ch(N){if(!A.value||!de.value)return;const[H,$e]=de.value;f(`[GameScene]  ${N} : (${H}, ${$e})`);try{const me=JSON.stringify({type:"on_summon_apply",content:{id:String(A.value.id),position:{x:String(H),y:String($e)},name:N}});await Ue(me)}catch(me){f("[GameScene] :",me)}finally{ve.value=!1,be.value=null,de.value=null,K.value&&K.value.cancelAction();try{const me=JSON.stringify({type:"on_summon_end"});await Ue(me)}catch(me){f("[GameScene] :",me)}}}function xh(){ve.value=!1,de.value=null,be.value=null;const N=JSON.stringify({type:"on_summon_end"});Ue(N).catch(H=>{f("[GameScene] ",H)})}function c_(){if(f("[GameScene] "),be.value==="structureMoving"){const N=JSON.stringify({type:"on_structure_move_end"});Ue(N).catch(H=>{f("[GameScene] ",H)})}else if(be.value==="structureAttacking"){const N=JSON.stringify({type:"on_structure_attack_end"});Ue(N).catch(H=>{f("[GameScene] ",H)})}else if(be.value==="structureExtract"){const N=JSON.stringify({type:"on_structure_extract_end"});Ue(N).catch(H=>{f("[GameScene] ",H)})}else if(be.value==="structureTransfer"){const N=JSON.stringify({type:"on_structure_transfer_end"});Ue(N).catch(H=>{f("[GameScene] ",H)})}be.value=null}function Ph(){c_(),Z.value=null,se.value=null,f("[GameScene] ")}async function Lh(N){if(!Z.value)return;const H=Z.value.id;switch(f(`[GameScene] : ${N.type}, ID=${H}`),N.type){case"move":await Ih(H);break;case"attack":await Th(H);break;case"transfer":await Ah(H);break;case"extract":await Eh(H);break;default:f("[GameScene] :",N.type)}}async function Ih(N){f(`[GameScene]  ${N} `);const H=JSON.stringify({type:"on_structure_move_start",content:{id:String(N)}});await Ue(H),be.value="structureMoving"}async function Th(N){f(`[GameScene]  ${N} `);const H=JSON.stringify({type:"on_structure_attack_start",content:{id:String(N)}});await Ue(H),be.value="structureAttacking"}async function Eh(N){f(`[GameScene]  ${N} `);const H=JSON.stringify({type:"on_structure_extract_start",content:{id:String(N)}});await Ue(H),be.value="structureExtract"}async function Ah(N){f(`[GameScene]  ${N} `);const H=JSON.stringify({type:"on_structure_transfer_start",content:{id:String(N)}});await Ue(H),be.value="structureTransfer"}async function Gh(N,H){if(!Z.value)return;f(`[GameScene]  ${Z.value.id}  (${N}, ${H})`);const $e=JSON.stringify({type:"on_structure_move_apply",content:{id:String(Z.value.id),position:{x:String(N),y:String(H)}}});await Ue($e),be.value=null}async function Rh(N,H){if(!Z.value)return;f(`[GameScene]  ${Z.value.id}  (${N}, ${H})`);const $e=JSON.stringify({type:"on_structure_attack_apply",content:{id:String(Z.value.id),position:{x:String(N),y:String(H)}}});await Ue($e),be.value=null}async function Oh(N,H){if(!Z.value)return;f(`[GameScene]  ${Z.value.id}  (${N}, ${H}) `);const $e=Z.value.id,me=JSON.stringify({type:"on_structure_extract_apply",content:{id:String($e),position:{x:String(N),y:String(H)}}});await Ue(me),f("[GameScene] ");const Ee=JSON.stringify({type:"on_structure_extract_end"});await Ue(Ee),await new Promise(M=>setTimeout(M,100)),f("[GameScene] "),be.value=null,setTimeout(async()=>{f("[GameScene] "),await Ti($e)},300)}async function Dh(N,H){if(!Z.value)return;f(`[GameScene]  ${Z.value.id}  (${N}, ${H}) `);const $e=Z.value.id,me=JSON.stringify({type:"on_structure_transfer_apply",content:{id:String($e),position:{x:String(N),y:String(H)}}});await Ue(me),f("[GameScene] ");const Ee=JSON.stringify({type:"on_structure_transfer_end"});await Ue(Ee),await new Promise(M=>setTimeout(M,100)),f("[GameScene] "),be.value=null,setTimeout(async()=>{f("[GameScene] "),await Ti($e)},300)}async function Mo(N){const H=Te.value.findIndex(me=>me.id===N);H!==-1&&(Ge.value=H),Z.value=null;const $e=JSON.stringify({type:"on_click_copper",content:{id:String(N)}});await Ue($e)}async function Ti(N){f(`[GameScene] : ID=${N}`),A.value=null;const H=JSON.stringify({type:"on_click_structure",content:{id:String(N)}});await Ue(H)}async function Hr(N,H=!1){if(H)Ge.value=-1,jc();else{const me=Te.value.findIndex(Ee=>Ee.id===N);me!==-1&&(Ge.value=me)}Z.value=null;const $e=JSON.stringify({type:"on_click_enemy",content:{id:String(N)}});await Ue($e)}function jc(){A.value=null,te.value=[],be.value=null}async function Nh(N){if(f("[GameScene] :",N),N.type==="moveStart")be.value="moving";else if(N.type==="attackStart")be.value="attacking";else if(N.type==="summonStart")be.value="summoning";else if(N.type==="buildRequest"){f("[GameScene] ");const H=JSON.stringify({type:"on_get_structure_menu"});await Ue(H)}else if(N.type==="buildStart")be.value="building",Ce.value=N.structureName||null;else if(N.type==="transferring"||N.type==="transferStart")be.value="transferring",_e.value=[],ie.value=[];else if(N.type==="transferComplete")be.value=null,_e.value=[],ie.value=[];else if(N.type==="cancel"){const H=be.value;if(H==="moving"){const $e=JSON.stringify({type:"on_move_end"});Ue($e).catch(me=>{f("[GameScene] ",me)})}else if(H==="attacking"){const $e=JSON.stringify({type:"on_attack_end"});Ue($e).catch(me=>{f("[GameScene] ",me)})}else if(H==="transferring"){const $e=JSON.stringify({type:"on_transfer_end"});Ue($e).catch(me=>{f("[GameScene] ",me)}),_e.value=[],ie.value=[]}else if(H==="summoning"){const $e=JSON.stringify({type:"on_summon_end"});Ue($e).catch(me=>{f("[GameScene] ",me)}),ve.value=!1}else if(H==="building"){const $e=JSON.stringify({type:"on_structure_build_end"});Ue($e).catch(me=>{f("[GameScene] ",me)}),Ce.value=null,de.value=null}be.value=null}else N.type==="wait"&&(f("[GameScene] "),Hc())}function l_(){if(Te.value.length!==0){if(A.value){const N=A.value.can_move,H=A.value.can_attack,$e=A.value.can_summon;if(f(`[GameScene] : ID=${A.value.id}, can_move=${N}, can_attack=${H}, can_summon=${$e}, hasAttackTargets=${X.value}`),N||H&&X.value||$e){f("[GameScene] ");return}}f("[GameScene] "),Hc()}}async function Hc(){var $e,me,Ee;if(Te.value.length===0)return;A.value=null,be.value=null,Ge.value;let N=0;const H=Te.value.length;for(;N<H;){Ge.value=(Ge.value+1)%Te.value.length;const M=Te.value[Ge.value];f(`[GameScene] : ${M.name||M.id} ( ${N+1}/${H})`),await new Promise(xe=>{setTimeout(async()=>{const Pe=P.find(qe=>qe.id===M.id);(Pe==null?void 0:Pe.type)==="summon"?await Hr(M.id,!1):await Mo(M.id),xe()},300)}),await new Promise(xe=>setTimeout(xe,200));const E=(($e=A.value)==null?void 0:$e.can_move)||!1,B=((me=A.value)==null?void 0:me.can_attack)||!1,ue=((Ee=A.value)==null?void 0:Ee.can_summon)||!1,pe=E||B&&X.value||ue;if(f(`[GameScene]  ${M.name}: can_move=${E}, can_attack=${B}, can_summon=${ue}, hasTargets=${X.value}, valid=${pe}`),A.value&&pe){f(`[GameScene] : ${M.name||M.id}`);return}N++}f("[GameScene] "),A.value=null,n.isGameMode&&f('[GameScene] ""')}function jh(){Ve.value++,Ge.value=-1,A.value=null,be.value=null,Te.value.forEach(H=>H.turnDone=!1),f(`[GameScene]  ${Ve.value}`);const N=P.filter(H=>H.type==="enemy"&&!H.isOwned);if(f(`[GameScene]  ${N.length} `),N.length===0)f("[GameScene] "),at.value=!1;else{at.value=!0,Pt.value.clear(),f("[GameScene] ");let H=setTimeout(()=>{at.value&&Pt.value.size>0&&(f("[GameScene] "),at.value=!1,Pt.value.clear())},3e3),$e=setInterval(()=>{at.value||(clearTimeout(H),clearInterval($e))},100);setTimeout(()=>{at.value&&Pt.value.size===0&&(f("[GameScene] "),at.value=!1,clearTimeout(H),clearInterval($e))},1e3)}}async function Hh(){f("[GameScene] "),As.value=!1;const N=JSON.stringify({type:"on_game_over"});await Ue(N),s("back")}async function Fh(){f("[GameScene] game over"),At.value=!1;const N=JSON.stringify({type:"on_game_over"});await Ue(N),Uh()}function Uh(){f("[GameScene] "),ln.value=!0,setTimeout(()=>{f("[GameScene] "),ln.value=!1,s("back")},5e3)}function Bh(){f("[GameScene] "),ln.value=!1,s("back")}function zh(){f("[GameScene] "),ko.value=!0}function Vh(){f("[GameScene] "),ko.value=!1}async function qh(){f("[GameScene]  game_over "),ko.value=!1;const N=JSON.stringify({type:"on_game_over"});await Ue(N),s("back")}function Wh(){f("[GameScene] "),ni.value=!1,Nc.value=""}const Kh=`url('${Q("@assets/ui/panel7.png")}')`,Jh=`url('${Q("@assets/ui/panel8.png")}')`;return(N,H)=>{var $e,me,Ee,M;return V(),ee("div",m9,[h("div",{ref_key:"container",ref:o,class:"scene-container"},null,512),e.isGameMode?(V(),kn(IG,{key:0,currentCopperId:ph.value,copperList:Te.value,roundNumber:Ve.value,isEnemyMoving:at.value,onNextCopper:Hc,onEndRound:jh,onSelectCopper:Mo},null,8,["currentCopperId","copperList","roundNumber","isEnemyMoving"])):Ie("",!0),e.isGameMode?(V(),ee("button",{key:1,class:"withdraw-button",onClick:zh},"  ")):Ie("",!0),e.isGameMode?(V(),kn(p9,{key:2})):Ie("",!0),e.isGameMode&&A.value?(V(),kn(mG,{key:3,ref_key:"copperActionPanelRef",ref:K,copper:A.value,resources:te.value,hasAttackTargets:X.value,transferTargets:ie.value,onSelectCopper:Mo,onClose:jc,onAction:Nh},null,8,["copper","resources","hasAttackTargets","transferTargets"])):Ie("",!0),e.isGameMode?(V(),kn(rR,{key:4,visible:ve.value,"copper-name":((Ee=(me=($e=A.value)==null?void 0:$e.copper)==null?void 0:me.copper_info)==null?void 0:Ee.name)||"","enemy-list":Se.value,position:de.value,onClose:xh,onSummon:Ch},null,8,["visible","copper-name","enemy-list","position"])):Ie("",!0),e.isGameMode&&Z.value?(V(),kn(IR,{key:5,structure:Z.value,resources:((M=se.value)==null?void 0:M.resources)||[],"action-mode":be.value==="structureMoving"?"move":be.value==="structureAttacking"?"attack":be.value==="structureExtract"?"extract":be.value==="structureTransfer"?"transfer":null,onClose:Ph,onAction:Lh,onCancel:c_},null,8,["structure","resources","action-mode"])):Ie("",!0),e.isGameMode?Ie("",!0):(V(),ee("div",f9,[...H[0]||(H[0]=[xa('<h3 data-v-8676fbc3>3D</h3><p style="color:#ffd700;font-weight:600;" data-v-8676fbc3> </p><div style="margin:8px 0;padding:8px;background:rgba(255, 255, 255, 0.1);border-radius:6px;" data-v-8676fbc3><p style="font-weight:600;" data-v-8676fbc3> </p><p style="font-size:12px;" data-v-8676fbc3>  = ID:1</p><p style="font-size:12px;" data-v-8676fbc3>  = ID:2</p></div><div style="margin:8px 0;padding:8px;background:rgba(255, 255, 255, 0.1);border-radius:6px;" data-v-8676fbc3><p style="font-weight:600;" data-v-8676fbc3> EventLoop</p><p style="font-size:12px;" data-v-8676fbc3>1.   EventLoop</p><p style="font-size:12px;" data-v-8676fbc3>2. &quot; &quot;</p><p style="font-size:12px;" data-v-8676fbc3>3. 3</p><p style="font-size:11px;" data-v-8676fbc3>  =IronWall  =Arcanist  =CraftsMan </p></div>',4)])])),As.value?(V(),ee("div",h9,[h("div",{class:"game-over-dialog"},[H[1]||(H[1]=h("h2",{class:"game-over-title"},"",-1)),H[2]||(H[2]=h("p",{class:"game-over-message"},"",-1)),h("button",{class:"game-over-button",onClick:Hh},"  ")])])):Ie("",!0),At.value?(V(),ee("div",g9,[h("div",{class:"game-over-dialog success-dialog"},[H[3]||(H[3]=h("h2",{class:"success-title"},"  ",-1)),H[4]||(H[4]=h("p",{class:"game-over-message"},"",-1)),h("button",{class:"game-over-button success-button",onClick:Fh},"  ")])])):Ie("",!0),ln.value?(V(),ee("div",b9,[h("div",{class:"credits-container"},[H[5]||(H[5]=xa('<h1 class="credits-title" data-v-8676fbc3></h1><div class="credits-content" data-v-8676fbc3><div class="credits-section" data-v-8676fbc3><h2 data-v-8676fbc3></h2><p data-v-8676fbc3>MGPIC Team</p></div><div class="credits-section" data-v-8676fbc3><h2 data-v-8676fbc3></h2><p data-v-8676fbc3>Backend Developer</p><p data-v-8676fbc3>Frontend Developer</p></div><div class="credits-section" data-v-8676fbc3><h2 data-v-8676fbc3></h2><p data-v-8676fbc3>3D Artist</p><p data-v-8676fbc3>UI Designer</p></div><div class="credits-section" data-v-8676fbc3><h2 data-v-8676fbc3></h2><p data-v-8676fbc3>Sound Designer</p></div><div class="credits-section" data-v-8676fbc3><h2 data-v-8676fbc3></h2><p data-v-8676fbc3></p></div></div>',2)),h("button",{class:"skip-credits-button",onClick:Bh},"")])])):Ie("",!0),ni.value?(V(),ee("div",y9,[h("div",w9,[H[6]||(H[6]=h("h2",{class:"withdraw-title"},"",-1)),h("p",v9,ce(Nc.value),1),h("div",{class:"dialog-buttons"},[h("button",{class:"dialog-button confirm-button",onClick:Wh},"  ")])])])):Ie("",!0),ko.value?(V(),ee("div",S9,[h("div",{class:"game-over-dialog"},[H[7]||(H[7]=h("h2",{class:"withdraw-title"},"",-1)),H[8]||(H[8]=h("p",{class:"game-over-message"},[Vo(""),h("br"),Vo("")],-1)),h("div",{class:"dialog-buttons"},[h("button",{class:"dialog-button cancel-button",onClick:Vh},"  "),h("button",{class:"dialog-button confirm-button",onClick:qh},"  ")])])])):Ie("",!0),h("audio",{ref_key:"audioRef",ref:i,src:ye(r),loop:"",preload:"auto"},null,8,k9),h("audio",{ref_key:"moveSoundRef",ref:a,src:ye(d),preload:"auto"},null,8,M9),h("audio",{ref_key:"moveEnemySoundRef",ref:c,src:ye(p),preload:"auto"},null,8,C9),h("audio",{ref_key:"attackSoundRef",ref:l,src:ye(b),preload:"auto"},null,8,x9),h("audio",{ref_key:"attackEnemySoundRef",ref:u,src:ye(g),preload:"auto"},null,8,P9),h("audio",{ref_key:"meHurtSoundRef",ref:_,src:ye(m),preload:"auto"},null,8,L9),h("audio",{ref_key:"enemyHurtSoundRef",ref:$,src:ye(w),preload:"auto"},null,8,I9)])}}},E9=Vt(T9,[["__scopeId","data-v-8676fbc3"]]),A9={class:"stage"},G9={key:0,style:{position:"relative",width:"100%",height:"100%"}},R9={key:2,class:"modal"},O9={class:"modal-title"},D9={key:2,class:"overlay",style:{"z-index":"30000","align-items":"flex-start","justify-content":"flex-start",background:"rgba(0, 0, 0, 0.25)"}},N9={class:"settings"},j9={class:"settings__header"},H9=["src"],F9={class:"settings__content"},U9={class:"settings__section"},B9={class:"settings__control-options"},z9={__name:"App",setup(e){const t=oe(!1),n=oe(null),o=oe(!1),s=oe(null),i=oe([]);oe(0);const r=oe(!0),a=oe(!1),c=oe("touchpad"),l=oe(!1);let u=null;function _(R){n.value!==R&&(i.value.push(n.value),n.value=R),window.__START_MENU_PAUSE__&&window.__START_MENU_PAUSE__(),t.value=!0}function $(){r.value=!1,u&&clearTimeout(u),u=setTimeout(()=>{r.value||(f("[App] StartMenu"),l.value=!0)},5*60*1e3)}function d(){n.value=null,i.value=[],window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__(),t.value=!1}function p(R){f("[App] ID:",R.ids),d(),a.value=!0,f("[App] ")}function b(){a.value=!1}function g(){const R=Dc();c.value=R.controlMode,o.value=!0,t.value=!0}function m(){o.value=!1,n.value||(window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__(),t.value=!1)}function w(R){c.value=R,uh("controlMode",R),window.updateControlMode&&window.updateControlMode(R),f(`[App] : ${R}`)}function y(){if(o.value){m();return}if(n.value){if(n.value==="warehouse"&&s.value&&s.value.handleBack&&s.value.handleBack())return;const R=i.value.pop()??null;n.value=R,R||(t.value=!1);return}if(!r.value){u&&(clearTimeout(u),u=null),l.value&&(l.value=!1,f("[App] StartMenu")),r.value=!0,setTimeout(()=>{window.__INIT_THREE_SCENE__?window.__INIT_THREE_SCENE__().then(()=>{window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}).catch(()=>{window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()}):window.__START_MENU_RESUME__&&window.__START_MENU_RESUME__()},100),t.value=!1;return}}const v=oe(!0),k=oe(null);function L(){v.value=!v.value,f("[App] :",v.value?"":"")}async function P(){try{f("[App] ...");const R=h7();if(R.type==="error"){f("[App] :",R.content),alert(": "+R.content);return}f("[App] ...");const D=new Blob([JSON.stringify(R,null,2)],{type:"application/json"}),x=document.createElement("a");x.href=URL.createObjectURL(D);const z=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);x.download=`mgpic-save-${z}.json`,x.click(),URL.revokeObjectURL(x.href),f("[App] ")}catch(R){f("[App] :",R),alert("")}}function O(){try{k.value&&k.value.click()}catch{}}async function I(R){try{const D=R.target&&R.target.files&&R.target.files[0];if(!D)return;f("[App] ...");const x=new FileReader;x.onload=async()=>{try{const z=String(x.result||"{}"),ge=JSON.parse(z);f("[App] ..."),f7(z),f("[App] "),alert("")}catch(z){f("[App] :",z),alert(": "+z.message)}R.target.value=""},x.onerror=()=>{f("[App] "),alert(""),R.target.value=""},x.readAsText(D)}catch(D){f("[App] :",D),alert("")}}return hn(()=>{rh(R=>{})}),Ps(()=>{u&&(clearTimeout(u),u=null)}),(R,D)=>(V(),ee("div",A9,[a.value?(V(),kn(E9,{key:0,isGameMode:!0,"music-on":v.value,onBack:b},null,8,["music-on"])):Ie("",!0),a.value?Ie("",!0):(V(),ee(mt,{key:1},[l.value?Ie("",!0):qd((V(),kn(XT,{key:0,visible:r.value,onStarted:$},null,8,["visible"])),[[Lp,r.value]]),r.value?Ie("",!0):(V(),kn(J$,{key:1,"music-on":v.value,onBack:y,onOpenSettings:g,onToggleMusic:L},null,8,["music-on"])),Ct(_1,{"music-on":v.value,paused:n.value==="start"||n.value==="warehouse"||a.value,onStartGame:D[0]||(D[0]=x=>_("start")),onOpenWarehouse:D[1]||(D[1]=x=>_("warehouse")),onOpenTutorial:D[2]||(D[2]=x=>_("tutorial")),onOpenEncyclopedia:D[3]||(D[3]=x=>_("encyclopedia")),onToggleMusic:L},null,8,["music-on","paused"]),n.value?(V(),ee("div",{key:2,class:wt(["overlay",{"overlay--warehouse":n.value==="warehouse"}])},[n.value==="warehouse"?(V(),ee("div",G9,[Ct(J$,{"music-on":v.value,onBack:y,onOpenSettings:g,onToggleMusic:L},null,8,["music-on"]),Ct(PT,{ref_key:"warehouseRef",ref:s,"music-on":v.value},null,8,["music-on"])])):n.value==="start"?(V(),kn(O8,{key:1,"music-on":v.value,paused:a.value,onClose:d,onConfirm:p},null,8,["music-on","paused"])):(V(),ee("div",R9,[h("h2",O9,ce(n.value==="warehouse"?"  Copper Warehouse":n.value==="tutorial"?"  Tutorial":n.value==="encyclopedia"?"  Game Encyclopedia":"  Start Game"),1),D[6]||(D[6]=h("p",{class:"modal-body"},"",-1)),h("button",{class:"close-btn",onClick:d},"")]))],2)):Ie("",!0)],64)),o.value?(V(),ee("div",D9,[h("div",N9,[h("div",j9,[D[7]||(D[7]=h("div",{class:"settings__title"},"",-1)),h("button",{class:"settings__close",onClick:m,"aria-label":""},[h("img",{src:ye(Q)("@assets/ui/close.png"),alt:""},null,8,H9)])]),h("div",F9,[h("div",U9,[D[10]||(D[10]=h("div",{class:"settings__section-title"},"",-1)),h("div",B9,[h("button",{class:wt(["settings__control-btn",{active:c.value==="touchpad"}]),onClick:D[4]||(D[4]=x=>w("touchpad"))},[...D[8]||(D[8]=[h("span",{class:"control-title"},"",-1),h("span",{class:"control-desc"},"",-1)])],2),h("button",{class:wt(["settings__control-btn",{active:c.value==="mouse"}]),onClick:D[5]||(D[5]=x=>w("mouse"))},[...D[9]||(D[9]=[h("span",{class:"control-title"},"",-1),h("span",{class:"control-desc"},"",-1)])],2)])]),h("button",{class:"settings__item",onClick:P},[...D[11]||(D[11]=[xa('<span class="settings__icon" data-v-73f79a12><svg width="44" height="44" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-73f79a12><path d="M12 3v12m0 0l-4-4m4 4l4-4" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-73f79a12></path><path d="M4 19h16" stroke="#fff" stroke-width="2" stroke-linecap="round" data-v-73f79a12></path></svg></span><span class="settings__label" data-v-73f79a12></span>',2)])]),h("button",{class:"settings__item",onClick:O},[...D[12]||(D[12]=[xa('<span class="settings__icon" data-v-73f79a12><svg width="44" height="44" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-73f79a12><path d="M12 21V9m0 0l4 4m-4-4L8 13" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-73f79a12></path><path d="M4 5h16" stroke="#fff" stroke-width="2" stroke-linecap="round" data-v-73f79a12></path></svg></span><span class="settings__label" data-v-73f79a12></span>',2)])]),h("input",{ref_key:"fileInput",ref:k,type:"file",accept:".json",onChange:I,style:{display:"none"}},null,544)])])])):Ie("",!0)]))}},nd=Vt(z9,[["__scopeId","data-v-73f79a12"]]);function V9(){const e=navigator.userAgent;return/Safari/.test(e)&&!/Chrome/.test(e)&&!/Chromium/.test(e)}function q9(){const e=document.getElementById("safari-warning"),t=document.getElementById("loading-screen");e.style.display="flex",t.style.display="none",document.getElementById("download-local").addEventListener("click",()=>{window.open("https://github.com/MGPIC-2025/Cross/releases","_blank")}),document.getElementById("continue-safari").addEventListener("click",()=>{e.style.display="none",t.style.display="flex",dh()}),document.getElementById("download-chrome").addEventListener("click",()=>{window.open("https://www.google.com/chrome/","_blank")})}function hl(e,t,n,o=""){const s=document.getElementById("progress-bar"),i=document.getElementById("progress-text"),r=document.querySelector(".loading-subtitle");s&&(s.style.width=n+"%"),i&&(e===0&&t===0?i.textContent=`${n}%`:i.textContent=`${e} / ${t} (${n}%)`),r&&o&&(r.textContent=o)}function sd(){const e=document.getElementById("loading-screen");e&&(e.classList.add("fade-out"),setTimeout(()=>{e.style.display="none"},500))}async function dh(){try{f("..."),await Dl(hl,["high"]),f(""),hl(0,100,100,"..."),Q_(nd).mount("#app"),await new Promise(t=>setTimeout(t,200)),window.__INIT_THREE_SCENE__&&await window.__INIT_THREE_SCENE__((t,n,o)=>{hl(0,0,o,`3D... ${o}%`)}),f(""),setTimeout(()=>{sd()},300),setTimeout(async()=>{try{f("..."),await Dl(null,["medium"]),f("")}catch(t){f(":",t)}},1e3)}catch(e){f(":",e),Q_(nd).mount("#app"),sd()}}V9()?(f("Safari"),q9()):(f("Safari"),dh());
